<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="wolfand11" />



<meta name="description" content="1 Unity GUI">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity GUI">
<meta property="og:url" content="http://wolfand11.coding.me/2017/01/01/unity/UnityGUI/index.html">
<meta property="og:site_name" content="wolfand11's blog">
<meta property="og:description" content="1 Unity GUI">
<meta property="og:updated_time" content="2017-04-02T12:45:46.215Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity GUI">
<meta name="twitter:description" content="1 Unity GUI">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="wolfand11&#39;s blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>Unity GUI | wolfand11&#39;s blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/images/m_lambda-320.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">wolfand11</a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" href="https://github.com/wolfand11" title="GitHub"></a>
                            
                                <a class="fa 豆瓣" href="https://www.douban.com/people/wolfand11" title="豆瓣"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/InitPC/">InitPC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ai/">ai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/architecture/">architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/art/">art</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/artist/">artist</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/behaviortree/">behaviortree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book/">book</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/">cmd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cryptology/">cryptology</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csharp/">csharp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/decode/">decode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elisp/">elisp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/emacs/">emacs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/encode/">encode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/framework/">framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fsm/">fsm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game-engine/">game engine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gameplay/">gameplay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/graphics/">graphics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gui/">gui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hot-update/">hot-update</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/htn/">htn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/language/">language</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lua/">lua</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matlab/">matlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mvc/">mvc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ngui/">ngui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resource/">resource</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/script/">script</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slua/">slua</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/software-architecture/">software architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spacemacs/">spacemacs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ugui/">ugui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unity/">unity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unity-doc/">unity-doc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/working-in-unity/">working-in-unity</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="http://xtutu.me/">xtutu</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">wolfand11</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/images/m_lambda-320.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">wolfand11</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/wolfand11" title="GitHub"></a>
                            
                                <a class="fa 豆瓣" target="_blank" href="https://www.douban.com/people/wolfand11" title="豆瓣"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-unity/UnityGUI" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/01/unity/UnityGUI/" class="article-date">
      <time datetime="2016-12-31T16:00:00.000Z" itemprop="datePublished">2017-01-01</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Unity GUI
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/unity/">unity</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gui/">gui</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ngui/">ngui</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ugui/">ugui</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/unity/">unity</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        


<div id="outline-container-orgheadline29" class="outline-2">
<h2 id="orgheadline29"><span class="section-number-2">1</span> Unity GUI</h2>
<div class="outline-text-2" id="text-1">
<a id="more"></a>
<ul class="org-ul">
<li>顶点属性如何管理？ 位置-颜色-贴图坐标 旋转-缩放<br></li>
<li>渲染顺序如何管理？<br></li>
<li>UI 事件如何处理？<br></li>
<li>多分辨率如何实现？<br></li>
</ul>
</div>
<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27"><span class="section-number-3">1.1</span> NGUI</h3>
<div class="outline-text-3" id="text-1-1">
</div><div id="outline-container-orgheadline2" class="outline-4">
<h4 id="orgheadline2"><span class="section-number-4">1.1.1</span> UIRoot UIRect UIRect.AnchorPoint</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
UIRoot 组件的作用是缩放 UI 为 2/(Screen.height)<br>
UIRect.OnAnchor 中会根据该 ui 元素的 4 个 AnchorPoint 计算出来自己的 position，如果有变化，就会更新。<br>
UIRect.GetSides 是用来获得该 ui 元素的四个角(lb lt rt rb)的坐标的<br>
AnchorPoint.GetSides 调用了 AnchorPoint 的 target.GetSides()<br>
</p>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #00ffff;">public</span> <span style="color: #98fb98;">Vector3</span>[] AnchorPoint.<span style="color: #87cefa;">GetSides</span> (<span style="color: #98fb98;">Transform</span> <span style="color: #eedd82;">relativeTo</span>)
{
    <span style="color: #00ffff;">if</span> (target != <span style="color: #7fffd4;">null</span>)
    {
        <span style="color: #00ffff;">if</span> (rect != <span style="color: #7fffd4;">null</span>) <span style="color: #00ffff;">return</span> rect.GetSides(relativeTo);
        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">cam</span> = target.GetComponent&lt;Camera&gt;();
        <span style="color: #00ffff;">if</span> (cam != <span style="color: #7fffd4;">null</span>) <span style="color: #00ffff;">return</span> cam.GetSides(relativeTo);
    }
    <span style="color: #00ffff;">return</span> <span style="color: #7fffd4;">null</span>;
}
</pre>
</div>
</div>
<ol class="org-ol"><li><a id="orgheadline1"></a><span class="todo TODO">TODO</span> 多分辨率如何实现？<br></li></ol>
</div>

<div id="outline-container-orgheadline8" class="outline-4">
<h4 id="orgheadline8"><span class="section-number-4">1.1.2</span> UIPanel-UIWidget-UIGeometry-UIDrawCall</h4>
<div class="outline-text-4" id="text-1-1-2">
</div><ol class="org-ol"><li><a id="orgheadline5"></a>顶点属性如何管理？ 位置-颜色-贴图坐标 旋转-缩放<br><ol class="org-ol"><li><a id="orgheadline3"></a>数据记录<br><div class="outline-text-6" id="text-1-1-2-1-1">
<ol class="org-ol">
<li>每个 UIWidget 包含一个 UIGeomery 来存储该 UI 的几何信息 - 顶点位置 verts 顶点贴图坐标 uvs 顶点颜色 cols，这 3 个都是 List；<br></li>
<li>UIText UISprite 等给 UIGeometry 填充的几何数据都是本地坐标，UIGeometry 通过 ApplyTransform 生成 mRtpVerts mRtpNormal mRtpTan；<br></li>
<li>每个 UIPanel 下包含一个 List&lt;UIDrawCall&gt; drawCalls 用来存储该 UIPanel 下所有的 DrawCall 信息；<br></li>
<li>每个 UIDrawCall 包含了绘制需要的一切信息，如下为 UIDrawCall 的部分代码：<br></li>
</ol>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #00ffff;">public</span> <span style="color: #98fb98;">int</span> <span style="color: #eedd82;">widgetCount</span> = 0;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">int</span> <span style="color: #eedd82;">depthStart</span> = <span style="color: #98fb98;">int</span>.MaxValue;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">int</span> <span style="color: #eedd82;">depthEnd</span> = <span style="color: #98fb98;">int</span>.MinValue;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">UIPanel</span> <span style="color: #eedd82;">manager</span>;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">UIPanel</span> <span style="color: #eedd82;">panel</span>;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">Texture2D</span> <span style="color: #eedd82;">clipTexture</span>;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">bool</span> <span style="color: #eedd82;">alwaysOnScreen</span> = <span style="color: #7fffd4;">false</span>;
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector3</span>&gt; verts = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">List</span>&lt;Vector3&gt;();
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector3</span>&gt; norms = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">List</span>&lt;Vector3&gt;();
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector4</span>&gt; tans = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">List</span>&lt;Vector4&gt;();
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector2</span>&gt; uvs = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">List</span>&lt;Vector2&gt;();
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector4</span>&gt; uv2 = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">List</span>&lt;Vector4&gt;();
<span style="color: #00ffff;">public</span> <span style="color: #98fb98;">List</span>&lt;Color&gt; <span style="color: #eedd82;">cols</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">List</span>&lt;Color&gt;();

<span style="color: #98fb98;">Material</span>                <span style="color: #eedd82;">mMaterial</span>;              <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Material used by this draw call</span>
<span style="color: #98fb98;">Texture</span>         <span style="color: #eedd82;">mTexture</span>;               <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Main texture used by the material</span>
<span style="color: #98fb98;">Shader</span>          <span style="color: #eedd82;">mShader</span>;                <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Shader used by the dynamically created material</span>
<span style="color: #98fb98;">int</span>                     <span style="color: #eedd82;">mClipCount</span> = 0; <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Number of times the draw call's content is getting clipped</span>
<span style="color: #98fb98;">Transform</span>           <span style="color: #eedd82;">mTrans</span>;                     <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Cached transform</span>
<span style="color: #98fb98;">Mesh</span>                    <span style="color: #eedd82;">mMesh</span>;                  <span style="color: #ff0000;">// </span><span style="color: #ff0000;">First generated mesh</span>
<span style="color: #98fb98;">MeshFilter</span>      <span style="color: #eedd82;">mFilter</span>;                <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Mesh filter for this draw call</span>
<span style="color: #98fb98;">MeshRenderer</span>    <span style="color: #eedd82;">mRenderer</span>;              <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Mesh renderer for this screen</span>
<span style="color: #98fb98;">Material</span>                <span style="color: #eedd82;">mDynamicMat</span>;    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Instantiated material</span>
<span style="color: #98fb98;">int</span>[]               <span style="color: #eedd82;">mIndices</span>;           <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Cached indices</span>
</pre>
</div>
</div></li>
<li><a id="orgheadline4"></a>数据更新<br><div class="outline-text-6" id="text-1-1-2-1-2">
<ul class="org-ul">
<li>渲染所需数据的更新都是从 UIPanel-&gt;LateUpdate 驱动的。<br></li>
<li>UIWidget 的 geomery 对象数据的更新<br>
UIWidget 在 UpdateGeometry 中触发 OnFill 方法。<br>
      UIWidget 的子类中在 OnFill 方法内会填充 geomery 数据。例如：UILabel 是在 OnFill 中调用 NGUIText.Print()来填充 geometry 数据的。<br></li>
<li>UIPanel 下 drawCalls 的数据更新<br>
情况 1：<br>
UIWidget 在 UpdateGeometry 中标记 drawCall 为 dirty<br>
UIPanel 在 UpdateSelf 中触发 FillDrawCall 来填充需要修改的 drawCall 的数据<br>
情况 2：<br>
UIPanel 在 FillAllDrawCall 中填充所有 drawCall 的数据<br></li>
</ul>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #ff0000;">// </span><span style="color: #ff0000;">-------------------------------------------------</span>
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">-- UIPanel</span>
<span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIPanel</span>::LateUpdate()
{
    <span style="color: #00ffff;">if</span> (mUpdateFrame != Time.frameCount)
    {
        <span style="color: #ff0000;">// </span><span style="color: #ff0000;">1 &#39318;&#20808;&#26356;&#26032;&#25152;&#26377; UIPanel. list &#20026; UIPanel &#30340;&#38745;&#24577;&#21464;&#37327;&#65292;&#20854;&#20013;&#23384;&#20648;&#20102;&#25152;&#26377;&#30340; UIPanel</span>
        <span style="color: #00ffff;">for</span> (i=0; i&lt;list.Count; i++)
        {
            list[i].UpdateSelf();
        }
    }
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">2 &#20854;&#27425;&#26356;&#26032;&#25152;&#26377;&#30340; draw calls&#65292;&#35753;&#23427;&#20204;&#20197;&#27491;&#30830;&#30340;&#28210;&#26579;&#39034;&#24207;&#28210;&#26579;</span>
}


<span style="color: #ff0000;">/// </span><span style="color: #ff0000;">&#26356;&#26032;&#24403;&#21069; panel &#20197;&#21450;&#23427;&#30340;&#25152;&#26377; widgets &#21644; draw calls</span>
<span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIPanel</span>::UpdateSelf()
{
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#20462;&#25913;&#33258;&#24049;&#30340; transform matrix</span>
    UpdateTransformMatrix();

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#26356;&#26032;&#33258;&#24049;&#20197;&#21450;&#27599;&#20010; widget &#30340; layer</span>
    UpdateLayers();

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#35843;&#29992;&#27599;&#20010; widget &#30340; UpdateTransform UpdateVisibility UpdateGeometry</span>
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#35843;&#29992; UpdateGeometry &#36820;&#22238; true&#65292;&#23601;&#23558;&#24403;&#21069; widget &#30340; drawCall &#26631;&#35760;&#20026; dirty</span>
    UpdateWidgets();

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#26356;&#26032; DrawCall</span>
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">1 &#22914;&#26524;&#38656;&#35201;&#37325;&#24314; DrawCall&#65288;&#20363;&#22914;&#65292;&#22312;&#19968;&#24320;&#22987;&#26174;&#31034; Panel &#30340;&#26102;&#20505;&#65289;&#65292;&#21017;&#28165;&#31354;&#25152;&#26377; DrawCall&#65292;&#35843;&#29992; FillAllDrawCall &#37325;&#26032;&#21019;&#24314;&#25152;&#26377; DrawCall</span>
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">2 &#36941;&#21382; drawCalls &#35843;&#29992; FillDrawCall &#26356;&#26032;&#27599;&#19968;&#20010;&#34987;&#26631;&#35760;&#20026; dirty &#30340; DrawCall</span>
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#22312;&#36825;&#20010;&#36807;&#31243;&#20013;&#20250;&#35843;&#29992; widget &#30340; WriteToBuffers(drawCall.verts,drawCalls.uvs,drawCalls.cols,drawCalls.normals)</span>
    <span style="color: #00ffff;">if</span> (mRebuild)
    {
        mRebuild = <span style="color: #7fffd4;">false</span>;
        FillAllDrawCall();
    }
    <span style="color: #00ffff;">else</span>
    {
        <span style="color: #00ffff;">foreach</span>(dc <span style="color: #00ffff;">in</span> drawCalls)
        {
            <span style="color: #00ffff;">if</span> (dc.isDirty &amp;&amp; !FillDrawCall(dc))
                <span style="color: #ff0000;">// </span><span style="color: #ff0000;">-- remove dc</span>
                }
    }
}

<span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#26356;&#26032; DrawCall</span>
<span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIPanel</span>::FillAllDrawCall()
{
    <span style="color: #00ffff;">foreach</span>(w <span style="color: #00ffff;">in</span> widgets)
    {
        <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#22914;&#26524;&#19981;&#33021;&#20849;&#29992;&#21069;&#38754; widget &#30340; drawCall&#65292;&#21017;&#26032;&#24314;&#19968;&#20010; drawCall</span>
        <span style="color: #ff0000;">// </span><span style="color: #ff0000;">mat texture shader &#26377;&#19968;&#20010;&#19981;&#21516;&#21017;&#19981;&#33021;&#20849;&#29992; drawCall</span>
        dc = UIDrawCall.Create(<span style="color: #00ffff;">this</span>, mat, tex, sdr);
    }
}
<span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIPanel</span>::FillDrawCall(<span style="color: #98fb98;">UIDrawCall</span> <span style="color: #eedd82;">dc</span>)
{
    <span style="color: #00ffff;">foreach</span>(w <span style="color: #00ffff;">in</span> widgets)
    {
        <span style="color: #00ffff;">if</span>(w.drawCall == dc)
        {
            <span style="color: #ff0000;">//</span>
            <span style="color: #00ffff;">if</span> (generateNormals) w.WriteToBuffers(dc.verts, dc.uvs, dc.cols, dc.norms, dc.tans, generateUV2 ? dc.uv2 : <span style="color: #7fffd4;">null</span>);
            <span style="color: #00ffff;">else</span> w.WriteToBuffers(dc.verts, dc.uvs, dc.cols, <span style="color: #7fffd4;">null</span>, <span style="color: #7fffd4;">null</span>, generateUV2 ? dc.uv2 : <span style="color: #7fffd4;">null</span>);
        }
    }
}

<span style="color: #ff0000;">// </span><span style="color: #ff0000;">-------------------------------------------------</span>
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">-- UIWidget</span>
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#21028;&#26029; widget &#30456;&#23545;&#20110; UIPanel &#26159;&#21542;&#26377;&#20301;&#32622;&#21464;&#21270; &#26356;&#26032; mMoved &#29366;&#24577;</span>
<span style="color: #98fb98;">bool</span> <span style="color: #87cefa;">UIWidget</span>::UpdateTransform();
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#26356;&#26032; widget &#30340;&#21487;&#35265;&#24615;&#29366;&#24577; mIsVisibleByAlpha(widget &#30340; alpha &#26159;&#21542;&#20026; 0) mIsVisibleByPanel(widget &#26159;&#21542;&#22312;&#21487;&#35270;&#21306;&#22495;&#20869;)</span>
<span style="color: #98fb98;">bool</span> <span style="color: #87cefa;">UIWidget</span>::UpdateVisibility();
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#21028;&#26029; widget &#30340;&#20960;&#20309;&#20449;&#24687;&#26159;&#21542;&#25913;&#21464; &#26356;&#26032; widget &#30340;&#20960;&#20309;&#20449;&#24687;</span>
<span style="color: #98fb98;">bool</span> <span style="color: #87cefa;">UIWidget</span>::UpdateGeometry();
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#35843;&#29992;&#23558;&#33258;&#24049;&#30340; geometry-&gt;WriteToBuffers &#26041;&#27861;&#65292;&#23558; geometry &#30340;&#20960;&#20309;&#25968;&#25454;&#21152;&#21040; drawCall &#23545;&#24212;&#30340; List &#20013;</span>
<span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIWidget</span>::WriteToBuffers(<span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector3</span>&gt; v, <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector2</span>&gt; u, <span style="color: #98fb98;">List</span>&lt;Color&gt; <span style="color: #eedd82;">c</span>, <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector3</span>&gt; n, <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector4</span>&gt; t, <span style="color: #98fb98;">List</span>&lt;<span style="color: #98fb98;">Vector4</span>&gt; u2);
</pre>
</div>
<ul class="org-ul">
<li><p>
Mesh 数据更新<br>
</p>
<ol class="org-ol">
<li>UIPanel 在 FillDrawCall 或 FillAllDrawCall 中调用 UIDrawCall 的 UpdateGeometry；<br></li>
</ol>
<ol class="org-ol">
<li>UIDrawCall 在 UpdateGeometry 中会创建 Mesh（如果已经存在，则用已存在的），并为 Mesh 设置数据。如下：<br></li>
<li>在创建 UIDrawCall 的时候会创建一个 GameObject，并将 UIDrawCall 组件加到该 GameObject 上，MeshFilter、MeshRenderer 都会加到该 GameObject 上。<br></li>
<li>UIDrawCall 所属的 GameObject 在编辑器的场景树中是不可见的，可以在 UIDrawCall 脚本中，开启宏定义 #define SHOW_HIDDEN_OBJECTS，来显示隐藏的 GameObject。<br></li>
</ol>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIDrawCall</span>::UpdateGeometry()
{
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">1. &#21019;&#24314; MeshFilter</span>
    <span style="color: #00ffff;">if</span> (mFilter == <span style="color: #7fffd4;">null</span>) mFilter = gameObject.AddComponent&lt;MeshFilter&gt;();

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">2. &#21019;&#24314; Mesh &#22635;&#20805;&#25968;&#25454;</span>
    <span style="color: #00ffff;">if</span> (mMesh == <span style="color: #7fffd4;">null</span>) mMesh = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">Mesh</span>();

    mMesh.SetVertices(verts);
    mMesh.SetUVs(0, uvs);
    mMesh.SetColors(cols);
    mMesh.SetUVs(1, (uv2.Count == vertexCount) ? uv2 : <span style="color: #7fffd4;">null</span>);
    mMesh.SetNormals((norms.Count == vertexCount) ? norms : <span style="color: #7fffd4;">null</span>);
    mMesh.SetTangents((tans.Count == vertexCount) ? tans : <span style="color: #7fffd4;">null</span>);

    mFilter.mesh = mMesh;

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">3. &#21019;&#24314; MeshRenderer</span>
    <span style="color: #00ffff;">if</span> (mRenderer == <span style="color: #7fffd4;">null</span>) mRenderer = gameObject.AddComponent&lt;MeshRenderer&gt;();
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">-- &#21019;&#24314;&#26448;&#36136;&#20026; mRenderer &#35774;&#32622;&#26448;&#36136;</span>
    UpdateMaterials();
}

<span style="color: #ff0000;">//</span>
<span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIDrawCall</span>::UpdateMaterials()
{
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Destroy the old material</span>
    NGUITools.DestroyImmediate(mDynamicMat);

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Create a new material</span>
    CreateMaterial();
    mDynamicMat.renderQueue = mRenderQueue;

    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">Update the renderer</span>
    <span style="color: #00ffff;">if</span> (mRenderer != <span style="color: #7fffd4;">null</span>)
    {
        mRenderer.sharedMaterials = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">Material</span>[] { mDynamicMat };
        mRenderer.sortingLayerName = mSortingLayerName;
        mRenderer.sortingOrder = mSortingOrder;
    }
}
</pre>
</div></li>
</ul>
</div></li></ol></li>
<li><a id="orgheadline7"></a>渲染顺序如何管理？<br><div class="outline-text-5" id="text-1-1-2-2">
<ul class="org-ul">
<li><p>
Unity 中渲染顺序<br>
Unity 中渲染顺序按照一下优先级来进行<br>
</p>
<ol class="org-ol">
<li>Camera 的 depth 越小越先渲染<br></li>
<li>Renderer 的 sortingLayer 越小越先渲染 (默认的 sortingLayer 为 Default 其值为 0)<br></li>
<li>Renderer 的 sortingOrder 越小越先渲染（默认值为 0）<br></li>
<li>Renderer.material.renderQueue 越小越先渲染<br></li>
</ol>
<p>
需要注意的是先渲染不一定就在后面，因为如果开启了深度测试，可能后渲染的物体部分像素的深度值比当前帧缓存区中已经存在的像素深度值大，该物体的这部分像素就不会被渲染到帧缓存区中。<br>
</p></li>
<li><p>
NGUI 中渲染顺序<br>
</p>
<ol class="org-ol">
<li>UIDrawCall 中有 mSortingOrder、mRenderQueue<br></li>
<li>UIDrawCall 的 mSortingOrder 会赋值给 mRenderer.sortingOrder<br></li>
<li>UIDrawCall 的 mRenderQueue 会赋值给 mDynamicMat.renderQueue<br></li>
<li>所有 UIPanel 都会按照 depth 来排序（在 UIPanel 的 OnInit 中会将自己添加到 list 中，并对 list 进行排序），UIPanel 下的所有 UIDrawCall 有相同的 sortingOrder，这个值为 UIPanel 在 list 中索引值。<br></li>
<li>在 UIPanel 的 LateUpdate 中，设置初始的 preRenderQueue=2999，遍历每个 UIPanel 下的每个 UIDrawCall 依次为每个 UIDrawCall 指定 renderQueue=preRenderQueue+1<br></li>
<li>每个 UIWidget 都会按照 depth 来排序(在 UIPanel 的 AddWidget 函数中)，在为 UIDrawCall 填充数据时（FillDrawCall/FillAllDrawCall），depth 小的 UIWidget，其数据会先被使用。<br></li>
</ol>
<p>
所以，NGUI 中渲染顺序是通过 depth 来决定的。<br>
对于 UIPanel 来说 depth 小的先渲染，depth 相同时，先加入 list 的先渲染。<br>
对于 UIWidget 来说，UIWidget 所属 UIPanel 不同时，哪个 UIPanel 先渲染其 widget 也先渲染；UIWidget 所属 UIPanel 相同时，depth 小的先渲染，depth 相同时，先加入 UIPanel widgets 中的先渲染。<br>
</p></li>
<li>关于 Material.renderQueue<br>
该属性指定了材质的渲染队列。默认情况下材质会使用它的 shader 中指定的渲染队列。一旦通过材质设置了 renderQueue 属性就会覆盖 shader 中设置的值。<br>
渲染队列的值为正数才能正常工作；当设置材质的 renderQueue 为-1 时，表示材质渲染使用 shader 中设置的 renderQueue.<br></li>
<li>关于 Renderer.sortingOrder<br>
该属性表示 Render 在一个层中的排序，它的值在-32768 到-32767 区间内。<br></li>
</ul>
</div>
<ol class="org-ol"><li><a id="orgheadline6"></a>参考链接<br><div class="outline-text-6" id="text-1-1-2-2-1">
<p>
<a href="https://docs.unity3d.com/ScriptReference/Material-renderQueue.html" target="_blank" rel="external">https://docs.unity3d.com/ScriptReference/Material-renderQueue.html</a><br>
<a href="http://www.cnblogs.com/Persona/p/4149086.html" target="_blank" rel="external">http://www.cnblogs.com/Persona/p/4149086.html</a><br>
</p>
</div></li></ol></li></ol>
</div>
<div id="outline-container-orgheadline9" class="outline-4">
<h4 id="orgheadline9"><span class="section-number-4">1.1.3</span> <span class="todo TODO">TODO</span> UICamera</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
UICamera 中可以配置事件处理在 Update 还是 LateUpdate 中进行，通常情况下，应该在 Update 中执行事件处理，因为 UI 渲染数据的更新是在 LateUpdate 中进行的。<br>
</p>
</div>
</div>
<div id="outline-container-orgheadline26" class="outline-4">
<h4 id="orgheadline26"><span class="section-number-4">1.1.4</span> Q&amp;A</h4>
<div class="outline-text-4" id="text-1-1-4">
</div><ol class="org-ol"><li><a id="orgheadline12"></a>material 是如何来的？shader 是如何来的？<br><ol class="org-ol"><li><a id="orgheadline10"></a>UILabel<br><div class="outline-text-6" id="text-1-1-4-1-1">
<p>
UILabel 中 material 来自字体。<br>
UILabel 的 shader 有通过 material 来获得<br>
</p>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #ff0000;">// </span><span style="color: #ff0000;">UILabel</span>
<span style="color: #00ffff;">public</span> <span style="color: #00ffff;">override</span> <span style="color: #98fb98;">Material</span> <span style="color: #eedd82;">material</span>
{
    <span style="color: #00ffff;">get</span>
    {
        <span style="color: #00ffff;">if</span> (mMat != <span style="color: #7fffd4;">null</span>) <span style="color: #00ffff;">return</span> mMat;
        <span style="color: #00ffff;">if</span> (mFont != <span style="color: #7fffd4;">null</span>) <span style="color: #00ffff;">return</span> mFont.material;
        <span style="color: #00ffff;">if</span> (mTrueTypeFont != <span style="color: #7fffd4;">null</span>) <span style="color: #00ffff;">return</span> mTrueTypeFont.material;
        <span style="color: #00ffff;">return</span> <span style="color: #7fffd4;">null</span>;
    }
    <span style="color: #00ffff;">set</span>
    {
        <span style="color: #00ffff;">base</span>.material = value;
    }
}
<span style="color: #ff0000;">// </span><span style="color: #ff0000;">UIWidget</span>
<span style="color: #00ffff;">public</span> <span style="color: #00ffff;">virtual</span> <span style="color: #98fb98;">Shader</span> <span style="color: #eedd82;">shader</span>
{
    <span style="color: #00ffff;">get</span>
    {
        <span style="color: #98fb98;">Material</span> <span style="color: #eedd82;">mat</span> = material;
        <span style="color: #00ffff;">return</span> (mat != <span style="color: #7fffd4;">null</span>) ? mat.shader : <span style="color: #7fffd4;">null</span>;
    }
    <span style="color: #00ffff;">set</span>
    {
        <span style="color: #00ffff;">throw</span> <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">System.NotImplementedException</span>(GetType() + <span style="color: #ffa07a;">" has no shader setter"</span>);
    }
}
</pre>
</div>
</div></li>
<li><a id="orgheadline11"></a>UISprite<br><div class="outline-text-6" id="text-1-1-4-1-2">
<p>
UISprite 的 material 来自 UIAtlas<br>
UISprite 的 shader 通过 material 来获得<br>
</p>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #00ffff;">public</span> <span style="color: #00ffff;">override</span> <span style="color: #98fb98;">Material</span> <span style="color: #eedd82;">material</span>
{
    <span style="color: #00ffff;">get</span>
    {
        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">mat</span> = <span style="color: #00ffff;">base</span>.material;
        <span style="color: #00ffff;">if</span> (mat != <span style="color: #7fffd4;">null</span>) <span style="color: #00ffff;">return</span> mat;
        <span style="color: #00ffff;">return</span> (mAtlas != <span style="color: #7fffd4;">null</span> ? mAtlas.spriteMaterial : <span style="color: #7fffd4;">null</span>);
    }
    <span style="color: #00ffff;">set</span>
    {
        <span style="color: #00ffff;">base</span>.material = value;
    }
}
</pre>
</div>
</div></li></ol></li>
<li><a id="orgheadline17"></a>什么时候会重新构建 UIDrawCall，如何避免？<br><ol class="org-ol"><li><a id="orgheadline13"></a>重新构建 UIPanel 下的某个 drawCall<br><div class="outline-text-6" id="text-1-1-4-2-1">
<ol class="org-ol">
<li>在该 Panel 下添加新的节点，当找到该节点适用的 UIDrawCall 时，会标记 drawCall dirty，在随后的更新中会重新给该 drawCall 填充数据。<br></li>
<li>删除或者 disable Panel 下某个 UIWidget 时，会标记该 UIWidget 的 drawCall dirty（也可能标记 UIPanel 的所有 drawCalls 都需要重新创建）<br></li>
<li>enable Panel 下某个 UIWidget 时，会调用该 UIWidget 的 OnInit 方法，该方法会引起一下处理：<br>
<a id="orgtarget1"></a><br>
<ul class="org-ul">
<li>调用 FindDrawCall，为 widget 指定 drawCall，如果没有合适的 drawCall 会 UIPanel 标记 mRebuild=true<br></li>
<li>标记 UIWidget 的 mChanged=true，在随后的更新中会重新给该 UIWdiget 填充几何数据，标识它的 drawCall 为 dirty<br></li>
</ul></li>
</ol>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #00ffff;">public</span> <span style="color: #98fb98;">void</span> <span style="color: #87cefa;">RemoveWidget</span> (<span style="color: #98fb98;">UIWidget</span> <span style="color: #eedd82;">w</span>)
{
    <span style="color: #00ffff;">if</span> (widgets.Remove(w) &amp;&amp; w.drawCall != <span style="color: #7fffd4;">null</span>)
    {
        <span style="color: #98fb98;">int</span> <span style="color: #eedd82;">depth</span> = w.depth;
        <span style="color: #00ffff;">if</span> (depth == w.drawCall.depthStart || depth == w.drawCall.depthEnd)
            mRebuild = <span style="color: #7fffd4;">true</span>;

        w.drawCall.isDirty = <span style="color: #7fffd4;">true</span>;
        w.drawCall = <span style="color: #7fffd4;">null</span>;
    }
}
</pre>
</div>
</div></li>
<li><a id="orgheadline14"></a>重新构建 UIPanel 下的所有 drawCalls？<br><div class="outline-text-6" id="text-1-1-4-2-2">
<ol class="org-ol">
<li>在 UIPanel 的 OnInit 中会标记 mRebuild=true，即重新生成 drawCalls<br></li>
<li>在该 Panel 下添加新的节点，当找不到该节点适用的 UIDrawCall 时（即 FindDrawCall 失败），会标记 mRebuild=true<br></li>
<li><p>
修改 UIPanel 下某个 UIWidget 的 depth 时 会先调用 会标记 mRebuild=true。<br>
</p>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #00ffff;">if</span> (mDepth != value)
{
    <span style="color: #00ffff;">if</span> (panel != <span style="color: #7fffd4;">null</span>) panel.RemoveWidget(<span style="color: #00ffff;">this</span>);
    mDepth = value;

    <span style="color: #00ffff;">if</span> (panel != <span style="color: #7fffd4;">null</span>)
    {
        panel.AddWidget(<span style="color: #00ffff;">this</span>);

        <span style="color: #00ffff;">if</span> (!Application.isPlaying)
        {
            panel.SortWidgets();
            panel.RebuildAllDrawCalls();
        }
    }
}
</pre>
</div></li>
<li><a href="#orgtarget1">3</a><br></li>
</ol>
</div></li>
<li><a id="orgheadline15"></a>避免 DrawCall 重新构建的方案<br><div class="outline-text-6" id="text-1-1-4-2-3">
<ol class="org-ol">
<li>在 UI 制作时就将所有用到的 UI 元素拼到 prefab 中，避免动态添加 UIWidget 节点到已经显示的 UIPanel.<br></li>
<li>如果无法避免动态添加 UI 元素，那么在所属 UIPanel 显示之前将 UIWidget 添加到 UIPanel 上.<br>
<ul class="org-ul">
<li>考虑到 UI 元素的复用，如：HeroIcon EquipIcon PropIcon<br></li>
</ul></li>
<li>如果当前 UIPanel 下的 UI 元素已经很多，第一次构建该 UIPanel 的 DrawCall 已经很卡了，那么可以考虑为暂时不显示的 UI 元素新建另外一个 UIPanel.<br>
例如：在商店 UIPanel 下有 装备 物品 碎片三个页签，每个页签下分别有 16 个物品，此时如果共享一个 UIPanel 卡的话，可以为这三个页签分别创建一个 UIPanel.<br></li>
<li>对于需要暂时隐藏的 UIPanel，不要使用 gameObject.SetActive(false) 或者 panel.enabled=false<br></li>
<li>对于需要暂时隐藏的 UIWidget，不要使用 SetActive(false)或 enabled=false 的方法，该方法会将 widget 从 UIPanel 中移除。<br>
如果该 widget 所用的 DrawCall 只用来渲染该 widget，那么它的 DrawCall 也会从 UIPanel 中移除，下次再显示时，需要重新创建 UIPanel 的所有 drawCall。<br>
如果该 widget 所用的 DrawCall 还用来渲染其他 widget，那么它的 DrawCall 不会从 UIPanel 中移除，下次再显示时，需要重新填充该 DrawCall 的数据。<br>
可以将需要暂时隐藏的 UIWidget 移动到屏幕外面，下次再显示时，移动回来就可以了。也可以将需要暂时隐藏的 UIWidget 的 z 值设置为某个很大或很小的值，将 UIWidget 移到摄像机视景体外面，下次再显示时将 z 值设置为 0 就可以了。<br>
按照上面的方式，当修改 UIWidget 的 Transform 时，会标记当前 UIWidget 的 DrawCall 为 dirty，需要重新填充该 DrawCall 的数据。<br></li>
<li>尽量不要修改 UIWidget depth。对于需要修改 UIWidget depth 的情况，可以考虑通过修改 UIPanel 的 depth 来实现，修改 UIPanel 的 depth 不会造成重新构建 DrawCall。<br></li>
</ol>
</div></li>
<li><a id="orgheadline16"></a>DrawCall 的优化方法<br><div class="outline-text-6" id="text-1-1-4-2-4">
<p>
PanelTool 可以统计每个 UIPanel 的 DrawCall 次数<br>
UIDrawCallTool 可以查看每个 Panel 的 UIDrawCall 是如何产生的<br>
根据上面两个工具定位 DrawCall 需要优化的 UI 元素，从而对其进行优化。<br>
</p>
</div></li></ol></li>
<li><a id="orgheadline18"></a>如何降低 UI 的 DrawCall？<br><div class="outline-text-5" id="text-1-1-4-3">
<p>
在 UIPanel 的 UpdateSelf 中，所有 widget 填充完自己的几何数据以后，开始遍历每个 widget 生成 UIDrawCall，当 widget 使用的 material texture shader 中任何一个和前一个不同，就会创建新的 UIDrawCall。所以，可以采用下面几种方法：<br>
</p>
<ol class="org-ol">
<li>尽量将 UI 图片打包，可以让 Sprite 共用相同的材质，贴图和 shader，从而减少 DrawCall<br></li>
<li>尽量少使用 UIPanel，这样可以让更多的 UI 元素共用 UIDrawCall。<br>
需要注意的是 UIPanel 中所含 UIWidget 越多，重建 UIPanel 的 drawCalls 越花时间。<br></li>
<li>尽量将同时可见的 UILabel 的 depth 调整为一样的值，这样可以让 UILabel 共用一个 UIDrawCall。尽量将共用同一个 atlas 的 UISprite 的 depth 调整为一样或者属于一个范围的，这样它们可以共用一个 atlas。为 UILabel 和 UISprite 采用不同范围的深度值。<br></li>
<li>不同的字体会造成 UILabel 的 material、texture 不同，所以不能共用相同的 UIDrawCall。但是，字体相同大小大小不同不会影响。因此，尽量采用相同的字体，并为不同字体的 UILabel 采用不同范围的深度值。<br></li>
</ol>
</div></li>
<li><a id="orgheadline19"></a>如何降低 UI 的 OverDraw？<br><div class="outline-text-5" id="text-1-1-4-4">
<p>
在编辑器的 Scene 视图中，点击左上角下拉按钮，选择 Miscellaneous-OverDraw 可以查看场景中 OverDraw 的状态，分析产生 OverDraw 的 UI 界面：<br>
</p>
<ol class="org-ol">
<li>如果这些界面是暂时完全不可见的，可以修改这些界面的 z 值，将界面移除到视景体外。<br></li>
<li>如果这些界面是不常显示的，可以将 UI 界面直接 Destroy 或者 SetActive(false)<br></li>
<li>如果这些界面是部分显示，部分不显示的，考虑这两部分是不是可以拆分开，可以拆分的话，不显示的部分处理可以参考 1、2 这两条方案。<br></li>
<li>UILabel 的 Outline 和 Shadow 特效创建了多个 UILabelMesh，会造成 OverDraw，尽量减少 Outline 和 Shadow 特效。<br></li>
</ol>
</div></li>
<li><a id="orgheadline20"></a>在渲染前，NGUI 对顶点坐标数据进行 模型变换 视图变换 在哪儿进行的？<br><div class="outline-text-5" id="text-1-1-4-5">
<p>
在 shader 中进行，例如 UILabel 的 shader 为 Unlit - Text.shader，其内容如下<br>
</p>
<div class="org-src-container">

<pre class="src src-c"><span style="color: #98fb98;">v2f</span> <span style="color: #87cefa;">vert</span> (<span style="color: #98fb98;">appdata_t</span> <span style="color: #eedd82;">v</span>)
{
    <span style="color: #98fb98;">v2f</span> <span style="color: #eedd82;">o</span>;
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#22312;&#36825;&#37324;&#36827;&#34892;&#20102; &#27169;&#22411; &#35270;&#22270; &#25237;&#24433;&#21464;&#25442;</span>
    o.vertex = mul(UNITY_MATRIX_MVP, v.vertex);
    o.texcoord = v.texcoord;
    o.color = v.color;
    <span style="color: #00ffff;">return</span> o;
}

<span style="color: #98fb98;">half4</span> <span style="color: #87cefa;">frag</span> (<span style="color: #98fb98;">v2f</span> <span style="color: #eedd82;">i</span>) : SV_Target
{
    <span style="color: #98fb98;">half4</span> <span style="color: #eedd82;">col</span> = i.color;
    col.a *= tex2D(_MainTex, i.texcoord).a;
    <span style="color: #00ffff;">return</span> col;
}
</pre>
</div>
</div></li>
<li><a id="orgheadline21"></a>Mesh 是挂在 UIDrawCall 所在的 GameObject 上的，如何保证 Mesh 渲染出来的位置和 UIWidget 的位置一致？<br><div class="outline-text-5" id="text-1-1-4-6">
<ol class="org-ol">
<li>UIWidget 中的 UIGeometry 记录了原始的顶点数据<br></li>
<li>UIGeometry 通过 void ApplyTransform (Matrix4x4 widgetToPanel, bool generateNormals = true)来将原始的顶点数据变换为 UIPanel 坐标系下的顶点数据<br></li>
<li>在 UIPanel 的 UpdateDrawCall 里面会将 panel 的 position 赋值给 drawCall 的 position，代码如下：<br></li>
</ol>
<div class="org-src-container">

<pre class="src src-csharp"><span style="color: #98fb98;">void</span> <span style="color: #87cefa;">UIPanel</span>::UpdateDrawCalls (<span style="color: #98fb98;">int</span> <span style="color: #eedd82;">sortOrder</span>)
{
    <span style="color: #ff0000;">// </span><span style="color: #ff0000;">...... </span>
    <span style="color: #98fb98;">Vector3</span> <span style="color: #eedd82;">pos</span>;

    <span style="color: #00ffff;">if</span> (isUI)
    {
        <span style="color: #98fb98;">Transform</span> <span style="color: #eedd82;">parent</span> = cachedTransform.parent;
        pos = cachedTransform.localPosition;

        <span style="color: #00ffff;">if</span> (clipping != UIDrawCall.Clipping.None)
        {
            pos.x = Mathf.RoundToInt(pos.x);
            pos.y = Mathf.RoundToInt(pos.y);
        }

        <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#23558;&#26412;&#22320;&#22352;&#26631;&#36716;&#21270;&#20026;&#19990;&#30028;&#22352;&#26631;</span>
        <span style="color: #00ffff;">if</span> (parent != <span style="color: #7fffd4;">null</span>) pos = parent.TransformPoint(pos);
        pos += drawCallOffset;
    }
    <span style="color: #00ffff;">else</span> pos = trans.position;

    <span style="color: #98fb98;">Quaternion</span> <span style="color: #eedd82;">rot</span> = trans.rotation;
    <span style="color: #98fb98;">Vector3</span> <span style="color: #eedd82;">scale</span> = trans.lossyScale;

    <span style="color: #00ffff;">for</span> (<span style="color: #98fb98;">int</span> <span style="color: #eedd82;">i</span> = 0; i &lt; drawCalls.Count; ++i)
    {
        <span style="color: #98fb98;">UIDrawCall</span> <span style="color: #eedd82;">dc</span> = drawCalls[i];

        <span style="color: #98fb98;">Transform</span> <span style="color: #eedd82;">t</span> = dc.cachedTransform;
        <span style="color: #ff0000;">// </span><span style="color: #ff0000;">&#35774;&#32622; drawCall &#23545;&#35937;&#30340;&#19990;&#30028;&#22352;&#26631;</span>
        t.position = pos;
        t.rotation = rot;
        t.localScale = scale;

        dc.renderQueue = (renderQueue == RenderQueue.Explicit) ? startingRenderQueue : startingRenderQueue + i;
        dc.alwaysOnScreen = alwaysOnScreen &amp;&amp;
            (mClipping == UIDrawCall.Clipping.None || mClipping == UIDrawCall.Clipping.ConstrainButDontClip);
        dc.sortingOrder = (mSortingOrder == 0) ? sortOrder : mSortingOrder;
        dc.sortingLayerName = mSortingLayerName;
        dc.clipTexture = mClipTexture;
    }
}
</pre>
</div>
</div></li>
<li><a id="orgheadline22"></a>UIPanel 的裁剪是如何实现的？<br><div class="outline-text-5" id="text-1-1-4-7">
<p>
通过 Shader 来实现，原理就是，将指定区域外的像素 alpha 值设置为 0<br>
需要注意的是对于 UIPanel 的嵌套裁剪，NGUI 是通过不同的 Shader 来实现的。例如：<br>
Unlit - Text.shader 用于不裁剪的<br>
Unlit - Text (TextureClip).shader 用于通过贴图来裁剪<br>
Unlit - Text 1.shader 一个 UIPanel 裁剪<br>
Unlit - Text 2.shader 两个 UIPanel 嵌套裁剪<br>
Unlit - Text 3.shader 三个 UIPanel 嵌套裁剪<br>
</p>
<div class="org-src-container">

<pre class="src src-shader"><span style="color: #00ffff;">Shader</span> <span style="color: #ffa07a;">"Hidden/Unlit/Transparent Colored 1"</span>
{
    <span style="color: #00ffff;">Properties</span>
    {
        <span style="color: #eedd82;">_MainTex</span> (<span style="color: #ffa07a;">"Base (RGB), Alpha (A)"</span>, 2D) = <span style="color: #ffa07a;">"black"</span> {}
    }

    <span style="color: #00ffff;">SubShader</span>
    {
        <span style="color: #00ffff;">LOD</span> 200

        <span style="color: #00ffff;">Tags</span>
        {
            <span style="color: #ffa07a;">"Queue"</span> = <span style="color: #ffa07a;">"Transparent"</span>
            <span style="color: #ffa07a;">"IgnoreProjector"</span> = <span style="color: #ffa07a;">"True"</span>
            <span style="color: #ffa07a;">"RenderType"</span> = <span style="color: #ffa07a;">"Transparent"</span>
            <span style="color: #ffa07a;">"DisableBatching"</span> = <span style="color: #ffa07a;">"True"</span>
        }

        <span style="color: #00ffff;">Pass</span>
        {
            <span style="color: #00ffff;">Cull</span> Off
            <span style="color: #00ffff;">Lighting</span> Off
            <span style="color: #00ffff;">ZWrite</span> Off
            <span style="color: #00ffff;">Offset</span> -1, -1
            <span style="color: #00ffff;">Fog</span> { <span style="color: #00ffff;">Mode</span> Off }
            <span style="color: #ff0000;">//ColorMask RGB</span>
            <span style="color: #00ffff;">Blend</span> SrcAlpha OneMinusSrcAlpha

            <span style="color: #00ffff;">CGPROGRAM</span>
<span style="color: #b0c4de;">            #pragma</span> vertex vert
<span style="color: #b0c4de;">            #pragma</span> fragment frag

<span style="color: #b0c4de;">            #include</span> <span style="color: #ffa07a;">"UnityCG.cginc"</span>

            <span style="color: #98fb98;">sampler2D</span> <span style="color: #eedd82;">_MainTex</span>;
            <span style="color: #98fb98;">float4</span> <span style="color: #eedd82;">_ClipRange0</span> = <span style="color: #98fb98;">float4</span>(0.0, 0.0, 1.0, 1.0);
            <span style="color: #98fb98;">float2</span> <span style="color: #eedd82;">_ClipArgs0</span> = <span style="color: #98fb98;">float2</span>(1000.0, 1000.0);

            <span style="color: #00ffff;">struct</span> appdata_t
            {
                <span style="color: #98fb98;">float4</span> vertex : <span style="color: #7fffd4;">POSITION</span>;
                <span style="color: #98fb98;">half4</span> color : <span style="color: #7fffd4;">COLOR</span>;
                <span style="color: #98fb98;">float2</span> texcoord : <span style="color: #7fffd4;">TEXCOORD0</span>;
            };

            <span style="color: #00ffff;">struct</span> v2f
            {
                <span style="color: #98fb98;">float4</span> vertex : <span style="color: #7fffd4;">SV_POSITION</span>;
                <span style="color: #98fb98;">half4</span> color : <span style="color: #7fffd4;">COLOR</span>;
                <span style="color: #98fb98;">float2</span> texcoord : <span style="color: #7fffd4;">TEXCOORD0</span>;
                <span style="color: #98fb98;">float2</span> worldPos : <span style="color: #7fffd4;">TEXCOORD1</span>;
            };

            v2f o;

            v2f <span style="color: #87cefa;">vert</span> (appdata_t v)
            {
                o.vertex = <span style="color: #b0c4de;">mul</span>(UNITY_MATRIX_MVP, v.vertex);
                o.color = v.color;
                o.texcoord = v.texcoord;
                o.worldPos = v.vertex.xy * <span style="color: #eedd82;">_ClipRange0</span>.zw + <span style="color: #eedd82;">_ClipRange0</span>.xy;
                <span style="color: #00ffff;">return</span> o;
            }

            <span style="color: #98fb98;">half4</span> <span style="color: #87cefa;">frag</span> (v2f IN) : <span style="color: #7fffd4;">SV_Target</span>
            {
                <span style="color: #ff0000;">// Softness factor</span>
                <span style="color: #ff0000;">// &#36229;&#20986;&#35009;&#21098;&#21306;&#22495;&#30340; factor &#20250;&#21464;&#20026;&#36127;&#20540;&#65292;&#22312;&#38543;&#21518;&#30340; clamp &#20989;&#25968;&#20013;&#20250;&#21464;&#20026; 0</span>
                <span style="color: #98fb98;">float2</span> factor = (<span style="color: #98fb98;">float2</span>(1.0, 1.0) - <span style="color: #b0c4de;">abs</span>(IN.worldPos)) * <span style="color: #eedd82;">_ClipArgs0</span>;

                <span style="color: #ff0000;">// Sample the texture</span>
                <span style="color: #98fb98;">half4</span> col = <span style="color: #b0c4de;">tex2D</span>(<span style="color: #eedd82;">_MainTex</span>, IN.texcoord) * IN.color;
                col.a *= <span style="color: #b0c4de;">clamp</span>( <span style="color: #b0c4de;">min</span>(factor.x, factor.y), 0.0, 1.0);
                <span style="color: #00ffff;">return</span> col;
            }
            <span style="color: #00ffff;">ENDCG</span>
        }
    }
    ......
}
</pre>
</div>
</div></li>
<li><a id="orgheadline23"></a>UIScrollView 中的 Item 有按钮时，NGUI 如何做到拖动按钮可以拖动 Item？<br><div class="outline-text-5" id="text-1-1-4-8">
<p>
需要在按钮上添加 UIDragScrollView 脚本，当 UICamera 检测出 Drag 操作时，会调用被拖动对象上的 OnDrag 方法，此时就会执行 UIDragScrollView 的 OnDrag 函数，从而调到 UIScrollView 的 OnDrag 方法。UIDragScrollView 脚本做了一次转发操作。<br>
</p>
</div></li>
<li><a id="orgheadline24"></a><span class="todo TODO">TODO</span> Outline 效果是如何实现的？<br></li>
<li><a id="orgheadline25"></a><span class="todo TODO">TODO</span> 点击 Button 切换贴图是否会导致 UIDrawCall 重新生成？<br></li></ol>
</div>
</div>
<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28"><span class="section-number-3">1.2</span> UGUI</h3>
</div>
</div>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/01/01/unity/UnityGUI/">Unity GUI</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">wolfand11</a></p>
        <p><span>发布时间:</span>2017-01-01, 00:00:00</p>
        <p><span>最后更新:</span>2017-04-02, 20:45:46</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/01/01/unity/UnityGUI/" title="Unity GUI">http://wolfand11.coding.me/2017/01/01/unity/UnityGUI/</a>
            <span class="copy-path" data-clipboard-text="原文: http://wolfand11.coding.me/2017/01/01/unity/UnityGUI/　　作者: wolfand11" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2017/01/06/gameplay/MoveSync/">
                    Move Sync
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/12/23/unity/UnityDoc-AnimationFromExternalSources/">
                    Animation From External Sources
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#orgheadline29"><span class="toc-number">1.</span> <span class="toc-text">1 Unity GUI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#orgheadline27"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 NGUI</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#orgheadline2"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1.1 UIRoot UIRect UIRect.AnchorPoint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#orgheadline8"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1.2 UIPanel-UIWidget-UIGeometry-UIDrawCall</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#orgheadline9"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.1.3 TODO UICamera</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#orgheadline26"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.1.4 Q&A</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#orgheadline28"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 UGUI</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Unity GUI　| wolfand11's blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
        <section id="comments">
    <style> aside.comment-bar { margin: auto 30px; }</style>
    <div id="disqus_thread"></div>
    <script>
        var disqus_config = function(){
            this.page.url = 'http://wolfand11.coding.me/2017/01/01/unity/UnityGUI/';
            this.page.identifier = '2017/01/01/unity/UnityGUI/';
        };
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = '//wolfand11.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        }
    </script>
    
    <script> loadComment(); </script>

</section>


    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/01/06/gameplay/MoveSync/" title="上一篇: Move Sync">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/12/23/unity/UnityDoc-AnimationFromExternalSources/" title="下一篇: Animation From External Sources">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/architecture/Cryptology/">Cryptology</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/04/architecture/GameEngineArchitecture/">Game Engine Architecture</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/29/tools/ArtTools/">ArtTools</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/18/language/Python/">Python Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/gameplay/GameAI/">GameAI</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/unity/DOTween/">DOTween</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/20/tools/Matlab/">Matlab</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/08/architecture/KSFrameworkNote/">KSFramework Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/unity/UnityHotUpdate/">Unity Hot Update</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/13/architecture/ActionScriptDeveloperGuideToPureMVC/">Action Script Developer Guide To PureMVC</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/06/gameplay/MoveSync/">Move Sync</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/01/unity/UnityGUI/">Unity GUI</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/23/unity/UnityDoc-AnimationFromExternalSources/">Animation From External Sources</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/22/unity/UnityDoc-AnimationClips/">Animation Clips</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/12/unity/UnityDoc-AnimationSystemOverview/">Animation System Overview</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/09/language/Lua/">Programming in Lua</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/28/unity/UnityNote/">Unity Note</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/29/tools/vim/">VIM</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/28/tools/GameDevTools/">Game Dev Tools</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/27/language/CSharp/">Programing in CSharp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/24/unity/UnityDoc-SpecialFolders/">Special Folders</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/tools/InitMyCore/">Init My Core</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/24/unity/UnityDoc-LoadingResourcesatRuntime/">Loading Resources at Runtime</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/20/unity/Unity5LightingCookbook/">Unity 5 Lighting Cookbook</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/20/unity/UnityShaderAndEffectCookbook/">UnityShaderAndEffectCookbook</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/14/tools/Emacs/">Emacs</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/14/language/Shell/">Shell</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/14/language/Elisp/">Programing in Elisp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/14/tools/GitAndGithub/">Git Github</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/14/tools/InitPC/">Init My PC</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/12/tools/CreateBlogWithHexo/">Create Blog With Hexo</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/12/tools/CreateBlogWithJeykll/">Create Blog With Jeykll</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/16/architecture/GameModules/">GameModules</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/01/algorithm/AlgorithmIntroduce/">AlgorithmIntroduce</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 wolfand11
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>