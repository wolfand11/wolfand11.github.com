<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-12-22 Thu 00:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Programing in CSharp</title>
<meta name="generator" content="Org Mode" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
         <meta name="viewport" content="width=device-width, initial-scale=1" />
         <link rel="stylesheet" title="Standard" href="https://wolfand11.github.io/res/worg_theme/css/worg.css" type="text/css" />
         <link rel="alternate stylesheet" title="Zenburn" href="https://wolfand11.github.io/res/worg_theme/css/worg-zenburn.css" type="text/css" />
         <link rel="alternate stylesheet" title="Classic" href="https://wolfand11.github.io/res/worg_theme/css/worg-classic.css" type="text/css" />
         <link rel="icon" href="https://wolfand11.github.io/res/favicon.ico" type="image/ico" />
         <script type="text/javascript" src="https://wolfand11.github.io/res/blog-tools.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://wolfand11.github.io"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">Programing in CSharp</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org13f39c4">The C# Language</a>
<ul>
<li><a href="#org7ce087f">C#语言基础</a>
<ul>
<li><a href="#orgdcbfc49">内置类型</a>
<ul>
<li><a href="#org881f860">指针类型</a></li>
<li><a href="#orgff5b48b">可以为 null 的值类型</a></li>
<li><a href="#orgbaa8f5f">判断是否为 NaN 和 Infinity</a></li>
</ul>
</li>
<li><a href="#org1eb3960">变量初始化 赋值</a></li>
<li><a href="#org3197b14">枚举类型</a>
<ul>
<li><a href="#orgefa70a4">枚举遍历</a></li>
<li><a href="#org8e42c3f">定义多个范围的枚举</a></li>
<li><a href="#orgdd9bc2b">通过 Enum 的名称字符串判断 Enum 是否定义</a></li>
<li><a href="#org8c3a7d4">string int Enum 互转</a></li>
</ul>
</li>
<li><a href="#org2c1c08c">运算符</a>
<ul>
<li><a href="#org8eedb95">&amp;符号</a></li>
<li><a href="#org06ee5f4">?符号</a></li>
<li><a href="#org8443b70">??</a></li>
</ul>
</li>
<li><a href="#orgc9b0401">条件分支语句</a></li>
<li><a href="#org45c9be6">预处理指令</a></li>
<li><a href="#org2949958">泛型函数</a></li>
</ul>
</li>
<li><a href="#orgd71efc0">类与对象</a>
<ul>
<li><a href="#org34534c9">定义类</a>
<ul>
<li><a href="#orgae00a3b">访问修饰符</a>
<ul>
<li><a href="#org5bb0084">protected internal</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4289f90">创建对象</a>
<ul>
<li><a href="#org235b39a">构造方法</a></li>
<li><a href="#org9c53452">初始化语句</a></li>
<li><a href="#orgd428e1e">ICloneable 接口</a></li>
<li><a href="#org2b06daa">对象构造顺序</a></li>
<li><a href="#org65d806d">Activator.CreateInstance</a></li>
</ul>
</li>
<li><a href="#orge41563d">使用静态成员</a>
<ul>
<li><a href="#org92f5356">静态成员</a></li>
<li><a href="#org018f9e1">静态类</a></li>
</ul>
</li>
<li><a href="#orgb444793">销毁对象</a>
<ul>
<li>
<ul>
<li><a href="#org873a756">析构函数</a></li>
<li><a href="#org4416352">Dispose 方法</a></li>
<li><a href="#orgfc0dd1b">using 语句</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf5083e7">参数传递</a>
<ul>
<li><a href="#orga1b6db6">默认情况下值类型是按值传递给方法的。</a></li>
<li><a href="#orgfa40b55">通过 ref 可以实现按照引用传递值类型的参数。</a></li>
<li><a href="#orgfd1a435">通过 out 可以克服明确赋值问题。</a></li>
</ul>
</li>
<li><a href="#org92fee20">通过属性封装数据</a></li>
</ul>
</li>
<li><a href="#orgff308f9">继承和多态</a>
<ul>
<li><a href="#org43d9308">多态</a>
<ul>
<li><a href="#org179c7ed">调用基类构造方法</a></li>
</ul>
</li>
<li><a href="#org0bc5d5a">抽象类</a></li>
<li><a href="#org4b2841c">密封类</a></li>
<li><a href="#org9850c4f">万类之根：Object</a></li>
<li><a href="#org00c3209">类型的装箱和拆箱</a></li>
<li><a href="#org21294ad">嵌套类</a></li>
</ul>
</li>
<li><a href="#orgffec2c6">操作符重载</a></li>
<li><a href="#orgba13300">结构体</a>
<ul>
<li><a href="#org74d1088">定义结构体</a></li>
<li><a href="#org6c9d0ca">创建结构对象</a></li>
</ul>
</li>
<li><a href="#org51f423d">接口</a>
<ul>
<li><a href="#org32d5dcb">定义接口</a></li>
<li><a href="#org5d235af">类可以实现多个接口</a></li>
<li><a href="#org465fc1a">扩展接口</a></li>
<li><a href="#org1f17559">组合接口</a></li>
<li><a href="#org51a6526">转换为接口</a></li>
<li><a href="#org26780a6">is 和 as 操作符</a></li>
<li><a href="#org2997495">接口和抽象类比较</a></li>
<li><a href="#orgcc08fe7">重定义接口的实现</a></li>
<li><a href="#orgfb9c7ba">显式接口实现</a></li>
<li><a href="#orgd08fd85">隐藏接口成员</a></li>
<li><a href="#orgc228556">访问密封类和结构体</a></li>
</ul>
</li>
<li><a href="#org6806d2b">数组索引器与集合</a>
<ul>
<li><a href="#orge1bd9ad">数组</a>
<ul>
<li><a href="#org450221e">声明数组</a></li>
<li><a href="#org5dfa6a7">内存分配</a></li>
<li><a href="#orgb5abb34">默认值</a></li>
<li><a href="#org4b7c2cb">遍历数组</a></li>
<li><a href="#orgdef2d72">初始化数组元素</a></li>
<li><a href="#org86b5499">params 关键字</a></li>
<li><a href="#org78515db">多维数组</a>
<ul>
<li><a href="#org7f294a1">规则数组</a></li>
<li><a href="#org1f0cd7d">不规则数组</a></li>
</ul>
</li>
<li><a href="#org89866bf">数组转换</a></li>
<li><a href="#org4758598">数组排序</a></li>
</ul>
</li>
<li><a href="#org2504b21">索引器</a></li>
<li><a href="#orgd578d76">集合接口</a>
<ul>
<li><a href="#orgdb0886c">约束</a></li>
<li><a href="#orga9e32f4">实现 IComparer IComparable</a></li>
<li><a href="#org3d46d0b">实现 IEnumerable&lt;T&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4c0802c">字符串与正则表达式</a>
<ul>
<li><a href="#org00912ae">string</a></li>
<li><a href="#org9e7e255">StringBuilder</a></li>
<li><a href="#org8f2473e"><span class="todo TODO">TODO</span> 正则表达式</a>
<ul>
<li><a href="#org57cfe55">正则表达式匹配 ftp list directory detial</a></li>
<li><a href="#org5441b65">参考资料</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd561384"><span class="todo TODO">TODO</span> 异常处理</a></li>
<li><a href="#orgfd1133b">委托和事件</a>
<ul>
<li><a href="#org7004566">委托</a>
<ul>
<li><a href="#orge0631a1">Action</a></li>
<li><a href="#org1d89f53">Func</a></li>
</ul>
</li>
<li><a href="#org8502bae">多重委托</a></li>
<li><a href="#org88cdd2b">事件</a></li>
<li><a href="#orgdccfff1">事件和接口</a></li>
<li><a href="#orgbcccca8">异步调用委托</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6008258">The CLR and .NET framework</a>
<ul>
<li><a href="#org4e108c6">程序集和版本控制</a>
<ul>
<li><a href="#org84784a1">多模块程序集</a></li>
<li><a href="#orgb7c625d">共享程序集</a></li>
<li><a href="#org8301b3f">最终解决 DLL 冲突 - 版本控制</a></li>
</ul>
</li>
<li><a href="#orgac568d5">性质</a>
<ul>
<li><a href="#orga496237">性质目标</a></li>
<li><a href="#org2b59832">性质的使用</a></li>
<li><a href="#org869039a">自定义性质</a></li>
</ul>
</li>
<li><a href="#org91f389a">反射</a>
<ul>
<li><a href="#org0cd8f57">查看元数据</a></li>
<li><a href="#org89fbd60">进行类型发现</a></li>
<li><a href="#orgdb4e561">对方法和特性的迟绑定</a></li>
<li><a href="#org344099d">运行期创建类型（反射输出）</a></li>
<li><a href="#orgc034460">反射应用实例</a>
<ul>
<li><a href="#org7da0f9c">反射创建实例</a></li>
<li><a href="#org218d7fd">反射序列化泛型 Array List Dictionary</a></li>
<li><a href="#org667e36d">反射创建泛型 Array List Dictionary</a></li>
<li><a href="#orgaed4b9d">反射序列化 其他程序集类</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1ed83fc">Tips</a>
<ul>
<li><a href="#org83fba2c">类型转换</a></li>
<li><a href="#org29c76ef">static const readonly</a></li>
<li><a href="#orgfc9b63a">装箱和拆箱</a>
<ul>
<li><a href="#orga52bc2f">装箱过程</a></li>
<li><a href="#orgf4a7cb7">拆箱过程</a></li>
<li><a href="#orgd321669">优化</a></li>
</ul>
</li>
<li><a href="#org8ee8cce">编码规范</a></li>
<li><a href="#orgb2c8204">override overload overwrite</a></li>
<li><a href="#orgab0ffb4">Tools</a>
<ul>
<li><a href="#org5f1997b">mono 版 ILDASM 为 monodis</a></li>
</ul>
</li>
<li><a href="#org27ccaf0">GetMethod 无法获取父类中定义的方法</a>
<ul>
<li><a href="#orge5f729d">情况 1</a></li>
<li><a href="#org4ae8622">情况 2</a></li>
<li><a href="#org82b5f18">情况 3</a></li>
</ul>
</li>
<li><a href="#org906ed67">CSharp Wiki</a></li>
</ul>
</li>
<li><a href="#orgf58cc79">HowTo</a>
<ul>
<li><a href="#orgc379216">Collections</a>
<ul>
<li><a href="#org237eb85">Array List</a>
<ul>
<li><a href="#orgfd2192c">数组转化为 String</a>
<ul>
<li><a href="#orga7c960a">方案 1 string 数组转 string</a></li>
<li><a href="#orgb689000">方案 2 任意类型数组 List 转 string</a></li>
</ul>
</li>
<li><a href="#org19fb512">Sort: 使用指定排序函数进行排序</a></li>
</ul>
</li>
<li><a href="#org92c6b6d">Dictionary</a>
<ul>
<li><a href="#org95e8ee0">如何用初始化器初始化 Dictionary</a></li>
<li><a href="#org434bd1b">Dictionary 如何遍历删除</a></li>
</ul>
</li>
<li><a href="#orgaddbaa7">HashSet</a>
<ul>
<li><a href="#org0ce14e2">判断集合相等</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3a0ec84">文件目录操作</a>
<ul>
<li><a href="#orgc2fdcd6">目录、文件获取</a>
<ul>
<li><a href="#org1365289">工作目录 脚本目录</a></li>
<li><a href="#org8762f2a">获取目录名 文件名</a></li>
<li><a href="#orgc45fc16">遍历目录下的文件和目录</a></li>
<li><a href="#org1506332">递归遍历目录中的文件</a></li>
<li><a href="#org4e8674b">递归遍历目录中的目录</a></li>
<li><a href="#orga57e952">判断目录 文件是否存在</a></li>
</ul>
</li>
<li><a href="#orgc73dc0a">读写目录 文件</a>
<ul>
<li><a href="#org0feb8ee">创建目录</a></li>
<li><a href="#orgd2f2611">读写文件</a></li>
<li><a href="#org04a8620">修改文件编码</a></li>
<li><a href="#orgebd3c89">修改文件名称</a></li>
<li><a href="#orgaebc414">移动文件和目录</a></li>
<li><a href="#orgaa555f6">复制文件和目录</a></li>
<li><a href="#org41dcc87">删除文件和目录</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org653d8fa">创建 C# DLL 工程</a></li>
<li><a href="#org8f53c42">DLL 混淆加密</a>
<ul>
<li><a href="#org9775959">DLL 混淆工具</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb54ae1c">参考资料</a></li>
</ul>
</div>
</div>
<p>
csharp language note.<br />
</p>
<div class="HTML" id="orgf880b9f">
<p>
&lt;!&#x2013; more &#x2013;&gt;<br />
</p>

</div>
<div id="outline-container-org13f39c4" class="outline-2">
<h2 id="org13f39c4">The C# Language</h2>
<div class="outline-text-2" id="text-org13f39c4">
</div>
<div id="outline-container-org7ce087f" class="outline-3">
<h3 id="org7ce087f">C#语言基础</h3>
<div class="outline-text-3" id="text-org7ce087f">
<p>
C#有两种类型内置类型和用户自定义类型。<br />
C#还可以分为值类型和引用类型。这两种类型的区别为值在内存中的存储方式不同。<br />
值类型在栈分配的内存中保存其实际值（或者作为更大的引用类型对象的一部分分配）。<br />
引用类型变量的地址保存在栈中，但实际对象存在堆中。<br />
C#还支持 C++风格的指针。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = 10;
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">j</span> = 10;
Console.WriteLine (<span style="color: #2d9574;">"object.ReferenceEquals(i,j) = {0}"</span>, <span style="color: #ce537a; font-weight: bold;">object</span>.ReferenceEquals (i, j));
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">output: False</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312; object.ReferenceEquals(i,j) &#36825;&#19968;&#27493;&#20250;&#23545; i,j &#20998;&#21035;&#36827;&#34892;&#35013;&#31665;&#25805;&#20316;</span>
</pre>
</div>
</div>
<div id="outline-container-orgdcbfc49" class="outline-4">
<h4 id="orgdcbfc49">内置类型</h4>
<div class="outline-text-4" id="text-orgdcbfc49">
<p>
C#中内置类型符合.Net CLS 规范。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">类型</th>
<th scope="col" class="org-right">大小/字节</th>
<th scope="col" class="org-left">.Net 类型</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">byte</td>
<td class="org-right">1</td>
<td class="org-left">Byte</td>
<td class="org-left">无符号（0~255）</td>
</tr>

<tr>
<td class="org-left">char</td>
<td class="org-right">2</td>
<td class="org-left">Char</td>
<td class="org-left">Unicode 字符</td>
</tr>

<tr>
<td class="org-left">bool</td>
<td class="org-right">1</td>
<td class="org-left">Boolean</td>
<td class="org-left">true 或者 false</td>
</tr>

<tr>
<td class="org-left">sbyte</td>
<td class="org-right">1</td>
<td class="org-left">Sbyte</td>
<td class="org-left">有符号（-128~127）</td>
</tr>

<tr>
<td class="org-left">short</td>
<td class="org-right">2</td>
<td class="org-left">Int16</td>
<td class="org-left">有符号 short（-32768~32767）</td>
</tr>

<tr>
<td class="org-left">ushort</td>
<td class="org-right">2</td>
<td class="org-left">Uint16</td>
<td class="org-left">无符号 short（0~65535）</td>
</tr>

<tr>
<td class="org-left">int</td>
<td class="org-right">4</td>
<td class="org-left">Int32</td>
<td class="org-left">有符号 int（-2147483648~2147483647）</td>
</tr>

<tr>
<td class="org-left">uint</td>
<td class="org-right">4</td>
<td class="org-left">Uint32</td>
<td class="org-left">无符号 int（0~4294967295）</td>
</tr>

<tr>
<td class="org-left">float</td>
<td class="org-right">4</td>
<td class="org-left">Single</td>
<td class="org-left">浮点数</td>
</tr>

<tr>
<td class="org-left">double</td>
<td class="org-right">8</td>
<td class="org-left">Double</td>
<td class="org-left">双精度浮点数</td>
</tr>

<tr>
<td class="org-left">decimal</td>
<td class="org-right">12</td>
<td class="org-left">Decimal</td>
<td class="org-left">固定精度</td>
</tr>

<tr>
<td class="org-left">long</td>
<td class="org-right">8</td>
<td class="org-left">Int64</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">ulong</td>
<td class="org-right">8</td>
<td class="org-left">Uint64</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org881f860" class="outline-5">
<h5 id="org881f860">指针类型</h5>
<div class="outline-text-5" id="text-org881f860">
<p>
为了保持类型安全，默认情况下，C# 不支持指针运算。不过，通过使用 unsafe 关键字，可以定义可使用指针的不安全上下文。<br />
在公共语言运行时 (CLR) 中，不安全代码是指无法验证的代码。C# 中的不安全代码不一定是危险的；只是其安全性无法由 CLR 进行验证的代码。 因此，CLR 只对在完全受信任的程序集中的不安全代码执行操作。 如果使用不安全代码，由您负责确保您的代码不会引起安全风险或指针错误。<br />
我们在运行 unsafe 代码是要在项目属性-生成选项里配置下"允许运行不安全代码"。<br />
参考资料: <a href="http://www.cnblogs.com/ydchw/p/3734453.html?utm_source=tuicool&amp;utm_medium=referral">http://www.cnblogs.com/ydchw/p/3734453.html?utm_source=tuicool&amp;utm_medium=referral</a><br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Tips:</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22312; csproj &#25991;&#20214;&#20013; PropertyGroup &#23383;&#27573;&#19979;&#28155;&#21152;&lt;AllowUnsafeBlocks&gt;true&lt;/AllowUnsafeBlocks&gt;</span>

  <span style="color: #4f97d7; font-weight: bold;">using</span> System;
  <span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">Point</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">x</span>, <span style="color: #7590db;">y</span>; 
  }

  <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MainClass</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">unsafe</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Main</span>() 
      {
          <span style="color: #ce537a; font-weight: bold;">Point</span> <span style="color: #7590db;">pt</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Point</span>();
          Point* pp = &amp;pt;
          pp-&gt;x = 123;
          pp-&gt;y = 456;
          Console.WriteLine ( <span style="color: #2d9574;">"{0} {1}"</span>, pt.<span style="color: #ce537a; font-weight: bold;">x</span>, pt.<span style="color: #ce537a; font-weight: bold;">y</span> );
      }
      <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Test</span>()
      {
          <span style="color: #4f97d7; font-weight: bold;">unsafe</span> {
              <span style="color: #ce537a; font-weight: bold;">UnsafePoint</span> <span style="color: #7590db;">pt</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">UnsafePoint</span> ();
              UnsafePoint* pp = &amp;pt;
              pp-&gt;x = 123;
              pp-&gt;y = 456;
              Console.WriteLine (<span style="color: #2d9574;">"{0} {1}"</span>, pt.<span style="color: #ce537a; font-weight: bold;">x</span>, pt.<span style="color: #ce537a; font-weight: bold;">y</span>);
          }
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgff5b48b" class="outline-5">
<h5 id="orgff5b48b">可以为 null 的值类型</h5>
<div class="outline-text-5" id="text-orgff5b48b">
<p>
普通的值类型不能有 null 值。 但是，可以通过在类型后面附加 ? 来创建可以为 null 值的类型。<br />
</p>
</div>
</div>
<div id="outline-container-orgbaa8f5f" class="outline-5">
<h5 id="orgbaa8f5f">判断是否为 NaN 和 Infinity</h5>
<div class="outline-text-5" id="text-orgbaa8f5f">
<p>
在 C#的浮点数计算中，0 除以 0 将得到 NaN，正数除以 0 将得到 PositiveInfinity,负数除以 0 将得到 NegativeInfinity。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #ce537a; font-weight: bold;">float</span>.<span style="color: #bc6ec5; font-weight: bold;">IsInfinity</span>(1.0f/0))
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"1.0f/0 is infinity"</span>);
}
<span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #ce537a; font-weight: bold;">float</span>.<span style="color: #bc6ec5; font-weight: bold;">IsNaN</span>(0.0f/0))
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"0.0f/0 is NaN"</span>);
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1eb3960" class="outline-4">
<h4 id="org1eb3960">变量初始化 赋值</h4>
<div class="outline-text-4" id="text-org1eb3960">
<p>
C#要求变量在使用前必须初始化或者赋值。<br />
const 为编译期常量 ，readonly 为运行时常量<br />
</p>
</div>
</div>
<div id="outline-container-org3197b14" class="outline-4">
<h4 id="org3197b14">枚举类型</h4>
<div class="outline-text-4" id="text-org3197b14">
<p>
每个枚举类型都有底层类型，可以是任意整数类型（integer，short，long），但 char 除外。默认情况下枚举类型的底层类型为 int。<br />
[性质][修饰符] enum 标识符 [:基础类型]<br />
{枚举列表};<br />
</p>
</div>
<div id="outline-container-orgefa70a4" class="outline-5">
<h5 id="orgefa70a4">枚举遍历</h5>
<div class="outline-text-5" id="text-orgefa70a4">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">enum</span> <span style="color: #ce537a; font-weight: bold;">SomeValues</span>
  {
      <span style="color: #7590db;">Value_0</span>,
      <span style="color: #7590db;">Value_1</span>,
      <span style="color: #7590db;">Value_20</span> = 20,
      <span style="color: #7590db;">Value_21</span>
  }
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36941;&#21382;&#26522;&#20030;&#20540;</span>
  <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">GViewType</span> <span style="color: #bc6ec5; font-weight: bold;">type</span> <span style="color: #4f97d7; font-weight: bold;">in</span> GViewType.<span style="color: #bc6ec5; font-weight: bold;">GetValues</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(GViewType))) {
      InitView_ (type);
  }
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#38656;&#35201;&#27880;&#24847;&#30340;&#26159; GViewType.GetValues(typeof(GViewType))&#36820;&#22238;&#30340;&#25968;&#32452;&#26159;&#25353;&#29031;&#21517;&#31216;&#23383;&#31526;&#20018;&#25490;&#24207;&#30340;&#65292;&#25152;&#20197;&#35201;&#25353;&#29031;&#26522;&#20030;&#20540;&#36941;&#21382;&#38656;&#35201;&#22914;&#19979;&#25805;&#20316;&#65306;</span>
  <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">enums</span> = GViewType.<span style="color: #bc6ec5; font-weight: bold;">GetValues</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(GViewType));
  Array.<span style="color: #bc6ec5; font-weight: bold;">Sort</span>(enums);
  <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">eValue</span> <span style="color: #4f97d7; font-weight: bold;">in</span> enums)
  {
       <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">do something</span>
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org8e42c3f" class="outline-5">
<h5 id="org8e42c3f">定义多个范围的枚举</h5>
<div class="outline-text-5" id="text-org8e42c3f">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#22810;&#20010;&#33539;&#22260;&#20851;&#32852;&#30340;&#26522;&#20030;</span>
  <span style="color: #4f97d7; font-weight: bold;">enum</span> <span style="color: #ce537a; font-weight: bold;">EnumType</span>
  {
      <span style="color: #7590db;">kFirstEnumStart</span> = 100,
      <span style="color: #7590db;">kFirstEnumEnd</span>   = 200,
      <span style="color: #7590db;">kSecondEnumStart</span> = 201,
      <span style="color: #7590db;">kSecondEnumEnd</span>   = 300
  }
  <span style="color: #4f97d7; font-weight: bold;">enum</span> <span style="color: #ce537a; font-weight: bold;">FirstEnum</span>
  {
      <span style="color: #7590db;">kFirstEnumStart</span>,
      <span style="color: #7590db;">kFirstEnumOne</span>,
      <span style="color: #7590db;">kFirstEnumTwo</span>,
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">...</span>
      <span style="color: #7590db;">kFirstEnumEnd</span>,
  }
  <span style="color: #4f97d7; font-weight: bold;">enum</span> <span style="color: #ce537a; font-weight: bold;">SecondEnum</span>
  {
      <span style="color: #7590db;">kSecondEnumStart</span>,
      <span style="color: #7590db;">kSecondEnumOne</span>,
      <span style="color: #7590db;">kSecondEnumTwo</span>,
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">...</span>
      <span style="color: #7590db;">kSecondEnumEnd</span>,
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdd9bc2b" class="outline-5">
<h5 id="orgdd9bc2b">通过 Enum 的名称字符串判断 Enum 是否定义</h5>
<div class="outline-text-5" id="text-orgdd9bc2b">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">netEventIDStr</span> = <span style="color: #2d9574;">"Cmd_"</span> + methodInfo.Name.<span style="color: #bc6ec5; font-weight: bold;">Replace</span>(_netEventPrefix, <span style="color: #2d9574;">""</span>);
  <span style="color: #4f97d7; font-weight: bold;">if</span>( Enum.<span style="color: #bc6ec5; font-weight: bold;">IsDefined</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(NETWORK.Command), netEventIDStr) )
  {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">do something</span>
  }

</pre>
</div>
</div>
</div>
<div id="outline-container-org8c3a7d4" class="outline-5">
<h5 id="org8c3a7d4">string int Enum 互转</h5>
<div class="outline-text-5" id="text-org8c3a7d4">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">enum</span> <span style="color: #ce537a; font-weight: bold;">Colors</span> { <span style="color: #7590db;">Red</span>, <span style="color: #7590db;">Green</span>, <span style="color: #7590db;">Blue</span>, <span style="color: #7590db;">Yellow</span> };

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">1 Enum--&gt;String </span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36820;&#22238; "Green"</span>
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">greenName</span> = Colors.Green.<span style="color: #bc6ec5; font-weight: bold;">ToString</span>(); 
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">greenName</span> = Enum.<span style="color: #bc6ec5; font-weight: bold;">GetName</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(Colors), Colors.Blue);
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">colorsNames</span> = Enum.<span style="color: #bc6ec5; font-weight: bold;">GetNames</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(Colors));

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">2 String--&gt;Enum</span>
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">redEnum</span> = (<span style="color: #ce537a; font-weight: bold;">Colors</span>)Enum.<span style="color: #bc6ec5; font-weight: bold;">Parse</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(Colors), <span style="color: #2d9574;">"Red"</span>);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">3 Enum--&gt;int</span>
(<span style="color: #ce537a; font-weight: bold;">int</span>)Colors.Red;
(<span style="color: #ce537a; font-weight: bold;">byte</span>)Colors.Green;

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">4 int--&gt;Enum</span>
<span style="color: #ce537a; font-weight: bold;">Colors</span> <span style="color: #7590db;">color</span> = (<span style="color: #ce537a; font-weight: bold;">Colors</span>)2;
<span style="color: #ce537a; font-weight: bold;">Colors</span> <span style="color: #7590db;">color</span> = (<span style="color: #ce537a; font-weight: bold;">Colors</span>)Enum.<span style="color: #bc6ec5; font-weight: bold;">ToObject</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(Colors), 2);
</pre>
</div>

<ul class="org-ul">
<li>参考链接 <a href="http://www.cnblogs.com/tekkaman/p/3973513.html">http://www.cnblogs.com/tekkaman/p/3973513.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2c1c08c" class="outline-4">
<h4 id="org2c1c08c">运算符</h4>
<div class="outline-text-4" id="text-org2c1c08c">
</div>
<div id="outline-container-org8eedb95" class="outline-5">
<h5 id="org8eedb95">&amp;符号</h5>
<div class="outline-text-5" id="text-org8eedb95">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">1 &#20301;&#19982;&#25805;&#20316;&#31526;</span>
Console.WriteLine (<span style="color: #2d9574;">"x&amp;y = {0}"</span>, 15 &amp; 3);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">2 &#21462;&#24341;&#29992;&#25805;&#20316;&#31526;</span>
<span style="color: #4f97d7; font-weight: bold;">unsafe</span> {
    <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = 10;
    <span style="color: #ce537a; font-weight: bold;">int</span>* j = &amp;i;
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">3 &amp;&amp; &#36923;&#36753;&#36816;&#31639;&#31526; &#19988;</span>
<span style="color: #4f97d7; font-weight: bold;">if</span> (a&gt;b &amp;&amp; a&lt;c)
{
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org06ee5f4" class="outline-5">
<h5 id="org06ee5f4">?符号</h5>
<div class="outline-text-5" id="text-org06ee5f4">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">1 &#20462;&#39280;&#22522;&#30784;&#31867;&#22411;&#20351;&#20854;&#21487;&#20026; null</span>
<span style="color: #ce537a; font-weight: bold;">int</span>? <span style="color: #7590db;">i</span> = <span style="color: #a45bad;">null</span>;
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">2 &#19977;&#20803;&#36816;&#31639;&#31526; &#26465;&#20214;&#34920;&#36798;&#24335; &#65311; &#34920;&#36798;&#24335; 1 : &#34920;&#36798;&#24335; 2</span>
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">a</span> = 3&gt;4 ? 3 : 4; <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">a=4;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8443b70" class="outline-5">
<h5 id="org8443b70">??</h5>
<div class="outline-text-5" id="text-org8443b70">
<p>
如果 ?? 运算符的左操作数非空，该运算符将返回左操作数，否则返回右操作数。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgc9b0401" class="outline-4">
<h4 id="orgc9b0401">条件分支语句</h4>
<div class="outline-text-4" id="text-orgc9b0401">
<p>
C/C++中条件语句中可以使用任意表达式，C#要求所有条件表达式都必须为布尔值.这是为了避免 if(a=10) 这样的错误的！<br />
</p>

<p>
switch 语句可以对字符串进行跳转。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">switch</span>(name)
   {
       <span style="color: #4f97d7; font-weight: bold;">case</span> <span style="color: #2d9574;">"Mr.A"</span>:
           <span style="color: #bc6ec5; font-weight: bold;">DoSomething</span>();
           <span style="color: #4f97d7; font-weight: bold;">break</span>;
       <span style="color: #4f97d7; font-weight: bold;">case</span> <span style="color: #2d9574;">"Mr.B"</span>:
           <span style="color: #bc6ec5; font-weight: bold;">DoOtherthing</span>();
           <span style="color: #4f97d7; font-weight: bold;">break</span>;
       <span style="color: #4f97d7; font-weight: bold;">default</span>:
           <span style="color: #4f97d7; font-weight: bold;">break</span>;
   }
</pre>
</div>
</div>
</div>
<div id="outline-container-org45c9be6" class="outline-4">
<h4 id="org45c9be6">预处理指令</h4>
<div class="outline-text-4" id="text-org45c9be6">
<p>
C#预处理器只实现了 C++预处理器的一个子集，不支持宏。<br />
#region [comment context]- #endregion 使用注释来标记一段代码.<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #bc6ec5;">#region</span> <span style="color: #2d9574;">test region</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">test region</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">a define is here</span>
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">a</span> = 10;
<span style="color: #bc6ec5;">#endregion</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org2949958" class="outline-4">
<h4 id="org2949958">泛型函数</h4>
<div class="outline-text-4" id="text-org2949958">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ForeachObjInScene</span>&lt;<span style="color: #ce537a; font-weight: bold;">ObjT</span>&gt;(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">scenePath</span>, <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">includeInactive</span>, <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">sceneProgress</span>, System.<span style="color: #ce537a; font-weight: bold;">Action</span>&lt;<span style="color: #ce537a; font-weight: bold;">ObjT</span>&gt; <span style="color: #7590db;">opt</span>) <span style="color: #4f97d7; font-weight: bold;">where</span> ObjT : UnityEngine.Object
{
    <span style="color: #4f97d7; font-weight: bold;">if</span> (opt == <span style="color: #a45bad;">null</span>) <span style="color: #4f97d7; font-weight: bold;">return</span>;

    <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">info</span> = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"Progessing {0}"</span>, scenePath);
    <span style="color: #4f97d7; font-weight: bold;">if</span> (EditorUtility.<span style="color: #bc6ec5; font-weight: bold;">DisplayCancelableProgressBar</span>(<span style="color: #2d9574;">"Modify Light Param"</span>, info, sceneProgress))
    {
    }

    <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">scene</span> = EditorSceneManager.<span style="color: #bc6ec5; font-weight: bold;">OpenScene</span>(scenePath);
    <span style="color: #4f97d7; font-weight: bold;">if</span> (scene == <span style="color: #a45bad;">null</span>)
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">LogWarningFormat</span>(<span style="color: #2d9574;">"scene not exist! {0}"</span>, scenePath);
    }

    <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">objArr</span> = GameObject.<span style="color: #bc6ec5; font-weight: bold;">FindObjectsOfType</span>&lt;<span style="color: #ce537a; font-weight: bold;">ObjT</span>&gt;(includeInactive);
    <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">obj</span> <span style="color: #4f97d7; font-weight: bold;">in</span> objArr)
    {
        <span style="color: #bc6ec5; font-weight: bold;">opt</span>(obj);
    }

    <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span>EditorSceneManager.<span style="color: #bc6ec5; font-weight: bold;">SaveScene</span>(scene))
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">LogWarningFormat</span>(<span style="color: #2d9574;">"Save Scene Failed! scene = {0}"</span>, scenePath);
    }
    <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span>EditorSceneManager.<span style="color: #bc6ec5; font-weight: bold;">CloseScene</span>(scene, <span style="color: #a45bad;">true</span>))
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">LogWarningFormat</span>(<span style="color: #2d9574;">"Close Scene Failed! scene = {0}"</span>, scenePath);
    }
}
</pre>
</div>

<ul class="org-ul">
<li><a href="https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/generics/generic-methods">https://learn.microsoft.com/zh-cn/dotnet/csharp/programming-guide/generics/generic-methods</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgd71efc0" class="outline-3">
<h3 id="orgd71efc0">类与对象</h3>
<div class="outline-text-3" id="text-orgd71efc0">
</div>
<div id="outline-container-org34534c9" class="outline-4">
<h4 id="org34534c9">定义类</h4>
<div class="outline-text-4" id="text-org34534c9">
<p>
[attribue 性质][修饰符]class 标识符[:基类]<br />
{类主体}<br />
C#类定义后不需要分号,加分号也不会报错。<br />
</p>
</div>

<div id="outline-container-orgae00a3b" class="outline-5">
<h5 id="orgae00a3b">访问修饰符</h5>
<div class="outline-text-5" id="text-orgae00a3b">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">访问修饰符</th>
<th scope="col" class="org-left">限制</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">public</td>
<td class="org-left">无限制。标记为 public 成员，任何类的任何方法都可以访问</td>
</tr>

<tr>
<td class="org-left">private</td>
<td class="org-left">标记为 private 的类 A 的成员，只有类 A 的方法可以访问</td>
</tr>

<tr>
<td class="org-left">protected</td>
<td class="org-left">标记为 protected 的类 A 的成员，类 A 和从类 A 派生的类的方法可以访问</td>
</tr>

<tr>
<td class="org-left">internal</td>
<td class="org-left">标记为 internal 的类 A 的成员，A 所处的程序集中的任何类的方法都可以访问</td>
</tr>

<tr>
<td class="org-left">protected internal</td>
<td class="org-left">protected 或 internal 的意思。（没有 protected 且 internal 的概念）</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org5bb0084" class="outline-6">
<h6 id="org5bb0084">protected internal</h6>
<div class="outline-text-6" id="text-org5bb0084">
<p>
protected internal 表示 类和子类可以访问，该成员所在程序集内的任何类也可以访问。protected internal 范围大于等于 internal，也大于等于 protected。<br />
<a href="http://www.cnblogs.com/adodo1/p/4327581.html">http://www.cnblogs.com/adodo1/p/4327581.html</a><br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org4289f90" class="outline-4">
<h4 id="org4289f90">创建对象</h4>
<div class="outline-text-4" id="text-org4289f90">
<p>
对象是引用类型，创建于堆中，需要使用关键字 new。<br />
</p>
</div>
<div id="outline-container-org235b39a" class="outline-5">
<h5 id="org235b39a">构造方法</h5>
<div class="outline-text-5" id="text-org235b39a">
<p>
未定义构造函数时，编译器会提供一个默认构造函数。<br />
未显式初始化的成员变量会按照下表的值初始化。<br />
用户实现任何构造函数后，编译器将不会提供默认构造函数。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">类型</th>
<th scope="col" class="org-left">默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">numeric(int long 等)</td>
<td class="org-left">0</td>
</tr>

<tr>
<td class="org-left">bool</td>
<td class="org-left">false</td>
</tr>

<tr>
<td class="org-left">char</td>
<td class="org-left">\0</td>
</tr>

<tr>
<td class="org-left">enum</td>
<td class="org-left">0</td>
</tr>

<tr>
<td class="org-left">reference</td>
<td class="org-left">null</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org9c53452" class="outline-5">
<h5 id="org9c53452">初始化语句</h5>
<div class="outline-text-5" id="text-org9c53452">
<p>
可以在初始化语句中初始化成员变量的值，而不需要都在构造函数中进行。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span> 
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#21021;&#22987;&#21270;&#35821;&#21477;&#20013;&#21021;&#22987;&#21270;&#20102;&#25104;&#21592;&#21464;&#37327;&#30340;&#20540;&#20026; "Unknown"</span>
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span> = <span style="color: #2d9574;">"Unknown"</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">Person</span>(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span>)
    {
      <span style="color: #4f97d7; font-weight: bold;">this</span>.name = name;
    }
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#20195;&#30721;&#32534;&#35793;&#20250;&#20986;&#38169;&#65292;&#25552;&#31034;&#26500;&#36896;&#20989;&#25968;&#27809;&#26377;&#25552;&#20379; string &#31867;&#22411;&#30340;&#21442;&#25968;</span>
<span style="color: #ce537a; font-weight: bold;">Person</span> <span style="color: #7590db;">p</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Person</span>();
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd428e1e" class="outline-5">
<h5 id="orgd428e1e">ICloneable 接口</h5>
<div class="outline-text-5" id="text-orgd428e1e">
<p>
C#中没有复制构造函数。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span>: <span style="color: #ce537a; font-weight: bold;">ICloneable</span>
{
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span> = <span style="color: #2d9574;">"Unknown"</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">Person</span>(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.name = name;
    }
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#35813;&#20989;&#25968;&#30340;&#36820;&#22238;&#31867;&#22411;&#20026; Object</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #bc6ec5; font-weight: bold;">Clone</span>()
    {
        <span style="color: #ce537a; font-weight: bold;">Person</span> <span style="color: #7590db;">newObj</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Person</span> (name);
        <span style="color: #4f97d7; font-weight: bold;">return</span> newObj;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org2b06daa" class="outline-5">
<h5 id="org2b06daa">对象构造顺序</h5>
<div class="outline-text-5" id="text-org2b06daa">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Temp</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">Temp</span>(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">arg</span>)
    {
        Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"Temp "</span> + arg);
    }
}
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">TestA</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Temp</span> <span style="color: #7590db;">tempA</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Temp</span>(<span style="color: #2d9574;">"A"</span>);
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">TestA</span>()
    {
        Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"TestA"</span>);
        <span style="color: #bc6ec5; font-weight: bold;">Print</span>();
    }
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">virtual</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Print</span>()
    {
        Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"TestA.Print"</span>);
    }
};

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">TestB</span> : <span style="color: #ce537a; font-weight: bold;">TestA</span>
{
    <span style="color: #ce537a; font-weight: bold;">Temp</span> <span style="color: #7590db;">tempB</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Temp</span>(<span style="color: #2d9574;">"B"</span>);
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">TestB</span>()
    {
        Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"TestB"</span>);
    }
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Print</span>()
    {
        Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"TestB.Print"</span>);
    }
};
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Program</span>
{
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Main</span>(<span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">args</span>)
    {
        <span style="color: #ce537a; font-weight: bold;">TestB</span> <span style="color: #7590db;">b</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">TestB</span>();
    }
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Output:</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Temp B</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Temp A</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">TestA</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">TestB.Print</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">TestB</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#31867;&#33258;&#24049;&#30340;&#21021;&#22987;&#21270;&#35821;&#21477;&#20808;&#25191;&#34892; &#28982;&#21518;&#25191;&#34892;&#29238;&#31867;&#21021;&#22987;&#21270;&#35821;&#21477; &#28982;&#21518;&#25191;&#34892;&#29238;&#31867;&#26500;&#36896;&#20989;&#25968;&#65288;&#29238;&#31867;&#26500;&#36896;&#20989;&#25968;&#20013;&#22810;&#24577;&#24050;&#32463;&#21487;&#29992;&#65289; &#28982;&#21518;&#25191;&#34892;&#23376;&#31867;&#26500;&#36896;&#20989;&#25968;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org65d806d" class="outline-5">
<h5 id="org65d806d">Activator.CreateInstance</h5>
<div class="outline-text-5" id="text-org65d806d">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #7590db;">System</span>;

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">default constructor</span>
obj = Activator.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;();
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">constructor with args</span>
<span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">obj_type</span> = <span style="color: #4f97d7; font-weight: bold;">typeof</span>(T);
obj = (<span style="color: #ce537a; font-weight: bold;">T</span>)Activator.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>(obj_type, arg0);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge41563d" class="outline-4">
<h4 id="orge41563d">使用静态成员</h4>
<div class="outline-text-4" id="text-orge41563d">
</div>
<div id="outline-container-org92f5356" class="outline-5">
<h5 id="org92f5356">静态成员</h5>
<div class="outline-text-5" id="text-org92f5356">
<p>
C#中不可以通过对象来访问类的静态成员方法和变量。但是在类内可以直接访问静态成员方法和变量。<br />
CLR 保证在类的其他操作之前运行静态构造方法。静态构造方法通常用于初始化语句无法完成或者仅需一次的设置工作。<br />
</p>
</div>
</div>
<div id="outline-container-org018f9e1" class="outline-5">
<h5 id="org018f9e1">静态类</h5>
<div class="outline-text-5" id="text-org018f9e1">
<p>
C#中没有全局方法或全局变量、常量。可以创建静态类来封装全局方法和全局变量、常量。<br />
静态类无法实例化，静态类不能被派生，静态类不可含非静态成员。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">AppConstant</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">MaxPlayer</span> = 3;
}
AppConstant.<span style="color: #7590db;">MaxPlayer</span> = 4;
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(AppConstant.MaxPlayer);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb444793" class="outline-4">
<h4 id="orgb444793">销毁对象</h4>
<div class="outline-text-4" id="text-orgb444793">
<p>
C#提供了垃圾回收器，因此不需要显式地销毁对象。但如果对象要控制非托管的资源，用完后显式地释放还是需要的。<br />
</p>
</div>
<div id="outline-container-org873a756" class="outline-6">
<h6 id="org873a756">析构函数</h6>
<div class="outline-text-6" id="text-org873a756">
<p>
对非托管资源的隐式控制是通过析构方法来提供的，它会在对象销毁时有垃圾回收器调用。<br />
</p>
<div class="org-src-container">
<pre class="src src-c#">~MyClass(){}
// 上面的代码会被编译器翻译为
protected override void Finalize()
{
	try
  {}
  finally
  {
		base.Finalize();
  }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org4416352" class="outline-6">
<h6 id="org4416352">Dispose 方法</h6>
<div class="outline-text-6" id="text-org4416352">
<p>
显式调用析构方法是不合法的。如果需要处理昂贵的非托管资源，需要尽快关闭和清除他们，应该实现 IDisposable 接口。<br />
IDisosable 接口要求实现者定义一个名为 Dispose()的方法，清除我们认为重要的一切。<br />
如果提供了 Dispose()方法，应该停止垃圾回收器调用对象的析构方法，这样保证只进行一次资源释放。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">TestDispose</span>:<span style="color: #ce537a; font-weight: bold;">IDisposable</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">RunTestDispose</span> (<span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">isRun</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #a45bad;">!</span>isRun)
              <span style="color: #4f97d7; font-weight: bold;">return</span>;

          <span style="color: #ce537a; font-weight: bold;">TestDispose</span> <span style="color: #7590db;">temp</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">TestDispose</span> ();
          temp.Dispose ();
      }

      <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">is_disposed</span> = <span style="color: #a45bad;">false</span>;
      <span style="color: #4f97d7; font-weight: bold;">public</span> TestDispose ()
      {
      }
      <span style="color: #4f97d7; font-weight: bold;">protected</span> <span style="color: #4f97d7; font-weight: bold;">virtual</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Dispose</span>(<span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">disposing</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">if</span>(<span style="color: #a45bad;">!</span>is_disposed)
          {
              <span style="color: #4f97d7; font-weight: bold;">if</span>(disposing)
              {
                  Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"Not in destructor,Ok to reference other objects"</span>);
              }
              Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"Disposing ... "</span>);
          }
          is_disposed = <span style="color: #a45bad;">true</span>;
      }
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27492;&#20026; IDisposable &#23450;&#20041;&#30340;&#26041;&#27861;</span>
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Dispose</span>()
      {
          <span style="color: #bc6ec5; font-weight: bold;">Dispose</span>(<span style="color: #a45bad;">true</span>);
          GC.<span style="color: #bc6ec5; font-weight: bold;">SuppressFinalize</span>(<span style="color: #4f97d7; font-weight: bold;">this</span>);
      }
      ~<span style="color: #bc6ec5; font-weight: bold;">TestDispose</span>()
      {
          <span style="color: #bc6ec5; font-weight: bold;">Dispose</span>(<span style="color: #a45bad;">false</span>);
          Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"In destructor"</span>);
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfc0dd1b" class="outline-6">
<h6 id="orgfc0dd1b">using 语句</h6>
<div class="outline-text-6" id="text-orgfc0dd1b">
<p>
using 语句用于保证 Dispose 会尽可能最早的时刻调用。<br />
</p>
<div class="org-src-container">
<pre class="src src-c#">//方法 1
using (Font theFont = new Font("Arial",10.0f))
{
	// 使用 theFont
	// 编译器会调用 theFont 的 Dispose
}
//方法 2
Font anotherFont = new Font("Arial",10.0f);
using (anotherFont)
{
	// 使用 anotherFont
  // 编译器会调用 anotherFont 的 Dispose
}
</pre>
</div>
<p>
方法 2 存在风险。<br />
首先：如果在创建对象后，进入 using 语句之前发生异常，对象将不会被清除。<br />
其次：变量在 using 语句块结束后仍然在作用域中，但是其资源已经释放了，所以再次使用它时可能会有错误。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgf5083e7" class="outline-4">
<h4 id="orgf5083e7">参数传递</h4>
<div class="outline-text-4" id="text-orgf5083e7">
</div>
<div id="outline-container-orga1b6db6" class="outline-5">
<h5 id="orga1b6db6">默认情况下值类型是按值传递给方法的。</h5>
<div class="outline-text-5" id="text-orga1b6db6">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg</span> = 10;
<span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ChangeArgTo20</span>(<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg</span>)
{
    arg = 20;
}
<span style="color: #bc6ec5; font-weight: bold;">ChangeArgTo20</span>(arg);
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"arg = "</span> + arg);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">arg = 10</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfa40b55" class="outline-5">
<h5 id="orgfa40b55">通过 ref 可以实现按照引用传递值类型的参数。</h5>
<div class="outline-text-5" id="text-orgfa40b55">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg</span> = 10;
<span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ChangeArgTo20</span>(<span style="color: #4f97d7; font-weight: bold;">ref</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg</span>)
{
    arg = 20;
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#65306; &#20256;&#36882;&#21442;&#25968;&#24517;&#39035;&#26631;&#35782; ref&#65292;&#21542;&#21017;&#20250;&#25253;&#38169;</span>
<span style="color: #bc6ec5; font-weight: bold;">ChangeArgTo20</span>(<span style="color: #4f97d7; font-weight: bold;">ref</span> <span style="color: #ce537a; font-weight: bold;">arg</span>);
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"arg = "</span> + arg);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">arg = 20</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfd1a435" class="outline-5">
<h5 id="orgfd1a435">通过 out 可以克服明确赋值问题。</h5>
<div class="outline-text-5" id="text-orgfd1a435">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg</span>;
<span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ChangeArgTo20</span>(<span style="color: #4f97d7; font-weight: bold;">out</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg</span>)
{
    arg = 20;
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#65306; &#20256;&#36882;&#21442;&#25968;&#24517;&#39035;&#26631;&#35782; out&#65292;&#21542;&#21017;&#20250;&#25253;&#38169;</span>
<span style="color: #bc6ec5; font-weight: bold;">ChangeArgTo20</span>(<span style="color: #4f97d7; font-weight: bold;">out</span> <span style="color: #ce537a; font-weight: bold;">arg</span>);
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"arg = "</span> + arg);

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg1</span>;
<span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ChangeArgAdd10</span>(<span style="color: #4f97d7; font-weight: bold;">out</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">arg1</span>)
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#65306;&#19979;&#38754;&#30340;&#20195;&#30721;&#24517;&#39035;&#26377;&#65292;&#21542;&#21017;&#32534;&#35793;&#25253;&#38169;&#65292;&#25552;&#31034; out &#31867;&#22411;&#21442;&#25968;&#24517;&#39035;&#22312;&#20989;&#25968;&#20869;&#36171;&#20540;</span>
    arg1 = 10;
    arg1 += 10;
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org92fee20" class="outline-4">
<h4 id="org92fee20">通过属性封装数据</h4>
<div class="outline-text-4" id="text-org92fee20">
<p>
通过属性，客户代码可以访问类的状态，就像直接访问成员字段一样，而实际上这是通过类方法访问才实现的。<br />
通过 public private protected internal 实现属性访问控制<br />
使用属性要小心，属性本身实际上是成员方法，在初始化所有成员变量之前不能调用成员方法。<br />
只定义 set 时，属性只可写不可读。只定义 get 时，属性只可读不可写。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span>{
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span>;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">Name</span>
      {
          <span style="color: #4f97d7; font-weight: bold;">get</span> 
          {
              <span style="color: #4f97d7; font-weight: bold;">return</span> name;
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span> 
          {
              name = <span style="color: #a45bad;">value</span>;
          }
      }
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">age</span>;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Age</span>
      {
          <span style="color: #4f97d7; font-weight: bold;">protected</span> <span style="color: #4f97d7; font-weight: bold;">get</span>
          {
              <span style="color: #4f97d7; font-weight: bold;">return</span> age;
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span>
          {
              age = <span style="color: #a45bad;">value</span>;
          }
      }
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">tel</span>;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">Tel</span>
      {
          <span style="color: #4f97d7; font-weight: bold;">set</span>{ tel = <span style="color: #a45bad;">value</span>; }
      }
  }
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgff308f9" class="outline-3">
<h3 id="orgff308f9">继承和多态</h3>
<div class="outline-text-3" id="text-orgff308f9">
</div>
<div id="outline-container-org43d9308" class="outline-4">
<h4 id="org43d9308">多态</h4>
<div class="outline-text-4" id="text-org43d9308">
<p>
必须显式用关键词 override 标记重新定义了虚方法的方法声明。否则通过基类多态调用该方法时不会调用子类的方法。此时编译器会有警告。<br />
函数前加 new 关键词，可以取消上述编译器的警告，注意此时多态调用依然只会调用基类的方法。<br />
</p>
</div>
<div id="outline-container-org179c7ed" class="outline-5">
<h5 id="org179c7ed">调用基类构造方法</h5>
<div class="outline-text-5" id="text-org179c7ed">
<p>
可以通过 base 来调用基类构造方法<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Button</span>: <span style="color: #ce537a; font-weight: bold;">Control</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">id</span> = 0;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">Button</span>(<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">id</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.id = id;
          <span style="color: #bc6ec5; font-weight: bold;">DrawWindow</span>();
      }
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DrawWindow</span>()
      {
          Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"Button DrawWindow"</span>);
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">LabelButton</span>:<span style="color: #ce537a; font-weight: bold;">Button</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">label</span>;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">LabelButton</span>(<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">id</span>,<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">label</span>)
          :<span style="color: #4f97d7; font-weight: bold;">base</span>(id)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.label = label;
          <span style="color: #bc6ec5; font-weight: bold;">DrawWindow</span>();
      }
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DrawWindow</span>()
      {
          Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"LabelButton DrawWindow"</span>);
      }
  }

  <span style="color: #ce537a; font-weight: bold;">LabelButton</span> <span style="color: #7590db;">tmp</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">LabelButton</span>(10, <span style="color: #2d9574;">"LabelBtn"</span>);
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#65306; &#22312;&#22522;&#31867;&#26500;&#36896;&#20989;&#25968;&#20013;&#35843;&#29992;&#34394;&#20989;&#25968;&#65292;&#23454;&#38469;&#34987;&#35843;&#29992;&#30340;&#26159;&#27966;&#29983;&#31867;&#30340;&#20989;&#25968;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">LabelButton DrawWindow</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">LabelButton DrawWindow</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org0bc5d5a" class="outline-4">
<h4 id="org0bc5d5a">抽象类</h4>
<div class="outline-text-4" id="text-org0bc5d5a">
<p>
将方法指定为抽象方法可以强制子类实现基类的该抽象方法。<br />
抽象方法没有实现。<br />
使类的一个或多个方法为抽象方法，会使类变为抽象类，而且必须在类定义前加 abatract 修饰符。<br />
抽象类无法实例化。<br />
抽象类代表了一种抽象的理念，要为所有派生类创建一个“合同（contract）”。也就是说，抽象类描述了要实现该抽象的所有类的公共方法。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#31867;&#20869;&#37096;&#26377;&#25277;&#35937;&#26041;&#27861;&#26102;&#65292;&#24517;&#39035;&#23558;&#31867;&#22768;&#26126;&#20026;&#25277;&#35937;&#31867;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">public class Control</span>
  <span style="color: #4f97d7; font-weight: bold;">abstract</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Control</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">id</span> = 0;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Id</span> {   
          <span style="color: #4f97d7; font-weight: bold;">get</span> { 
              <span style="color: #4f97d7; font-weight: bold;">return</span> id;            
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span> {
              id = <span style="color: #a45bad;">value</span>;
          }
      }

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#20197;&#23558;&#20989;&#25968;&#25351;&#23450;&#20026; virtual &#25552;&#20379;&#40664;&#35748;&#23454;&#29616;</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//        </span><span style="color: #2aa1ae; background-color: #292e34;">public virtual void DrawWindow ()</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//        </span><span style="color: #2aa1ae; background-color: #292e34;">{</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//        </span><span style="color: #2aa1ae; background-color: #292e34;">}</span>

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">error &#25277;&#35937;&#26041;&#27861;&#19981;&#33021;&#26377;&#23454;&#29616;</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//        </span><span style="color: #2aa1ae; background-color: #292e34;">abstract public void DrawWindow ()</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//        </span><span style="color: #2aa1ae; background-color: #292e34;">{</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//        </span><span style="color: #2aa1ae; background-color: #292e34;">}</span>

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#20197;&#23558;&#20989;&#25968;&#25351;&#23450;&#20026; abstract &#22914;&#26524;&#23376;&#31867;&#27809;&#26377;&#23454;&#29616; abstract &#26041;&#27861;&#21017;&#23376;&#31867;&#20063;&#38656;&#35201;&#26631;&#35760;&#20026;&#25277;&#35937;&#31867;</span>
      <span style="color: #4f97d7; font-weight: bold;">abstract</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DrawWindow</span> ();
  }

  <span style="color: #4f97d7; font-weight: bold;">abstract</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ConrolX</span> : <span style="color: #ce537a; font-weight: bold;">Control</span>
  {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19981;&#38656;&#35201;&#37325;&#26032;&#22768;&#26126;&#25277;&#35937;&#26041;&#27861;&#65292;&#21542;&#21017;&#20250;&#38544;&#34255; Control &#20013;&#30340;&#22768;&#26126;</span>
      <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">abstract public void DrawWindow ();</span>
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Button</span>: <span style="color: #ce537a; font-weight: bold;">Control</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> Button (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">id</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.Id = id;
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DrawWindow</span> ()
      {
          Console.WriteLine (<span style="color: #2d9574;">"Button DrawWindow"</span>);
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org4b2841c" class="outline-4">
<h4 id="org4b2841c">密封类</h4>
<div class="outline-text-4" id="text-org4b2841c">
<p>
抽象类是用来派生的，与抽象相对的设计概念是密封。sealed 置于类声明之前用来阻止派生。<br />
struct 是隐式密封的，因此在定义 struct 的时候不用使用 sealed 和 abstract 关键字<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">sealed</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">SealedClass</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">x</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">y</span>;
}
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyDerivedC</span>: <span style="color: #ce537a; font-weight: bold;">SealedClass</span> {} <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Error</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9850c4f" class="outline-4">
<h4 id="org9850c4f">万类之根：Object</h4>
<div class="outline-text-4" id="text-org9850c4f">
<p>
所有 C#类，无论是何类型，都可以看成是从 System.Object 派生而来的。值类型也包括在内。<br />
类不需要声明从 Ojbect 派生，继承是隐含的。<br />
所有的值类型均隐式派生自 System.ValueType。<br />
</p>
</div>
</div>
<div id="outline-container-org00c3209" class="outline-4">
<h4 id="org00c3209">类型的装箱和拆箱</h4>
<div class="outline-text-4" id="text-org00c3209">
<p>
装箱和拆箱是使值类型能够被当成引用类型（对象）的处理过程。值被装箱到一个 Object 里然后拆箱回一个值类型。<br />
装箱是一种隐含的转换。<br />
拆箱必须是显式的。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = 123;
<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span> = i;   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#35013;&#31665;</span>
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">j</span> = (<span style="color: #ce537a; font-weight: bold;">int</span>)obj; <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25286;&#31665;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org21294ad" class="outline-4">
<h4 id="org21294ad">嵌套类</h4>
<div class="outline-text-4" id="text-org21294ad">
<p>
嵌套类的方法可以访问外层类的私有成员。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">OuterClass</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">outer_obj_count</span> = 0;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #bc6ec5; font-weight: bold;">OuterClass</span>()
      {
          outer_obj_count++;
      }
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">NestedClass</span>
      {
          <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">nested_obj_count</span> = 0;
          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">PrintOuterObjCount</span>()
          {
              Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #ce537a; font-weight: bold;">outer_obj_count</span>);
          }
          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">PrintNestedObjCount</span>()
          {
              Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #ce537a; font-weight: bold;">nested_obj_count</span>);
          }
      }
  }
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgffec2c6" class="outline-3">
<h3 id="orgffec2c6">操作符重载</h3>
<div class="outline-text-3" id="text-orgffec2c6">
<p>
c#中，操作符都是一些静态方法，其返回值表示操作结果，其参数是操作数。<br />
C#要求必须成对重载操作符。例如 <code>=与!</code> &lt;与&gt; &lt;=与&gt;=<br />
转换操作符重载中，implicit 关键字用于转换肯定成功，不会丢失信息的时候；否则就用关键字 explicit。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#35814;&#32454;&#20195;&#30721;&#35831;&#30475; Fraction.cs &#25991;&#20214;</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Fraction</span>
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#30465;&#30053;&#37096;&#20998;&#20195;&#30721; ......</span>
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">implicit</span> <span style="color: #4f97d7; font-weight: bold;">operator</span> Fraction (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">theInt</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Fraction</span> (<span style="color: #ce537a; font-weight: bold;">theInt</span>);
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">explicit</span> <span style="color: #4f97d7; font-weight: bold;">operator</span> <span style="color: #ce537a; font-weight: bold;">int</span> (<span style="color: #ce537a; font-weight: bold;">Fraction</span> <span style="color: #7590db;">fraction</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">return</span> fraction.numerator / fraction.denominator;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #4f97d7; font-weight: bold;">operator</span>== (<span style="color: #ce537a; font-weight: bold;">Fraction</span> <span style="color: #7590db;">lhs</span>, <span style="color: #ce537a; font-weight: bold;">Fraction</span> <span style="color: #7590db;">rhs</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (lhs.denominator == rhs.denominator &amp;&amp;
            lhs.numerator == rhs.numerator) {
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">true</span>;
        }
        <span style="color: #4f97d7; font-weight: bold;">return</span> lhs.numerator / lhs.denominator == rhs.numerator / rhs.denominator;
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #4f97d7; font-weight: bold;">operator</span>!= (<span style="color: #ce537a; font-weight: bold;">Fraction</span> <span style="color: #7590db;">lhs</span>, <span style="color: #ce537a; font-weight: bold;">Fraction</span> <span style="color: #7590db;">rhs</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">!</span>(lhs == rhs);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgba13300" class="outline-3">
<h3 id="orgba13300">结构体</h3>
<div class="outline-text-3" id="text-orgba13300">
<p>
结构体不支持继承和析构函数。结构体是值类型。(所以函数的结构体类型的参数是按值传递的)<br />
结构体数组在内存使用方面效率相对更好。结构体集合的效率就不行了。集合的元素必须是引用类型，所以结构体必须进行装箱处理。<br />
结构体不能通过初始化语句初始化结构体的实例字段。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">Student</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span> = <span style="color: #2d9574;">"hi"</span>; <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">this is error</span>
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">age</span>;
  }
</pre>
</div>
<p>
结构体成员默认的访问权限也为 private。<br />
</p>
</div>
<div id="outline-container-org74d1088" class="outline-4">
<h4 id="org74d1088">定义结构体</h4>
<div class="outline-text-4" id="text-org74d1088">
<p>
[attribue 性质][访问修饰符]struct 标识符[:接口列表]<br />
{结构体成员}<br />
</p>
</div>
</div>
<div id="outline-container-org6c9d0ca" class="outline-4">
<h4 id="org6c9d0ca">创建结构对象</h4>
<div class="outline-text-4" id="text-org6c9d0ca">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 1</span>
<span style="color: #ce537a; font-weight: bold;">Student</span> <span style="color: #7590db;">stu1</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Student</span>();
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2</span>
<span style="color: #ce537a; font-weight: bold;">Student</span> <span style="color: #7590db;">stu2</span>;
stu2.name = <span style="color: #2d9574;">""</span>;
stu2.age = 0;
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2 &#38656;&#35201;&#25163;&#21160;&#21021;&#22987;&#21270;&#25152;&#26377;&#25104;&#21592;&#30340;&#21021;&#22987;&#20540;&#12290;&#24403;&#32467;&#26500;&#20307;&#20869;&#26377;&#31169;&#26377;&#25104;&#21592;&#21464;&#37327;&#26102;&#65292;&#26041;&#27861; 2 &#23558;&#26080;&#27861;&#20351;&#29992;&#65292;&#22240;&#20026;&#26080;&#27861;&#21021;&#22987;&#21270;&#31169;&#26377;&#25104;&#21592;&#21464;&#37327;&#12290;</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org51f423d" class="outline-3">
<h3 id="org51f423d">接口</h3>
<div class="outline-text-3" id="text-org51f423d">
<p>
接口是向客户保证类或结构体行为方式的一种协定。定义接口时可以定义实现该接口的类需要实现的方法、属性、索引器和事件。<br />
继承抽象类描述了 is-a 的关系，类实现接口描述了 implement 的关系。<br />
</p>
</div>
<div id="outline-container-org32d5dcb" class="outline-4">
<h4 id="org32d5dcb">定义接口</h4>
<div class="outline-text-4" id="text-org32d5dcb">
<p>
[attribue 性质][访问修饰符]interface 标识符[:基列表]<br />
{接口主体}<br />
interface 后的标识符通常会以 I 开头，不过不是必须的。<br />
基列表列出了此接口扩展的接口。<br />
接口中属性的声明并没有实现 get\set 方法。<br />
接口中的方法声明没有访问修饰符，接口的方法隐含就是 public 的，因为接口是要其他类使用的协定。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IStorable</span>
  {
      <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Read</span> ();

      <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Write</span> (<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span>);

      <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Status</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GDoc</span> : <span style="color: #ce537a; font-weight: bold;">IStorable</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Read</span> ()
      {
          Console.WriteLine (<span style="color: #2d9574;">"GDoc read ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Write</span> (<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span>)
      {
          Console.WriteLine (<span style="color: #2d9574;">"GDoc write ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">status</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Status</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org5d235af" class="outline-4">
<h4 id="org5d235af">类可以实现多个接口</h4>
<div class="outline-text-4" id="text-org5d235af">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GDoc</span> : <span style="color: #ce537a; font-weight: bold;">IStorable</span>, <span style="color: #ce537a; font-weight: bold;">ICompressible</span>
{ ... }
</pre>
</div>
</div>
</div>
<div id="outline-container-org465fc1a" class="outline-4">
<h4 id="org465fc1a">扩展接口</h4>
<div class="outline-text-4" id="text-org465fc1a">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">ILoggedCompressible</span> : <span style="color: #ce537a; font-weight: bold;">ICompressible</span>
{
    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">LogSavedBytes</span>();
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org1f17559" class="outline-4">
<h4 id="org1f17559">组合接口</h4>
<div class="outline-text-4" id="text-org1f17559">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IStorableCompressible</span>: <span style="color: #ce537a; font-weight: bold;">IStorable</span>,<span style="color: #ce537a; font-weight: bold;">ICompressible</span>
{
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org51a6526" class="outline-4">
<h4 id="org51a6526">转换为接口</h4>
<div class="outline-text-4" id="text-org51a6526">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">IStorable</span> <span style="color: #7590db;">iObj</span> = doc <span style="color: #4f97d7; font-weight: bold;">as</span> IStorable;
  <span style="color: #4f97d7; font-weight: bold;">if</span>(iObj != <span style="color: #a45bad;">null</span>)
   {
       iObj.<span style="color: #bc6ec5; font-weight: bold;">Read</span>();
   }
</pre>
</div>
</div>
</div>
<div id="outline-container-org26780a6" class="outline-4">
<h4 id="org26780a6">is 和 as 操作符</h4>
<div class="outline-text-4" id="text-org26780a6">
<p>
is 可用来判断某个对象是否为某个类型。也可以判断某个对象是否实现了某个接口。<br />
表达式 is 类型 // is 返回 true 或 false<br />
is 运算符只考虑引用转换、装箱转换和取消装箱转换。不考虑其他转换，如用户定义的转换。<br />
as 是将 is 和转换操作结合起来。首先测试转换是否合法，如果是就进行转换。如果转换不合法就返回 null。<br />
表达式 as 类型 // as 返回转换后的对象 或 null<br />
as 用于在兼容的引用类型之间执行转换.as 运算符只执行引用转换和装箱转换。as 运算符无法执行其他转换，如用户定义的转换。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">iValue</span> = 10;
Console.WriteLine (<span style="color: #2d9574;">"iValue is object = {0}"</span>, iValue <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #ce537a; font-weight: bold;">object</span>);
Console.WriteLine (<span style="color: #2d9574;">"iValue is int    = {0}"</span>, iValue <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #ce537a; font-weight: bold;">int</span>);
Console.WriteLine (<span style="color: #2d9574;">"iValue as object = {0}"</span>, iValue <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">object</span>);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">output</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">iValue is object = True</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">iValue is int    = True</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">iValue as object = 10</span>

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#20195;&#30721;&#32534;&#35793;&#20250;&#20986;&#38169;</span>
Console.WriteLine (<span style="color: #2d9574;">"iValue as int    = {0}"</span>, iValue <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">int</span>);
</pre>
</div>
</div>
</div>
<div id="outline-container-org2997495" class="outline-4">
<h4 id="org2997495">接口和抽象类比较</h4>
<div class="outline-text-4" id="text-org2997495">
<p>
若要创建一个会被许多人使用的类库，最好使用抽象基类；这样当你需要增加一个新的方法时，只需要在抽象基类中添加一个虚方法，然后配一个默认实现就好了。<br />
若只是为单个项目创建类，则使用接口更好，因为接口更加灵活且具有弹性。<br />
</p>
</div>
</div>
<div id="outline-container-orgcc08fe7" class="outline-4">
<h4 id="orgcc08fe7">重定义接口的实现</h4>
<div class="outline-text-4" id="text-orgcc08fe7">
<p>
实现类可以自由地将任何或全部实现接口的方法标记为虚。派生类可以重定义或提供新的实现。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IStorable</span>
  {
      <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Read</span> ();

      <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Write</span> (<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span>);

      <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Status</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GDoc</span> : <span style="color: #ce537a; font-weight: bold;">IStorable</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">virtual</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Read</span> ()
      {
          Console.WriteLine (<span style="color: #2d9574;">"GDoc read ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">virtual</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Write</span> (<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span>)
      {
          Console.WriteLine (<span style="color: #2d9574;">"GDoc write ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">status</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Status</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GNote</span> : <span style="color: #ce537a; font-weight: bold;">GDoc</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Read</span> ()
      {
          Console.WriteLine (<span style="color: #2d9574;">"GNote read ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Write</span> (<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span>)
      {
          Console.WriteLine (<span style="color: #2d9574;">"GNote write ..."</span>);
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfb9c7ba" class="outline-4">
<h4 id="orgfb9c7ba">显式接口实现</h4>
<div class="outline-text-4" id="text-orgfb9c7ba">
<p>
当需要实现的两个接口有相同的方法时，其中一个接口的方法需要显式实现。<br />
显式实现声明的方法不能用访问修饰符，该方法隐含为公共的。<br />
显式实现声明的方法不能用 abstract\virtual\override\new 修饰符声明。<br />
将接口方法通过显式实现，可以一定程度的隐藏接口方法，从而达到有选择公开接口方法的目的。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GDoc</span> : <span style="color: #ce537a; font-weight: bold;">IStorable</span>,<span style="color: #ce537a; font-weight: bold;">ITalk</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">virtual</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Read</span> ()
      {
          Console.WriteLine (<span style="color: #2d9574;">"GDoc read ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">virtual</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Write</span> (<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">obj</span>)
      {
          Console.WriteLine (<span style="color: #2d9574;">"GDoc write ..."</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Talk</span> ()
      {
          Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"IStorable Talk implement"</span>);
      }

      <span style="color: #ce537a; font-weight: bold;">void</span> ITalk.<span style="color: #bc6ec5; font-weight: bold;">Talk</span> ()
      {
          Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"ITalk Talk implement"</span>);
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">status</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Status</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd08fd85" class="outline-4">
<h4 id="orgd08fd85">隐藏接口成员</h4>
<div class="outline-text-4" id="text-orgd08fd85">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IGBase</span>
  {
      <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">P</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IGDerived</span>:<span style="color: #ce537a; font-weight: bold;">IGBase</span>
  {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">new &#21487;&#20197;&#38544;&#34255; IGBase &#30340; P &#25104;&#21592;</span>
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #ce537a; font-weight: bold;">P</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>;
          <span style="color: #4f97d7; font-weight: bold;">set</span>;
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GMyClass</span>:<span style="color: #ce537a; font-weight: bold;">IGDerived</span>
  {
      <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">IGBase_P</span>;

      <span style="color: #ce537a; font-weight: bold;">int</span> IGBase.<span style="color: #7590db;">P</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span> {
              <span style="color: #4f97d7; font-weight: bold;">return</span> IGBase_P;
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span> { 
              IGBase_P = <span style="color: #a45bad;">value</span>;
          }
      }

      <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">p</span> = 10;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">P</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span> {
              <span style="color: #4f97d7; font-weight: bold;">return</span> p;
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span> { 
              p = <span style="color: #a45bad;">value</span>;
          }
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc228556" class="outline-4">
<h4 id="orgc228556">访问密封类和结构体</h4>
<div class="outline-text-4" id="text-orgc228556">
<p>
使用值类型实现接口时，一定要通过对象访问接口成员，而不要通过接口引用。因为将值类型对象转换为接口引用时会对值类型对象进行装箱操作，<br />
通过接口引用调用接口方法是在装箱后的引用对象上进行的。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">GStudentA</span> <span style="color: #7590db;">stu1</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GStudentA</span> (<span style="color: #2d9574;">"God1"</span>); <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">GStudentA is a struct</span>
<span style="color: #ce537a; font-weight: bold;">IChangeName</span> <span style="color: #7590db;">iCN</span> = stu1;
iCN.Name = <span style="color: #2d9574;">"God2"</span>;
Console.WriteLine (<span style="color: #2d9574;">"stu1 name = {0}"</span>, stu1.Name);
Console.WriteLine (<span style="color: #2d9574;">"iCN  name = {0}"</span>, iCN.Name);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">output</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">stu1 name = God1</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">iCN  name = God2</span>

<span style="color: #ce537a; font-weight: bold;">GStudentB</span> <span style="color: #7590db;">stu2</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GStudentB</span> (<span style="color: #2d9574;">"Dog1"</span>); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">GStudentB is a sealed class</span>
<span style="color: #ce537a; font-weight: bold;">IChangeName</span> <span style="color: #7590db;">iCN2</span> = stu2;
iCN2.Name = <span style="color: #2d9574;">"Dog2"</span>;
Console.WriteLine (<span style="color: #2d9574;">"stu2 name = {0}"</span>, stu2.Name);
Console.WriteLine (<span style="color: #2d9574;">"iCN2 name = {0}"</span>, iCN2.Name);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">output</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">stu2 name = Dog2</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">iCN2 name = Dog2</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org6806d2b" class="outline-3">
<h3 id="org6806d2b">数组索引器与集合</h3>
<div class="outline-text-3" id="text-org6806d2b">
</div>
<div id="outline-container-orge1bd9ad" class="outline-4">
<h4 id="orge1bd9ad">数组</h4>
<div class="outline-text-4" id="text-orge1bd9ad">
<p>
C#中数组为对象，数组可以有自己的方法和属性。<br />
</p>
</div>
<div id="outline-container-org450221e" class="outline-5">
<h5 id="org450221e">声明数组</h5>
<div class="outline-text-5" id="text-org450221e">
<p>
类型[] 数组名;<br />
</p>
</div>
</div>
<div id="outline-container-org5dfa6a7" class="outline-5">
<h5 id="org5dfa6a7">内存分配</h5>
<div class="outline-text-5" id="text-org5dfa6a7">
<p>
C#数组为引用类型，所以其在堆中分配，数组内的元素如何分配要看他们自己的类型。如果数组元素为值类型，则所有元素在为数组分配的内存块中创建。<br />
如果数组元素为引用类型，分配给数组的内存将用来存放对实际元素的引用。实际元素本身是在堆中分配的，所占内存和分配给数组的内存是不同的。<br />
</p>
</div>
</div>
<div id="outline-container-orgb5abb34" class="outline-5">
<h5 id="orgb5abb34">默认值</h5>
<div class="outline-text-5" id="text-orgb5abb34">
<p>
创建值类型数组时，每个元素最初都存放着数组所存类型的默认值。<br />
创建引用类型数组时，每个元素被初始化为 null。<br />
</p>
</div>
</div>
<div id="outline-container-org4b7c2cb" class="outline-5">
<h5 id="org4b7c2cb">遍历数组</h5>
<div class="outline-text-5" id="text-org4b7c2cb">
<p>
foreach(类型 标识符 in 表达式)语句<br />
for(int i=0; i&lt;arr.Length; i++)语句<br />
</p>
</div>
</div>
<div id="outline-container-orgdef2d72" class="outline-5">
<h5 id="orgdef2d72">初始化数组元素</h5>
<div class="outline-text-5" id="text-orgdef2d72">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">Employee</span>[] <span style="color: #7590db;">empArr</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span>[3] {
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span> (110),
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span> (111),
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span> (112)
  };
  <span style="color: #ce537a; font-weight: bold;">Employee</span>[] <span style="color: #7590db;">empArr</span> = {
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span> (110),
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span> (111),
      <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Employee</span> (112)
  };
</pre>
</div>
</div>
</div>
<div id="outline-container-org86b5499" class="outline-5">
<h5 id="org86b5499">params 关键字</h5>
<div class="outline-text-5" id="text-org86b5499">
<p>
params 可用于可变数目的数组函数参数。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">PrintIntArray</span> (<span style="color: #4f97d7; font-weight: bold;">params</span> <span style="color: #ce537a; font-weight: bold;">int</span>[] <span style="color: #7590db;">intArr</span>)
  {
      <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #a45bad;">value</span> <span style="color: #4f97d7; font-weight: bold;">in</span> intArr) {
          Console.WriteLine (<span style="color: #a45bad;">value</span>);
      }
  }
  <span style="color: #ce537a; font-weight: bold;">int</span>[] <span style="color: #7590db;">intArr</span> = { 11111, 11112, 11113, 11114 };
  PrintIntArray (intArr);
  PrintIntArray (1111, 1112, 1113);
</pre>
</div>
</div>
</div>
<div id="outline-container-org78515db" class="outline-5">
<h5 id="org78515db">多维数组</h5>
<div class="outline-text-5" id="text-org78515db">
<p>
数组可分为规则数组和不规则数组。规则数组每行长度是相同的，不规则数组是数组组成的数组。<br />
</p>
</div>
<div id="outline-container-org7f294a1" class="outline-6">
<h6 id="org7f294a1">规则数组</h6>
<div class="outline-text-6" id="text-org7f294a1">
<p>
二维数组 类型[,]数组名;<br />
三维数组 类型[,,]数组名;<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">int</span>[2,3]arr;     <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">2 &#34892; 3 &#21015;&#30340;&#20108;&#32500;&#25968;&#32452;</span>
  <span style="color: #ce537a; font-weight: bold;">int</span>[2,3,4]arr;   <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#19977;&#32500;&#25968;&#32452;</span>
  <span style="color: #ce537a; font-weight: bold;">int</span>[,] arr = {
      {0,1,2},
      {3,4,5},
      {6,7,8},
      {9,10,11}
  };                       <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">4 &#34892; 3 &#21015;&#30340;&#20108;&#32500;&#25968;&#32452;</span>
  arr[1,1];                <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#35775;&#38382;&#31532;&#20108;&#34892;&#31532;&#20108;&#21015;&#30340;&#20803;&#32032;&#65292;&#35813;&#20540;&#20026; 4</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1f0cd7d" class="outline-6">
<h6 id="org1f0cd7d">不规则数组</h6>
<div class="outline-text-6" id="text-org1f0cd7d">
<p>
类型[][]&#x2026;数组名;<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span>[3][]arr;      <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20108;&#32500;&#25972;&#22411;&#19981;&#35268;&#21017;&#25968;&#32452;</span>
arr[0] = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span>[4];
arr[1] = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span>[2];
arr[2] = {0,2,4,6,8};
arr[2][3];        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#35775;&#38382;&#31532;&#19977;&#34892;&#31532;&#22235;&#21015;&#30340;&#20803;&#32032;&#65292;&#35813;&#20540;&#20026; 8</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org89866bf" class="outline-5">
<h5 id="org89866bf">数组转换</h5>
<div class="outline-text-5" id="text-org89866bf">
<p>
如果维数相同，且引用元素类型可以转换，那么可以进行数组间的转换。如果元素类型可以隐式转换，则可以进行隐式转换，否则必须进行显式转换。<br />
Tips: 值类型元素的数组不可以转换。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">ImgButton</span>[] <span style="color: #7590db;">imgBtnArr</span> = { <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ImgButton</span> (10, <span style="color: #2d9574;">"10"</span>), <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ImgButton</span> (11, <span style="color: #2d9574;">"11"</span>) };
PrintControl (imgBtnArr);
<span style="color: #ce537a; font-weight: bold;">Control</span>[] <span style="color: #7590db;">tmpCtrlArr</span> = imgBtnArr;
PrintControl (tmpCtrlArr);
<span style="color: #ce537a; font-weight: bold;">ImgButton</span>[] <span style="color: #7590db;">tmpImgBtnArr</span> = (<span style="color: #ce537a; font-weight: bold;">ImgButton</span>[])tmpCtrlArr;
PrintControl (tmpImgBtnArr);

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">PrintControl</span> (<span style="color: #ce537a; font-weight: bold;">Control</span>[] <span style="color: #7590db;">controlArr</span>)
{
    <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">Control</span> <span style="color: #7590db;">ctr</span> <span style="color: #4f97d7; font-weight: bold;">in</span> controlArr) {
        Console.WriteLine (<span style="color: #2d9574;">"controlId = {0}"</span>, ctr.Id);
    }
}


<span style="color: #ce537a; font-weight: bold;">float</span>[] <span style="color: #7590db;">floatArr</span> = { 1.0f, 1.1f, 1.2f };
<span style="color: #ce537a; font-weight: bold;">float</span>[] <span style="color: #7590db;">floatArr2</span> = {0.0f, 1.0f};
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#20195;&#30721;&#27491;&#30830;</span>
floatArr2 = floatArr;
PrintArray&lt;<span style="color: #ce537a; font-weight: bold;">float</span>&gt; (floatArr2);

<span style="color: #ce537a; font-weight: bold;">double</span>[] <span style="color: #7590db;">doubleArr</span> = { 2.0, 2.1, 2.2 };
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#20195;&#30721;&#32534;&#35793;&#20250;&#20986;&#38169;</span>
doubleArr = (<span style="color: #ce537a; font-weight: bold;">double</span>[])floatArr;
</pre>
</div>
</div>
</div>
<div id="outline-container-org4758598" class="outline-5">
<h5 id="org4758598">数组排序</h5>
<div class="outline-text-5" id="text-org4758598">
<p>
Array.Sort    可用来排序数组。<br />
Array.Reverse 可用来将数组元素顺序反转。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org2504b21" class="outline-4">
<h4 id="org2504b21">索引器</h4>
<div class="outline-text-4" id="text-org2504b21">
<p>
索引器是一种特殊的属性，可以通过 get set 方法来指定其行为。<br />
(返回)类型 this[(索引)类型 参数]{get;set}<br />
索引类型<br />
索引操作符在 C#中不能重载，所以提供了索引器。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ListBox</span>:<span style="color: #ce537a; font-weight: bold;">IEnumerable</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt;
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> ListBox (<span style="color: #4f97d7; font-weight: bold;">params</span> <span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">init_strs</span>)
      {
          strings = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">string</span>[256];
          <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">str</span> <span style="color: #4f97d7; font-weight: bold;">in</span> init_strs) {
              strings [count++] = str;
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">IEnumerator</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">GetEnumerator</span> ()
      {
          <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">s</span> <span style="color: #4f97d7; font-weight: bold;">in</span> strings) {
              <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">return</span> s;
          }
      }

      <span style="color: #ce537a; font-weight: bold;">IEnumerator</span> IEnumerable.<span style="color: #bc6ec5; font-weight: bold;">GetEnumerator</span> ()
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> GetEnumerator ();
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Add</span> (<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">item</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">if</span> (count &gt;= strings.Length) {
              <span style="color: #2aa1ae; background-color: #292e34;">//</span>
          } <span style="color: #4f97d7; font-weight: bold;">else</span> {
              strings [count++] = item;
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #4f97d7; font-weight: bold;">this</span> [<span style="color: #ce537a; font-weight: bold;">int</span> index] {
          <span style="color: #4f97d7; font-weight: bold;">get</span> {
              <span style="color: #4f97d7; font-weight: bold;">if</span> (index &gt;= count) {
                  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">""</span>;
              } <span style="color: #4f97d7; font-weight: bold;">else</span> {
                  <span style="color: #4f97d7; font-weight: bold;">return</span> strings [index];
              }
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span> {
              <span style="color: #4f97d7; font-weight: bold;">if</span> (index &gt;= strings.Length) {
                  <span style="color: #2aa1ae; background-color: #292e34;">//</span>
              } <span style="color: #4f97d7; font-weight: bold;">else</span> {
                  <span style="color: #4f97d7; font-weight: bold;">if</span> (index &gt;= count) {
                      count = index + 1;
                  }
                  strings [index] = <span style="color: #a45bad;">value</span>;
              }
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #4f97d7; font-weight: bold;">this</span> [<span style="color: #ce537a; font-weight: bold;">string</span> index] {
          <span style="color: #4f97d7; font-weight: bold;">get</span> {
              <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">idx</span> = findString (index);
              <span style="color: #4f97d7; font-weight: bold;">if</span> (idx != -1) {
                  <span style="color: #4f97d7; font-weight: bold;">return</span> strings [idx];
              } <span style="color: #4f97d7; font-weight: bold;">else</span> {
                  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">""</span>;
              }
          }
          <span style="color: #4f97d7; font-weight: bold;">set</span> {
              <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">idx</span> = findString (index);
              <span style="color: #4f97d7; font-weight: bold;">if</span> (idx != -1) {
                  strings [idx] = <span style="color: #a45bad;">value</span>;
              } <span style="color: #4f97d7; font-weight: bold;">else</span> {
                  <span style="color: #2aa1ae; background-color: #292e34;">//</span>
              }
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">findString</span> (<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">str</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">for</span> (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = 0; i &lt; count; i++) {
              <span style="color: #4f97d7; font-weight: bold;">if</span> (strings [i].StartsWith (str)) {
                  <span style="color: #4f97d7; font-weight: bold;">return</span> i;
              }
          }
          <span style="color: #4f97d7; font-weight: bold;">return</span> -1;
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">Count</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span> {
              <span style="color: #4f97d7; font-weight: bold;">return</span> count;
          }
          <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">private set;</span>
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">strings</span>;
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">count</span>;
  }

</pre>
</div>
</div>
</div>
<div id="outline-container-orgd578d76" class="outline-4">
<h4 id="orgd578d76">集合接口</h4>
<div class="outline-text-4" id="text-orgd578d76">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">接口</th>
<th scope="col" class="org-left">目的</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">ICollection&lt;T&gt;</td>
<td class="org-left">泛型集合的基接口</td>
</tr>

<tr>
<td class="org-left">IEnumerator&lt;T&gt; IEnumerable&lt;T&gt;</td>
<td class="org-left">用 foreach 语句枚举集合</td>
</tr>

<tr>
<td class="org-left">ICollection&lt;T&gt;</td>
<td class="org-left">所有集合都要实现，以提供 CopyTo()方法，以及 Count、IsSynchronized 和 SyncRoot 属性</td>
</tr>

<tr>
<td class="org-left">IComparer&lt;T&gt; IComparable&lt;T&gt;</td>
<td class="org-left">比较集合中的两个对象以对集合排序</td>
</tr>

<tr>
<td class="org-left">IList&lt;T&gt;</td>
<td class="org-left">用于数组可索引的集合</td>
</tr>

<tr>
<td class="org-left">IDictionary&lt;K,V&gt;</td>
<td class="org-left">用于基于键值对的集合，如 Dictionary</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-orgdb0886c" class="outline-5">
<h5 id="orgdb0886c">约束</h5>
<div class="outline-text-5" id="text-orgdb0886c">
<p>
通过关键字 where 指定约束。<br />
public class Node&lt;T&gt;:IComparable&lt;Node&lt;T&gt;&gt; where T : IComparable&lt;T&gt; <i>/ 指定约束 T 需要实现 IComparable&lt;T&gt;接口<br />
public class Node&lt;T&gt; where T : new() /</i> 指定 T 支持不带参数的构造函数<br />
public class Node&lt;T&gt; where T : class <i>/ 指定 T 可以被赋值为 null<br />
public class ComMgr&lt;ComType&gt; where ComType : Component /</i> 指定 ComType 为 Component 类型或 Component 的派生类<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;:<span style="color: #ce537a; font-weight: bold;">IComparable</span>&lt;<span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">where</span> T : <span style="color: #ce537a; font-weight: bold;">IComparable</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">T</span> <span style="color: #7590db;">data</span>;
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">prev</span>;
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">next</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> Node (<span style="color: #ce537a; font-weight: bold;">T</span> <span style="color: #7590db;">data</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.data = data;
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">T</span> <span style="color: #7590db;">Data</span>{ <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> data; } }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">Next</span> { <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> next; } }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">CompareTo</span> (<span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">rhs</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> data.CompareTo (rhs.Data);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #bc6ec5; font-weight: bold;">Equals</span> (<span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">rhs</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> data.Equals (rhs.Data);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">Add</span> (<span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">newNode</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.CompareTo (newNode) &gt; 0) {
              newNode.next = <span style="color: #4f97d7; font-weight: bold;">this</span>;
              <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.prev != <span style="color: #a45bad;">null</span>) {
                  <span style="color: #4f97d7; font-weight: bold;">this</span>.prev.next = newNode;
                  newNode.prev = <span style="color: #4f97d7; font-weight: bold;">this</span>.prev;
              }
              <span style="color: #4f97d7; font-weight: bold;">this</span>.prev = newNode;

              <span style="color: #4f97d7; font-weight: bold;">return</span> newNode;
          } <span style="color: #4f97d7; font-weight: bold;">else</span> {
              <span style="color: #4f97d7; font-weight: bold;">if</span> (<span style="color: #4f97d7; font-weight: bold;">this</span>.next != <span style="color: #a45bad;">null</span>) {
                  <span style="color: #4f97d7; font-weight: bold;">this</span>.next.Add (newNode);
              } <span style="color: #4f97d7; font-weight: bold;">else</span> {
                  <span style="color: #4f97d7; font-weight: bold;">this</span>.next = newNode;
                  newNode.prev = <span style="color: #4f97d7; font-weight: bold;">this</span>;
              }
              <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">this</span>;
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #bc6ec5; font-weight: bold;">ToString</span> ()
      {
          <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">output</span> = data.ToString ();
          <span style="color: #4f97d7; font-weight: bold;">if</span> (next != <span style="color: #a45bad;">null</span>) {
              output += <span style="color: #2d9574;">", "</span>    + next.ToString ();
          }
          <span style="color: #4f97d7; font-weight: bold;">return</span> output;
      }
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">LinkedList</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #4f97d7; font-weight: bold;">where</span> T : <span style="color: #ce537a; font-weight: bold;">IComparable</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">headNode</span> = <span style="color: #a45bad;">null</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">T</span> <span style="color: #4f97d7; font-weight: bold;">this</span> [<span style="color: #ce537a; font-weight: bold;">int</span> index] {
          <span style="color: #4f97d7; font-weight: bold;">get</span> {
              <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">count</span> = 0;
              <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">node</span> = headNode;
              <span style="color: #4f97d7; font-weight: bold;">while</span> (node != <span style="color: #a45bad;">null</span> &amp;&amp; count &lt;= index) {
                  <span style="color: #4f97d7; font-weight: bold;">if</span> (count == index) {
                      <span style="color: #4f97d7; font-weight: bold;">return</span> node.Data;
                  } <span style="color: #4f97d7; font-weight: bold;">else</span> {
                      count++;
                      node = node.Next;
                  }
              }
              <span style="color: #4f97d7; font-weight: bold;">throw</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ArgumentOutOfRangeException</span> ();
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Add</span> (<span style="color: #ce537a; font-weight: bold;">T</span> <span style="color: #7590db;">data</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">if</span> (headNode == <span style="color: #a45bad;">null</span>) {
              headNode = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; (data);
          } <span style="color: #4f97d7; font-weight: bold;">else</span> {
              headNode.Add (<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Node</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; (<span style="color: #ce537a; font-weight: bold;">data</span>));
          }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #bc6ec5; font-weight: bold;">ToString</span> ()
      {
          <span style="color: #4f97d7; font-weight: bold;">if</span> (headNode == <span style="color: #a45bad;">null</span>) {
              <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #ce537a; font-weight: bold;">string</span>.Empty;
          } <span style="color: #4f97d7; font-weight: bold;">else</span> {
              <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">this</span>.headNode.ToString ();
          }
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orga9e32f4" class="outline-5">
<h5 id="orga9e32f4">实现 IComparer IComparable</h5>
<div class="outline-text-5" id="text-orga9e32f4">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">IComparable    &#23450;&#20041;&#30340;&#25509;&#21475;&#26041;&#27861; int CompareTo(object obj)</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">IComparable&lt;T&gt; &#23450;&#20041;&#30340;&#25509;&#21475;&#26041;&#27861; int CompareTo(T other);</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Employee</span>:<span style="color: #ce537a; font-weight: bold;">IComparable</span>&lt;<span style="color: #ce537a; font-weight: bold;">Employee</span>&gt;
  {
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">empID</span>;
      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">yearsOfSvr</span> = 1;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">EmpID</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>{ <span style="color: #4f97d7; font-weight: bold;">return</span> empID; }
          <span style="color: #4f97d7; font-weight: bold;">set</span>{ empID = <span style="color: #a45bad;">value</span>; }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">YearsOfSvr</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>{ <span style="color: #4f97d7; font-weight: bold;">return</span> yearsOfSvr; }
          <span style="color: #4f97d7; font-weight: bold;">set</span>{ yearsOfSvr = <span style="color: #a45bad;">value</span>; }
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> Employee (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">empID</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.empID = empID;
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> Employee (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">empID</span>, <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">yearsOfSvr</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.empID = empID;
          <span style="color: #4f97d7; font-weight: bold;">this</span>.yearsOfSvr = yearsOfSvr;
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">EmployeeComparer</span> <span style="color: #bc6ec5; font-weight: bold;">GetComparer</span> ()
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">EmployeeComparer</span> ();
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">CompareTo</span> (<span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">rhs</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">this</span>.empID.CompareTo (rhs.EmpID);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">CompareTo</span> (<span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">rhs</span>, EmployeeComparer.<span style="color: #ce537a; font-weight: bold;">ComparerType</span> <span style="color: #7590db;">cmpType</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">switch</span> (cmpType) {
              <span style="color: #4f97d7; font-weight: bold;">case</span> EmployeeComparer.ComparerType.EmpID:
                  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">this</span>.empID.CompareTo (rhs.EmpID);
              <span style="color: #4f97d7; font-weight: bold;">case</span> EmployeeComparer.ComparerType.YearOfSvr:
                  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">this</span>.yearsOfSvr.CompareTo (rhs.yearsOfSvr);
          }
          <span style="color: #4f97d7; font-weight: bold;">return</span> 0;
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #bc6ec5; font-weight: bold;">ToString</span> ()
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"EmpID={0}, SvrYears={1}"</span>, empID, yearsOfSvr);
      }

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">EmployeeComparer</span>:<span style="color: #ce537a; font-weight: bold;">IComparer</span>&lt;<span style="color: #ce537a; font-weight: bold;">Employee</span>&gt;
      {
          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">enum</span> <span style="color: #ce537a; font-weight: bold;">ComparerType</span>
          {
              <span style="color: #7590db;">EmpID</span>,
              <span style="color: #7590db;">YearOfSvr</span>
          }

          <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">ComparerType</span> <span style="color: #7590db;">compType</span>;

          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">ComparerType</span> <span style="color: #7590db;">CompType</span> {
              <span style="color: #4f97d7; font-weight: bold;">get</span>{ <span style="color: #4f97d7; font-weight: bold;">return</span> compType; }
              <span style="color: #4f97d7; font-weight: bold;">set</span>{ compType = <span style="color: #a45bad;">value</span>; }
          }

          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #bc6ec5; font-weight: bold;">Equals</span> (<span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">lhs</span>, <span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">rhs</span>)
          {
              <span style="color: #4f97d7; font-weight: bold;">return</span> lhs.CompareTo (rhs) == 0;
          }

          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">GetHashCode</span> (<span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">e</span>)
          {
              <span style="color: #4f97d7; font-weight: bold;">return</span> e.GetHashCode ();
          }

          <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">Compare</span> (<span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">lhs</span>, <span style="color: #ce537a; font-weight: bold;">Employee</span> <span style="color: #7590db;">rhs</span>)
          {
              <span style="color: #4f97d7; font-weight: bold;">return</span> lhs.CompareTo (rhs, compType);
          }
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org3d46d0b" class="outline-5">
<h5 id="org3d46d0b">实现 IEnumerable&lt;T&gt;</h5>
<div class="outline-text-5" id="text-org3d46d0b">
<p>
由于 IEnumerable&lt;T&gt;扩展（继承）了旧的 IEnumerable 接口，所以实现 IEnumerable&lt;T&gt;时，要实现两个不同的方法：<br />
IEnumerator&lt;T&gt; GetEnumerator();<br />
IEnumerator GetEnumerator();      // 由于和泛型版本的方法同名，所以该方法的实现需要使用显式接口实现<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">IEnumerator    &#23450;&#20041;&#30340;&#25509;&#21475;&#26041;&#27861;&#20026; IEnumerator GetEnumerator()</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">IEnumerator&lt;T&gt; &#23450;&#20041;&#30340;&#25509;&#21475;&#26041;&#27861;&#20026; IEnumerator&lt;T&gt; GetEnumerator();</span>

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">IEnumerator</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #bc6ec5; font-weight: bold;">GetEnumerator</span> ()
{
    <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">isUseType1</span> = <span style="color: #a45bad;">false</span>;
    <span style="color: #4f97d7; font-weight: bold;">if</span> (isUseType1) {
        <span style="color: #4f97d7; font-weight: bold;">for</span> (<span style="color: #ce537a; font-weight: bold;">GListNode</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">iter</span> = first; iter != <span style="color: #a45bad;">null</span>; iter = iter.Next) {
            <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">return</span> iter.Value;
        }
    } 
    <span style="color: #4f97d7; font-weight: bold;">else</span> {
        <span style="color: #ce537a; font-weight: bold;">GListNode</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt; <span style="color: #7590db;">iter</span> = first;
        <span style="color: #4f97d7; font-weight: bold;">while</span> (iter != <span style="color: #a45bad;">null</span>) {
            <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">return</span> iter.Value;
            iter = iter.Next;
        }
    }
}
System.Collections.<span style="color: #ce537a; font-weight: bold;">IEnumerator</span> System.Collections.IEnumerable.<span style="color: #bc6ec5; font-weight: bold;">GetEnumerator</span> ()
{  
    <span style="color: #4f97d7; font-weight: bold;">return</span> GetEnumerator ();  
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org4c0802c" class="outline-3">
<h3 id="org4c0802c">字符串与正则表达式</h3>
<div class="outline-text-3" id="text-org4c0802c">
</div>
<div id="outline-container-org00912ae" class="outline-4">
<h4 id="org00912ae">string</h4>
<div class="outline-text-4" id="text-org00912ae">
<p>
C#中 string 是一种正常的类型，而不是字符数组。string 为引用类型。<br />
string 类的声明为：<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">sealed</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">String</span>:<span style="color: #ce537a; font-weight: bold;">IComparable</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;,<span style="color: #ce537a; font-weight: bold;">ICloneable</span>,<span style="color: #ce537a; font-weight: bold;">IConvertible</span>,<span style="color: #ce537a; font-weight: bold;">IEnumerable</span>&lt;<span style="color: #ce537a; font-weight: bold;">T</span>&gt;
</pre>
</div>
<p>
每个 string 对象都是一个不变的 unicode 字符序列。默认情况下每个字符都采用 UTF16 编码，string 不变这一事实意味着看似要改变字符串的方法实际上返回的是一个修改后的副本，原字符串在内存中是不变的，直至被垃圾回收。这可能会带来性能问题，所以如果需要频繁修改字符串，应该使用 StringBuilder。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ChangeStr</span> (<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">str</span>)
{
    str = <span style="color: #2d9574;">"after changed\n"</span>;
}
<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">str</span> = <span style="color: #2d9574;">"before changed\n"</span>;
<span style="color: #bc6ec5; font-weight: bold;">ChangeStr</span>(str);
Console.WriteLine (str); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;: before changed</span>

<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#20462;&#25913; string</span>
<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">line</span> = <span style="color: #2d9574;">"My name is God!"</span>;
<span style="color: #ce537a; font-weight: bold;">char</span>[] <span style="color: #7590db;">lineCharArr</span> = line.ToCharArray ();
lineCharArr [0] = <span style="color: #2d9574;">'m'</span>;
line = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">string</span> (lineCharArr);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">@ &#31526;&#21495;&#20250;&#21578;&#30693;&#23383;&#31526;&#20018;&#26500;&#36896;&#20989;&#25968;&#24573;&#30053;&#36716;&#20041;&#31526;&#21644;&#20998;&#34892;&#31526;&#12290;&#22240;&#27492;&#65292;&#20197;&#19979;&#20004;&#20010;&#23383;&#31526;&#20018;&#26159;&#23436;&#20840;&#30456;&#21516;&#30340;&#65306;</span>
<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">p1</span> = <span style="color: #2d9574;">"\\\\My Documents\\My Files\\"</span>;
<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">p2</span> = @<span style="color: #2d9574;">"\\My Documents\My Files\";</span>

<span style="color: #2d9574;">// string.Format</span>
<span style="color: #2d9574;">Debug.Log(string.Format("</span>{0:D2}<span style="color: #dc752f; background-color: #292b2e;">"</span><span style="color: #2d9574;">, 1));                 // 01</span>
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"{0}"</span>, 0.123));                <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">0.123</span>
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"{0:00.00}"</span>, 111.123));        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">111.12</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9e7e255" class="outline-4">
<h4 id="org9e7e255">StringBuilder</h4>
<div class="outline-text-4" id="text-org9e7e255">
<p>
System.Text.StringBuilder 的作用是用来创建和修改字符串的。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">StringBuilder</span> <span style="color: #7590db;">mutableStr</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">StringBuilder</span> (<span style="color: #2d9574;">"My name is God!"</span>);
mutableStr [0] = <span style="color: #2d9574;">'m'</span>;
mutableStr.<span style="color: #bc6ec5; font-weight: bold;">Append</span>(<span style="color: #2d9574;">"This is a sentence."</span>);
Console.WriteLine (mutableStr);
</pre>
</div>
</div>
</div>
<div id="outline-container-org8f2473e" class="outline-4">
<h4 id="org8f2473e"><span class="todo TODO">TODO</span> 正则表达式</h4>
<div class="outline-text-4" id="text-org8f2473e">
<p>
名字空间 System.Text.RegularExpressions 是所以与正则表达式相关的.NET 框架对象的大本营。<br />
</p>
</div>
<div id="outline-container-org57cfe55" class="outline-5">
<h5 id="org57cfe55">正则表达式匹配 ftp list directory detial</h5>
<div class="outline-text-5" id="text-org57cfe55">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">drwxr-xr-x  3 user00  staff  102 Aug  9 12:00 testdir</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">-rw-r--r--  1 user00 staff   42 Aug  9 12:00 test.txt</span>
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">ftpDirOrFileInfoUnixRegex</span> =
      @<span style="color: #2d9574;">"^"</span> +
      @<span style="color: #2d9574;">"(?&lt;dir&gt;[\-ld])"</span> +
      @<span style="color: #2d9574;">"(?&lt;permission&gt;[\-rwx]{9})"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;filecode&gt;\d+)"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;owner&gt;\w+)"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;group&gt;\w+)"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;size&gt;\d+)"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;month&gt;\w{3})"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;day&gt;\d{1,2})"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;timeyear&gt;[\d:]{4,5})"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;name&gt;(.*))$"</span>;

  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">07-25-17 03:49PM &lt;DIR&gt; HDX</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">02-08-17  01:24AM 31605 index.html</span>
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">ftpDirOrFileInfoWinRegex</span> =
      @<span style="color: #2d9574;">"^"</span> +
      @<span style="color: #2d9574;">"(?&lt;month&gt;\d{1,2})-(?&lt;day&gt;\d{1,2})-(?&lt;year&gt;\d{1,2})"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;hour&gt;\d{1,2}):(?&lt;minutes&gt;\d{1,2})(?&lt;ampm&gt;am|pm)"</span> +
      @<span style="color: #2d9574;">"\s+"</span> +
      @<span style="color: #2d9574;">"(?&lt;dir&gt;[&lt;]dir[&gt;]\s+)?"</span> +
      @<span style="color: #2d9574;">"(?&lt;size&gt;\d+\s+)?"</span> +
      @<span style="color: #2d9574;">"(?&lt;name&gt;.*)$"</span>;

  <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">split</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Regex</span>(ftpDirOrFileInfoWinRegex, RegexOptions.IgnoreCase).<span style="color: #bc6ec5; font-weight: bold;">Match</span>(line);
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">dir</span> = split.Groups[<span style="color: #2d9574;">"dir"</span>].<span style="color: #bc6ec5; font-weight: bold;">ToString</span>().<span style="color: #bc6ec5; font-weight: bold;">Trim</span>();
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">filename</span> = split.Groups[<span style="color: #2d9574;">"name"</span>].<span style="color: #bc6ec5; font-weight: bold;">ToString</span>();
  Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"dir = "</span>+ dir + <span style="color: #2d9574;">" filename = "</span> + filename);
</pre>
</div>
</div>
</div>
<div id="outline-container-org5441b65" class="outline-5">
<h5 id="org5441b65">参考资料</h5>
<div class="outline-text-5" id="text-org5441b65">
<ol class="org-ol">
<li>C#正则表达式语言 <a href="https://msdn.microsoft.com/zh-cn/library/az24scfc(v=vs.110).aspx">https://msdn.microsoft.com/zh-cn/library/az24scfc(v=vs.110).aspx</a><br /></li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd561384" class="outline-3">
<h3 id="orgd561384"><span class="todo TODO">TODO</span> 异常处理</h3>
</div>
<div id="outline-container-orgfd1133b" class="outline-3">
<h3 id="orgfd1133b">委托和事件</h3>
<div class="outline-text-3" id="text-orgfd1133b">
</div>
<div id="outline-container-org7004566" class="outline-4">
<h4 id="org7004566">委托</h4>
<div class="outline-text-4" id="text-org7004566">
<p>
委托是一种引用类型，用来封装带有特定签名和返回类型的方法。委托可用来封装静态成员方法、实例方法、匿名方法等。<br />
</p>
</div>
<div id="outline-container-orge0631a1" class="outline-5">
<h5 id="orge0631a1">Action</h5>
<div class="outline-text-5" id="text-orge0631a1">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">namespace</span> <span style="color: #7590db;">System</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">delegate</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Action</span>&lt;<span style="color: #4f97d7; font-weight: bold;">in</span> T&gt;(<span style="color: #ce537a; font-weight: bold;">T</span> <span style="color: #7590db;">obj</span>);
}
</pre>
</div>
<ul class="org-ul">
<li><a href="https://learn.microsoft.com/zh-cn/dotnet/api/system.action-1?view=net-6.0">https://learn.microsoft.com/zh-cn/dotnet/api/system.action-1?view=net-6.0</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org1d89f53" class="outline-5">
<h5 id="org1d89f53">Func</h5>
<div class="outline-text-5" id="text-org1d89f53">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">namespace</span> <span style="color: #7590db;">System</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">delegate</span> <span style="color: #ce537a; font-weight: bold;">TResult</span> <span style="color: #bc6ec5; font-weight: bold;">Func</span>&lt;<span style="color: #4f97d7; font-weight: bold;">out</span> <span style="color: #ce537a; font-weight: bold;">TResult</span>&gt;();
}
</pre>
</div>

<ul class="org-ul">
<li><a href="https://learn.microsoft.com/zh-cn/dotnet/api/system.func-1?view=net-6.0">https://learn.microsoft.com/zh-cn/dotnet/api/system.func-1?view=net-6.0</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8502bae" class="outline-4">
<h4 id="org8502bae">多重委托</h4>
<div class="outline-text-4" id="text-org8502bae">
<p>
委托可以通过+、+=形成多重委托，委托也可以通过-、-=移除多重委托中的委托.<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  MultiDelegate.MyClassWithDelegate.<span style="color: #ce537a; font-weight: bold;">StringDelegate</span> <span style="color: #7590db;">writer</span>, <span style="color: #7590db;">logger</span>, <span style="color: #7590db;">transmiter</span>;
  writer = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MultiDelegate</span>.MyClassWithDelegate.StringDelegate (MultiDelegate.MyImplClass.WriteStr);
  logger = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MultiDelegate</span>.MyClassWithDelegate.StringDelegate (MultiDelegate.MyImplClass.LogStr);
  transmiter = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">MultiDelegate</span>.MyClassWithDelegate.StringDelegate (MultiDelegate.MyImplClass.TransmitStr);

  writer (<span style="color: #2d9574;">"str pass to writer"</span>);
  logger (<span style="color: #2d9574;">"str pass to logger"</span>);

  MultiDelegate.MyClassWithDelegate.<span style="color: #ce537a; font-weight: bold;">StringDelegate</span> <span style="color: #7590db;">multiDelegate</span> = writer + transmiter;
  multiDelegate (<span style="color: #2d9574;">"str pass to writer+transmiter"</span>);
  multiDelegate += logger; 
  multiDelegate (<span style="color: #2d9574;">"str pass to writer+transmiter+loger"</span>);
  multiDelegate -= transmiter; 
  multiDelegate (<span style="color: #2d9574;">"str pass to writer+transmiter+loger-transmiter"</span>);
  multiDelegate += logger; 
  multiDelegate (<span style="color: #2d9574;">"str pass to writer+loger+loger"</span>);
  <span style="color: #9f8766;">///////////////////////////////////</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#20026;&#36755;&#20986;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Write String     -- str pass to writer</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Log String       -- str pass to logger</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Write String     -- str pass to writer+transmiter</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Transimit String -- str pass to writer+transmiter</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Write String     -- str pass to writer+transmiter+loger</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Transimit String -- str pass to writer+transmiter+loger</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Log String       -- str pass to writer+transmiter+loger</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Write String     -- str pass to writer+transmiter+loger-transmiter</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Log String       -- str pass to writer+transmiter+loger-transmiter</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Write String     -- str pass to writer+loger+loger</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Log String       -- str pass to writer+loger+loger</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Log String       -- str pass to writer+loger+loger</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org88cdd2b" class="outline-4">
<h4 id="org88cdd2b">事件</h4>
<div class="outline-text-4" id="text-org88cdd2b">
<p>
可以通过多重委托来实现事件。<br />
event 关键字能够告诉编译器委托只能由定义类调用，其他类只能分别使用相应的+=和-=操作符订阅和退订委托。<br />
</p>
</div>
</div>
<div id="outline-container-orgdccfff1" class="outline-4">
<h4 id="orgdccfff1">事件和接口</h4>
<div class="outline-text-4" id="text-orgdccfff1">
<p>
事件可以放在接口中，表示需要实现对应委托的 add,remove 方法。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IDrawingObject</span>
  {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Raise this event before drawing</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">the object.</span>
      <span style="color: #4f97d7; font-weight: bold;">event</span> <span style="color: #ce537a; font-weight: bold;">EventHandler</span> <span style="color: #7590db;">OnDraw</span>;
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">interface</span> <span style="color: #ce537a; font-weight: bold;">IShape</span>
  {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Raise this event after drawing</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">the shape.</span>
      <span style="color: #4f97d7; font-weight: bold;">event</span> <span style="color: #ce537a; font-weight: bold;">EventHandler</span> <span style="color: #7590db;">OnDraw</span>;
  }


  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Base class event publisher inherits two</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">interfaces, each with an OnDraw event</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Shape</span> : <span style="color: #ce537a; font-weight: bold;">IDrawingObject</span>, <span style="color: #ce537a; font-weight: bold;">IShape</span>
  {
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Create an event for each interface event</span>
      <span style="color: #4f97d7; font-weight: bold;">event</span> <span style="color: #ce537a; font-weight: bold;">EventHandler</span> <span style="color: #7590db;">PreDrawEvent</span>;
      <span style="color: #4f97d7; font-weight: bold;">event</span> <span style="color: #ce537a; font-weight: bold;">EventHandler</span> <span style="color: #7590db;">PostDrawEvent</span>;

      <span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">objectLock</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Object</span> ();

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Explicit interface implementation required.</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Associate IDrawingObject's event with</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">PreDrawEvent</span>
      <span style="color: #4f97d7; font-weight: bold;">event</span> <span style="color: #ce537a; font-weight: bold;">EventHandler</span> IDrawingObject.<span style="color: #7590db;">OnDraw</span> {
          add {
              <span style="color: #4f97d7; font-weight: bold;">lock</span> (objectLock) {
                  PreDrawEvent += <span style="color: #a45bad;">value</span>;
              }
          }
          remove {
              <span style="color: #4f97d7; font-weight: bold;">lock</span> (objectLock) {
                  PreDrawEvent -= <span style="color: #a45bad;">value</span>;
              }
          }
      }
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Explicit interface implementation required.</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Associate IShape's event with</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">PostDrawEvent</span>
      <span style="color: #4f97d7; font-weight: bold;">event</span> <span style="color: #ce537a; font-weight: bold;">EventHandler</span> IShape.<span style="color: #7590db;">OnDraw</span> {
          add {
              <span style="color: #4f97d7; font-weight: bold;">lock</span> (objectLock) {
                  PostDrawEvent += <span style="color: #a45bad;">value</span>;
              }
          }
          remove {
              <span style="color: #4f97d7; font-weight: bold;">lock</span> (objectLock) {
                  PostDrawEvent -= <span style="color: #a45bad;">value</span>;
              }
          }


      }

      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">For the sake of simplicity this one method</span>
      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">implements both interfaces.</span>
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Draw</span> ()
      {
          <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Raise IDrawingObject's event before the object is drawn.</span>
          <span style="color: #ce537a; font-weight: bold;">EventHandler</span> <span style="color: #7590db;">handler</span> = PreDrawEvent;
          <span style="color: #4f97d7; font-weight: bold;">if</span> (handler != <span style="color: #a45bad;">null</span>) {
              handler (<span style="color: #4f97d7; font-weight: bold;">this</span>, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">EventArgs</span> ());
          }
          Console.WriteLine (<span style="color: #2d9574;">"Drawing a shape."</span>);

          <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">RaiseIShape's event after the object is drawn.</span>
          handler = PostDrawEvent;
          <span style="color: #4f97d7; font-weight: bold;">if</span> (handler != <span style="color: #a45bad;">null</span>) {
              handler (<span style="color: #4f97d7; font-weight: bold;">this</span>, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">EventArgs</span> ());
          }
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbcccca8" class="outline-4">
<h4 id="orgbcccca8">异步调用委托</h4>
<div class="outline-text-4" id="text-orgbcccca8">
<div class="org-src-container">
<pre class="src src-csharp">  subDelegate.BeginInvoke (<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">AsyncCallback</span> (<span style="color: #ce537a; font-weight: bold;">ResultsReturned</span>), <span style="color: #ce537a; font-weight: bold;">subDelegate</span>);
  <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ResultsReturned</span> (<span style="color: #ce537a; font-weight: bold;">IAsyncResult</span> <span style="color: #7590db;">iar</span>)
  {
      <span style="color: #ce537a; font-weight: bold;">DelegateReturnInt</span> <span style="color: #7590db;">subDelegate</span> = (<span style="color: #ce537a; font-weight: bold;">DelegateReturnInt</span>)iar.AsyncState;
      <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">result</span> = subDelegate.EndInvoke (iar);
      Console.WriteLine (<span style="color: #2d9574;">"result = {0}"</span>, result);
  }
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org6008258" class="outline-2">
<h2 id="org6008258">The CLR and .NET framework</h2>
<div class="outline-text-2" id="text-org6008258">
</div>
<div id="outline-container-org4e108c6" class="outline-3">
<h3 id="org4e108c6">程序集和版本控制</h3>
<div class="outline-text-3" id="text-org4e108c6">
<ol class="org-ol">
<li>程序集是一种 Portable Executable 可移植可执行文件。物理上，程序集可以包括一个或多个模块。一个程序集的全部内容会被作为一个部署和重用的单元。一个程序集只会在被调用的时候才会被导入，不被需要时就暂时不会被导入。<br /></li>
<li>元数据是一种二进制信息，它被存储在程序集中，用来对程序集中的类型和方法进行描述，并提供其他的一些关于程序集的有用信息。<br /></li>
<li>程序集形成安全边界及类型边界。即一个程序集构成了它其中类型定义的作用域范围，类型定义的作用域不能跨越多个程序集。每一类型的标识均包括该类型所驻留的程序集的名称。<br /></li>
<li>作为元数据的一部分，每个程序集都有一个清单。它描述着程序集的内容：程序集的标识信息（名称、版本号等），程序集包含的类型和资源列表，程序集包含的模块的列表，描述如何在引用公共类型时映射到包含其声明和实现的代码的信息，以及程序集所依赖的其他程序集的列表。清单就像描述着程序集内容的一份自述地图。<br /></li>
</ol>
</div>
<div id="outline-container-org84784a1" class="outline-4">
<h4 id="org84784a1">多模块程序集</h4>
<div class="outline-text-4" id="text-org84784a1">
<ol class="org-ol">
<li>一个包含单一模块的程序集只有一个文件，或者是 EXE 或者是 DLL 文件。这个单一模块包含着程序的所有类型说明和实现代码。程序集的清单也内嵌在这个模块中。<br /></li>
<li>一个多模块程序集可能包含多个文件（零个或一个 EXE 文件及零个或多个 DLL 文件，至少一个 EXE 或 DLL 文件）。程序集清单这时可以作为单独的一个文件出现，也可以嵌在某一个模块中。当多模块程序集被引用的时候，运行环境将会先导入包含程序集清单的文件，然后根据清单导入需要的模块。<br /></li>
<li>每个模块都有自己的清单，该清单独立于程序集的清单。模块的清单列着这个模块自身对其他程序集的引用。并且任何在这个模块中声明的类型，都会被列在这个和现实代码一道存放的清单中。一个模块还可能包含资源，如一些该模块需要的图片。<br /></li>
</ol>
</div>
</div>
<div id="outline-container-orgb7c625d" class="outline-4">
<h4 id="orgb7c625d">共享程序集</h4>
<div class="outline-text-4" id="text-orgb7c625d">
<p>
共享程序集必须满足一些严格的要求：<br />
</p>
<ol class="org-ol">
<li>程序集必须有一个强名称。强名称是全局唯一的。任何人都不会生成和你相同的程序集名称，这是由于用一个私钥生成的程序集的名称和用其他私钥生成的程序集名称不相同。<br /></li>
<li>共享程序集必须防止比它更新的版本被错误地当做这个程序集被引用，因此共享程序集的每个新版本在发布的时候都要带一个新的版本号。<br /></li>
<li>为了共享该程序集，需要将它放入全局程序集缓存(Global Assembly Cache)中。这是通用语言运行时在文件系统中指定的一块区域，专门用来保存共享程序集。<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org8301b3f" class="outline-4">
<h4 id="org8301b3f">最终解决 DLL 冲突 - 版本控制</h4>
<div class="outline-text-4" id="text-org8301b3f">
<p>
在.NET 编程环境中的共享程序集可以由名称和版本号唯一地标识。GAC 允许同一程序集的不同版本“并行执行”，即同一程序集的较老版本和较新版本在 GAC 中可以同时存在。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgac568d5" class="outline-3">
<h3 id="orgac568d5">性质</h3>
<div class="outline-text-3" id="text-orgac568d5">
<p>
性质是一种生成元数据的机制。性质是一个对象，它代表着与你的程序中的一个元素相关的数据。而这个有性质的元素被称为性质的目标元素。<br />
</p>
<div class="org-src-container">
<pre class="src src-c#">// 下面是一个类或者一个接口的性质，表示目标类在被导出给 COM 时应该继承自 IUnknown 类而不是 IDispatch 类。(类或接口为目标元素)
[NoIDispatch]

// 下面的性质将元数据插入到程序集中，指定该程序的强名称.(程序集为目标元素)
[assembly: AssemblyKeyFile("c:\\myStrongName.key")]
</pre>
</div>
</div>
<div id="outline-container-orga496237" class="outline-4">
<h4 id="orga496237">性质目标</h4>
<div class="outline-text-4" id="text-orga496237">
<p>
性质的目标可以是程序集、类、接口、类成员等等。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">名称</th>
<th scope="col" class="org-left">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">All</td>
<td class="org-left">适用于以下任意中元素：程序集、类、构造函数、委托、枚举、事件、域、接口、方法、模块、参数、特性、返回值或者结构</td>
</tr>

<tr>
<td class="org-left">Assembly</td>
<td class="org-left">适用于程序集自身</td>
</tr>

<tr>
<td class="org-left">Class</td>
<td class="org-left">适用于类</td>
</tr>

<tr>
<td class="org-left">Constructor</td>
<td class="org-left">适用于给定的构造函数</td>
</tr>

<tr>
<td class="org-left">Delegate</td>
<td class="org-left">适用于委托</td>
</tr>

<tr>
<td class="org-left">Enum</td>
<td class="org-left">适用于枚举类型</td>
</tr>

<tr>
<td class="org-left">Event</td>
<td class="org-left">适用于事件</td>
</tr>

<tr>
<td class="org-left">Field</td>
<td class="org-left">适用于域</td>
</tr>

<tr>
<td class="org-left">Interface</td>
<td class="org-left">适用于接口</td>
</tr>

<tr>
<td class="org-left">Method</td>
<td class="org-left">适用于方法</td>
</tr>

<tr>
<td class="org-left">Module</td>
<td class="org-left">适用于单个模块</td>
</tr>

<tr>
<td class="org-left">Parameter</td>
<td class="org-left">适用于方法的参数</td>
</tr>

<tr>
<td class="org-left">Property</td>
<td class="org-left">适用于属性</td>
</tr>

<tr>
<td class="org-left">ReturnValue</td>
<td class="org-left">适用于返回值</td>
</tr>

<tr>
<td class="org-left">Struct</td>
<td class="org-left">适用于结构</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org2b59832" class="outline-4">
<h4 id="org2b59832">性质的使用</h4>
<div class="outline-text-4" id="text-org2b59832">
<p>
性质的使用是通过把它们放在方括号里并且紧放在它们的目标元素之前。（目标是程序集的情况除外，在这种情况下需要把它们放在文件的最头部。）<br />
Tips: 必须把程序集属性放在所有 using 语句之后并且在其他任意代码之前。<br />
</p>
</div>
</div>
<div id="outline-container-org869039a" class="outline-4">
<h4 id="org869039a">自定义性质</h4>
<div class="outline-text-4" id="text-org869039a">
<p>
通过继承 System.Attribute 来实现自定义性质。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  [AttributeUsage (AttributeTargets.Class |
                   AttributeTargets.Constructor |
                   AttributeTargets.Delegate |
                   AttributeTargets.Field |
                   AttributeTargets.Method |
                   AttributeTargets.Property,
                   AllowMultiple = <span style="color: #a45bad;">true</span>)]
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> BugFixAttribute : System.<span style="color: #ce537a; font-weight: bold;">Attribute</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> BugFixAttribute (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">bugID</span>, <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">programmer</span>, <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">date</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">this</span>.bugID = bugID;
          <span style="color: #4f97d7; font-weight: bold;">this</span>.programmer = programmer;
          <span style="color: #4f97d7; font-weight: bold;">this</span>.date = date;
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">comment</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">Comment</span> {
          <span style="color: #4f97d7; font-weight: bold;">get</span>{ <span style="color: #4f97d7; font-weight: bold;">return</span> comment; }
          <span style="color: #4f97d7; font-weight: bold;">set</span>{ comment = <span style="color: #a45bad;">value</span>; }
      }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">bugID</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">BugID</span>{ <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> bugID; } }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">programmer</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">Programmer</span>{ <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> programmer; } }

      <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">date</span>;

      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">Date</span>{ <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> date; } }
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#26159;&#20351;&#29992;&#33258;&#23450;&#20041;&#24615;&#36136;&#30340;&#24773;&#20917;</span>
  [BugFix (101, <span style="color: #2d9574;">"GuoDong"</span>, <span style="color: #2d9574;">"2016-07-09"</span>)]
  [BugFix (102, <span style="color: #2d9574;">"GuoDong"</span>, <span style="color: #2d9574;">"2016-07-10"</span>, Comment = <span style="color: #2d9574;">"comment 1"</span>)]
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> MyMath
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #bc6ec5; font-weight: bold;">DoFunc1</span> (<span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">param</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> param + <span style="color: #4f97d7; font-weight: bold;">this</span>.DoFunc2 (param);
      }

      [BugFix (103, <span style="color: #2d9574;">"GuoDong"</span>, <span style="color: #2d9574;">"2016-07-11"</span>, Comment = <span style="color: #2d9574;">"comment x"</span>)]
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">double</span> DoFunc2 (<span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">param</span>)
      {
          <span style="color: #4f97d7; font-weight: bold;">return</span> param / 3;
      }
  }
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org91f389a" class="outline-3">
<h3 id="org91f389a">反射</h3>
<div class="outline-text-3" id="text-org91f389a">
<p>
反射是指一个程序读取其自身的或其他程序的元数据的过程。一个程序被称为在反射它自身或另一个程序，是指该程序提取被反射程序集的元数据用来提交给用户或改变自身程序行为的过程。<br />
在 Reflection 命名空间的类，以及 System.Type 中的类，提供了对元数据进行检查和交互的支持。<br />
反射一般用于以下四种任务：<br />
</p>
</div>
<div id="outline-container-org0cd8f57" class="outline-4">
<h4 id="org0cd8f57">查看元数据</h4>
<div class="outline-text-4" id="text-org0cd8f57">
<p>
工具或使用程序可以使用它来显示元数据。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">System.Reflection.<span style="color: #ce537a; font-weight: bold;">MemberInfo</span> <span style="color: #7590db;">info</span> = <span style="color: #4f97d7; font-weight: bold;">typeof</span>(MyMath);
<span style="color: #ce537a; font-weight: bold;">object</span>[] <span style="color: #7590db;">attri_arr</span> = info.GetCustomAttributes (<span style="color: #4f97d7; font-weight: bold;">typeof</span>(BugFixAttribute), <span style="color: #a45bad;">false</span>);
<span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">attri</span> <span style="color: #4f97d7; font-weight: bold;">in</span> attri_arr) {
    <span style="color: #ce537a; font-weight: bold;">BugFixAttribute</span> <span style="color: #7590db;">pAttri</span> = (<span style="color: #ce537a; font-weight: bold;">BugFixAttribute</span>)attri;
    Console.WriteLine (<span style="color: #2d9574;">"\nBugID:      {0}"</span>, pAttri.BugID);
    Console.WriteLine (<span style="color: #2d9574;">"Programmer: {0}"</span>, pAttri.Programmer);
    Console.WriteLine (<span style="color: #2d9574;">"Date:       {0}"</span>, pAttri.Date);
    Console.WriteLine (<span style="color: #2d9574;">"Comment:    {0}"</span>, pAttri.Comment);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org89fbd60" class="outline-4">
<h4 id="org89fbd60">进行类型发现</h4>
<div class="outline-text-4" id="text-org89fbd60">
<p>
这允许你检查程序集中的类型，以及跟这些类型交互或对类型进行实例化。这在创建自定义脚本的时候有用，例如你可能希望允许你的用户使用脚本语言和你的程序<br />
交互。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">Assembly</span> <span style="color: #7590db;">a</span> = Assembly.Load (<span style="color: #2d9574;">"mscorlib"</span>);
  <span style="color: #ce537a; font-weight: bold;">Type</span>[] <span style="color: #7590db;">types</span> = a.GetTypes ();
  <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">t</span> <span style="color: #4f97d7; font-weight: bold;">in</span> types)
  {
       Console.WriteLine (<span style="color: #2d9574;">"Type is {0}"</span>, t);
  }
  Console.WriteLine (<span style="color: #2d9574;">"{0} types found"</span>, types.Length);
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdb4e561" class="outline-4">
<h4 id="orgdb4e561">对方法和特性的迟绑定</h4>
<div class="outline-text-4" id="text-orgdb4e561">
<p>
这允许程序员可以调用动态实例化的对象的特性和方法，这也称为动态激活。<br />
</p>
</div>
</div>
<div id="outline-container-org344099d" class="outline-4">
<h4 id="org344099d">运行期创建类型（反射输出）</h4>
<div class="outline-text-4" id="text-org344099d">
<p>
对反射的终极使用是在运行期创建新的类型，然后使用这些类型执行任务。<br />
</p>
</div>
</div>
<div id="outline-container-orgc034460" class="outline-4">
<h4 id="orgc034460">反射应用实例</h4>
<div class="outline-text-4" id="text-orgc034460">
</div>
<div id="outline-container-org7da0f9c" class="outline-5">
<h5 id="org7da0f9c">反射创建实例</h5>
<div class="outline-text-5" id="text-org7da0f9c">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">baseToolT</span> = <span style="color: #4f97d7; font-weight: bold;">typeof</span>(GToolBase);
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">types</span> = Assembly.<span style="color: #bc6ec5; font-weight: bold;">GetExecutingAssembly</span>().<span style="color: #bc6ec5; font-weight: bold;">GetTypes</span>();
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">t</span> <span style="color: #4f97d7; font-weight: bold;">in</span> types)
{
    <span style="color: #4f97d7; font-weight: bold;">if</span>(<span style="color: #a45bad;">!</span>t.<span style="color: #bc6ec5; font-weight: bold;">IsSubclassOf</span>(baseToolT))
    {
        <span style="color: #4f97d7; font-weight: bold;">continue</span>;
    }

    <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">tool</span> = System.Activator.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>(t, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">object</span>[] { <span style="color: #4f97d7; font-weight: bold;">this</span> });
    toolArr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(tool <span style="color: #4f97d7; font-weight: bold;">as</span> GToolBase);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org218d7fd" class="outline-5">
<h5 id="org218d7fd">反射序列化泛型 Array List Dictionary</h5>
<div class="outline-text-5" id="text-org218d7fd">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">objType</span> = obj.<span style="color: #bc6ec5; font-weight: bold;">GetType</span>();
  <span style="color: #4f97d7; font-weight: bold;">if</span>(objType.FullName.<span style="color: #bc6ec5; font-weight: bold;">StartsWith</span>(<span style="color: #2d9574;">"System.Collections.Generic.List"</span>))
  {
      jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONArray</span>();
      <span style="color: #ce537a; font-weight: bold;">Type</span>[] <span style="color: #7590db;">eType</span> = objType.<span style="color: #bc6ec5; font-weight: bold;">GetGenericArguments</span>();
      <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">temp</span> <span style="color: #4f97d7; font-weight: bold;">in</span> obj <span style="color: #4f97d7; font-weight: bold;">as</span> IEnumerable)
      {
          jsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #bc6ec5; font-weight: bold;">SerializeToJSON</span>(temp));
      }
  }
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(objType.FullName.<span style="color: #bc6ec5; font-weight: bold;">StartsWith</span>(<span style="color: #2d9574;">"System.Collections.Generic.Dictionary"</span>))
  {
      jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONObject</span>();
      <span style="color: #ce537a; font-weight: bold;">Type</span>[] <span style="color: #7590db;">kvType</span> = objType.<span style="color: #bc6ec5; font-weight: bold;">GetGenericArguments</span>();
      jsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(_JSON_DictKType_Key, kvType[0].FullName);
      jsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(_JSON_DictVType_Key, kvType[1].FullName);
      <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">DictionaryEntry</span> <span style="color: #7590db;">kv</span> <span style="color: #4f97d7; font-weight: bold;">in</span> obj <span style="color: #4f97d7; font-weight: bold;">as</span> IDictionary)
      {
          jsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(kv.Key <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">string</span>, <span style="color: #bc6ec5; font-weight: bold;">SerializeToJSON</span>(kv.Value));
      }
  }
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(objType.FullName.<span style="color: #bc6ec5; font-weight: bold;">EndsWith</span>(<span style="color: #2d9574;">"[]"</span>))
  {
      jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONObject</span>();
      <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">arrJsonObj</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONArray</span>();
      <span style="color: #ce537a; font-weight: bold;">Type</span>[] <span style="color: #7590db;">eType</span> = objType.<span style="color: #bc6ec5; font-weight: bold;">GetGenericArguments</span>();
      <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">temp</span> <span style="color: #4f97d7; font-weight: bold;">in</span> obj <span style="color: #4f97d7; font-weight: bold;">as</span> IEnumerable)
      {
          arrJsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #bc6ec5; font-weight: bold;">SerializeToJSON</span>(temp));
      }
      jsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(_JSON_ArrType_Key, arrJsonObj);
  }
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(objType.FullName.<span style="color: #bc6ec5; font-weight: bold;">StartsWith</span>(<span style="color: #2d9574;">"System"</span>))
  {
      <span style="color: #4f97d7; font-weight: bold;">if</span>(objType == <span style="color: #4f97d7; font-weight: bold;">typeof</span>(<span style="color: #ce537a; font-weight: bold;">string</span>))
      {
          jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONString</span>(obj <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">string</span>);
      }
      <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(objType == <span style="color: #4f97d7; font-weight: bold;">typeof</span>(<span style="color: #ce537a; font-weight: bold;">bool</span>))
      {
          jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONBool</span>((<span style="color: #ce537a; font-weight: bold;">bool</span>)obj);
      }
      <span style="color: #4f97d7; font-weight: bold;">else</span>
      {
          jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONNumber</span>(obj.<span style="color: #bc6ec5; font-weight: bold;">ToString</span>());
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org667e36d" class="outline-5">
<h5 id="org667e36d">反射创建泛型 Array List Dictionary</h5>
<div class="outline-text-5" id="text-org667e36d">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">if</span>(jsonObj.Tag == JSONNodeType.Object)
   {
       <span style="color: #ce537a; font-weight: bold;">JSONObject</span> <span style="color: #7590db;">tJsonObj</span> = jsonObj <span style="color: #4f97d7; font-weight: bold;">as</span> JSONObject;
       <span style="color: #4f97d7; font-weight: bold;">if</span>(tJsonObj[_JSON_DictKType_Key]!=<span style="color: #a45bad;">null</span> &amp;&amp; tJsonObj[_JSON_DictVType_Key]!=<span style="color: #a45bad;">null</span>)
       {
           <span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">kType</span> = Type.<span style="color: #bc6ec5; font-weight: bold;">GetType</span>(tJsonObj[_JSON_DictKType_Key]);
           <span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">vType</span> = Type.<span style="color: #bc6ec5; font-weight: bold;">GetType</span>(tJsonObj[_JSON_DictVType_Key]);
           <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dictType</span> = <span style="color: #4f97d7; font-weight: bold;">typeof</span>(Dictionary&lt;,&gt;).<span style="color: #bc6ec5; font-weight: bold;">MakeGenericType</span>(kType, vType);
           obj = Activator.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>(dictType);
           <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dictAddFunc</span> = dictType.<span style="color: #bc6ec5; font-weight: bold;">GetMethod</span>(<span style="color: #2d9574;">"Add"</span>, <span style="color: #4f97d7; font-weight: bold;">new</span>[] { kType, vType });
           <span style="color: #4f97d7; font-weight: bold;">foreach</span>(KeyValuePair&lt;<span style="color: #ce537a; font-weight: bold;">string</span>, JSONNode&gt; kv <span style="color: #4f97d7; font-weight: bold;">in</span> tJsonObj)
           {
               <span style="color: #4f97d7; font-weight: bold;">if</span>(kv.Key != _JSON_DictKType_Key &amp;&amp; kv.Key!=_JSON_DictVType_Key)
               {
                   <span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">dictK</span> = <span style="color: #a45bad;">null</span>;
                   <span style="color: #4f97d7; font-weight: bold;">if</span>(kType != <span style="color: #4f97d7; font-weight: bold;">typeof</span>(<span style="color: #ce537a; font-weight: bold;">string</span>))
                   {
                       dictK = Convert.<span style="color: #bc6ec5; font-weight: bold;">ChangeType</span>(kv.Value, kType);
                   }
                   <span style="color: #4f97d7; font-weight: bold;">else</span>
                   {
                       dictK = kv.Key;
                   }
                   <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dictV</span> = <span style="color: #bc6ec5; font-weight: bold;">DeserializeFromJSON</span>(kv.Value);
                   dictAddFunc.<span style="color: #bc6ec5; font-weight: bold;">Invoke</span>(obj, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">object</span>[] {dictK, dictV});
               }
           }
       }
       <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(tJsonObj[_JSON_CustomType_Key]!=<span style="color: #a45bad;">null</span>)
       {
           <span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">objType</span> = Type.<span style="color: #bc6ec5; font-weight: bold;">GetType</span>(tJsonObj[_JSON_CustomType_Key]);
           obj = Activator.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>(objType);
           <span style="color: #4f97d7; font-weight: bold;">foreach</span> (KeyValuePair&lt;<span style="color: #ce537a; font-weight: bold;">string</span>, JSONNode&gt; kv <span style="color: #4f97d7; font-weight: bold;">in</span> tJsonObj)
           {
               <span style="color: #4f97d7; font-weight: bold;">if</span> (kv.Key != _JSON_CustomType_Key)
               {
                   <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">objV</span> = <span style="color: #bc6ec5; font-weight: bold;">DeserializeFromJSON</span>(kv.Value);
                   <span style="color: #ce537a; font-weight: bold;">FieldInfo</span> <span style="color: #7590db;">fieldInfo</span> = objType.<span style="color: #bc6ec5; font-weight: bold;">GetField</span>(kv.Key, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
                   <span style="color: #4f97d7; font-weight: bold;">if</span>(fieldInfo != <span style="color: #a45bad;">null</span>)
                   {
                       objV = Convert.<span style="color: #bc6ec5; font-weight: bold;">ChangeType</span>(objV, fieldInfo.FieldType);
                       fieldInfo.<span style="color: #bc6ec5; font-weight: bold;">SetValue</span>(obj, objV);
                   }
                   <span style="color: #4f97d7; font-weight: bold;">else</span>
                   {
                       <span style="color: #ce537a; font-weight: bold;">PropertyInfo</span> <span style="color: #7590db;">propInfo</span> = objType.<span style="color: #bc6ec5; font-weight: bold;">GetProperty</span>(kv.Key, BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance);
                       <span style="color: #4f97d7; font-weight: bold;">if</span>(propInfo!=<span style="color: #a45bad;">null</span>)
                       {
                           propInfo.<span style="color: #bc6ec5; font-weight: bold;">SetValue</span>(obj, objV, <span style="color: #a45bad;">null</span>);
                       }
                       <span style="color: #4f97d7; font-weight: bold;">else</span>
                       {
                           Debug.<span style="color: #bc6ec5; font-weight: bold;">LogError</span>(objType.FullName + <span style="color: #2d9574;">"not exist property "</span> + kv.Key);
                       }
                   }
               }
           }
       }
       <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(tJsonObj[_JSON_ArrType_Key]!=<span style="color: #a45bad;">null</span>)
       {
           <span style="color: #ce537a; font-weight: bold;">Array</span> <span style="color: #7590db;">arrObj</span> = <span style="color: #a45bad;">null</span>;
           <span style="color: #ce537a; font-weight: bold;">JSONArray</span> <span style="color: #7590db;">arrJsonObj</span> = tJsonObj[_JSON_ArrType_Key] <span style="color: #4f97d7; font-weight: bold;">as</span> JSONArray;
           <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">idx</span> = 0;
           <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">JSONNode</span> <span style="color: #7590db;">v</span> <span style="color: #4f97d7; font-weight: bold;">in</span> arrJsonObj)
           {
               <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">elem</span> = <span style="color: #bc6ec5; font-weight: bold;">DeserializeFromJSON</span>(v);
               <span style="color: #4f97d7; font-weight: bold;">if</span>(arrObj == <span style="color: #a45bad;">null</span>)
               {
                   <span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">elemType</span> = elem.<span style="color: #bc6ec5; font-weight: bold;">GetType</span>();
                   arrObj = Array.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>(elemType,arrJsonObj.Count);
               }
               arrObj.<span style="color: #bc6ec5; font-weight: bold;">SetValue</span>(elem, idx++);
           }
           obj = arrObj;
       }
       <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #4f97d7; font-weight: bold;">if</span>(tJsonObj[_JSON_ListType_Key]!=<span style="color: #a45bad;">null</span>)
       {
           <span style="color: #ce537a; font-weight: bold;">JSONArray</span> <span style="color: #7590db;">arrJsonObj</span> = tJsonObj[_JSON_ListType_Key] <span style="color: #4f97d7; font-weight: bold;">as</span> JSONArray;
           <span style="color: #ce537a; font-weight: bold;">MethodInfo</span> <span style="color: #7590db;">listAddFunc</span> = <span style="color: #a45bad;">null</span>;
           <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">JSONNode</span> <span style="color: #7590db;">v</span> <span style="color: #4f97d7; font-weight: bold;">in</span> arrJsonObj)
           {
               <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">elem</span> = <span style="color: #bc6ec5; font-weight: bold;">DeserializeFromJSON</span>(v);
               <span style="color: #4f97d7; font-weight: bold;">if</span>(obj==<span style="color: #a45bad;">null</span>)
               {
                   <span style="color: #ce537a; font-weight: bold;">Type</span> <span style="color: #7590db;">elemType</span> = elem.<span style="color: #bc6ec5; font-weight: bold;">GetType</span>();
                   <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">listType</span> = <span style="color: #4f97d7; font-weight: bold;">typeof</span>(<span style="color: #ce537a; font-weight: bold;">List</span>&lt;&gt;).<span style="color: #bc6ec5; font-weight: bold;">MakeGenericType</span>(elemType);
                   listAddFunc = listType.<span style="color: #bc6ec5; font-weight: bold;">GetMethod</span>(<span style="color: #2d9574;">"Add"</span>, <span style="color: #4f97d7; font-weight: bold;">new</span>[] {elemType});
                   obj = Activator.<span style="color: #bc6ec5; font-weight: bold;">CreateInstance</span>(listType);
               }
               listAddFunc.<span style="color: #bc6ec5; font-weight: bold;">Invoke</span>(obj, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">object</span>[] {elem});
           }
       }
   }
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaed4b9d" class="outline-5">
<h5 id="orgaed4b9d">反射序列化 其他程序集类</h5>
<div class="outline-text-5" id="text-orgaed4b9d">
<div class="org-src-container">
<pre class="src src-csharp">  jsonObj = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">JSONObject</span>();
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#65306;&#24517;&#39035;&#20351;&#29992; AssemblyQualifiedName &#26080;&#27861;&#26681;&#25454; FullName &#33719;&#21462;&#21040;&#20854;&#20182;&#31243;&#24207;&#38598;&#30340;&#31867;</span>
  jsonObj.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(_JSON_CustomType_Key, objType.AssemblyQualifiedName);
</pre>
</div>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org1ed83fc" class="outline-2">
<h2 id="org1ed83fc">Tips</h2>
<div class="outline-text-2" id="text-org1ed83fc">
</div>
<div id="outline-container-org83fba2c" class="outline-3">
<h3 id="org83fba2c">类型转换</h3>
<div class="outline-text-3" id="text-org83fba2c">
<p>
类型 <a href="https://msdn.microsoft.com/zh-cn/library/ms173104.aspx">https://msdn.microsoft.com/zh-cn/library/ms173104.aspx</a><br />
如何将字符串转换为数字 <a href="https://msdn.microsoft.com/zh-cn/library/bb397679.aspx">https://msdn.microsoft.com/zh-cn/library/bb397679.aspx</a><br />
类型转换相关文档 <a href="https://msdn.microsoft.com/zh-cn/library/ms173105.aspx">https://msdn.microsoft.com/zh-cn/library/ms173105.aspx</a><br />
</p>
</div>
</div>
<div id="outline-container-org29c76ef" class="outline-3">
<h3 id="org29c76ef">static const readonly</h3>
<div class="outline-text-3" id="text-org29c76ef">
<p>
static 修饰符可用于类、字段、方法、属性、运算符、事件和构造函数，但不能用于索引器、析构函数或类以外的类型。<br />
const 指定字段或局部变量的值是常数，不能被修改。被指定为 const 的变量，其初始值是在编译期计算的。<br />
readonly 指定字段或局部变量的值为常数，不能被修改。被指定为 readonly 的变量，其初始值是在运行时计算的。<br />
Tips：<br />
static 不支持局部变量，只能用类的静态字段来代替 c++中的局部静态变量。<br />
const 字段只能在该字段的声明中初始化。<br />
readonly 字段可以在声明或构造函数中初始化。因此，根据所使用的构造函数，readonly 字段可能具有不同的值。<br />
const 字段会被当做静态成员变量，所以不必要也不允许为该字段添加 static 修饰符。<br />
</p>

<p>
数组的初始化器是在运行时执行的，所以无法定义一个 const 数组并用指定的值初始化它。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GStaticMember</span>
  {
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">const</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">const_imember_0</span> = 10;
      <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">const</span> <span style="color: #ce537a; font-weight: bold;">int</span>[] <span style="color: #7590db;">int_arr</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span>[3]{1,2,3}; <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#32534;&#35793;&#38169;&#35823;&#25552;&#31034;&#21482;&#33021;&#29992; null &#21021;&#22987;&#21270;&#12290;</span>
  }
  <span style="color: #ce537a; font-weight: bold;">GStaticMember</span> <span style="color: #7590db;">member</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GStaticMember</span> ();
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Console.WriteLine ("const_imember_0 = {0}", member.const_imember_0);       // &#32534;&#35793;&#38169;&#35823;&#65292;&#19981;&#20801;&#35768;&#36890;&#36807;&#23545;&#35937;&#35775;&#38382;&#38745;&#24577;&#23383;&#27573;</span>
  Console.WriteLine (<span style="color: #2d9574;">"const_imember_0 = {0}"</span>, GStaticMember.const_imember_0);
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfc9b63a" class="outline-3">
<h3 id="orgfc9b63a">装箱和拆箱</h3>
<div class="outline-text-3" id="text-orgfc9b63a">
</div>
<div id="outline-container-orga52bc2f" class="outline-4">
<h4 id="orga52bc2f">装箱过程</h4>
<div class="outline-text-4" id="text-orga52bc2f">
<ol class="org-ol">
<li>在堆中申请内存，内存大小为值类型的大小，再加上额外固定空间（引用类型的标配：TypeHandle 和同步索引块）；<br /></li>
<li>将值类型的字段值（x=1023）拷贝新分配的内存中；<br /></li>
<li>返回新引用对象的地址（给引用变量 object o）<br /></li>
</ol>
</div>
</div>
<div id="outline-container-orgf4a7cb7" class="outline-4">
<h4 id="orgf4a7cb7">拆箱过程</h4>
<div class="outline-text-4" id="text-orgf4a7cb7">
<ol class="org-ol">
<li>检查实例对象（object o）是否有效，如是否为 null，其装箱的类型与拆箱的类型（int）是否一致，如检测不合法，抛出异常；<br /></li>
<li>指针返回，就是获取装箱对象（object o）中值类型字段值的地址；<br /></li>
<li>字段拷贝，把装箱对象（object o）中值类型字段值拷贝到栈上，意思就是创建一个新的值类型变量来存储拆箱后的值；<br /></li>
</ol>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">iValue</span> = 10;
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Boxing int value</span>
<span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">oValue</span> = iValue;
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"Unboxing oValue result = "</span> + (<span style="color: #ce537a; font-weight: bold;">int</span>)oValue);
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">ERROR &#22312;&#25191;&#34892;&#21040;&#19979;&#38754;&#36825;&#21477;&#20195;&#30721;&#26102;&#65292;&#20250;&#25253;&#38169;&#65292;&#25552;&#31034;&#38750;&#27861;&#30340;&#31867;&#22411;&#36716;&#25442;</span>
<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">fValue</span> = (<span style="color: #ce537a; font-weight: bold;">float</span>)oValue;
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(<span style="color: #2d9574;">"Unboxing oValue result = "</span> + fValue);
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd321669" class="outline-4">
<h4 id="orgd321669">优化</h4>
<div class="outline-text-4" id="text-orgd321669">
<p>
使用显式的装箱操作来减少多余的装箱操作<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">x</span> = 100;
<span style="color: #ce537a; font-weight: bold;">ArrayList</span> <span style="color: #7590db;">arr</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ArrayList</span>(3);
arr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(x);
arr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(x);
arr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(x);

<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#19978;&#38754;&#30340;&#20195;&#30721;&#21487;&#20197;&#20248;&#21270;&#20026;</span>
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">x</span> = 100;
<span style="color: #ce537a; font-weight: bold;">ArrayList</span> <span style="color: #7590db;">arr</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ArrayList</span>(3);
<span style="color: #ce537a; font-weight: bold;">object</span> <span style="color: #7590db;">o</span> = x;
arr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(o);
arr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(o);
arr.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(o);
</pre>
</div>
<p>
使用泛型集合类可以避免装箱操作<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org8ee8cce" class="outline-3">
<h3 id="org8ee8cce">编码规范</h3>
<div class="outline-text-3" id="text-org8ee8cce">
<p>
<a href="https://msdn.microsoft.com/zh-cn/library/ff926074">https://msdn.microsoft.com/zh-cn/library/ff926074</a><br />
</p>
</div>
</div>
<div id="outline-container-orgb2c8204" class="outline-3">
<h3 id="orgb2c8204">override overload overwrite</h3>
<div class="outline-text-3" id="text-orgb2c8204">
<p>
override  在 C#中实现多态时需要使用 override 关键字来覆盖父类的方法<br />
overload  表示类中同名函数，不同参数，c#重载中不需要关键字，c#中没有 overload 关键字<br />
overwrite 表示重新实现从父类派生而来的方法，需要关键字 new。<br />
</p>
</div>
</div>
<div id="outline-container-orgab0ffb4" class="outline-3">
<h3 id="orgab0ffb4">Tools</h3>
<div class="outline-text-3" id="text-orgab0ffb4">
</div>
<div id="outline-container-org5f1997b" class="outline-4">
<h4 id="org5f1997b">mono 版 ILDASM 为 monodis</h4>
<div class="outline-text-4" id="text-org5f1997b">
<p>
<a href="http://stackoverflow.com/questions/1655767/does-mono-have-the-equivalent-of-ildasm">http://stackoverflow.com/questions/1655767/does-mono-have-the-equivalent-of-ildasm</a><br />
<a href="http://www.mono-project.com/docs/tools+libraries/tools/monodis/">http://www.mono-project.com/docs/tools+libraries/tools/monodis/</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org27ccaf0" class="outline-3">
<h3 id="org27ccaf0">GetMethod 无法获取父类中定义的方法</h3>
<div class="outline-text-3" id="text-org27ccaf0">
</div>
<div id="outline-container-orge5f729d" class="outline-4">
<h4 id="orge5f729d">情况 1</h4>
<div class="outline-text-4" id="text-orge5f729d">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">BindingFlags.FlattenHierarchy &#34920;&#31034;&#36820;&#22238;&#32487;&#25215;&#32780;&#26469;&#30340;&#26041;&#27861; - &#21482;&#36820;&#22238;&#29238;&#31867;&#20013;&#30340; public &#21644; protected &#26041;&#27861;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">BindingFlags.Instance &#34920;&#31034;&#36820;&#22238;&#23454;&#20363;&#26041;&#27861;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">BindingFlags.Static &#34920;&#31034;&#36820;&#22238;&#38745;&#24577;&#26041;&#27861;</span>
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">flags</span> = BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.FlattenHierarchy | BindingFlags.Instance;
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">deserializeMethod</span> = type.<span style="color: #bc6ec5; font-weight: bold;">GetMethod</span>(<span style="color: #2d9574;">"DeserializeTable"</span>, flags);
</pre>
</div>
</div>
</div>
<div id="outline-container-org4ae8622" class="outline-4">
<h4 id="org4ae8622">情况 2</h4>
<div class="outline-text-4" id="text-org4ae8622">
<p>
检查 DeserializeTable 是否为 public 或 protected 方法<br />
</p>
</div>
</div>
<div id="outline-container-org82b5f18" class="outline-4">
<h4 id="org82b5f18">情况 3</h4>
<div class="outline-text-4" id="text-org82b5f18">
<p>
函数名相同，参数不同时，获取特定函数需要指定该函数的参数类型。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">deserializeMethod = tblMgrType.<span style="color: #bc6ec5; font-weight: bold;">GetMethod</span>(<span style="color: #2d9574;">"DeserializeTable"</span>, flags, <span style="color: #a45bad;">null</span>, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Type</span>[] { <span style="color: #4f97d7; font-weight: bold;">typeof</span>(<span style="color: #ce537a; font-weight: bold;">byte</span>[]) }, <span style="color: #a45bad;">null</span>);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org906ed67" class="outline-3">
<h3 id="org906ed67">CSharp Wiki</h3>
<div class="outline-text-3" id="text-org906ed67">
<ul class="org-ul">
<li>CSharp 发展历史<br /></li>
<li>CSharp 特性介绍<br /></li>
</ul>
<p>
<a href="https://en.wikipedia.org/wiki/C_Sharp_(programming_language)">https://en.wikipedia.org/wiki/C_Sharp_(programming_language)</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgf58cc79" class="outline-2">
<h2 id="orgf58cc79">HowTo</h2>
<div class="outline-text-2" id="text-orgf58cc79">
</div>
<div id="outline-container-orgc379216" class="outline-3">
<h3 id="orgc379216">Collections</h3>
<div class="outline-text-3" id="text-orgc379216">
</div>
<div id="outline-container-org237eb85" class="outline-4">
<h4 id="org237eb85">Array List</h4>
<div class="outline-text-4" id="text-org237eb85">
</div>
<div id="outline-container-orgfd2192c" class="outline-5">
<h5 id="orgfd2192c">数组转化为 String</h5>
<div class="outline-text-5" id="text-orgfd2192c">
</div>
<div id="outline-container-orga7c960a" class="outline-6">
<h6 id="orga7c960a">方案 1 string 数组转 string</h6>
<div class="outline-text-6" id="text-orga7c960a">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">arr</span> = { <span style="color: #2d9574;">"Miami"</span>, <span style="color: #2d9574;">"Berlin"</span>, <span style="color: #2d9574;">"Hamburg"</span>};
<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">s</span> = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Join</span>(<span style="color: #2d9574;">" "</span>, arr);
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb689000" class="outline-6">
<h6 id="orgb689000">方案 2 任意类型数组 List 转 string</h6>
<div class="outline-text-6" id="text-orgb689000">
<p>
String.Join&lt;T&gt; Method (String, IEnumerable&lt;T&gt;)<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #7590db;">System</span>.<span style="color: #7590db;">Linq</span>;

<span style="color: #ce537a; font-weight: bold;">int</span>[] <span style="color: #7590db;">array</span> = {1,2,3,4,5};
<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">ids</span> = String.<span style="color: #bc6ec5; font-weight: bold;">Join</span>(<span style="color: #2d9574;">","</span>, array.<span style="color: #bc6ec5; font-weight: bold;">Select</span>(p=&gt;p.<span style="color: #bc6ec5; font-weight: bold;">ToString</span>()).<span style="color: #bc6ec5; font-weight: bold;">ToArray</span>());
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">output  = "1,2,3,4,5";</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org19fb512" class="outline-5">
<h5 id="org19fb512">Sort: 使用指定排序函数进行排序</h5>
<div class="outline-text-5" id="text-org19fb512">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">x.tex &#20026; Texture2D</span>
_allObjects.<span style="color: #bc6ec5; font-weight: bold;">Sort</span>((x, y) =&gt; {
    <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">xSize</span> = x.tex.width * x.tex.height;
    <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">ySize</span> = y.tex.width * y.tex.height;
    <span style="color: #4f97d7; font-weight: bold;">return</span> xSize - ySize;
});
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org92c6b6d" class="outline-4">
<h4 id="org92c6b6d">Dictionary</h4>
<div class="outline-text-4" id="text-org92c6b6d">
</div>
<div id="outline-container-org95e8ee0" class="outline-5">
<h5 id="org95e8ee0">如何用初始化器初始化 Dictionary</h5>
<div class="outline-text-5" id="text-org95e8ee0">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">Dictionary</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>, <span style="color: #ce537a; font-weight: bold;">int</span>&gt; <span style="color: #7590db;">dic</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Dictionary</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>, <span style="color: #ce537a; font-weight: bold;">int</span>&gt; {
      {<span style="color: #2d9574;">"name1"</span>,3},
      {<span style="color: #2d9574;">"name2"</span>,3},
      {<span style="color: #2d9574;">"name3"</span>,3},
      {<span style="color: #2d9574;">"name4"</span>,3}
  };
  <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">curries</span> = <span style="color: #4f97d7; font-weight: bold;">new</span>[]
      {
          <span style="color: #4f97d7; font-weight: bold;">new</span>
          {
              <span style="color: #7590db;">MainIngredient</span>= <span style="color: #2d9574;">"Lamb"</span>,
              <span style="color: #7590db;">Style</span>= <span style="color: #2d9574;">"Dhansak"</span>,
              <span style="color: #7590db;">Spiciness</span>= 5
          },
          <span style="color: #4f97d7; font-weight: bold;">new</span>
          {
              <span style="color: #7590db;">MainIngredient</span>= <span style="color: #2d9574;">"Lamb"</span>,
              <span style="color: #7590db;">Style</span>= <span style="color: #2d9574;">"Dhansak"</span>,
              <span style="color: #7590db;">Spiciness</span>= 5
          },
          <span style="color: #4f97d7; font-weight: bold;">new</span>
          {
              <span style="color: #7590db;">MainIngredient</span>= <span style="color: #2d9574;">"Chicken"</span>,
              <span style="color: #7590db;">Style</span>= <span style="color: #2d9574;">"Dhansak"</span>,
              <span style="color: #7590db;">Spiciness</span>= 5
          }
      };
</pre>
</div>
</div>
</div>
<div id="outline-container-org434bd1b" class="outline-5">
<h5 id="org434bd1b">Dictionary 如何遍历删除</h5>
<div class="outline-text-5" id="text-org434bd1b">
<p>
不能直接遍历 Keys 进行删除,删除元素会修改 Keys 内容，导致 foreach 出错<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#38169;&#35823;&#30340;&#26041;&#27861; &#36816;&#34892;&#26102;&#20250;&#25243;&#20986;&#24322;&#24120;</span>
  <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">key</span> <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">int</span>&gt;(dict.Keys)) {
      <span style="color: #4f97d7; font-weight: bold;">if</span> (key == 1 || key==2) dict.<span style="color: #bc6ec5; font-weight: bold;">Remove</span>(key);
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27491;&#30830;&#30340;&#26041;&#27861;</span>
  <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">int</span>&gt; <span style="color: #7590db;">needRemoveKeys</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">int</span>&gt;();
  <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">key</span> <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">int</span>&gt;(dict.Keys)) {
      <span style="color: #4f97d7; font-weight: bold;">if</span> (key == 1 || key==2) needRemoveKeys.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(key);
  }
  <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">key</span> <span style="color: #4f97d7; font-weight: bold;">in</span> needRemoveKeys) {
      dict.<span style="color: #bc6ec5; font-weight: bold;">Remove</span>(key);
  }
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgaddbaa7" class="outline-4">
<h4 id="orgaddbaa7">HashSet</h4>
<div class="outline-text-4" id="text-orgaddbaa7">
</div>
<div id="outline-container-org0ce14e2" class="outline-5">
<h5 id="org0ce14e2">判断集合相等</h5>
<div class="outline-text-5" id="text-org0ce14e2">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">HashSet</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; <span style="color: #7590db;">s1</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HashSet</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; { <span style="color: #2d9574;">"a"</span>, <span style="color: #2d9574;">"b"</span> };
  <span style="color: #ce537a; font-weight: bold;">HashSet</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; <span style="color: #7590db;">s2</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">HashSet</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; { <span style="color: #2d9574;">"b"</span>, <span style="color: #2d9574;">"a"</span> };
  Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"s1.Equals(s2) = {0}"</span>, s1.<span style="color: #bc6ec5; font-weight: bold;">Equals</span>(s2)));   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">false</span>
  Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"Equals(s1, s2) = {0}"</span>, <span style="color: #bc6ec5; font-weight: bold;">Equals</span>(s1, s2))); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">false</span>
  Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"s1 == s2 -&gt; {0}"</span>, s1==s2));              <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">false</span>
  <span style="color: #4f97d7; font-weight: bold;">if</span>(s1.Count==s2.Count &amp;&amp; s1.<span style="color: #bc6ec5; font-weight: bold;">IsSubsetOf</span>(s2)) <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">true</span>
  {
      Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"xxxx"</span>);
  }
  <span style="color: #4f97d7; font-weight: bold;">if</span>(s1.<span style="color: #bc6ec5; font-weight: bold;">SetEquals</span>(s2)) <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">true</span>
  {
      Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"yyyy"</span>);
  }
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org3a0ec84" class="outline-3">
<h3 id="org3a0ec84">文件目录操作</h3>
<div class="outline-text-3" id="text-org3a0ec84">
</div>
<div id="outline-container-orgc2fdcd6" class="outline-4">
<h4 id="orgc2fdcd6">目录、文件获取</h4>
<div class="outline-text-4" id="text-orgc2fdcd6">
</div>
<div id="outline-container-org1365289" class="outline-5">
<h5 id="org1365289">工作目录 脚本目录</h5>
<div class="outline-text-5" id="text-org1365289">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#33050;&#26412;&#36816;&#34892;&#30446;&#24405; </span>
Directory.<span style="color: #bc6ec5; font-weight: bold;">GetCurrentDirectory</span>();

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25913;&#21464;&#24403;&#21069;&#24037;&#20316;&#30446;</span>
Directory.<span style="color: #bc6ec5; font-weight: bold;">SetCurrentDirectory</span>(curDir + <span style="color: #2d9574;">"/../"</span>);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#33050;&#26412;&#25152;&#22312;&#30446;&#24405; </span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">os.path.split(os.path.realpath(__file__))[0]     </span>

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#36335;&#24452;&#30340;&#26631;&#20934;&#36335;&#24452; &#20840;&#36335;&#24452;&#20999;&#20854;&#20013;&#19981;&#21547;&#26377;&#8220;./ ../&#8221;&#20043;&#31867;</span>
Path.<span style="color: #bc6ec5; font-weight: bold;">GetFullPath</span>(<span style="color: #2d9574;">"./../"</span>);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462; a_abs_path &#36335;&#24452;&#30456;&#23545;&#20110; b_abs_path &#36335;&#24452;&#30340;&#30456;&#23545;&#36335;&#24452;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">os.path.relpath(a_abs_path,b_abs_path)</span>

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">windows &#36335;&#24452;&#36716;&#20026; linux &#36335;&#24452;</span>
dirPath = Path.<span style="color: #bc6ec5; font-weight: bold;">GetFullPath</span>(dirPath);
dirPath = dirPath.<span style="color: #bc6ec5; font-weight: bold;">Replace</span>(<span style="color: #2d9574;">"\\"</span>, <span style="color: #2d9574;">"/"</span>);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#26700;&#38754;&#30446;&#24405;</span>
System.Environment.<span style="color: #bc6ec5; font-weight: bold;">GetFolderPath</span>(System.Environment.SpecialFolder.Desktop);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462; HOME &#30446;&#24405;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">usr_home = os.path.expanduser(&#8217;~')</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org8762f2a" class="outline-5">
<h5 id="org8762f2a">获取目录名 文件名</h5>
<div class="outline-text-5" id="text-org8762f2a">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #7590db;">System</span>.<span style="color: #7590db;">IO</span>;
<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">f</span> = <span style="color: #2d9574;">"a/b/c/d.txt"</span>

Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(Path.<span style="color: #bc6ec5; font-weight: bold;">GetDirectoryName</span>(f));             <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">a/b/c</span>
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(Path.<span style="color: #bc6ec5; font-weight: bold;">GetFileName</span>(f));                  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">d.txt</span>
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(Path.<span style="color: #bc6ec5; font-weight: bold;">GetFileNameWithoutExtension</span>(f));  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">d</span>
Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(Path.<span style="color: #bc6ec5; font-weight: bold;">GetExtension</span>(f));                 <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">.txt</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc45fc16" class="outline-5">
<h5 id="orgc45fc16">遍历目录下的文件和目录</h5>
<div class="outline-text-5" id="text-orgc45fc16">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">fileList</span> = Directory.<span style="color: #bc6ec5; font-weight: bold;">GetFiles</span>(path, <span style="color: #2d9574;">"*"</span>,  SearchOption.TopDirectoryOnly);
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> fileList)
{
    <span style="color: #2aa1ae; background-color: #292e34;">//</span>
}

<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dirList</span> = Directory.<span style="color: #bc6ec5; font-weight: bold;">GetDirectories</span>(desktop);
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dir</span> <span style="color: #4f97d7; font-weight: bold;">in</span> dirList)
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"  -&gt; "</span> + dir);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org1506332" class="outline-5">
<h5 id="org1506332">递归遍历目录中的文件</h5>
<div class="outline-text-5" id="text-org1506332">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">fileList</span> = Directory.<span style="color: #bc6ec5; font-weight: bold;">GetFiles</span>(path, <span style="color: #2d9574;">"*"</span>, SearchOption.AllDirectories);
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> fileList)
{
    <span style="color: #2aa1ae; background-color: #292e34;">//</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org4e8674b" class="outline-5">
<h5 id="org4e8674b">递归遍历目录中的目录</h5>
<div class="outline-text-5" id="text-org4e8674b">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dirList</span> = Directory.<span style="color: #bc6ec5; font-weight: bold;">GetDirectories</span>(desktop, <span style="color: #2d9574;">"*"</span>, SearchOption.AllDirectories);
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dir</span> <span style="color: #4f97d7; font-weight: bold;">in</span> dirList)
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"  -&gt; "</span> + dir);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orga57e952" class="outline-5">
<h5 id="orga57e952">判断目录 文件是否存在</h5>
<div class="outline-text-5" id="text-orga57e952">
<div class="org-src-container">
<pre class="src src-csharp">File.<span style="color: #bc6ec5; font-weight: bold;">Exists</span>(file-path);
Directory.<span style="color: #bc6ec5; font-weight: bold;">Exists</span>(dir-path);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc73dc0a" class="outline-4">
<h4 id="orgc73dc0a">读写目录 文件</h4>
<div class="outline-text-4" id="text-orgc73dc0a">
</div>
<div id="outline-container-org0feb8ee" class="outline-5">
<h5 id="org0feb8ee">创建目录</h5>
<div class="outline-text-5" id="text-org0feb8ee">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">dirInfo</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">DirectoryInfo</span>(dir-path); <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22810;&#23618;&#30446;&#24405;</span>
dirInfo.<span style="color: #bc6ec5; font-weight: bold;">Create</span>();

Directory.<span style="color: #bc6ec5; font-weight: bold;">Create</span>(path); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#23618;&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd2f2611" class="outline-5">
<h5 id="orgd2f2611">读写文件</h5>
<div class="outline-text-5" id="text-orgd2f2611">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">using</span> System.IO;
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20889;&#20837;&#25991;&#20214; 1 - &#20197; Append &#26041;&#24335;&#20889;&#20837; </span>
  <span style="color: #4f97d7; font-weight: bold;">using</span> (<span style="color: #ce537a; font-weight: bold;">FileStream</span> <span style="color: #7590db;">fs</span> = File.<span style="color: #bc6ec5; font-weight: bold;">Open</span>(path, FileMode.Append))
  {
      <span style="color: #ce537a; font-weight: bold;">Byte</span>[] <span style="color: #7590db;">info</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">UTF8Encoding</span>(<span style="color: #a45bad;">true</span>).<span style="color: #bc6ec5; font-weight: bold;">GetBytes</span>(<span style="color: #2d9574;">"This is some test text."</span>);
      fs.<span style="color: #bc6ec5; font-weight: bold;">Write</span>(info, 0, info.Length);
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20889;&#20837;&#25991;&#20214; 2 - &#20197; &#38750; Append &#26041;&#24335;&#20889;&#20837; </span>
  File.<span style="color: #bc6ec5; font-weight: bold;">WriteAllText</span>(path, <span style="color: #2d9574;">"This is some test text."</span>, Encoding.UTF8);
  File.<span style="color: #bc6ec5; font-weight: bold;">WriteAllLines</span>(path, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt;{<span style="color: #2d9574;">"one line."</span>,<span style="color: #2d9574;">"two line."</span>}, Encoding.UTF8);

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20889;&#20837;&#25991;&#20214; 2 - &#20197; Append &#26041;&#24335;&#20889;&#20837; </span>
  File.<span style="color: #bc6ec5; font-weight: bold;">AppendAllText</span>(path, <span style="color: #2d9574;">"This is some test text."</span>, Encoding.UTF8);
  File.<span style="color: #bc6ec5; font-weight: bold;">AppendAllLines</span>(path, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt;{<span style="color: #2d9574;">"one line."</span>,<span style="color: #2d9574;">"two line."</span>}, Encoding.UTF8);

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#35835;&#21462;&#25991;&#20214;</span>
  <span style="color: #4f97d7; font-weight: bold;">if</span>(File.<span style="color: #bc6ec5; font-weight: bold;">Exists</span>(path))
  {
      <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">contentStr1</span> = File.<span style="color: #bc6ec5; font-weight: bold;">ReadAllText</span>(path, Encoding.UTF8);     <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">default is Encoding.UTF8</span>
      <span style="color: #ce537a; font-weight: bold;">string</span>[] <span style="color: #7590db;">contentStr2</span> = File.<span style="color: #bc6ec5; font-weight: bold;">ReadAllLines</span>(path, Encoding.UTF8);  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">default is Encoding.UTF8</span>
      <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; <span style="color: #7590db;">contentStr3</span> = File.<span style="color: #bc6ec5; font-weight: bold;">ReadLines</span>(path, Encoding.UTF8); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">default is Encoding.UTF8</span>
      <span style="color: #ce537a; font-weight: bold;">byte</span>[] <span style="color: #7590db;">contentBytes</span> = File.<span style="color: #bc6ec5; font-weight: bold;">ReadAllBytes</span>(path);
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org04a8620" class="outline-5">
<h5 id="org04a8620">修改文件编码</h5>
<div class="outline-text-5" id="text-org04a8620">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">using</span> System.Text;
  <span style="color: #4f97d7; font-weight: bold;">using</span> System.IO;
  <span style="color: #ce537a; font-weight: bold;">Encoding</span> <span style="color: #7590db;">old_coding</span> = Encoding.<span style="color: #bc6ec5; font-weight: bold;">GetEncoding</span>(<span style="color: #2d9574;">"gb2312"</span>);
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">old_content</span> = File.<span style="color: #bc6ec5; font-weight: bold;">ReadAllText</span>(path, coding);
  <span style="color: #ce537a; font-weight: bold;">byte</span>[] <span style="color: #7590db;">old_bytes</span> = old_coding.<span style="color: #bc6ec5; font-weight: bold;">GetBytes</span>(old_content);

  <span style="color: #ce537a; font-weight: bold;">Encoding</span> <span style="color: #7590db;">new_coding</span> = Encoding.<span style="color: #bc6ec5; font-weight: bold;">GetEncoding</span>(<span style="color: #2d9574;">"utf-8"</span>);
  <span style="color: #ce537a; font-weight: bold;">byte</span>[] <span style="color: #7590db;">new_bytes</span> = Encoding.<span style="color: #bc6ec5; font-weight: bold;">Convert</span>(old_coding, new_coding, old_bytes);
  File.<span style="color: #bc6ec5; font-weight: bold;">WriteAllBytes</span>(path, new_bytes);
</pre>
</div>
</div>
</div>
<div id="outline-container-orgebd3c89" class="outline-5">
<h5 id="orgebd3c89">修改文件名称</h5>
<div class="outline-text-5" id="text-orgebd3c89">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">using</span> System.IO;
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">dirPath</span> = Path.<span style="color: #bc6ec5; font-weight: bold;">GetDirectoryName</span>(file_path);
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">fileName</span> = Path.<span style="color: #bc6ec5; font-weight: bold;">GetFileNameWithoutExtension</span>(file_path);
  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">fileExt</span> = Path.<span style="color: #bc6ec5; font-weight: bold;">GetFileExtension</span>(file_path);

  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">new_file_path</span> = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"{0}/{1}/{2}"</span>, dirPath, new_file_name, fileExt);
  File.<span style="color: #bc6ec5; font-weight: bold;">Move</span>(file_path, new_file_path);

  <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">new_file_path2</span> = Path.<span style="color: #bc6ec5; font-weight: bold;">ChangeExtension</span>(file_path, <span style="color: #2d9574;">".prefab"</span>);
  File.<span style="color: #bc6ec5; font-weight: bold;">Move</span>(file_path, new_file_path2);
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaebc414" class="outline-5">
<h5 id="orgaebc414">移动文件和目录</h5>
<div class="outline-text-5" id="text-orgaebc414">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">using</span> System.IO;

  Directory.<span style="color: #bc6ec5; font-weight: bold;">Move</span>(old_file_or_dir_path, new_file_or_dir_path);
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaa555f6" class="outline-5">
<h5 id="orgaa555f6">复制文件和目录</h5>
<div class="outline-text-5" id="text-orgaa555f6">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">using</span> System.IO;

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">CopyDirectory</span>(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">srcPath</span>, <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">desPath</span>)
  {
      <span style="color: #4f97d7; font-weight: bold;">try</span>
      {
          <span style="color: #ce537a; font-weight: bold;">DirectoryInfo</span> <span style="color: #7590db;">dirInfo</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">DirectoryInfo</span>(srcPath);
          <span style="color: #ce537a; font-weight: bold;">FileSystemInfo</span>[] <span style="color: #7590db;">fileSysInfos</span> = dirInfo.<span style="color: #bc6ec5; font-weight: bold;">GetFileSystemInfos</span>();
          <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">fileSysInfo</span> <span style="color: #4f97d7; font-weight: bold;">in</span> fileSysInfos)
          {
              <span style="color: #ce537a; font-weight: bold;">var</span> <span style="color: #7590db;">subDesPath</span> = desPath + <span style="color: #2d9574;">"/"</span> + fileSysInfo.Name;
              <span style="color: #4f97d7; font-weight: bold;">if</span>(fileSysInfo <span style="color: #4f97d7; font-weight: bold;">is</span> DirectoryInfo)
              {
                  <span style="color: #4f97d7; font-weight: bold;">if</span>(<span style="color: #a45bad;">!</span>Directory.<span style="color: #bc6ec5; font-weight: bold;">Exists</span>(subDesPath))
                  {
                      Directory.<span style="color: #bc6ec5; font-weight: bold;">CreateDirectory</span>(subDesPath);
                  }
                  <span style="color: #bc6ec5; font-weight: bold;">CopyDirectory</span>(fileSysInfo.FullName, subDesPath);
              }
              <span style="color: #4f97d7; font-weight: bold;">else</span>
              {
                  File.<span style="color: #bc6ec5; font-weight: bold;">Copy</span>(fileSysInfo.FullName, subDesPath, <span style="color: #a45bad;">true</span>);
              }
          }
      }
      <span style="color: #4f97d7; font-weight: bold;">catch</span>(<span style="color: #ce537a; font-weight: bold;">Exception</span> <span style="color: #7590db;">e</span>)
      {
          Console.<span style="color: #bc6ec5; font-weight: bold;">WriteLine</span>(e);
          <span style="color: #4f97d7; font-weight: bold;">throw</span>;
      }
  }
</pre>
</div>
</div>
</div>
<div id="outline-container-org41dcc87" class="outline-5">
<h5 id="org41dcc87">删除文件和目录</h5>
<div class="outline-text-5" id="text-org41dcc87">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #4f97d7; font-weight: bold;">using</span> System.IO;

  File.<span style="color: #bc6ec5; font-weight: bold;">Delete</span>(file_path);           <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#25991;&#20214;</span>
  Directory.<span style="color: #bc6ec5; font-weight: bold;">Delete</span>(empty_dir);      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#31354;&#30446;&#24405;</span>

  Directory.<span style="color: #bc6ec5; font-weight: bold;">Delete</span>(root_dir, <span style="color: #a45bad;">true</span>); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36882;&#24402;&#21024;&#38500;&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org653d8fa" class="outline-3">
<h3 id="org653d8fa">创建 C# DLL 工程</h3>
<div class="outline-text-3" id="text-org653d8fa">
<p>
参考下面链接内容<br />
</p>
<ul class="org-ul">
<li>C#创建 dll 类库 <a href="https://www.cnblogs.com/Yesi/p/6125905.html">https://www.cnblogs.com/Yesi/p/6125905.html</a><br /></li>
<li>C#编写动态链接库类库 dll 文件 <a href="https://blog.csdn.net/sibaison/article/details/70196913">https://blog.csdn.net/sibaison/article/details/70196913</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org8f53c42" class="outline-3">
<h3 id="org8f53c42">DLL 混淆加密</h3>
<div class="outline-text-3" id="text-org8f53c42">
</div>
<div id="outline-container-org9775959" class="outline-4">
<h4 id="org9775959">DLL 混淆工具</h4>
<div class="outline-text-4" id="text-org9775959">
<ul class="org-ul">
<li>dotfuscator  <a href="https://www.preemptive.com/products/dotfuscator">https://www.preemptive.com/products/dotfuscator</a><br /></li>
<li>.NET Reactor <a href="http://www.eziriz.com/dotnet_reactor.htm">http://www.eziriz.com/dotnet_reactor.htm</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb54ae1c" class="outline-2">
<h2 id="orgb54ae1c">参考资料</h2>
<div class="outline-text-2" id="text-orgb54ae1c">
<ul class="org-ul">
<li>.Net 系列文章 <a href="http://www.cnblogs.com/anding/p/5226343.html">http://www.cnblogs.com/anding/p/5226343.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="vssue"></div>
        <link rel="stylesheet" href="https://unpkg.com/vssue/dist/vssue.min.css">
        <script src="https://unpkg.com/vue@2.7.10/dist/vue.runtime.min.js"></script>
        <script src="https://unpkg.com/vssue/dist/vssue.github.min.js"></script>
        <script>
          new Vue({
            el: '#vssue',
            render: h => h('Vssue', {
              props: {
                // 在这里设置当前页面对应的 Issue 标题
                title: 'Programing in CSharp',

                // 在这里设置你使用的平台的 OAuth App 配置
                options: {
                    owner: 'wolfand11',
                    repo: 'blog_comments',
                    clientId: 'a02b49185d85859cb92c',
                    clientSecret: '6f123085c6f1ce339e2517d24e5b099fa1dc9c85', // 只有在使用某些平台时需要
                },
              }
            })
          })
        </script>
</div>
</body>
</html>
