<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-08-24 Wed 22:48 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python Note</title>
<meta name="generator" content="Org mode" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
         <meta name="viewport" content="width=device-width, initial-scale=1" />
         <link rel="stylesheet" type="text/css" href="https://wolfand11.gitee.io/res/readtheorg_theme/css/htmlize.css"/>
         <link rel="stylesheet" type="text/css" href="https://wolfand11.gitee.io/res/readtheorg_theme/css/readtheorg.css"/>
         <script type="text/javascript" src="https://wolfand11.gitee.io/res/lib/js/jquery.min.js"></script>
         <script type="text/javascript" src="https://wolfand11.gitee.io/res/lib/js/bootstrap.min.js"></script>
         <script type="text/javascript" src="https://wolfand11.gitee.io/res/lib/js/jquery.stickytableheaders.min.js"></script>
         <script type="text/javascript" src="https://wolfand11.gitee.io/res/readtheorg_theme/js/readtheorg.js"></script>
         <link rel="icon" href="https://wolfand11.gitee.io/res/favicon.ico" type="image/ico" />
         <script type="text/javascript" src="https://wolfand11.gitee.io/res/blog-tools.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://wolfand11.gitee.io"> HOME </a>
</div><div id="content">
<h1 class="title">Python Note</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org54555c0">Python Language</a>
<ul>
<li><a href="#orga1e00da">Python 编程</a>
<ul>
<li><a href="#orgdf3ae58">for</a></li>
<li><a href="#orgf104faa">枚举类型</a>
<ul>
<li><a href="#org360bb0e">Tips</a></li>
<li><a href="#org7bbf893">参考资料</a></li>
</ul>
</li>
<li><a href="#org338bca9">string</a>
<ul>
<li><a href="#orgea6afdc">format</a></li>
<li><a href="#org00fa4c0">list to string</a></li>
<li><a href="#orgea36c1d">任意类型对象的打印</a></li>
<li><a href="#orgf061bc0">参考资料</a></li>
</ul>
</li>
<li><a href="#orge247d7b">list</a>
<ul>
<li><a href="#orga96a74f">参考资料</a></li>
</ul>
</li>
<li><a href="#org2598fa8">dict</a>
<ul>
<li><a href="#orgae0dcdd">增删改</a></li>
<li><a href="#org3f0e6bc">遍历 dict</a></li>
<li><a href="#orgbd8eb03">判断 key 是否存在</a></li>
</ul>
</li>
<li><a href="#org8481a68">正则表达式</a>
<ul>
<li><a href="#org2876c42">正则表达式模式</a></li>
<li><a href="#org85054e6">Capture</a></li>
<li><a href="#org23202aa">正则表达式修饰符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf51ff36">文件目录操作</a>
<ul>
<li><a href="#org2457792">目录、文件获取</a>
<ul>
<li><a href="#org678f400">工作目录 脚本目录</a></li>
<li><a href="#org5087535">获取目录名 文件名</a></li>
<li><a href="#orgf6533c7">遍历目录下的文件和目录</a></li>
<li><a href="#org0c7da9f">递归遍历目录中的文件</a></li>
<li><a href="#orgb1daa7c">递归遍历目录中的目录</a></li>
<li><a href="#orgb23ef39">判断目录 文件是否存在</a></li>
</ul>
</li>
<li><a href="#org5276ef8">读写目录 文件</a>
<ul>
<li><a href="#org5b949c4">创建目录</a></li>
<li><a href="#org8071d39">读写文件</a></li>
<li><a href="#org28193a2">修改文件编码</a></li>
<li><a href="#org488040a">修改文件名称</a></li>
<li><a href="#orgf2b40ea">移动文件和目录</a></li>
<li><a href="#orgca28e2f">复制文件和目录</a></li>
<li><a href="#orgf89421e">删除文件和目录</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1344d41">压缩相关操作</a>
<ul>
<li><a href="#org0c04eb1">zip</a>
<ul>
<li><a href="#orgfe1291c">zip directory</a></li>
<li><a href="#org9bb5024">zip test password</a>
<ul>
<li><a href="#org512f355">zipfile</a></li>
<li><a href="#orgdc7b77d">subprocess</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org136f52e">7z</a></li>
</ul>
</li>
<li><a href="#org4a6cef9">解析命令行参数</a></li>
<li><a href="#org7dee657">Ftp 上传文件</a>
<ul>
<li><a href="#org469c949">参考链接：</a></li>
</ul>
</li>
<li><a href="#orgf205129">subprocess 使用</a>
<ul>
<li><a href="#orge95ba94">执行 svn 更新</a></li>
<li><a href="#orgd45afdb">获得文件夹属性</a></li>
</ul>
</li>
<li><a href="#org198246a">面向对象编程</a>
<ul>
<li><a href="#org44630aa">包</a></li>
<li><a href="#orga2131c3">模块</a></li>
<li><a href="#org0efc83d">面向对象编程</a>
<ul>
<li><a href="#org6f58f84">python 的构造和析构函数为固定的名字。</a></li>
<li><a href="#org54c553e">python 的静态成员 静态成员函数 普通成员函数</a></li>
<li><a href="#org1297ca4">python 的封装（private public protected）</a></li>
<li><a href="#org9ac112d">python 类的继承</a></li>
<li><a href="#org8171b59">参考资料</a></li>
</ul>
</li>
<li><a href="#org7e4a642">MISC</a></li>
</ul>
</li>
<li><a href="#org18da572">异常处理</a>
<ul>
<li><a href="#org9cb9f0b">通用异常错误打印</a></li>
<li><a href="#orgd2e4eb1">subprocess 异常处理</a></li>
<li><a href="#orgb947bac">参考资料</a></li>
</ul>
</li>
<li><a href="#orgdc26777">Async Programming</a>
<ul>
<li><a href="#org9b1b34b">Multi Threading</a></li>
<li><a href="#org3b906aa">Multi Processing</a>
<ul>
<li><a href="#orgd48a8b4">创建 cpu core 数量的进程</a></li>
<li><a href="#orga04687d">multiprocessing pool apply vs apply_async</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgb0c5f1f">World-Excel 处理</a>
<ul>
<li><a href="#org2040f43">安装使用的库</a></li>
<li><a href="#org8479a74">docx</a>
<ul>
<li><a href="#org1df1a88">docx</a></li>
<li><a href="#org4308366">python-docx</a></li>
</ul>
</li>
<li><a href="#org5bbfdba">xlrd</a></li>
<li><a href="#org017e1f2">xlwt</a>
<ul>
<li><a href="#orgdf2f411">xlwt 写入 Excel 文件后，打开时提示文件后缀错误</a></li>
<li><a href="#org5123dcd">ValueError: column index (256) not an int in range(256)</a></li>
</ul>
</li>
<li><a href="#orgdf57f4e">xlsmwriter</a>
<ul>
<li><a href="#orga24dcc0">安装</a></li>
<li><a href="#orgdbd2375">使用</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf40df58">NetworkX</a></li>
<li><a href="#orgbf034b5">colour</a>
<ul>
<li><a href="#org27a51c8">colour 基础</a></li>
<li><a href="#orge2d2ddd">plot matching function</a></li>
<li><a href="#org210a760">spd xyz rgb convert</a></li>
<li><a href="#org5ff8bbf">luminance radiance convert</a></li>
<li><a href="#orgcabc7d2">plot SPD</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org50aaa04">Misc</a>
<ul>
<li><a href="#org1219182">python 版本管理器</a>
<ul>
<li><a href="#org32c186f">pyen</a>
<ul>
<li><a href="#orgd26569b">安装</a>
<ul>
<li><a href="#org638291d">Windows 版本安装请参考下面官方链接：</a></li>
<li><a href="#org3d86a53">OSX</a></li>
<li><a href="#orge239f95">其他版本</a></li>
</ul>
</li>
<li><a href="#org8bc45ae">使用</a></li>
<li><a href="#org43cd1c1">错误处理</a>
<ul>
<li><a href="#org5194628">pyenv Fatal error in launcher: Unable to create process using</a></li>
<li><a href="#orga3e65b4">安装可执行文件后找不到</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3528ff7">rbenv</a></li>
</ul>
</li>
<li><a href="#org6f5d628">python 编辑器</a>
<ul>
<li><a href="#orgaaca52e">PyCharm</a></li>
<li><a href="#org31fa7ff">emacs</a></li>
</ul>
</li>
<li><a href="#orgb9c41bd">easy_install 安装插件</a></li>
<li><a href="#orga460f4a">pip 安装更新卸载插件</a>
<ul>
<li><a href="#org9dcab04">Error 解决 ModuleNotFoundError: No module named 'pip'</a></li>
</ul>
</li>
<li><a href="#orgab0e6a6">离线安装插件</a>
<ul>
<li><a href="#orgf3bd73d">下载需要安装的插件</a></li>
<li><a href="#orgd33bbc9">安装插件</a></li>
</ul>
</li>
<li><a href="#org025c449">将 python 脚本转化为 exe 可执行文件</a></li>
<li><a href="#orgd8d7457">修改 Python 脚本文件编码</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
python note.<br />
</p>
<div class="HTML" id="org1663f2d">
<p>
&lt;!&#x2013; more &#x2013;&gt;<br />
</p>

</div>
<div id="outline-container-org54555c0" class="outline-2">
<h2 id="org54555c0">Python Language</h2>
<div class="outline-text-2" id="text-org54555c0">
</div>
<div id="outline-container-orga1e00da" class="outline-3">
<h3 id="orga1e00da">Python 编程</h3>
<div class="outline-text-3" id="text-orga1e00da">
</div>
<div id="outline-container-orgdf3ae58" class="outline-4">
<h4 id="orgdf3ae58">for</h4>
<div class="outline-text-4" id="text-orgdf3ae58">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(1,10,2):
      <span style="color: #4f97d7; font-weight: bold;">print</span>(i)

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">output: 1 3 5 7 9</span>

  <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> [1,2,3]:
      <span style="color: #4f97d7; font-weight: bold;">print</span>(i)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf104faa" class="outline-4">
<h4 id="orgf104faa">枚举类型</h4>
<div class="outline-text-4" id="text-orgf104faa">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#31181;&#26041;&#24335;</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> enum <span style="color: #4f97d7; font-weight: bold;">import</span> Enum
<span style="color: #7590db;">Month</span> = Enum(<span style="color: #2d9574;">'Month'</span>, (<span style="color: #2d9574;">'Jan'</span>, <span style="color: #2d9574;">'Feb'</span>, <span style="color: #2d9574;">'Mar'</span>, <span style="color: #2d9574;">'Apr'</span>, <span style="color: #2d9574;">'May'</span>, <span style="color: #2d9574;">'Jun'</span>, <span style="color: #2d9574;">'Jul'</span>, <span style="color: #2d9574;">'Aug'</span>, <span style="color: #2d9574;">'Sep'</span>, <span style="color: #2d9574;">'Oct'</span>, <span style="color: #2d9574;">'Nov'</span>, <span style="color: #2d9574;">'Dec'</span>))

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#24341;&#29992;&#19968;&#20010;&#24120;&#37327;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(Month.Jan)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36941;&#21382;&#26522;&#20030;&#30340;&#25152;&#26377;&#25104;&#21592;&#65306;</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> name, member <span style="color: #4f97d7; font-weight: bold;">in</span> Month.__members__.items():
    <span style="color: #4f97d7; font-weight: bold;">print</span>(name, <span style="color: #2d9574;">'=&gt;'</span>, member, <span style="color: #2d9574;">','</span>, member.value)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#31181;&#26041;&#24335;</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> enum <span style="color: #4f97d7; font-weight: bold;">import</span> Enum, unique

<span style="color: #ce537a; font-weight: bold;">@unique</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Weekday</span>(Enum):
    <span style="color: #7590db;">Sun</span> = 0 <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Sun &#30340; value &#34987;&#35774;&#23450;&#20026; 0</span>
    <span style="color: #7590db;">Mon</span> = 1
    <span style="color: #7590db;">Tue</span> = 2
    <span style="color: #7590db;">Wed</span> = 3
    <span style="color: #7590db;">Thu</span> = 4
    <span style="color: #7590db;">Fri</span> = 5
    <span style="color: #7590db;">Sat</span> = 6

&gt;&gt;&gt; <span style="color: #7590db;">day1</span> = Weekday.Mon
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1)
Weekday.Mon
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday.Tue)
Weekday.Tue
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday[<span style="color: #2d9574;">'Tue'</span>])
Weekday.Tue
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday.Tue.value)
2
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1 == Weekday.Mon)
<span style="color: #a45bad;">True</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1 == Weekday.Tue)
<span style="color: #a45bad;">False</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday(1))
Weekday.Mon
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1 == Weekday(1))
<span style="color: #a45bad;">True</span>
&gt;&gt;&gt; Weekday(7)
Traceback (most recent call last):
  ...
<span style="color: #ce537a; font-weight: bold;">ValueError</span>: 7 <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #4f97d7; font-weight: bold;">not</span> a valid Weekday
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">for</span> name, member <span style="color: #4f97d7; font-weight: bold;">in</span> Weekday.__members__.items():
...     <span style="color: #4f97d7; font-weight: bold;">print</span>(name, <span style="color: #2d9574;">'=&gt;'</span>, member)
...
<span style="color: #7590db;">Sun</span> =&gt; Weekday.Sun
<span style="color: #7590db;">Mon</span> =&gt; Weekday.Mon
<span style="color: #7590db;">Tue</span> =&gt; Weekday.Tue
<span style="color: #7590db;">Wed</span> =&gt; Weekday.Wed
<span style="color: #7590db;">Thu</span> =&gt; Weekday.Thu
<span style="color: #7590db;">Fri</span> =&gt; Weekday.Fri
<span style="color: #7590db;">Sat</span> =&gt; Weekday.Sat
</pre>
</div>
</div>

<div id="outline-container-org360bb0e" class="outline-5">
<h5 id="org360bb0e">Tips</h5>
<div class="outline-text-5" id="text-org360bb0e">
<p>
enum 支持直到 python 3.4 版本才添加进来.低于 3.4 版本时，使用 enum 必须安装 enum34.<br />
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992; pip &#23433;&#35013;</span>
pip install --upgrade pip enum34
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992; easy_install &#23433;&#35013;</span>
easy_install enum34
</pre>
</div>
</div>
</div>
<div id="outline-container-org7bbf893" class="outline-5">
<h5 id="org7bbf893">参考资料</h5>
<div class="outline-text-5" id="text-org7bbf893">
<ul class="org-ul">
<li><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191235886950998592cd3e426e91687cdae696e64b000/">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191235886950998592cd3e426e91687cdae696e64b000/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org338bca9" class="outline-4">
<h4 id="org338bca9">string</h4>
<div class="outline-text-4" id="text-org338bca9">
</div>
<div id="outline-container-orgea6afdc" class="outline-5">
<h5 id="orgea6afdc">format</h5>
<div class="outline-text-5" id="text-orgea6afdc">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9f8766;">"{} {}"</span>.<span style="color: #4f97d7;">format</span>(<span style="color: #9f8766;">"hello"</span>, <span style="color: #9f8766;">"world"</span>)        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">'hello world'</span>
 
<span style="color: #9f8766;">"{0} {1}"</span>.<span style="color: #4f97d7;">format</span>(<span style="color: #9f8766;">"hello"</span>, <span style="color: #9f8766;">"world"</span>)      <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">'hello world'</span>
 
<span style="color: #2d9574;">"{1} {0} {1}"</span>.<span style="color: #4f97d7;">format</span>(<span style="color: #2d9574;">"hello"</span>, <span style="color: #2d9574;">"world"</span>)  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">'world hello world'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org00fa4c0" class="outline-5">
<h5 id="org00fa4c0">list to string</h5>
<div class="outline-text-5" id="text-org00fa4c0">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">doc_content</span> = <span style="color: #2d9574;">''</span>.join(paragraph.text <span style="color: #4f97d7; font-weight: bold;">for</span> paragraph <span style="color: #4f97d7; font-weight: bold;">in</span> doc_file.paragraphs)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgea36c1d" class="outline-5">
<h5 id="orgea36c1d">任意类型对象的打印</h5>
<div class="outline-text-5" id="text-orgea36c1d">
<p>
利用 str() 函数将对象转化为适于人阅读的形式，然后打印。<br />
</p>
<ul class="org-ul">
<li><a href="http://www.runoob.com/python/python-func-str.html">http://www.runoob.com/python/python-func-str.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgf061bc0" class="outline-5">
<h5 id="orgf061bc0">参考资料</h5>
<div class="outline-text-5" id="text-orgf061bc0">
<p>
<a href="http://www.runoob.com/python/python-strings.html">http://www.runoob.com/python/python-strings.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-orge247d7b" class="outline-4">
<h4 id="orge247d7b">list</h4>
<div class="outline-text-4" id="text-orge247d7b">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21019;&#24314; List</span>
<span style="color: #7590db;">list1</span> = [<span style="color: #2d9574;">'physics'</span>, <span style="color: #2d9574;">'chemistry'</span>, 1997, 2000]
<span style="color: #7590db;">list2</span> = [1, 2, 3, 4, 5, 6, 7 ]
 
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#35775;&#38382;&#21015;&#34920;&#30340;&#20540;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">"list1[0]: "</span>, list1[0]
<span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">"list2[1:5]: "</span>, list2[1:5]
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">list1[0]:  physics</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">list2[1:5]:  [2, 3, 4, 5]</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#28155;&#21152;&#20803;&#32032;</span>
list1.append(3000)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21024;&#38500;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">del</span> list1[2]

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#33719;&#21462;&#21015;&#34920;&#38271;&#24230;</span>
<span style="color: #4f97d7;">len</span>(list1)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21015;&#34920;&#36830;&#25509;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>([1,2] + [<span style="color: #2d9574;">"name"</span>,<span style="color: #2d9574;">"age"</span>])
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">[1,2,"name","age"]</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21015;&#34920;&#25193;&#23637;</span>
<span style="color: #7590db;">aList</span> = [123, <span style="color: #2d9574;">'xyz'</span>, <span style="color: #2d9574;">'zara'</span>, <span style="color: #2d9574;">'abc'</span>, 123];
<span style="color: #7590db;">bList</span> = [2009, <span style="color: #2d9574;">'manni'</span>];
aList.extend(bList)
<span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">"Extended List : "</span>, aList ;
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Extended List :  [123, 'xyz', 'zara', 'abc', 123, 2009, 'manni']</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21028;&#26029;&#26159;&#21542;&#21253;&#21547;&#26576;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(3 <span style="color: #4f97d7; font-weight: bold;">in</span> [1, 2, 3])
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">True</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21015;&#34920;&#25130;&#21462;</span>
&gt;&gt;&gt;<span style="color: #7590db;">L</span> = [<span style="color: #2d9574;">'Google'</span>, <span style="color: #2d9574;">'Runoob'</span>, <span style="color: #2d9574;">'Taobao'</span>]
&gt;&gt;&gt; L[2]
<span style="color: #2d9574;">'Taobao'</span>
&gt;&gt;&gt; L[-2]
<span style="color: #2d9574;">'Runoob'</span>
&gt;&gt;&gt; L[1:]
[<span style="color: #2d9574;">'Runoob'</span>, <span style="color: #2d9574;">'Taobao'</span>]

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#36941;&#21382;&#21015;&#34920;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> x <span style="color: #4f97d7; font-weight: bold;">in</span> [1, 2, 3]: <span style="color: #4f97d7; font-weight: bold;">print</span> x
<span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(0,<span style="color: #4f97d7;">len</span>(xx_list)): <span style="color: #4f97d7; font-weight: bold;">print</span> xx_list[i]
</pre>
</div>
</div>
<div id="outline-container-orga96a74f" class="outline-5">
<h5 id="orga96a74f">参考资料</h5>
<div class="outline-text-5" id="text-orga96a74f">
<p>
<a href="http://www.runoob.com/python/python-lists.html">http://www.runoob.com/python/python-lists.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org2598fa8" class="outline-4">
<h4 id="org2598fa8">dict</h4>
<div class="outline-text-4" id="text-org2598fa8">
</div>
<div id="outline-container-orgae0dcdd" class="outline-5">
<h5 id="orgae0dcdd">增删改</h5>
<div class="outline-text-5" id="text-orgae0dcdd">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #4f97d7;">dict</span> = {<span style="color: #2d9574;">'Name'</span>: <span style="color: #2d9574;">'Zara'</span>, <span style="color: #2d9574;">'Age'</span>: 7, <span style="color: #2d9574;">'Class'</span>: <span style="color: #2d9574;">'First'</span>}

  <span style="color: #4f97d7;">dict</span>[<span style="color: #2d9574;">'School'</span>] = <span style="color: #2d9574;">"RUNOOB"</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#28155;&#21152;</span>
  <span style="color: #4f97d7;">dict</span>[<span style="color: #2d9574;">'Age'</span>] = 8 <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26356;&#26032;</span>

  <span style="color: #4f97d7; font-weight: bold;">del</span> <span style="color: #4f97d7;">dict</span>[<span style="color: #2d9574;">'Name'</span>]  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#38190;&#26159;'Name'&#30340;&#26465;&#30446;</span>
  <span style="color: #4f97d7;">dict</span>.clear()      <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#28165;&#31354;&#23383;&#20856;&#25152;&#26377;&#26465;&#30446;</span>
  <span style="color: #4f97d7; font-weight: bold;">del</span> <span style="color: #4f97d7;">dict</span>          <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#23383;&#20856;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3f0e6bc" class="outline-5">
<h5 id="org3f0e6bc">遍历 dict</h5>
<div class="outline-text-5" id="text-org3f0e6bc">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> k,v <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">dict</span>.items():
     <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"key:"</span>, k, <span style="color: #2d9574;">"value:"</span>, <span style="color: #4f97d7;">str</span>(v))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbd8eb03" class="outline-5">
<h5 id="orgbd8eb03">判断 key 是否存在</h5>
<div class="outline-text-5" id="text-orgbd8eb03">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python2</span>
xx_dict.has_key(xx_key)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python3</span>
xx_key <span style="color: #4f97d7; font-weight: bold;">in</span> xx_dict
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8481a68" class="outline-4">
<h4 id="org8481a68">正则表达式</h4>
<div class="outline-text-4" id="text-org8481a68">
</div>
<div id="outline-container-org2876c42" class="outline-5">
<h5 id="org2876c42">正则表达式模式</h5>
<div class="outline-text-5" id="text-org2876c42">
<p>
模式字符串使用特殊的语法来表示一个正则表达式：<br />
</p>

<p>
字母和数字表示他们自身。一个正则表达式模式中的字母和数字匹配同样的字符串。<br />
多数字母和数字前加一个反斜杠时会拥有不同的含义。<br />
标点符号只有被转义时才匹配自身，否则它们表示特殊的含义。<br />
反斜杠本身需要使用反斜杠转义。<br />
由于正则表达式通常都包含反斜杠，所以你最好使用原始字符串来表示它们。模式元素(如 r'\t'，等价于'\\t')匹配相应的特殊字符。<br />
</p>

<p>
下表列出了正则表达式模式语法中的特殊元素。如果你使用模式的同时提供了可选的标志参数，某些模式元素的含义会改变。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">模式</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">^</td>
<td class="org-left">匹配字符串的开头</td>
</tr>

<tr>
<td class="org-left">$</td>
<td class="org-left">匹配字符串的末尾。</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">匹配任意字符，除了换行符，当 re.DOTALL 标记被指定时，则可以匹配包括换行符的任意字符。</td>
</tr>

<tr>
<td class="org-left">[&#x2026;]</td>
<td class="org-left">用来表示一组字符,单独列出：[amk] 匹配 'a'，'m'或'k'</td>
</tr>

<tr>
<td class="org-left">[^&#x2026;]</td>
<td class="org-left">不在[]中的字符：[^abc] 匹配除了 a,b,c 之外的字符。</td>
</tr>

<tr>
<td class="org-left">re*</td>
<td class="org-left">匹配 0 个或多个的表达式。</td>
</tr>

<tr>
<td class="org-left">re+</td>
<td class="org-left">匹配 1 个或多个的表达式。</td>
</tr>

<tr>
<td class="org-left">re?</td>
<td class="org-left">匹配 0 个或 1 个由前面的正则表达式定义的片段，非贪婪方式</td>
</tr>

<tr>
<td class="org-left">re{ n}</td>
<td class="org-left">精确匹配 n 个前面表达式。例如，o{2} 不能匹配 "Bob" 中的 "o"，但是能匹配 "food" 中的两个 o。</td>
</tr>

<tr>
<td class="org-left">re{ n,}</td>
<td class="org-left">匹配 n 个前面表达式。例如，o{2,} 不能匹配"Bob"中的"o"，但能匹配 "foooood"中的所有 o。"o{1,}" 等价于 "o+"。"o{0,}" 则等价于 "o*"。</td>
</tr>

<tr>
<td class="org-left">re{ n, m}</td>
<td class="org-left">匹配 n 到 m 次由前面的正则表达式定义的片段，贪婪方式</td>
</tr>

<tr>
<td class="org-left">a &vert; b</td>
<td class="org-left">匹配 a 或 b</td>
</tr>

<tr>
<td class="org-left">(re)</td>
<td class="org-left">G 匹配括号内的表达式，也表示一个组</td>
</tr>

<tr>
<td class="org-left">(?imx)</td>
<td class="org-left">正则表达式包含三种可选标志：i, m, 或 x。只影响括号中的区域。</td>
</tr>

<tr>
<td class="org-left">(?-imx)</td>
<td class="org-left">正则表达式关闭 i, m, 或 x 可选标志。只影响括号中的区域。</td>
</tr>

<tr>
<td class="org-left">(?: re)</td>
<td class="org-left">类似 (&#x2026;), 但是不表示一个组</td>
</tr>

<tr>
<td class="org-left">(?imx: re)</td>
<td class="org-left">在括号中使用 i, m, 或 x 可选标志</td>
</tr>

<tr>
<td class="org-left">(?-imx: re)</td>
<td class="org-left">在括号中不使用 i, m, 或 x 可选标志</td>
</tr>

<tr>
<td class="org-left">(?#&#x2026;)</td>
<td class="org-left">注释.</td>
</tr>

<tr>
<td class="org-left">(?= re)</td>
<td class="org-left">前向肯定界定符。如果所含正则表达式，以 &#x2026; 表示，在当前位置成功匹配时成功，否则失败。但一旦所含表达式已经尝试，匹配引擎根本没有提高；模式的剩余部分还要尝试界定符的右边。</td>
</tr>

<tr>
<td class="org-left">(?! re)</td>
<td class="org-left">前向否定界定符。与肯定界定符相反；当所含表达式不能在字符串当前位置匹配时成功</td>
</tr>

<tr>
<td class="org-left">(?&gt; re)</td>
<td class="org-left">匹配的独立模式，省去回溯。</td>
</tr>

<tr>
<td class="org-left">\w</td>
<td class="org-left">匹配字母数字</td>
</tr>

<tr>
<td class="org-left">\W</td>
<td class="org-left">匹配非字母数字</td>
</tr>

<tr>
<td class="org-left">\s</td>
<td class="org-left">匹配任意空白字符，等价于 [\t\n\r\f].</td>
</tr>

<tr>
<td class="org-left"><code>\</code> S</td>
<td class="org-left">匹配任意非空字符</td>
</tr>

<tr>
<td class="org-left">\d</td>
<td class="org-left">匹配任意数字，等价于 [0-9].</td>
</tr>

<tr>
<td class="org-left">\D</td>
<td class="org-left">匹配任意非数字</td>
</tr>

<tr>
<td class="org-left">\A</td>
<td class="org-left">匹配字符串开始</td>
</tr>

<tr>
<td class="org-left">\Z</td>
<td class="org-left">匹配字符串结束，如果是存在换行，只匹配到换行前的结束字符串。c</td>
</tr>

<tr>
<td class="org-left">\z</td>
<td class="org-left">匹配字符串结束</td>
</tr>

<tr>
<td class="org-left">\G</td>
<td class="org-left">匹配最后匹配完成的位置。</td>
</tr>

<tr>
<td class="org-left">\b</td>
<td class="org-left">匹配一个单词边界，也就是指单词和空格间的位置。例如， 'er\b' 可以匹配"never" 中的 'er'，但不能匹配 "verb" 中的 'er'。</td>
</tr>

<tr>
<td class="org-left">\B</td>
<td class="org-left">匹配非单词边界。'er\B' 能匹配 "verb" 中的 'er'，但不能匹配 "never" 中的 'er'。</td>
</tr>

<tr>
<td class="org-left">\n, \t, 等.</td>
<td class="org-left">匹配一个换行符。匹配一个制表符。等</td>
</tr>

<tr>
<td class="org-left">\1&#x2026;\9</td>
<td class="org-left">匹配第 n 个分组的子表达式。</td>
</tr>

<tr>
<td class="org-left">\10</td>
<td class="org-left">匹配第 n 个分组的子表达式，如果它经匹配。否则指的是八进制字符码的表达式。</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org85054e6" class="outline-5">
<h5 id="org85054e6">Capture</h5>
<div class="outline-text-5" id="text-org85054e6">
<p>
(…)     正常分组，并捕获<br />
(?:…)   分组，但是不捕获<br />
</p>
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">m</span> = re.search(r<span style="color: #2d9574;">'^(\d{3,4}-)?(\d{7,8})$'</span>,<span style="color: #2d9574;">'020-82228888'</span>)
&gt;&gt;&gt; m.group(0)
<span style="color: #2d9574;">'020-82228888'</span>
&gt;&gt;&gt; m.group(1)
<span style="color: #2d9574;">'020-'</span>
&gt;&gt;&gt; m.group(2)
<span style="color: #2d9574;">'82228888'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org23202aa" class="outline-5">
<h5 id="org23202aa">正则表达式修饰符</h5>
<div class="outline-text-5" id="text-org23202aa">
<ul class="org-ul">
<li>re.M  正则表达式中的 re.M 表示将字符串视为多行,从而^匹配每一行的行首,$匹配每一行的行尾<br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf51ff36" class="outline-3">
<h3 id="orgf51ff36">文件目录操作</h3>
<div class="outline-text-3" id="text-orgf51ff36">
</div>
<div id="outline-container-org2457792" class="outline-4">
<h4 id="org2457792">目录、文件获取</h4>
<div class="outline-text-4" id="text-org2457792">
</div>
<div id="outline-container-org678f400" class="outline-5">
<h5 id="org678f400">工作目录 脚本目录</h5>
<div class="outline-text-5" id="text-org678f400">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#33050;&#26412;&#36816;&#34892;&#30446;&#24405; </span>
os.getcwd()

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#25913;&#21464;&#24403;&#21069;&#24037;&#20316;&#30446;&#24405;</span>
os.chdir(new_work_dir)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#33050;&#26412;&#25152;&#22312;&#30446;&#24405; </span>
os.path.split(os.path.realpath(__file__))[0]     

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#36335;&#24452;&#30340;&#26631;&#20934;&#36335;&#24452; &#20840;&#36335;&#24452;&#20999;&#20854;&#20013;&#19981;&#21547;&#26377;&#8220;./ ../&#8221;&#20043;&#31867;</span>
os.path.realpath(a_abs_path)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462; a_abs_path &#36335;&#24452;&#30456;&#23545;&#20110; b_abs_path &#36335;&#24452;&#30340;&#30456;&#23545;&#36335;&#24452;</span>
os.path.relpath(a_abs_path,b_abs_path)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">windows &#36335;&#24452;&#36716;&#20026; linux &#36335;&#24452;</span>
<span style="color: #7590db;">a_path</span> = os.path.realpath(a_path)
<span style="color: #7590db;">a_path</span> = a_path.replace(<span style="color: #2d9574;">"\\"</span>,<span style="color: #2d9574;">"/"</span>)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462; HOME &#30446;&#24405;</span>
<span style="color: #7590db;">usr_home</span> = os.path.expanduser(&#8217;~<span style="color: #2d9574;">')</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5087535" class="outline-5">
<h5 id="org5087535">获取目录名 文件名</h5>
<div class="outline-text-5" id="text-org5087535">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> os
<span style="color: #7590db;">f</span> = <span style="color: #2d9574;">"a/b/c/d.txt"</span>
<span style="color: #7590db;">name</span>, <span style="color: #7590db;">ext</span> = os.path.splitext(f)
<span style="color: #4f97d7; font-weight: bold;">print</span> name, ext                   <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">a/b/c/d .txt</span>
<span style="color: #4f97d7; font-weight: bold;">print</span> os.path.dirname(f)          <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">a/b/c</span>
<span style="color: #4f97d7; font-weight: bold;">print</span> os.path.basename(f)         <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">d.txt </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf6533c7" class="outline-5">
<h5 id="orgf6533c7">遍历目录下的文件和目录</h5>
<div class="outline-text-5" id="text-orgf6533c7">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #7590db;">file_dir_list</span> = os.listdir(<span style="color: #4f97d7;">dir</span>)
  <span style="color: #4f97d7; font-weight: bold;">for</span> file_or_dir <span style="color: #4f97d7; font-weight: bold;">in</span> file_dir_list:
      <span style="color: #7590db;">file_or_dir_abs_path</span> = os.path.join(<span style="color: #4f97d7;">dir</span>, file_or_dir)
      <span style="color: #4f97d7; font-weight: bold;">if</span> os.path.isfile(file_or_dir_abs_path):
          ProcessFile(file_or_dir_abs_path)
      <span style="color: #4f97d7; font-weight: bold;">else</span>:
          ProcessDir(file_or_dir_abs_path)
</pre>
</div>
</div>
</div>
<div id="outline-container-org0c7da9f" class="outline-5">
<h5 id="org0c7da9f">递归遍历目录中的文件</h5>
<div class="outline-text-5" id="text-org0c7da9f">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> parent_dir, dirs, files <span style="color: #4f97d7; font-weight: bold;">in</span> os.walk(ccsproj_res_abs_path):
    <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> files:
        ProcessResFile(os.path.join(parent_dir, <span style="color: #4f97d7;">file</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb1daa7c" class="outline-5">
<h5 id="orgb1daa7c">递归遍历目录中的目录</h5>
<div class="outline-text-5" id="text-orgb1daa7c">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> parent_dir,dirs,files <span style="color: #4f97d7; font-weight: bold;">in</span> os.walk(ccsproj_res_abs_path):
    <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">dir</span> <span style="color: #4f97d7; font-weight: bold;">in</span> dirs:
        ProcessDir(os.path.join(parent_dir,<span style="color: #4f97d7;">dir</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb23ef39" class="outline-5">
<h5 id="orgb23ef39">判断目录 文件是否存在</h5>
<div class="outline-text-5" id="text-orgb23ef39">
<div class="org-src-container">
<pre class="src src-python">os.path.exists(<span style="color: #4f97d7;">dir</span>-<span style="color: #4f97d7; font-weight: bold;">or</span>-<span style="color: #4f97d7;">file</span>-full-path)
os.path.isfile(<span style="color: #4f97d7;">file</span>-full-path)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5276ef8" class="outline-4">
<h4 id="org5276ef8">读写目录 文件</h4>
<div class="outline-text-4" id="text-org5276ef8">
</div>
<div id="outline-container-org5b949c4" class="outline-5">
<h5 id="org5b949c4">创建目录</h5>
<div class="outline-text-5" id="text-org5b949c4">
<div class="org-src-container">
<pre class="src src-python">os.makedirs(path) <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#22810;&#23618;&#30446;&#24405;</span>
os.mkdir(path)    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#23618;&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8071d39" class="outline-5">
<h5 id="org8071d39">读写文件</h5>
<div class="outline-text-5" id="text-org8071d39">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">op_file</span> = <span style="color: #4f97d7;">open</span>(<span style="color: #2d9574;">"op.txt"</span>, <span style="color: #2d9574;">"r"</span>)
<span style="color: #7590db;">lines</span> = op_file.readlines()
op_file.close()

<span style="color: #7590db;">op_file</span> = <span style="color: #4f97d7;">open</span>(<span style="color: #2d9574;">"op.txt"</span>, <span style="color: #2d9574;">"w"</span>)
op_file.write(<span style="color: #2d9574;">"You&#8217;re still goin&#8217; strong"</span>)
op_file.close()
</pre>
</div>
</div>
</div>
<div id="outline-container-org28193a2" class="outline-5">
<h5 id="org28193a2">修改文件编码</h5>
<div class="outline-text-5" id="text-org28193a2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python &#32534;&#30721;&#30456;&#20851;&#30340;&#24211;</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> chardet

<span style="color: #7590db;">f</span> = <span style="color: #4f97d7;">open</span>(oldname)
<span style="color: #7590db;">old_content</span> = f.read()
f.close()

<span style="color: #7590db;">old_coding</span> = chardet.detect(old_content)[<span style="color: #2d9574;">'encoding'</span>]
<span style="color: #7590db;">old_content</span> = old_content.decode(old_coding)

<span style="color: #7590db;">f</span> = <span style="color: #4f97d7;">open</span>(oldname, <span style="color: #2d9574;">'w'</span>)
<span style="color: #7590db;">new_content</span> = old_content.encode(new_coding)
f.write(new_content)
f.close()
</pre>
</div>
</div>
</div>
<div id="outline-container-org488040a" class="outline-5">
<h5 id="org488040a">修改文件名称</h5>
<div class="outline-text-5" id="text-org488040a">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">name</span>, <span style="color: #7590db;">ext</span> = os.path.splitext(<span style="color: #4f97d7;">file</span>)
<span style="color: #7590db;">newname</span> = os.path.join(root,name+<span style="color: #2d9574;">".md"</span>)
os.rename(oldname,newname)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf2b40ea" class="outline-5">
<h5 id="orgf2b40ea">移动文件和目录</h5>
<div class="outline-text-5" id="text-orgf2b40ea">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> shutil
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#31227;&#21160;&#25991;&#20214;&#65288;&#30446;&#24405;&#65289;</span>
shutil.move(<span style="color: #2d9574;">"oldpos"</span>,<span style="color: #2d9574;">"newpos"</span>) 
</pre>
</div>
</div>
</div>
<div id="outline-container-orgca28e2f" class="outline-5">
<h5 id="orgca28e2f">复制文件和目录</h5>
<div class="outline-text-5" id="text-orgca28e2f">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> shutil
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#22797;&#21046;&#25991;&#20214;:</span>
shutil.copy(<span style="color: #2d9574;">"oldfile"</span>,<span style="color: #2d9574;">"newfile&#8221;)     #oldfile &#21482;&#33021;&#26159;&#25991;&#20214;&#65292;newfile &#21487;&#20197;&#26159;&#25991;&#20214;&#65292;&#20063;&#21487;&#20197;&#26159;&#30446;&#26631;&#30446;&#24405;</span>
<span style="color: #2d9574;">shutil.copyfile("</span>oldfile<span style="color: #2d9574;">","</span>newfile<span style="color: #2d9574;">") #oldfile &#21644; newfile &#37117;&#21482;&#33021;&#26159;&#25991;&#20214;</span>

<span style="color: #2d9574;">#&#36882;&#24402; copy &#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#25991;&#20214;&#21644;&#30446;&#24405;:</span>
<span style="color: #2d9574;">shutil.copytree(src_dir,des_dir)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf89421e" class="outline-5">
<h5 id="orgf89421e">删除文件和目录</h5>
<div class="outline-text-5" id="text-orgf89421e">
<div class="org-src-container">
<pre class="src src-python">os.remove(<span style="color: #4f97d7;">file</span>)          <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#25991;&#20214;</span>
os.rmdir(empty_dir)      <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#31354;&#30446;&#24405;</span>
os.removedirs(root_dir)  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36882;&#24402;&#21024;&#38500;&#31354;&#30446;&#24405;</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> shutil
shutil.rmtree(root_dir)  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36882;&#24402;&#21024;&#38500;&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org1344d41" class="outline-3">
<h3 id="org1344d41">压缩相关操作</h3>
<div class="outline-text-3" id="text-org1344d41">
</div>
<div id="outline-container-org0c04eb1" class="outline-4">
<h4 id="org0c04eb1">zip</h4>
<div class="outline-text-4" id="text-org0c04eb1">
</div>
<div id="outline-container-orgfe1291c" class="outline-5">
<h5 id="orgfe1291c">zip directory</h5>
<div class="outline-text-5" id="text-orgfe1291c">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> os
<span style="color: #4f97d7; font-weight: bold;">import</span> zipfile

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">ZipDir</span>(src_dir_path, out_zipfile_path):
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> os.path.exists(src_dir_path):
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"source dir not exist! src_dir_path = "</span> + src_dir_path)
        <span style="color: #4f97d7; font-weight: bold;">return</span>

    <span style="color: #7590db;">zip_handler</span> = zipfile.ZipFile(out_zipfile_path, <span style="color: #2d9574;">'w'</span>)
    <span style="color: #7590db;">source_dir_len</span> = <span style="color: #4f97d7;">len</span>(os.path.dirname(src_dir_path))
    <span style="color: #4f97d7; font-weight: bold;">for</span> parent_dir, dirs, files <span style="color: #4f97d7; font-weight: bold;">in</span> os.walk(ccsproj_res_abs_path):
        <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> files:
            <span style="color: #7590db;">file_path</span> = os.path.join(parent_dir, <span style="color: #4f97d7;">file</span>)
            <span style="color: #7590db;">relative_path</span> = file_path[source_dir_len:].strip(os.path.sep)
            zip_handler.write(file_path, relative_path)
    zip_handler.close()

<span style="color: #7590db;">g_curPath</span> = os.path.split(os.path.realpath(__file__))[0]
ZipDir(g_curPath+<span style="color: #2d9574;">"/testx"</span>, g_curPath+<span style="color: #2d9574;">"/ttt.zip"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org9bb5024" class="outline-5">
<h5 id="org9bb5024">zip test password</h5>
<div class="outline-text-5" id="text-org9bb5024">
</div>
<div id="outline-container-org512f355" class="outline-6">
<h6 id="org512f355">zipfile</h6>
<div class="outline-text-6" id="text-org512f355">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-*- coding utf-8 -*-</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> argparse
<span style="color: #4f97d7; font-weight: bold;">import</span> zipfile


<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">is_pwd_correct</span>(archieve, some_file, pwd):
    <span style="color: #7590db;">is_correct</span> = <span style="color: #a45bad;">False</span>
    <span style="color: #4f97d7; font-weight: bold;">try</span>:
        <span style="color: #4f97d7;">file</span> = zfile.<span style="color: #4f97d7;">open</span>(some_file, mode=<span style="color: #2d9574;">"r"</span>, pwd=<span style="color: #4f97d7;">bytes</span>(pwd, <span style="color: #2d9574;">'utf-8'</span>))
        <span style="color: #7590db;">is_correct</span> = <span style="color: #a45bad;">True</span>
    <span style="color: #4f97d7; font-weight: bold;">except</span>:
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> is_correct


<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">__name__</span> == <span style="color: #2d9574;">"__main__"</span>:
    <span style="color: #7590db;">parser</span> = argparse.ArgumentParser(<span style="color: #2d9574;">"--file &lt;archive&gt;"</span> + <span style="color: #2d9574;">"--dict &lt;dictionary&gt;"</span>)

    parser.add_argument(
        <span style="color: #2d9574;">"-f"</span>, <span style="color: #2d9574;">"--file"</span>, dest=<span style="color: #2d9574;">"archieve"</span>, required=<span style="color: #a45bad;">True</span>, <span style="color: #4f97d7;">type</span>=<span style="color: #4f97d7;">str</span>, <span style="color: #4f97d7;">help</span>=<span style="color: #2d9574;">"Archieve file"</span>
    )
    <span style="color: #7590db;">args</span> = parser.parse_args()
    <span style="color: #4f97d7; font-weight: bold;">print</span>(args.archieve)

    <span style="color: #7590db;">zfile</span> = zipfile.ZipFile(args.archieve, <span style="color: #2d9574;">"r"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(is_pwd_correct(zfile, <span style="color: #2d9574;">"test-zipcrack.txt"</span>, b<span style="color: #2d9574;">"12332"</span>))
    <span style="color: #4f97d7; font-weight: bold;">print</span>(is_pwd_correct(zfile, <span style="color: #2d9574;">"test-zipcrack.txt"</span>, b<span style="color: #2d9574;">"123321"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdc7b77d" class="outline-6">
<h6 id="orgdc7b77d">subprocess</h6>
<div class="outline-text-6" id="text-orgdc7b77d">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">sys_command_list</span> = [<span style="color: #2d9574;">"7z"</span>]
sys_command_list.append(<span style="color: #2d9574;">"t"</span>)
sys_command_list.append(<span style="color: #2d9574;">"-p{}"</span>.<span style="color: #4f97d7;">format</span>(pwd))
sys_command_list.append(archieve)
<span style="color: #7590db;">result</span> = subprocess.call(sys_command_list, stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)
<span style="color: #4f97d7; font-weight: bold;">if</span> result == 0:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"pwd = "</span>, pwd)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org136f52e" class="outline-4">
<h4 id="org136f52e">7z</h4>
<div class="outline-text-4" id="text-org136f52e">
<div class="org-src-container">
<pre class="src src-python">
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org4a6cef9" class="outline-3">
<h3 id="org4a6cef9">解析命令行参数</h3>
<div class="outline-text-3" id="text-org4a6cef9">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#26696; 1</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> optparse <span style="color: #4f97d7; font-weight: bold;">import</span> OptionParser 
<span style="color: #7590db;">parser</span> = OptionParser(usage=<span style="color: #2d9574;">"%prog [options]"</span>)
parser.add_option(<span style="color: #2d9574;">"-m"</span>,<span style="color: #2d9574;">"--machine"</span>,action=<span style="color: #2d9574;">"store"</span>,<span style="color: #4f97d7;">type</span>=<span style="color: #2d9574;">"string"</span>,dest=<span style="color: #2d9574;">"machine"</span>,<span style="color: #4f97d7;">help</span>=<span style="color: #2d9574;">"the machine to be check"</span>)
parser.add_option(<span style="color: #2d9574;">"--OpenUnityProj"</span>, action=<span style="color: #2d9574;">"store"</span>, <span style="color: #4f97d7;">type</span>=<span style="color: #2d9574;">"string"</span>, dest=<span style="color: #2d9574;">"unity_proj_path_arr"</span>, <span style="color: #4f97d7;">help</span>=<span style="color: #2d9574;">"open multi unity projects!"</span>)
(options,args)=parser.parse_args()   
<span style="color: #4f97d7; font-weight: bold;">if</span> options.machine:        
    <span style="color: #4f97d7; font-weight: bold;">print</span> options.machine

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#26696; 2</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-*- coding: utf-8 -*-</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> sys

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">ShowHelper</span>():
    <span style="color: #7590db;">cmd_prefix</span> = <span style="color: #2d9574;">" python ./core_mgr.py "</span>
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"usage :"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i                     #init core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i (ec)emacs-config    #init core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i (se)spacemacs-elpa  #init spacemacs-elpa"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i (omz)ohmyzsh        #init ohmyzsh"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-u                     #update core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-u (se)spacemacs-elpa  #update spacemacs-elpa"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-c                     #commit core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-c (se)spacemacs-elpa  #commit spacemacs-elpa"</span>)
    <span style="color: #4f97d7; font-weight: bold;">pass</span>

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>():
    <span style="color: #4f97d7; font-weight: bold;">print</span>(sys.argv)
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">len</span>(sys.argv)&lt;2:
        ShowHelper()
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        <span style="color: #7590db;">opt_type</span> = sys.argv[1]
        <span style="color: #4f97d7; font-weight: bold;">if</span> opt_type==<span style="color: #2d9574;">"-i"</span>:
            <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">len</span>(sys.argv)==2:
                <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"++++ START INIT MY CORE"</span>)
                <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitEmacs()</span>
                <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitOhMyZsh()</span>
                <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"---- END INIT MY CORE"</span>)
            <span style="color: #4f97d7; font-weight: bold;">elif</span> <span style="color: #4f97d7;">len</span>(sys.argv)==3:
                <span style="color: #7590db;">opt_arg</span> = sys.argv[2]
                <span style="color: #4f97d7; font-weight: bold;">if</span> opt_arg==<span style="color: #2d9574;">"ec"</span>:
                    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitEmacsConfig()</span>
                    <span style="color: #4f97d7; font-weight: bold;">pass</span>
                <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_arg==<span style="color: #2d9574;">"se"</span>:
                    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitSpacemacsElpa()</span>
                    <span style="color: #4f97d7; font-weight: bold;">pass</span>
                <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_arg==<span style="color: #2d9574;">"omz"</span>:
                    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitOhMyZsh()</span>
                    <span style="color: #4f97d7; font-weight: bold;">pass</span>
                <span style="color: #4f97d7; font-weight: bold;">pass</span>
        <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_type==<span style="color: #2d9574;">"-u"</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"UNSUPPORT -u!"</span>)
        <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_type==<span style="color: #2d9574;">"-c"</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"UNSUPPORT -c!"</span>)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Logic Start</span>
<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">__name__</span> == <span style="color: #2d9574;">"__main__"</span>:
    main()
</pre>
</div>
</div>
</div>
<div id="outline-container-org7dee657" class="outline-3">
<h3 id="org7dee657">Ftp 上传文件</h3>
<div class="outline-text-3" id="text-org7dee657">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">FTPClient</span>(<span style="color: #4f97d7;">object</span>):
    <span style="color: #9f8766;">'''''</span>
<span style="color: #9f8766;">    @note: upload local file or dirs recursively to ftp server</span>
<span style="color: #9f8766;">    '''</span>
    <span style="color: #7590db;">_DataTypeFILE</span> = <span style="color: #2d9574;">'FILE'</span>
    <span style="color: #7590db;">_DataTypeDIR</span>  = <span style="color: #2d9574;">'DIR'</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp = <span style="color: #a45bad;">None</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__del__</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">pass</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">setFtpParams</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, ip, uname, pwd, port=21, timeout=60):
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ip = ip
        <span style="color: #4f97d7; font-weight: bold;">self</span>.uname = uname
        <span style="color: #4f97d7; font-weight: bold;">self</span>.pwd = pwd
        <span style="color: #4f97d7; font-weight: bold;">self</span>.port = port
        <span style="color: #4f97d7; font-weight: bold;">self</span>.timeout = timeout

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">initEnv</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #a45bad;">None</span>:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp = ftplib.FTP()
            <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">'### connect ftp server: %s ...'</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.ip
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.connect(<span style="color: #4f97d7; font-weight: bold;">self</span>.ip, <span style="color: #4f97d7; font-weight: bold;">self</span>.port, <span style="color: #4f97d7; font-weight: bold;">self</span>.timeout)
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.login(<span style="color: #4f97d7; font-weight: bold;">self</span>.uname, <span style="color: #4f97d7; font-weight: bold;">self</span>.pwd)
            <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.getwelcome()

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">clearEnv</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.close()
            <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">'### disconnect ftp server: %s!'</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.ip
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp = <span style="color: #a45bad;">None</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">uploadDir</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, localdir=<span style="color: #2d9574;">'./'</span>, remotedir=<span style="color: #2d9574;">'./'</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> os.path.isdir(localdir):
            <span style="color: #4f97d7; font-weight: bold;">return</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.cwd(remotedir)
        <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> os.listdir(localdir):
            <span style="color: #7590db;">src</span> = os.path.join(localdir, <span style="color: #4f97d7;">file</span>)
            <span style="color: #4f97d7; font-weight: bold;">if</span> os.path.isfile(src):
                <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadFile(src, <span style="color: #4f97d7;">file</span>)
            <span style="color: #4f97d7; font-weight: bold;">elif</span> os.path.isdir(src):
                <span style="color: #4f97d7; font-weight: bold;">try</span>:
                    <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.mkd(<span style="color: #4f97d7;">file</span>)
                <span style="color: #4f97d7; font-weight: bold;">except</span>:
                    sys.stderr.write(<span style="color: #2d9574;">'the dir is exists %s'</span> % <span style="color: #4f97d7;">file</span>)
                <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadDir(src, <span style="color: #4f97d7;">file</span>)
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.cwd(<span style="color: #2d9574;">'..'</span>)

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">uploadFile</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, localpath, remotepath=<span style="color: #2d9574;">'./'</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> os.path.isfile(localpath):
            <span style="color: #4f97d7; font-weight: bold;">return</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">'+++ upload %s to %s:%s'</span> % (localpath, <span style="color: #4f97d7; font-weight: bold;">self</span>.ip, remotepath)
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.storbinary(<span style="color: #2d9574;">'STOR '</span> + remotepath, <span style="color: #4f97d7;">open</span>(localpath, <span style="color: #2d9574;">'rb'</span>))

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__filetype</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, src):
        <span style="color: #4f97d7; font-weight: bold;">if</span> os.path.isfile(src):
            <span style="color: #7590db;">index</span> = src.rfind(<span style="color: #2d9574;">'\\'</span>)
            <span style="color: #4f97d7; font-weight: bold;">if</span> index == -1:
                <span style="color: #7590db;">index</span> = src.rfind(<span style="color: #2d9574;">'/'</span>)
            <span style="color: #4f97d7; font-weight: bold;">return</span> FTPClient._DataTypeFILE, src[index + 1:]
        <span style="color: #4f97d7; font-weight: bold;">elif</span> os.path.isdir(src):
            <span style="color: #4f97d7; font-weight: bold;">return</span> FTPClient._DataTypeDIR, <span style="color: #2d9574;">''</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">upload</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, src, des=<span style="color: #2d9574;">'/'</span>):
        <span style="color: #7590db;">filetype</span>, <span style="color: #7590db;">filename</span> = <span style="color: #4f97d7; font-weight: bold;">self</span>.__filetype(src)

        <span style="color: #4f97d7; font-weight: bold;">self</span>.initEnv()
        <span style="color: #4f97d7; font-weight: bold;">if</span> filetype == FTPClient._DataTypeDIR:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.srcDir = src
            <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadDir(<span style="color: #4f97d7; font-weight: bold;">self</span>.srcDir, des)
        <span style="color: #4f97d7; font-weight: bold;">elif</span> filetype == FTPClient._DataTypeFILE:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadFile(src, des+filename)
        <span style="color: #4f97d7; font-weight: bold;">self</span>.clearEnv()

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">UploadFileOrDir</span>():
    <span style="color: #7590db;">appDirPath</span> = g_projPath+<span style="color: #2d9574;">"/build/"</span>+g_platformType
    <span style="color: #7590db;">fileName</span> = g_appName+<span style="color: #2d9574;">"_"</span>+g_buildNO
    <span style="color: #7590db;">localFilePath</span> = <span style="color: #2d9574;">""</span>
    <span style="color: #7590db;">remoteDirPath</span> = <span style="color: #2d9574;">"/GameDistribution/HDX_Dev/"</span>+g_platformType+<span style="color: #2d9574;">"/"</span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> g_platformType == <span style="color: #2d9574;">"PC"</span>:
        <span style="color: #7590db;">fileName</span> = fileName + <span style="color: #2d9574;">".zip"</span>
    <span style="color: #4f97d7; font-weight: bold;">elif</span> g_platformType == <span style="color: #2d9574;">"IOS"</span>:
        <span style="color: #7590db;">fileName</span> = fileName + <span style="color: #2d9574;">".ipa"</span>
    <span style="color: #4f97d7; font-weight: bold;">elif</span> g_platformType == <span style="color: #2d9574;">"Android"</span>:
        <span style="color: #7590db;">fileName</span> = fileName + <span style="color: #2d9574;">".apk"</span>
    <span style="color: #7590db;">localFilePath</span> = g_projPath+<span style="color: #2d9574;">"/build/"</span>+fileName
    <span style="color: #7590db;">ftpClient</span> = FTPClient()
    ftpClient.setFtpParams(<span style="color: #2d9574;">'dd-pc'</span>, <span style="color: #2d9574;">'sa'</span>, <span style="color: #2d9574;">''</span>)
    LogInfo(<span style="color: #2d9574;">"upload local file = "</span> + localFilePath)
    LogInfo(<span style="color: #2d9574;">"upload remote dir = "</span> + remoteDirPath)
    ftpClient.upload(os.path.realpath(localFilePath), remoteDirPath)
</pre>
</div>
</div>
<div id="outline-container-org469c949" class="outline-4">
<h4 id="org469c949">参考链接：</h4>
<div class="outline-text-4" id="text-org469c949">
<ul class="org-ul">
<li><a href="http://effbot.org/librarybook/ftplib.htm">http://effbot.org/librarybook/ftplib.htm</a><br /></li>
<li><a href="http://blog.csdn.net/xudacheng06/article/details/13613647">http://blog.csdn.net/xudacheng06/article/details/13613647</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgf205129" class="outline-3">
<h3 id="orgf205129">subprocess 使用</h3>
<div class="outline-text-3" id="text-orgf205129">
</div>
<div id="outline-container-orge95ba94" class="outline-4">
<h4 id="orge95ba94">执行 svn 更新</h4>
<div class="outline-text-4" id="text-orge95ba94">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> subprocess

<span style="color: #7590db;">sys_command_list</span> = [<span style="color: #2d9574;">"svn"</span>]
sys_command_list.append(<span style="color: #2d9574;">"update"</span>)
sys_command_list.append(<span style="color: #2d9574;">"xxx/my-svn-path"</span>)
subprocess.call(sys_command_list)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd45afdb" class="outline-4">
<h4 id="orgd45afdb">获得文件夹属性</h4>
<div class="outline-text-4" id="text-orgd45afdb">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> subprocess

<span style="color: #7590db;">result</span> = subprocess.check_output(<span style="color: #2d9574;">"attrib "</span>+folder,shell=<span style="color: #a45bad;">True</span>)
<span style="color: #7590db;">result_list</span> = result.decode(<span style="color: #2d9574;">"utf-8"</span>).split(<span style="color: #2d9574;">' '</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org198246a" class="outline-3">
<h3 id="org198246a">面向对象编程</h3>
<div class="outline-text-3" id="text-org198246a">
</div>
<div id="outline-container-org44630aa" class="outline-4">
<h4 id="org44630aa">包</h4>
</div>
<div id="outline-container-orga2131c3" class="outline-4">
<h4 id="orga2131c3">模块</h4>
<div class="outline-text-4" id="text-orga2131c3">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">A.py</span>
  <span style="color: #7590db;">AElem</span> = 100

  <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">BElem</span>(): <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"BElem"</span>)

  <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">CElem</span>:
      <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
          <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"C init"</span>)

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1. &#24341;&#29992;&#21478;&#19968;&#20010;&#25991;&#20214; A.py &#20013;&#30340;&#20803;&#32032; AElem,&#20803;&#32032; BElem</span>
  <span style="color: #4f97d7; font-weight: bold;">import</span> AElem <span style="color: #4f97d7; font-weight: bold;">from</span> A
  <span style="color: #4f97d7; font-weight: bold;">import</span> BElem <span style="color: #4f97d7; font-weight: bold;">from</span> A
  <span style="color: #4f97d7; font-weight: bold;">import</span> CElem <span style="color: #4f97d7; font-weight: bold;">from</span> A

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2. &#24341;&#29992;&#21478;&#19968;&#20010;&#25991;&#20214; A.py &#20013;&#30340;&#25152;&#26377;&#31867;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 1 &#21487;&#20197;&#30452;&#25509;&#35775;&#38382; A &#20013;&#30340;&#20803;&#32032;</span>
  <span style="color: #4f97d7; font-weight: bold;">from</span> A <span style="color: #4f97d7; font-weight: bold;">import</span> *
  <span style="color: #4f97d7; font-weight: bold;">print</span>(AElem)

  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2 &#38656;&#35201;&#36890;&#36807; A &#26469;&#35775;&#38382; A &#20013;&#30340;&#20803;&#32032;</span>
  <span style="color: #4f97d7; font-weight: bold;">import</span> A
  <span style="color: #4f97d7; font-weight: bold;">print</span>(A.AElem)

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3. &#36890;&#36807; __all__ &#23450;&#20041;&#23548;&#20986;&#30340;&#27169;&#22359;&#20869;&#23481;</span>
  <span style="color: #4f97d7;">__all__</span> = [<span style="color: #2d9574;">'bar'</span>, <span style="color: #2d9574;">'baz'</span>]

  <span style="color: #7590db;">waz</span> = 5
  <span style="color: #7590db;">bar</span> = 10
  <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">baz</span>(): <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'baz'</span>

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4. &#20174;&#25351;&#23450;&#36335;&#24452; import &#27169;&#22359;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">https://stackoverflow.com/questions/67631/how-to-import-a-module-given-the-full-path</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python 3.5</span>
  <span style="color: #4f97d7; font-weight: bold;">import</span> importlib.util
  <span style="color: #7590db;">spec</span> = importlib.util.spec_from_file_location(<span style="color: #2d9574;">"module.name"</span>, <span style="color: #2d9574;">"/path/to/file.py"</span>)
  <span style="color: #7590db;">foo</span> = importlib.util.module_from_spec(spec)
  spec.loader.exec_module(foo)
  foo.MyClass()

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python 2</span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 1</span>
  <span style="color: #4f97d7; font-weight: bold;">import</span> imp
  <span style="color: #7590db;">gsvn</span> = imp.load_source(<span style="color: #2d9574;">"gsvn"</span>, os.path.realpath(os.path.dirname(__file__)) + <span style="color: #2d9574;">"/../gsvn.py"</span>)
  gsvn.update()

  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2</span>
  <span style="color: #4f97d7; font-weight: bold;">import</span> os
  <span style="color: #4f97d7; font-weight: bold;">import</span> imp
  imp.load_source(<span style="color: #2d9574;">"log"</span>, os.path.realpath(os.path.dirname(__file__)) + <span style="color: #2d9574;">"/../log.py"</span>)
  <span style="color: #4f97d7; font-weight: bold;">from</span> log <span style="color: #4f97d7; font-weight: bold;">import</span> *
  log_info(<span style="color: #2d9574;">"HelloWorld!"</span>)

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">5. &#38169;&#35823;&#30340; import &#27169;&#22359;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312; A.py &#29238;&#32423;&#30446;&#24405;&#20013;&#23384;&#22312; D.py&#65292;&#19979;&#38754;&#20195;&#30721;&#20986;&#38169;&#30340;&#21407;&#22240;&#22312;&#20110;&#65292;&#30456;&#23545;&#36335;&#24452; import &#21482;&#23545; package &#26377;&#25928;</span>

  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Error 1 :</span>
  <span style="color: #4f97d7; font-weight: bold;">import</span> ../D

  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Error 2 :</span>
  <span style="color: #4f97d7; font-weight: bold;">from</span> ../D <span style="color: #4f97d7; font-weight: bold;">import</span> *

  <span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Error 3 :</span>
  <span style="color: #4f97d7; font-weight: bold;">from</span> .. <span style="color: #4f97d7; font-weight: bold;">import</span> D
</pre>
</div>
</div>
</div>

<div id="outline-container-org0efc83d" class="outline-4">
<h4 id="org0efc83d">面向对象编程</h4>
<div class="outline-text-4" id="text-org0efc83d">
</div>
<div id="outline-container-org6f58f84" class="outline-5">
<h5 id="org6f58f84">python 的构造和析构函数为固定的名字。</h5>
<div class="outline-text-5" id="text-org6f58f84">
<div class="org-src-container">
<pre class="src src-python">  &#26500;&#36896;&#20989;&#25968;---------------------   __init__( <span style="color: #4f97d7; font-weight: bold;">self</span> )
  &#26512;&#26500;&#20989;&#25968;---------------------   __del__( <span style="color: #4f97d7; font-weight: bold;">self</span> )
</pre>
</div>
</div>
</div>
<div id="outline-container-org54c553e" class="outline-5">
<h5 id="org54c553e">python 的静态成员 静态成员函数 普通成员函数</h5>
<div class="outline-text-5" id="text-org54c553e">
<div class="org-src-container">
<pre class="src src-python">    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#25104;&#21592;&#21464;&#37327;&#23450;&#20041;&#22312;&#31867;&#20316;&#29992;&#22495;&#20013;:</span>
    <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Test</span>:
        <span style="color: #7590db;">static_var</span>=<span style="color: #2d9574;">""</span>
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#21442;&#25968;&#19981;&#21547; self:</span>
    @<span style="color: #4f97d7;">staticmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">StaticFunc1</span>():
        <span style="color: #2aa1ae; background-color: #292e34;">###</span>
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#21442;&#25968;&#19981;&#21547; self, &#21253;&#21547; cls &#26041;&#20415;&#35843;&#29992;&#20854;&#20182;&#38745;&#24577;&#20989;&#25968;:</span>
    @<span style="color: #4f97d7;">classmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">StaticFunc2</span>(cls):
        cls.StaticFunc1()
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26222;&#36890;&#25104;&#21592;&#20989;&#25968;&#31532;&#19968;&#20010;&#21442;&#25968;&#20026; self</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">MemberF</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #2aa1ae; background-color: #292e34;">###</span>
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1297ca4" class="outline-5">
<h5 id="org1297ca4">python 的封装（private public protected）</h5>
<div class="outline-text-5" id="text-org1297ca4">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31169;&#26377;&#30340;&#21464;&#37327;&#65306;</span>
  ```
  <span style="color: #4f97d7; font-weight: bold;">self</span>.__pvar
  ```
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31169;&#26377;&#30340;&#20989;&#25968;&#65306;</span>
  ```
  <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__pfunc</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
      <span style="color: #2aa1ae; background-color: #292e34;">###</span>
      <span style="color: #4f97d7; font-weight: bold;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9ac112d" class="outline-5">
<h5 id="org9ac112d">python 类的继承</h5>
<div class="outline-text-5" id="text-org9ac112d">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">A</span>:        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#31867; A</span>

  <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">B</span>:         <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#31867; B</span>

  <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">C</span>(A, B):   <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#32487;&#25215;&#31867; A &#21644; B</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8171b59" class="outline-5">
<h5 id="org8171b59">参考资料</h5>
<div class="outline-text-5" id="text-org8171b59">
<p>
Python 面向对象编程 <a href="http://www.runoob.com/python/python-object.html">http://www.runoob.com/python/python-object.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org7e4a642" class="outline-4">
<h4 id="org7e4a642">MISC</h4>
<div class="outline-text-4" id="text-org7e4a642">
<ol class="org-ol">
<li>脚本执行完暂停<br /></li>
</ol>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> os
os.system(<span style="color: #2d9574;">'pause'</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org18da572" class="outline-3">
<h3 id="org18da572">异常处理</h3>
<div class="outline-text-3" id="text-org18da572">
</div>
<div id="outline-container-org9cb9f0b" class="outline-4">
<h4 id="org9cb9f0b">通用异常错误打印</h4>
<div class="outline-text-4" id="text-org9cb9f0b">
<div class="org-src-container">
<pre class="src src-python">  <span style="color: #4f97d7; font-weight: bold;">try</span>:
      subprocess.check_output(cmd_str, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
  <span style="color: #4f97d7; font-weight: bold;">except</span> <span style="color: #ce537a; font-weight: bold;">Exception</span>, e:
      <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"ERROR: "</span> + e)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd2e4eb1" class="outline-4">
<h4 id="orgd2e4eb1">subprocess 异常处理</h4>
<div class="outline-text-4" id="text-orgd2e4eb1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">try</span>:
    subprocess.check_output(cmd_str, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
<span style="color: #4f97d7; font-weight: bold;">except</span> subprocess.CalledProcessError, e:
    log_error(<span style="color: #2d9574;">"output = "</span> + <span style="color: #4f97d7;">str</span>(e.output))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb947bac" class="outline-4">
<h4 id="orgb947bac">参考资料</h4>
<div class="outline-text-4" id="text-orgb947bac">
<ul class="org-ul">
<li><a href="http://www.runoob.com/python/python-exceptions.html">http://www.runoob.com/python/python-exceptions.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgdc26777" class="outline-3">
<h3 id="orgdc26777">Async Programming</h3>
<div class="outline-text-3" id="text-orgdc26777">
</div>
<div id="outline-container-org9b1b34b" class="outline-4">
<h4 id="org9b1b34b">Multi Threading</h4>
</div>
<div id="outline-container-org3b906aa" class="outline-4">
<h4 id="org3b906aa">Multi Processing</h4>
<div class="outline-text-4" id="text-org3b906aa">
</div>
<div id="outline-container-orgd48a8b4" class="outline-5">
<h5 id="orgd48a8b4">创建 cpu core 数量的进程</h5>
<div class="outline-text-5" id="text-orgd48a8b4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-*- coding utf-8 -*-</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> multiprocessing

<span style="color: #7590db;">data_list</span> = []

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">process_data</span>(lst, idx, NS):
    <span style="color: #4f97d7; font-weight: bold;">if</span> idx == 45:
        <span style="color: #7590db;">NS.is_find</span> = <span style="color: #a45bad;">True</span>
        <span style="color: #7590db;">NS.value</span> = idx
    <span style="color: #4f97d7; font-weight: bold;">print</span>(lst[idx])


<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">__name__</span> == <span style="color: #2d9574;">"__main__"</span>:
    <span style="color: #7590db;">manager</span> = multiprocessing.Manager()
    <span style="color: #7590db;">NS</span> = manager.Namespace()
    <span style="color: #7590db;">NS.is_find</span> = <span style="color: #a45bad;">False</span>
    <span style="color: #7590db;">NS.value</span> = -1

    <span style="color: #7590db;">cpu_core_count</span> = multiprocessing.cpu_count()
    <span style="color: #7590db;">processor_count</span> = <span style="color: #4f97d7;">max</span>(2, cpu_core_count - 2)
    <span style="color: #7590db;">pool</span> = multiprocessing.Pool(processor_count)

    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(200):
        data_list.append(<span style="color: #2d9574;">"hi"</span> + <span style="color: #4f97d7;">str</span>(i))

    <span style="color: #4f97d7; font-weight: bold;">print</span>(multiprocessing.cpu_count())

    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(200):
        pool.<span style="color: #4f97d7;">apply</span>(
            process_data,
            (
                data_list,
                i,
                NS,
            ),
        )

    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"============"</span>)
    pool.close()
    pool.join()
    <span style="color: #4f97d7; font-weight: bold;">print</span>(NS)
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga04687d" class="outline-5">
<h5 id="orga04687d">multiprocessing pool apply vs apply_async</h5>
<div class="outline-text-5" id="text-orga04687d">
<ul class="org-ul">
<li><a href="https://stackoverflow.com/questions/8533318/multiprocessing-pool-when-to-use-apply-apply-async-or-map">https://stackoverflow.com/questions/8533318/multiprocessing-pool-when-to-use-apply-apply-async-or-map</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb0c5f1f" class="outline-3">
<h3 id="orgb0c5f1f">World-Excel 处理</h3>
<div class="outline-text-3" id="text-orgb0c5f1f">
</div>
<div id="outline-container-org2040f43" class="outline-4">
<h4 id="org2040f43">安装使用的库</h4>
<div class="outline-text-4" id="text-org2040f43">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22788;&#29702; word &#25991;&#20214;&#30340;&#24211;</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">python2 &#23433;&#35013; docx</span>
pip install docx 
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">python3 &#23433;&#35013; python-docx</span>
pip install python-docx 
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35835; excel &#30340;&#24211;</span>
pip install xlrd
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20889; excel &#30340;&#24211;</span>
pip install xlwt
</pre>
</div>
</div>
</div>
<div id="outline-container-org8479a74" class="outline-4">
<h4 id="org8479a74">docx</h4>
<div class="outline-text-4" id="text-org8479a74">
</div>
<div id="outline-container-org1df1a88" class="outline-5">
<h5 id="org1df1a88">docx</h5>
<div class="outline-text-5" id="text-org1df1a88">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> docx

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_docx</span>(file_name):
    <span style="color: #7590db;">d</span> = docx.opendocx(file_name)
    <span style="color: #7590db;">doc</span> = docx.getdocumenttext(d)
    <span style="color: #4f97d7; font-weight: bold;">return</span> doc

<span style="color: #7590db;">doc</span> = get_docx(<span style="color: #2d9574;">'tt.docx'</span>)
<span style="color: #4f97d7; font-weight: bold;">print</span>(doc)  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#34892;&#25968;&#65306;1075</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> d <span style="color: #4f97d7; font-weight: bold;">in</span> doc[:5]:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(d) <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21360;&#21069; 5 &#34892;</span>

<span style="color: #2d9574;">'''&#36755;&#20986;&#65306;</span>
<span style="color: #2d9574;">&#19968;&#12289;&#34917;&#30410;&#20043;&#21058;</span>
<span style="color: #2d9574;">1&#65294;&#22235;&#21531;&#23376;&#27748;</span>
<span style="color: #2d9574;">&#22235;&#21531;&#23376;&#27748;&#20013;&#21644;&#20041;&#65292;&#21442;&#26415;&#33583;&#33491;&#29976;&#33609;&#27604;</span>
<span style="color: #2d9574;">&#30410;&#20197;&#22799;&#38472;&#21517;&#20845;&#21531;&#65292;&#31067;&#30192;&#34917;&#27668;&#38451;&#34394;&#39285;</span>
<span style="color: #2d9574;">&#38500;&#21364;&#21322;&#22799;&#21517;&#24322;&#21151;&#65292;&#25110;&#21152;&#39321;&#30722;&#32963;&#23506;&#20351;</span>
<span style="color: #2d9574;">'''</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4308366" class="outline-5">
<h5 id="org4308366">python-docx</h5>
<div class="outline-text-5" id="text-org4308366">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> docx
<span style="color: #4f97d7; font-weight: bold;">from</span> docx <span style="color: #4f97d7; font-weight: bold;">import</span> Document
<span style="color: #7590db;">path</span> = <span style="color: #2d9574;">"C:\\Users\\Administrator\\Desktop\\word.docx"</span>
<span style="color: #7590db;">document</span> = Document(path)
<span style="color: #4f97d7; font-weight: bold;">for</span> paragraph <span style="color: #4f97d7; font-weight: bold;">in</span> document.paragraphs:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(paragraph.text)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5bbfdba" class="outline-4">
<h4 id="org5bbfdba">xlrd</h4>
</div>
<div id="outline-container-org017e1f2" class="outline-4">
<h4 id="org017e1f2">xlwt</h4>
<div class="outline-text-4" id="text-org017e1f2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> xlwt

<span style="color: #7590db;">wb</span> = xlwt.Workbook(encoding = <span style="color: #2d9574;">'utf-8'</span>)
<span style="color: #7590db;">ws</span> = wb.add_sheet(<span style="color: #2d9574;">"Data"</span>, cell_overwrite_ok=<span style="color: #a45bad;">True</span>)
ws.write(0,0,<span style="color: #2d9574;">"row0 colum0 value"</span>)
ws.write(1,0,<span style="color: #2d9574;">"row1 colum0 value"</span>)
ws.save(<span style="color: #2d9574;">"test.xls"</span>)
</pre>
</div>
</div>

<div id="outline-container-orgdf2f411" class="outline-5">
<h5 id="orgdf2f411">xlwt 写入 Excel 文件后，打开时提示文件后缀错误</h5>
<div class="outline-text-5" id="text-orgdf2f411">
<p>
xlwt 只能写 xls 文件，不能写 xlsm 文件，所以保存文件时，后缀名应该使用 xls<br />
</p>
</div>
</div>
<div id="outline-container-org5123dcd" class="outline-5">
<h5 id="org5123dcd">ValueError: column index (256) not an int in range(256)</h5>
<div class="outline-text-5" id="text-org5123dcd">
<p>
xls 类型的文件，最大只支持 256 列，xlsm 文件可以支持更多列。改用 xlsmwriter 模块来实现写入 xlsm 文件。<br />
<a href="https://www.cnblogs.com/z-x-y/p/9639702.html">https://www.cnblogs.com/z-x-y/p/9639702.html</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdf57f4e" class="outline-4">
<h4 id="orgdf57f4e">xlsmwriter</h4>
<div class="outline-text-4" id="text-orgdf57f4e">
<p>
<a href="https://xlsxwriter.readthedocs.io/">https://xlsxwriter.readthedocs.io/</a><br />
</p>
</div>
<div id="outline-container-orga24dcc0" class="outline-5">
<h5 id="orga24dcc0">安装</h5>
<div class="outline-text-5" id="text-orga24dcc0">
<div class="org-src-container">
<pre class="src src-shell">pip install XlsxWriter
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdbd2375" class="outline-5">
<h5 id="orgdbd2375">使用</h5>
<div class="outline-text-5" id="text-orgdbd2375">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> xlsxwriter

<span style="color: #7590db;">wb</span> = xlsxwriter.Workbook(<span style="color: #2d9574;">"xxx.xlsx"</span>)
<span style="color: #7590db;">ws</span> = wb.add_worksheet()
<span style="color: #7590db;">row_num</span> = 1
<span style="color: #4f97d7; font-weight: bold;">for</span> row_id,row <span style="color: #4f97d7; font-weight: bold;">in</span> rows_dict.items():
    ws.write(row_num, 0, row_id)
    <span style="color: #4f97d7; font-weight: bold;">for</span> column_name,column_value <span style="color: #4f97d7; font-weight: bold;">in</span> row.items():
        <span style="color: #4f97d7; font-weight: bold;">if</span> column_name <span style="color: #4f97d7; font-weight: bold;">not</span> <span style="color: #4f97d7; font-weight: bold;">in</span> g_column_info_dict:
            <span style="color: #7590db;">g_column_info_dict</span>[column_name] = (g_column_counter, column_value[1])
            <span style="color: #7590db;">g_column_counter</span> = g_column_counter + 1
        <span style="color: #7590db;">column_num</span> = (g_column_info_dict[column_name])[0]
        ws.write(row_num,column_num, column_value[0])
    <span style="color: #7590db;">row_num</span> = row_num + 1
<span style="color: #4f97d7; font-weight: bold;">for</span> column_name,column_info <span style="color: #4f97d7; font-weight: bold;">in</span> g_column_info_dict.items():
    <span style="color: #7590db;">column_num</span> = column_info[0]
    ws.write(0, column_num, column_name+<span style="color: #2d9574;">"  "</span>+column_info[1])
wb.close()
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf40df58" class="outline-3">
<h3 id="orgf40df58">NetworkX</h3>
<div class="outline-text-3" id="text-orgf40df58">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23433;&#35013;</span>
pip install networkx
</pre>
</div>
<ul class="org-ul">
<li><a href="https://zhuanlan.zhihu.com/p/371818115">https://zhuanlan.zhihu.com/p/371818115</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgbf034b5" class="outline-3">
<h3 id="orgbf034b5">colour</h3>
<div class="outline-text-3" id="text-orgbf034b5">
</div>
<div id="outline-container-org27a51c8" class="outline-4">
<h4 id="org27a51c8">colour 基础</h4>
<div class="outline-text-4" id="text-org27a51c8">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23433;&#35013; colour</span>
pip install --user colour-science
pip install matplotlib
</pre>
</div>

<ul class="org-ul">
<li>colour github <a href="https://github.com/colour-science/colour">https://github.com/colour-science/colour</a><br /></li>
<li>colour doc <a href="https://colour.readthedocs.io/en/develop/">https://colour.readthedocs.io/en/develop/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orge2d2ddd" class="outline-4">
<h4 id="orge2d2ddd">plot matching function</h4>
<div class="outline-text-4" id="text-orge2d2ddd">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-*- coding: utf-8 -*-</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> colour

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">colour.plotting.plot_single_cmfs('CIE 1931 2 Degree Standard Observer')</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">colour.plotting.plot_single_cmfs('CIE 1964 10 Degree Standard Observer')</span>
colour.plotting.plot_single_cmfs(<span style="color: #2d9574;">'Wright &amp; Guild 1931 2 Degree RGB CMFs'</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#29992;&#30340;matching function &#22914;&#19979;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Stockman &amp; Sharpe 2 Degree Cone Fundamentals</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Stockman &amp; Sharpe 10 Degree Cone Fundamentals</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Wright &amp; Guild 1931 2 Degree RGB CMFs</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Stiles &amp; Burch 1955 2 Degree RGB CMFs</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Stiles &amp; Burch 1959 10 Degree RGB CMFs</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">CIE 1931 2 Degree Standard Observer</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">CIE 1964 10 Degree Standard Observer</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">CIE 2012 10 Degree Standard Observer</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">CIE 2012 2 Degree Standard Observer</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org210a760" class="outline-4">
<h4 id="org210a760">spd xyz rgb convert</h4>
<div class="outline-text-4" id="text-org210a760">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> colour
<span style="color: #4f97d7; font-weight: bold;">import</span> numpy <span style="color: #4f97d7; font-weight: bold;">as</span> np

<span style="color: #7590db;">cmfs</span> = (
    colour.MSDS_CMFS[<span style="color: #2d9574;">'CIE 1931 2 Degree Standard Observer'</span>].copy().align(colour.SpectralShape(360, 780, 10))
)
<span style="color: #7590db;">illuminant</span> = colour.SDS_ILLUMINANTS[<span style="color: #2d9574;">'D65'</span>].copy().align(cmfs.shape)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">XYZ-&gt;SPD</span>
<span style="color: #7590db;">XYZ</span> = np.array([1, 0, 0])
<span style="color: #7590db;">sd</span> = colour.XYZ_to_sd(XYZ, method=<span style="color: #2d9574;">'Jakob 2019'</span>, cmfs=cmfs, illuminant=illuminant)
colour.plotting.plot_single_sd(sd)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">SPD-&gt;XYZ</span>
<span style="color: #7590db;">sd</span> = colour.sd_constant(100)
<span style="color: #4f97d7; font-weight: bold;">print</span>(colour.sd_to_XYZ(sd, cmfs, illuminant))

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">wavelength-&gt;XYZ</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(colour.wavelength_to_XYZ(480, cmfs))

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">RGB-&gt;XYZ</span>
<span style="color: #7590db;">XYZ</span> = np.array([0.7347,0.2653, 1-0.7347-0.2653])
<span style="color: #7590db;">illuminant_XYZ</span> = np.array([0.34570, 0.35850])
<span style="color: #7590db;">illuminant_RGB</span> = np.array([0.31270, 0.32900])
<span style="color: #7590db;">mat_XYZ_to_RGB</span> = colour.RGB_COLOURSPACES[<span style="color: #2d9574;">'CIE RGB'</span>].matrix_XYZ_to_RGB
<span style="color: #7590db;">chromatic_adaptation_transform</span> = <span style="color: #2d9574;">'Bradford'</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(colour.XYZ_to_RGB(XYZ, illuminant_XYZ, illuminant_RGB, mat_XYZ_to_RGB, chromatic_adaptation_transform))
</pre>
</div>
</div>
</div>
<div id="outline-container-org5ff8bbf" class="outline-4">
<h4 id="org5ff8bbf">luminance radiance convert</h4>
<div class="outline-text-4" id="text-org5ff8bbf">
<ul class="org-ul">
<li><a href="https://www.optical-calculation.com/unit-conversions+photometry+luminance+radiance+conversion">https://www.optical-calculation.com/unit-conversions+photometry+luminance+radiance+conversion</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgcabc7d2" class="outline-4">
<h4 id="orgcabc7d2">plot SPD</h4>
<div class="outline-text-4" id="text-orgcabc7d2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26174;&#31034;SPD</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> colour

<span style="color: #7590db;">sd</span> = colour.sd_constant(100)
colour.plotting.plot_single_sd(sd)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org50aaa04" class="outline-2">
<h2 id="org50aaa04">Misc</h2>
<div class="outline-text-2" id="text-org50aaa04">
</div>
<div id="outline-container-org1219182" class="outline-3">
<h3 id="org1219182">python 版本管理器</h3>
<div class="outline-text-3" id="text-org1219182">
</div>
<div id="outline-container-org32c186f" class="outline-4">
<h4 id="org32c186f">pyen</h4>
<div class="outline-text-4" id="text-org32c186f">
<p>
如果已经安装了 python，可以将已经安装的 copy 到 d:/Applications/.pyenv/pyenv-win/versions 目录下，目录名称改为 python 版本号，便于识别不同版本。手动添加版本，需要执行如下操作<br />
</p>
<div class="org-src-container">
<pre class="src src-shell">pyenv rehash
</pre>
</div>
</div>
<div id="outline-container-orgd26569b" class="outline-5">
<h5 id="orgd26569b">安装</h5>
<div class="outline-text-5" id="text-orgd26569b">
</div>
<div id="outline-container-org638291d" class="outline-6">
<h6 id="org638291d">Windows 版本安装请参考下面官方链接：</h6>
<div class="outline-text-6" id="text-org638291d">
<p>
<a href="https://github.com/pyenv-win/pyenv-win">https://github.com/pyenv-win/pyenv-win</a><br />
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36890;&#36807;git&#23433;&#35013;</span>
git clone https://github.com/pyenv-win/pyenv-win.git D:<span style="color: #2d9574;">\.</span>pyenv

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#28155;&#21152; PYENV PYENV_HOME PYENV_ROOT &#29615;&#22659;&#21464;&#37327;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">D:\.pyenv\pyenv-win\</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#28155;&#21152;PATH&#29615;&#22659;&#21464;&#37327;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">D:\.pyenv\pyenv-win\bin</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">D:\.pyenv\pyenv-win\shims</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26356;&#26032; pyenv</span>
<span style="color: #4f97d7;">cd</span> D:<span style="color: #2d9574;">\.</span>pyenv
git pull
</pre>
</div>
</div>
</div>
<div id="outline-container-org3d86a53" class="outline-6">
<h6 id="org3d86a53">OSX</h6>
<div class="outline-text-6" id="text-org3d86a53">
<div class="org-src-container">
<pre class="src src-shell">brew install pyenv

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#28155;&#21152;PATH&#29615;&#22659;&#21464;&#37327;</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">zsh &#29992;&#25143;</span>
<span style="color: #4f97d7;">echo</span> <span style="color: #2d9574;">'export PYENV_ROOT="$HOME/.pyenv"'</span> &gt;&gt; ~/.zshrc
<span style="color: #4f97d7;">echo</span> <span style="color: #2d9574;">'export PATH="$PYENV_ROOT/bin:$PYENV_ROOT/shims:$PATH"'</span> &gt;&gt; ~/.zshrc
<span style="color: #4f97d7;">echo</span> <span style="color: #2d9574;">'eval "$(pyenv init -)"'</span> &gt;&gt; ~/.zshrc

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">bash &#29992;&#25143;</span>
<span style="color: #4f97d7;">echo</span> <span style="color: #2d9574;">'export PYENV_ROOT="$HOME/.pyenv"'</span> &gt;&gt; ~/.bashrc
<span style="color: #4f97d7;">echo</span> <span style="color: #2d9574;">'export PATH="$PYENV_ROOT/bin:$PYENV_ROOT/shims:$PATH"'</span> &gt;&gt; ~/.bashrc
<span style="color: #4f97d7;">echo</span> <span style="color: #2d9574;">'eval "$(pyenv init -)"'</span> &gt;&gt; ~/.bashrc

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">fish shell &#29992;&#25143;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#37197;&#32622; &#22312;shell&#20013;&#25191;&#34892;&#19979;&#38754;&#21629;&#20196;</span>
<span style="color: #4f97d7;">set</span> -Ux PYENV_ROOT $<span style="color: #7590db;">HOME</span>/.pyenv
<span style="color: #4f97d7;">set</span> -U fish_user_paths $<span style="color: #7590db;">PYENV_ROOT</span>/bin $<span style="color: #7590db;">fish_user_paths</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312; ~/.config/fish/config.fish &#25991;&#20214;&#20013;&#28155;&#21152;&#22914;&#19979;&#20004;&#34892;</span>
status is-interactive; and pyenv init --path | source
pyenv init - | source
</pre>
</div>
</div>
</div>
<div id="outline-container-orge239f95" class="outline-6">
<h6 id="orge239f95">其他版本</h6>
<div class="outline-text-6" id="text-orge239f95">
<p>
<a href="https://github.com/pyenv/pyenv">https://github.com/pyenv/pyenv</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org8bc45ae" class="outline-5">
<h5 id="org8bc45ae">使用</h5>
<div class="outline-text-5" id="text-org8bc45ae">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26597;&#30475;&#21487;&#23433;&#35013;python&#30340;&#25152;&#26377;&#29256;&#26412;</span>
pyenv install -l

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23433;&#35013;&#25351;&#23450;&#29256;&#26412;</span>
pyenv install 3.9.4

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26597;&#30475;&#24403;&#21069;&#29256;&#26412;&#20449;&#24687;</span>
pyenv versions

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622;&#24403;&#21069;&#20840;&#23616;&#20351;&#29992;&#30340;&#29256;&#26412;</span>
pyenv global 3.7.2

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622;&#39033;&#30446;&#23616;&#37096;&#29256;&#26412;</span>
pyenv local 3.7.2

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Alias &#21487;&#25191;&#34892;&#25991;&#20214;&#65288;&#27599;&#27425;&#23433;&#35013;&#21487;&#25191;&#34892;&#25991;&#20214;&#21518;&#65292;&#37117;&#38656;&#35201;&#25191;&#34892;&#35813;&#21629;&#20196;&#65289;</span>
pyenv rehash

</pre>
</div>
</div>
</div>
<div id="outline-container-org43cd1c1" class="outline-5">
<h5 id="org43cd1c1">错误处理</h5>
<div class="outline-text-5" id="text-org43cd1c1">
</div>
<div id="outline-container-org5194628" class="outline-6">
<h6 id="org5194628">pyenv Fatal error in launcher: Unable to create process using</h6>
<div class="outline-text-6" id="text-org5194628">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25191;&#34892;&#19979;&#38754;&#21629;&#20196;&#65292;&#25552;&#31034;&#22914;&#39064;&#38169;&#35823;</span>
pip install twisted
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#19979;&#38754;&#21629;&#20196;&#20195;&#26367;&#19978;&#38754;&#21629;&#20196;</span>
python -m pip install twisted
</pre>
</div>

<p>
<a href="https://stackoverflow.com/questions/24627525/fatal-error-in-launcher-unable-to-create-process-using-c-program-files-x86">https://stackoverflow.com/questions/24627525/fatal-error-in-launcher-unable-to-create-process-using-c-program-files-x86</a><br />
</p>
</div>
</div>
<div id="outline-container-orga3e65b4" class="outline-6">
<h6 id="orga3e65b4">安装可执行文件后找不到</h6>
<div class="outline-text-6" id="text-orga3e65b4">
<div class="org-src-container">
<pre class="src src-shell">pyenv rehash
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org3528ff7" class="outline-4">
<h4 id="org3528ff7">rbenv</h4>
<div class="outline-text-4" id="text-org3528ff7">
<p>
<a href="https://github.com/mislav/anyenv">https://github.com/mislav/anyenv</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org6f5d628" class="outline-3">
<h3 id="org6f5d628">python 编辑器</h3>
<div class="outline-text-3" id="text-org6f5d628">
</div>
<div id="outline-container-orgaaca52e" class="outline-4">
<h4 id="orgaaca52e">PyCharm</h4>
<div class="outline-text-4" id="text-orgaaca52e">
<p>
参考 InitMyCore 中 InitJetBrainsIDE 部分的配置方法<br />
</p>

<p>
<a href="https://www.jetbrains.com/pycharm">https://www.jetbrains.com/pycharm</a><br />
</p>
</div>
</div>
<div id="outline-container-org31fa7ff" class="outline-4">
<h4 id="org31fa7ff">emacs</h4>
<div class="outline-text-4" id="text-org31fa7ff">
<p>
参考 InitMyCore 中 python 部分的配置方法<br />
<a href="../tools/InitMyCore.html#org07a57e6">spacemacs python</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb9c41bd" class="outline-3">
<h3 id="orgb9c41bd">easy_install 安装插件</h3>
<div class="outline-text-3" id="text-orgb9c41bd">
<p>
安装 Python 后，easy_install 默认会被安装到 C:Python\Python27\Scripts 目录下<br />
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20999;&#25442;&#21040; eazy_install &#25152;&#22312;&#30340;&#30446;&#24405; &#25191;&#34892;&#19979;&#38754;&#21629;&#20196;</span>
easy_install.exe xlrd
</pre>
</div>
</div>
</div>
<div id="outline-container-orga460f4a" class="outline-3">
<h3 id="orga460f4a">pip 安装更新卸载插件</h3>
<div class="outline-text-3" id="text-orga460f4a">
<p>
安装 Python 后，pip 默认会被安装到 C:Python\Python27\Scripts 目录下<br />
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20999;&#25442;&#21040; pip &#25152;&#22312;&#30340;&#30446;&#24405; &#25191;&#34892;&#19979;&#38754;&#21629;&#20196;</span>
pip install pyinstaller
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26356;&#26032;</span>
pip install -U pyinstaller
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21368;&#36733;</span>
pip uninstall pyinstaller
</pre>
</div>
</div>
<div id="outline-container-org9dcab04" class="outline-4">
<h4 id="org9dcab04">Error 解决 ModuleNotFoundError: No module named 'pip'</h4>
<div class="outline-text-4" id="text-org9dcab04">
<p>
可以首先执行  python -m ensurepip  然后执行 python -m pip install &#x2013;upgrade pip  即可更新完毕。<br />
</p>

<ul class="org-ul">
<li><a href="https://blog.csdn.net/wwangfabei1989/article/details/80107147">https://blog.csdn.net/wwangfabei1989/article/details/80107147</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgab0e6a6" class="outline-3">
<h3 id="orgab0e6a6">离线安装插件</h3>
<div class="outline-text-3" id="text-orgab0e6a6">
</div>
<div id="outline-container-orgf3bd73d" class="outline-4">
<h4 id="orgf3bd73d">下载需要安装的插件</h4>
<div class="outline-text-4" id="text-orgf3bd73d">
<p>
在线搜索并下载你需要的第三方库：网址 <a href="https://pypi.org/project/">https://pypi.org/project/</a><br />
</p>
</div>
</div>
<div id="outline-container-orgd33bbc9" class="outline-4">
<h4 id="orgd33bbc9">安装插件</h4>
<div class="outline-text-4" id="text-orgd33bbc9">
<p>
安装 whl 包：pip install  **.whl（前提是要安装好 pip 和 wheel）<br />
安装 tar.gz 包：cd 到解压后路径,python setup.py install（安装 pip 和 wheel 都可以参照这种方法）<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org025c449" class="outline-3">
<h3 id="org025c449">将 python 脚本转化为 exe 可执行文件</h3>
<div class="outline-text-3" id="text-org025c449">
<div class="org-src-container">
<pre class="src src-shell">  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21253; python &#33050;&#26412;</span>
  pyinstaller yourprogram.py
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21253; python &#33050;&#26412;&#20026;&#19968;&#20010; exe &#25991;&#20214;</span>
  pyinstaller -F make_proto.py

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">pyinstaller &#25991;&#26723;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Pyinstaller &#29992;&#20110;&#25171;&#21253; Python</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23433;&#35013;&#21629;&#20196;&#65306;pip install PyInstaller</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21253;&#21629;&#20196;&#65306;pyinstaller -F -w myfile.py</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20837;&#21442;&#25968;&#30340;&#21547;&#20041;:</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-F &#34920;&#31034;&#29983;&#25104;&#21333;&#20010;&#21487;&#25191;&#34892;&#25991;&#20214;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-w &#34920;&#31034;&#21435;&#25481;&#25511;&#21046;&#21488;&#31383;&#21475;&#65292;&#36825;&#22312; GUI &#30028;&#38754;&#26102;&#38750;&#24120;&#26377;&#29992;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-p &#34920;&#31034;&#20320;&#33258;&#24049;&#33258;&#23450;&#20041;&#38656;&#35201;&#21152;&#36733;&#30340;&#31867;&#36335;&#24452;&#65292;&#19968;&#33324;&#24773;&#20917;&#19979;&#29992;&#19981;&#21040;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-i &#34920;&#31034;&#21487;&#25191;&#34892;&#25991;&#20214;&#30340;&#22270;&#26631; </span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Tips:</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-F &#21629;&#20196;&#29983;&#25104;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#22312;&#21551;&#21160;&#26102;&#20250;&#33457;&#24456;&#38271;&#26102;&#38388;&#12290;</span>
</pre>
</div>

<ul class="org-ul">
<li>官网 <a href="http://www.pyinstaller.org">http://www.pyinstaller.org</a><br /></li>
<li>文档 <a href="https://pyinstaller.readthedocs.io/en/stable/">https://pyinstaller.readthedocs.io/en/stable/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgd8d7457" class="outline-3">
<h3 id="orgd8d7457">修改 Python 脚本文件编码</h3>
<div class="outline-text-3" id="text-orgd8d7457">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;&#25991;&#20214;&#21069;&#21152;&#19979;&#38754;&#20195;&#30721;&#65306;</span>
 -*- coding: utf-8 -*- 
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
