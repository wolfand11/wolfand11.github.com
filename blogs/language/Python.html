<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-07-07 周二 20:18 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python Note</title>
<meta name="generator" content="Org mode" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
           <meta name="viewport" content="width=device-width, initial-scale=1" />
           <link rel="stylesheet" title="Standard" href="https://wolfand11.gitee.io/res/css/worg.css" type="text/css" />
           <link rel="alternate stylesheet" title="Zenburn" href="https://wolfand11.gitee.io/res/css/worg-zenburn.css" type="text/css" />
           <link rel="alternate stylesheet" title="Classic" href="https://wolfand11.gitee.io/res/css/worg-classic.css" type="text/css" />
           <link rel="icon" href="https://wolfand11.gitee.io/res/favicon.ico" type="image/ico" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://wolfand11.gitee.io"> HOME </a>
</div><div id="content">
<h1 class="title">Python Note</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd6bf731">Python Language</a>
<ul>
<li><a href="#orgb26a713">Python 编程</a>
<ul>
<li><a href="#orgc2471b8">for</a></li>
<li><a href="#org7a5aefd">枚举类型</a>
<ul>
<li><a href="#org3050011">Tips</a></li>
<li><a href="#orgbaa5e10">参考资料</a></li>
</ul>
</li>
<li><a href="#org34fe288">string</a>
<ul>
<li><a href="#orgcb5690e">list to string</a></li>
<li><a href="#orgcb03a12">任意类型对象的打印</a></li>
<li><a href="#org6cc8658">参考资料</a></li>
</ul>
</li>
<li><a href="#org85142ed">list</a>
<ul>
<li><a href="#org2054333">参考资料</a></li>
</ul>
</li>
<li><a href="#orgfc2f830">dict</a>
<ul>
<li><a href="#org8e1d972">遍历 dict</a></li>
<li><a href="#org8d548c8">判断 key 是否存在</a></li>
</ul>
</li>
<li><a href="#orgb22b3b6">正则表达式</a>
<ul>
<li><a href="#orgdf399c8">正则表达式模式</a></li>
<li><a href="#orgde292c5">Capture</a></li>
<li><a href="#org07bb5c6">正则表达式修饰符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdc7ac3c">文件目录操作</a>
<ul>
<li><a href="#orgcf74269">目录、文件获取</a>
<ul>
<li><a href="#orga229cc1">工作目录 脚本目录</a></li>
<li><a href="#orge833f1e">获取目录名 文件名</a></li>
<li><a href="#orgd4595d8">遍历目录下的文件和目录</a></li>
<li><a href="#orgfd79ceb">递归遍历目录中的文件</a></li>
<li><a href="#orgd71bedb">递归遍历目录中的目录</a></li>
<li><a href="#org05a8efc">判断目录 文件是否存在</a></li>
</ul>
</li>
<li><a href="#org03f5efd">读写目录 文件</a>
<ul>
<li><a href="#org384bd62">创建目录</a></li>
<li><a href="#org7b68205">读取文件</a></li>
<li><a href="#org78524c4">修改文件编码</a></li>
<li><a href="#org2971138">修改文件名称</a></li>
<li><a href="#orgf23ef36">移动文件和目录</a></li>
<li><a href="#orgd05a2d2">复制文件和目录</a></li>
<li><a href="#org6a407fd">删除文件和目录</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgc0a8b48">压缩文件夹</a></li>
<li><a href="#org346a08f">解析命令行参数</a></li>
<li><a href="#org7893c44">Ftp 上传文件</a>
<ul>
<li><a href="#orgede2540">参考链接：</a></li>
</ul>
</li>
<li><a href="#org699bf5f">subprocess 使用</a>
<ul>
<li><a href="#org54c18da">执行 svn 更新</a></li>
<li><a href="#org900054f">获得文件夹属性</a></li>
</ul>
</li>
<li><a href="#org9253567">面向对象编程</a>
<ul>
<li><a href="#orgd0da6bb">包</a></li>
<li><a href="#org838893c">模块</a></li>
<li><a href="#orgf812331">面向对象编程</a>
<ul>
<li><a href="#org1bbd381">python 的构造和析构函数为固定的名字。</a></li>
<li><a href="#orgd0c2328">python 的静态成员 静态成员函数 普通成员函数</a></li>
<li><a href="#org2f535a4">python 的封装（private public protected）</a></li>
<li><a href="#org81af89a">python 类的继承</a></li>
<li><a href="#org6bd2f79">参考资料</a></li>
</ul>
</li>
<li><a href="#org0d67e56">MISC</a></li>
</ul>
</li>
<li><a href="#orga5c7e2d">异常处理</a>
<ul>
<li><a href="#orgc83102c">通用异常错误打印</a></li>
<li><a href="#org479db4c">subprocess 异常处理</a></li>
<li><a href="#orgfe58fd6">参考资料</a></li>
</ul>
</li>
<li><a href="#org99d7f14">World-Excel 处理</a>
<ul>
<li><a href="#org1bb6eab">安装使用的库</a></li>
<li><a href="#org376ea47">docx</a>
<ul>
<li><a href="#orgdc6cf97">docx</a></li>
<li><a href="#org67da6ee">python-docx</a></li>
</ul>
</li>
<li><a href="#org200f4ab">xlrd</a></li>
<li><a href="#orgd9b9df2">xlwt</a>
<ul>
<li><a href="#org1cf6438">xlwt 写入 Excel 文件后，打开时提示文件后缀错误</a></li>
<li><a href="#org4230393">ValueError: column index (256) not an int in range(256)</a></li>
</ul>
</li>
<li><a href="#org383fd3d">xlsmwriter</a>
<ul>
<li><a href="#org240074c">安装</a></li>
<li><a href="#orgb3ded38">使用</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd3a1c8a">Misc</a>
<ul>
<li><a href="#org6aa2ee6">python 版本管理器</a>
<ul>
<li><a href="#org515673f">pyen</a>
<ul>
<li><a href="#org65861b0">安装</a></li>
<li><a href="#org0e782ce">使用</a></li>
<li><a href="#org4b869e1">错误处理</a>
<ul>
<li><a href="#org974061a">pyenv Fatal error in launcher: Unable to create process using</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org229c502">rbenv</a></li>
</ul>
</li>
<li><a href="#org89e0fde">python 编辑器</a>
<ul>
<li><a href="#org14c45b4">PyCharm</a></li>
</ul>
</li>
<li><a href="#org1d3e96e">easy_install 安装插件</a></li>
<li><a href="#org787edfc">pip 安装插件</a></li>
<li><a href="#org59a014c">离线安装插件</a>
<ul>
<li><a href="#orgba57c9d">下载需要安装的插件</a></li>
<li><a href="#orgf31b1c7">安装插件</a></li>
</ul>
</li>
<li><a href="#orgb99e977">将 python 脚本转化为 exe 可执行文件</a></li>
<li><a href="#org52024ca">修改 Python 脚本文件编码</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
python note.<br />
</p>
<div class="HTML">
<p>
&lt;!&#x2013; more &#x2013;&gt;<br />
</p>

</div>
<div id="outline-container-orgd6bf731" class="outline-2">
<h2 id="orgd6bf731">Python Language</h2>
<div class="outline-text-2" id="text-orgd6bf731">
</div>
<div id="outline-container-orgb26a713" class="outline-3">
<h3 id="orgb26a713">Python 编程</h3>
<div class="outline-text-3" id="text-orgb26a713">
</div>
<div id="outline-container-orgc2471b8" class="outline-4">
<h4 id="orgc2471b8">for</h4>
<div class="outline-text-4" id="text-orgc2471b8">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(1,10,2):
    <span style="color: #4f97d7; font-weight: bold;">print</span>(i)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">output: 1 3 5 7 9</span>

<span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> [1,2,3]:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(i)
</pre>
</div>
</div>
</div>
<div id="outline-container-org7a5aefd" class="outline-4">
<h4 id="org7a5aefd">枚举类型</h4>
<div class="outline-text-4" id="text-org7a5aefd">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#31181;&#26041;&#24335;</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> enum <span style="color: #4f97d7; font-weight: bold;">import</span> Enum
<span style="color: #7590db;">Month</span> = Enum(<span style="color: #2d9574;">'Month'</span>, (<span style="color: #2d9574;">'Jan'</span>, <span style="color: #2d9574;">'Feb'</span>, <span style="color: #2d9574;">'Mar'</span>, <span style="color: #2d9574;">'Apr'</span>, <span style="color: #2d9574;">'May'</span>, <span style="color: #2d9574;">'Jun'</span>, <span style="color: #2d9574;">'Jul'</span>, <span style="color: #2d9574;">'Aug'</span>, <span style="color: #2d9574;">'Sep'</span>, <span style="color: #2d9574;">'Oct'</span>, <span style="color: #2d9574;">'Nov'</span>, <span style="color: #2d9574;">'Dec'</span>))

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#24341;&#29992;&#19968;&#20010;&#24120;&#37327;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(Month.Jan)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36941;&#21382;&#26522;&#20030;&#30340;&#25152;&#26377;&#25104;&#21592;&#65306;</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> name, member <span style="color: #4f97d7; font-weight: bold;">in</span> Month.__members__.items():
    <span style="color: #4f97d7; font-weight: bold;">print</span>(name, <span style="color: #2d9574;">'=&gt;'</span>, member, <span style="color: #2d9574;">','</span>, member.value)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#31181;&#26041;&#24335;</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> enum <span style="color: #4f97d7; font-weight: bold;">import</span> Enum, unique

<span style="color: #ce537a; font-weight: bold;">@unique</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Weekday</span>(Enum):
    <span style="color: #7590db;">Sun</span> = 0 <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Sun &#30340; value &#34987;&#35774;&#23450;&#20026; 0</span>
    <span style="color: #7590db;">Mon</span> = 1
    <span style="color: #7590db;">Tue</span> = 2
    <span style="color: #7590db;">Wed</span> = 3
    <span style="color: #7590db;">Thu</span> = 4
    <span style="color: #7590db;">Fri</span> = 5
    <span style="color: #7590db;">Sat</span> = 6

&gt;&gt;&gt; <span style="color: #7590db;">day1</span> = Weekday.Mon
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1)
Weekday.Mon
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday.Tue)
Weekday.Tue
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday[<span style="color: #2d9574;">'Tue'</span>])
Weekday.Tue
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday.Tue.value)
2
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1 == Weekday.Mon)
<span style="color: #a45bad;">True</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1 == Weekday.Tue)
<span style="color: #a45bad;">False</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(Weekday(1))
Weekday.Mon
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span>(day1 == Weekday(1))
<span style="color: #a45bad;">True</span>
&gt;&gt;&gt; Weekday(7)
Traceback (most recent call last):
  ...
<span style="color: #ce537a; font-weight: bold;">ValueError</span>: 7 <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #4f97d7; font-weight: bold;">not</span> a valid Weekday
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">for</span> name, member <span style="color: #4f97d7; font-weight: bold;">in</span> Weekday.__members__.items():
...     <span style="color: #4f97d7; font-weight: bold;">print</span>(name, <span style="color: #2d9574;">'=&gt;'</span>, member)
...
<span style="color: #7590db;">Sun</span> =&gt; Weekday.Sun
<span style="color: #7590db;">Mon</span> =&gt; Weekday.Mon
<span style="color: #7590db;">Tue</span> =&gt; Weekday.Tue
<span style="color: #7590db;">Wed</span> =&gt; Weekday.Wed
<span style="color: #7590db;">Thu</span> =&gt; Weekday.Thu
<span style="color: #7590db;">Fri</span> =&gt; Weekday.Fri
<span style="color: #7590db;">Sat</span> =&gt; Weekday.Sat
</pre>
</div>
</div>

<div id="outline-container-org3050011" class="outline-5">
<h5 id="org3050011">Tips</h5>
<div class="outline-text-5" id="text-org3050011">
<p>
enum 支持直到 python 3.4 版本才添加进来.低于 3.4 版本时，使用 enum 必须安装 enum34.<br />
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992; pip &#23433;&#35013;</span>
pip install --upgrade pip enum34
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992; easy_install &#23433;&#35013;</span>
easy_install enum34
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbaa5e10" class="outline-5">
<h5 id="orgbaa5e10">参考资料</h5>
<div class="outline-text-5" id="text-orgbaa5e10">
<ul class="org-ul">
<li><a href="https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191235886950998592cd3e426e91687cdae696e64b000/">https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/00143191235886950998592cd3e426e91687cdae696e64b000/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org34fe288" class="outline-4">
<h4 id="org34fe288">string</h4>
<div class="outline-text-4" id="text-org34fe288">
</div>
<div id="outline-container-orgcb5690e" class="outline-5">
<h5 id="orgcb5690e">list to string</h5>
<div class="outline-text-5" id="text-orgcb5690e">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">doc_content</span> = <span style="color: #2d9574;">''</span>.join(paragraph.text <span style="color: #4f97d7; font-weight: bold;">for</span> paragraph <span style="color: #4f97d7; font-weight: bold;">in</span> doc_file.paragraphs)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcb03a12" class="outline-5">
<h5 id="orgcb03a12">任意类型对象的打印</h5>
<div class="outline-text-5" id="text-orgcb03a12">
<p>
利用 str() 函数将对象转化为适于人阅读的形式，然后打印。<br />
</p>
<ul class="org-ul">
<li><a href="http://www.runoob.com/python/python-func-str.html">http://www.runoob.com/python/python-func-str.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org6cc8658" class="outline-5">
<h5 id="org6cc8658">参考资料</h5>
<div class="outline-text-5" id="text-org6cc8658">
<p>
<a href="http://www.runoob.com/python/python-strings.html">http://www.runoob.com/python/python-strings.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org85142ed" class="outline-4">
<h4 id="org85142ed">list</h4>
<div class="outline-text-4" id="text-org85142ed">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21019;&#24314; List</span>
<span style="color: #7590db;">list1</span> = [<span style="color: #2d9574;">'physics'</span>, <span style="color: #2d9574;">'chemistry'</span>, 1997, 2000]
<span style="color: #7590db;">list2</span> = [1, 2, 3, 4, 5, 6, 7 ]

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#35775;&#38382;&#21015;&#34920;&#30340;&#20540;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">"list1[0]: "</span>, list1[0]
<span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">"list2[1:5]: "</span>, list2[1:5]
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">list1[0]:  physics</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">list2[1:5]:  [2, 3, 4, 5]</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#28155;&#21152;&#20803;&#32032;</span>
list1.append(3000)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21024;&#38500;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">del</span> list1[2]

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#33719;&#21462;&#21015;&#34920;&#38271;&#24230;</span>
<span style="color: #4f97d7;">len</span>(list1)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21015;&#34920;&#36830;&#25509;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>([1,2] + [<span style="color: #2d9574;">"name"</span>,<span style="color: #2d9574;">"age"</span>])
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">[1,2,"name","age"]</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21015;&#34920;&#25193;&#23637;</span>
<span style="color: #7590db;">aList</span> = [123, <span style="color: #2d9574;">'xyz'</span>, <span style="color: #2d9574;">'zara'</span>, <span style="color: #2d9574;">'abc'</span>, 123];
<span style="color: #7590db;">bList</span> = [2009, <span style="color: #2d9574;">'manni'</span>];
aList.extend(bList)
<span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">"Extended List : "</span>, aList ;
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Extended List :  [123, 'xyz', 'zara', 'abc', 123, 2009, 'manni']</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21028;&#26029;&#26159;&#21542;&#21253;&#21547;&#26576;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">print</span>(3 <span style="color: #4f97d7; font-weight: bold;">in</span> [1, 2, 3])
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#32467;&#26524;:</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">True</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#21015;&#34920;&#25130;&#21462;</span>
&gt;&gt;&gt;<span style="color: #7590db;">L</span> = [<span style="color: #2d9574;">'Google'</span>, <span style="color: #2d9574;">'Runoob'</span>, <span style="color: #2d9574;">'Taobao'</span>]
&gt;&gt;&gt; L[2]
<span style="color: #2d9574;">'Taobao'</span>
&gt;&gt;&gt; L[-2]
<span style="color: #2d9574;">'Runoob'</span>
&gt;&gt;&gt; L[1:]
[<span style="color: #2d9574;">'Runoob'</span>, <span style="color: #2d9574;">'Taobao'</span>]

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-- &#36941;&#21382;&#21015;&#34920;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> x <span style="color: #4f97d7; font-weight: bold;">in</span> [1, 2, 3]: <span style="color: #4f97d7; font-weight: bold;">print</span> x
<span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span>(0,<span style="color: #4f97d7;">len</span>(xx_list)): <span style="color: #4f97d7; font-weight: bold;">print</span> xx_list[i]
</pre>
</div>
</div>
<div id="outline-container-org2054333" class="outline-5">
<h5 id="org2054333">参考资料</h5>
<div class="outline-text-5" id="text-org2054333">
<p>
<a href="http://www.runoob.com/python/python-lists.html">http://www.runoob.com/python/python-lists.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgfc2f830" class="outline-4">
<h4 id="orgfc2f830">dict</h4>
<div class="outline-text-4" id="text-orgfc2f830">
</div>
<div id="outline-container-org8e1d972" class="outline-5">
<h5 id="org8e1d972">遍历 dict</h5>
<div class="outline-text-5" id="text-org8e1d972">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> k,v <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">dict</span>.items():
     <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"key:"</span>, k, <span style="color: #2d9574;">"value:"</span>, <span style="color: #4f97d7;">str</span>(v))
</pre>
</div>
</div>
</div>
<div id="outline-container-org8d548c8" class="outline-5">
<h5 id="org8d548c8">判断 key 是否存在</h5>
<div class="outline-text-5" id="text-org8d548c8">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python2</span>
xx_dict.has_key(xx_key)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python3</span>
xx_key <span style="color: #4f97d7; font-weight: bold;">in</span> xx_dict
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb22b3b6" class="outline-4">
<h4 id="orgb22b3b6">正则表达式</h4>
<div class="outline-text-4" id="text-orgb22b3b6">
</div>
<div id="outline-container-orgdf399c8" class="outline-5">
<h5 id="orgdf399c8">正则表达式模式</h5>
<div class="outline-text-5" id="text-orgdf399c8">
<p>
模式字符串使用特殊的语法来表示一个正则表达式：<br />
</p>

<p>
字母和数字表示他们自身。一个正则表达式模式中的字母和数字匹配同样的字符串。<br />
多数字母和数字前加一个反斜杠时会拥有不同的含义。<br />
标点符号只有被转义时才匹配自身，否则它们表示特殊的含义。<br />
反斜杠本身需要使用反斜杠转义。<br />
由于正则表达式通常都包含反斜杠，所以你最好使用原始字符串来表示它们。模式元素(如 r'\t'，等价于'\\t')匹配相应的特殊字符。<br />
</p>

<p>
下表列出了正则表达式模式语法中的特殊元素。如果你使用模式的同时提供了可选的标志参数，某些模式元素的含义会改变。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">模式</th>
<th scope="col" class="org-left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">^</td>
<td class="org-left">匹配字符串的开头</td>
</tr>

<tr>
<td class="org-left">$</td>
<td class="org-left">匹配字符串的末尾。</td>
</tr>

<tr>
<td class="org-left">.</td>
<td class="org-left">匹配任意字符，除了换行符，当 re.DOTALL 标记被指定时，则可以匹配包括换行符的任意字符。</td>
</tr>

<tr>
<td class="org-left">[&#x2026;]</td>
<td class="org-left">用来表示一组字符,单独列出：[amk] 匹配 'a'，'m'或'k'</td>
</tr>

<tr>
<td class="org-left">[^&#x2026;]</td>
<td class="org-left">不在[]中的字符：[^abc] 匹配除了 a,b,c 之外的字符。</td>
</tr>

<tr>
<td class="org-left">re*</td>
<td class="org-left">匹配 0 个或多个的表达式。</td>
</tr>

<tr>
<td class="org-left">re+</td>
<td class="org-left">匹配 1 个或多个的表达式。</td>
</tr>

<tr>
<td class="org-left">re?</td>
<td class="org-left">匹配 0 个或 1 个由前面的正则表达式定义的片段，非贪婪方式</td>
</tr>

<tr>
<td class="org-left">re{ n}</td>
<td class="org-left">精确匹配 n 个前面表达式。例如，o{2} 不能匹配 "Bob" 中的 "o"，但是能匹配 "food" 中的两个 o。</td>
</tr>

<tr>
<td class="org-left">re{ n,}</td>
<td class="org-left">匹配 n 个前面表达式。例如，o{2,} 不能匹配"Bob"中的"o"，但能匹配 "foooood"中的所有 o。"o{1,}" 等价于 "o+"。"o{0,}" 则等价于 "o*"。</td>
</tr>

<tr>
<td class="org-left">re{ n, m}</td>
<td class="org-left">匹配 n 到 m 次由前面的正则表达式定义的片段，贪婪方式</td>
</tr>

<tr>
<td class="org-left">a &vert; b</td>
<td class="org-left">匹配 a 或 b</td>
</tr>

<tr>
<td class="org-left">(re)</td>
<td class="org-left">G 匹配括号内的表达式，也表示一个组</td>
</tr>

<tr>
<td class="org-left">(?imx)</td>
<td class="org-left">正则表达式包含三种可选标志：i, m, 或 x。只影响括号中的区域。</td>
</tr>

<tr>
<td class="org-left">(?-imx)</td>
<td class="org-left">正则表达式关闭 i, m, 或 x 可选标志。只影响括号中的区域。</td>
</tr>

<tr>
<td class="org-left">(?: re)</td>
<td class="org-left">类似 (&#x2026;), 但是不表示一个组</td>
</tr>

<tr>
<td class="org-left">(?imx: re)</td>
<td class="org-left">在括号中使用 i, m, 或 x 可选标志</td>
</tr>

<tr>
<td class="org-left">(?-imx: re)</td>
<td class="org-left">在括号中不使用 i, m, 或 x 可选标志</td>
</tr>

<tr>
<td class="org-left">(?#&#x2026;)</td>
<td class="org-left">注释.</td>
</tr>

<tr>
<td class="org-left">(?= re)</td>
<td class="org-left">前向肯定界定符。如果所含正则表达式，以 &#x2026; 表示，在当前位置成功匹配时成功，否则失败。但一旦所含表达式已经尝试，匹配引擎根本没有提高；模式的剩余部分还要尝试界定符的右边。</td>
</tr>

<tr>
<td class="org-left">(?! re)</td>
<td class="org-left">前向否定界定符。与肯定界定符相反；当所含表达式不能在字符串当前位置匹配时成功</td>
</tr>

<tr>
<td class="org-left">(?&gt; re)</td>
<td class="org-left">匹配的独立模式，省去回溯。</td>
</tr>

<tr>
<td class="org-left">\w</td>
<td class="org-left">匹配字母数字</td>
</tr>

<tr>
<td class="org-left">\W</td>
<td class="org-left">匹配非字母数字</td>
</tr>

<tr>
<td class="org-left">\s</td>
<td class="org-left">匹配任意空白字符，等价于 [\t\n\r\f].</td>
</tr>

<tr>
<td class="org-left"><code>\</code> S</td>
<td class="org-left">匹配任意非空字符</td>
</tr>

<tr>
<td class="org-left">\d</td>
<td class="org-left">匹配任意数字，等价于 [0-9].</td>
</tr>

<tr>
<td class="org-left">\D</td>
<td class="org-left">匹配任意非数字</td>
</tr>

<tr>
<td class="org-left">\A</td>
<td class="org-left">匹配字符串开始</td>
</tr>

<tr>
<td class="org-left">\Z</td>
<td class="org-left">匹配字符串结束，如果是存在换行，只匹配到换行前的结束字符串。c</td>
</tr>

<tr>
<td class="org-left">\z</td>
<td class="org-left">匹配字符串结束</td>
</tr>

<tr>
<td class="org-left">\G</td>
<td class="org-left">匹配最后匹配完成的位置。</td>
</tr>

<tr>
<td class="org-left">\b</td>
<td class="org-left">匹配一个单词边界，也就是指单词和空格间的位置。例如， 'er\b' 可以匹配"never" 中的 'er'，但不能匹配 "verb" 中的 'er'。</td>
</tr>

<tr>
<td class="org-left">\B</td>
<td class="org-left">匹配非单词边界。'er\B' 能匹配 "verb" 中的 'er'，但不能匹配 "never" 中的 'er'。</td>
</tr>

<tr>
<td class="org-left">\n, \t, 等.</td>
<td class="org-left">匹配一个换行符。匹配一个制表符。等</td>
</tr>

<tr>
<td class="org-left">\1&#x2026;\9</td>
<td class="org-left">匹配第 n 个分组的子表达式。</td>
</tr>

<tr>
<td class="org-left">\10</td>
<td class="org-left">匹配第 n 个分组的子表达式，如果它经匹配。否则指的是八进制字符码的表达式。</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgde292c5" class="outline-5">
<h5 id="orgde292c5">Capture</h5>
<div class="outline-text-5" id="text-orgde292c5">
<p>
(…)     正常分组，并捕获<br />
(?:…)   分组，但是不捕获<br />
</p>
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">m</span> = re.search(r<span style="color: #2d9574;">'^(\d{3,4}-)?(\d{7,8})$'</span>,<span style="color: #2d9574;">'020-82228888'</span>)
&gt;&gt;&gt; m.group(0)
<span style="color: #2d9574;">'020-82228888'</span>
&gt;&gt;&gt; m.group(1)
<span style="color: #2d9574;">'020-'</span>
&gt;&gt;&gt; m.group(2)
<span style="color: #2d9574;">'82228888'</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org07bb5c6" class="outline-5">
<h5 id="org07bb5c6">正则表达式修饰符</h5>
<div class="outline-text-5" id="text-org07bb5c6">
<ul class="org-ul">
<li>re.M  正则表达式中的 re.M 表示将字符串视为多行,从而^匹配每一行的行首,$匹配每一行的行尾<br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgdc7ac3c" class="outline-3">
<h3 id="orgdc7ac3c">文件目录操作</h3>
<div class="outline-text-3" id="text-orgdc7ac3c">
</div>
<div id="outline-container-orgcf74269" class="outline-4">
<h4 id="orgcf74269">目录、文件获取</h4>
<div class="outline-text-4" id="text-orgcf74269">
</div>
<div id="outline-container-orga229cc1" class="outline-5">
<h5 id="orga229cc1">工作目录 脚本目录</h5>
<div class="outline-text-5" id="text-orga229cc1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#33050;&#26412;&#36816;&#34892;&#30446;&#24405; </span>
os.getcwd()

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#25913;&#21464;&#24403;&#21069;&#24037;&#20316;&#30446;&#24405;</span>
os.chdir(new_work_dir)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#33050;&#26412;&#25152;&#22312;&#30446;&#24405; </span>
os.path.split(os.path.realpath(__file__))[0]     

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462;&#36335;&#24452;&#30340;&#26631;&#20934;&#36335;&#24452; &#20840;&#36335;&#24452;&#20999;&#20854;&#20013;&#19981;&#21547;&#26377;&#8220;./ ../&#8221;&#20043;&#31867;</span>
os.path.realpath(a_abs_path)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462; a_abs_path &#36335;&#24452;&#30456;&#23545;&#20110; b_abs_path &#36335;&#24452;&#30340;&#30456;&#23545;&#36335;&#24452;</span>
os.path.relpath(a_abs_path,b_abs_path)

<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">windows &#36335;&#24452;&#36716;&#20026; linux &#36335;&#24452;</span>
<span style="color: #7590db;">a_path</span> = os.path.realpath(a_path)
a_path.replace(<span style="color: #2d9574;">"\\"</span>,<span style="color: #2d9574;">"/"</span>)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#33719;&#21462; HOME &#30446;&#24405;</span>
<span style="color: #7590db;">usr_home</span> = os.path.expanduser(&#8217;~<span style="color: #2d9574;">')</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge833f1e" class="outline-5">
<h5 id="orge833f1e">获取目录名 文件名</h5>
<div class="outline-text-5" id="text-orge833f1e">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> os
<span style="color: #7590db;">f</span> = <span style="color: #2d9574;">"a/b/c/d.txt"</span>
<span style="color: #7590db;">name</span>, <span style="color: #7590db;">ext</span> = os.path.splitext(f)
<span style="color: #4f97d7; font-weight: bold;">print</span> name, ext                   <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">a/b/c/d .txt</span>
<span style="color: #4f97d7; font-weight: bold;">print</span> os.path.dirname(f)          <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">a/b/c</span>
<span style="color: #4f97d7; font-weight: bold;">print</span> os.path.basename(f)         <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">d.txt </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd4595d8" class="outline-5">
<h5 id="orgd4595d8">遍历目录下的文件和目录</h5>
<div class="outline-text-5" id="text-orgd4595d8">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">file_dir_list</span> = os.listdir(<span style="color: #4f97d7;">dir</span>)
<span style="color: #4f97d7; font-weight: bold;">for</span> file_or_dir <span style="color: #4f97d7; font-weight: bold;">in</span> file_dir_list:
    <span style="color: #7590db;">file_or_dir_abs_path</span> = os.path.join(<span style="color: #4f97d7;">dir</span>, file_or_dir)
    <span style="color: #4f97d7; font-weight: bold;">if</span> os.path.isfile(file_or_dir_abs_path):
        ProcessFile(file_or_dir_abs_path)
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        ProcessDir(file_or_dir_abs_path)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfd79ceb" class="outline-5">
<h5 id="orgfd79ceb">递归遍历目录中的文件</h5>
<div class="outline-text-5" id="text-orgfd79ceb">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> parent_dir, dirs, files <span style="color: #4f97d7; font-weight: bold;">in</span> os.walk(ccsproj_res_abs_path):
    <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> files:
        ProcessResFile(os.path.join(parent_dir, <span style="color: #4f97d7;">file</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd71bedb" class="outline-5">
<h5 id="orgd71bedb">递归遍历目录中的目录</h5>
<div class="outline-text-5" id="text-orgd71bedb">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">for</span> parent_dir,dirs,files <span style="color: #4f97d7; font-weight: bold;">in</span> os.walk(ccsproj_res_abs_path):
    <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">dir</span> <span style="color: #4f97d7; font-weight: bold;">in</span> dirs:
        ProcessDir(os.path.join(parent_dir,<span style="color: #4f97d7;">dir</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org05a8efc" class="outline-5">
<h5 id="org05a8efc">判断目录 文件是否存在</h5>
<div class="outline-text-5" id="text-org05a8efc">
<div class="org-src-container">
<pre class="src src-python">os.path.exists(<span style="color: #4f97d7;">dir</span>-<span style="color: #4f97d7; font-weight: bold;">or</span>-<span style="color: #4f97d7;">file</span>-full-path)
os.path.isfile(<span style="color: #4f97d7;">file</span>-full-path)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org03f5efd" class="outline-4">
<h4 id="org03f5efd">读写目录 文件</h4>
<div class="outline-text-4" id="text-org03f5efd">
</div>
<div id="outline-container-org384bd62" class="outline-5">
<h5 id="org384bd62">创建目录</h5>
<div class="outline-text-5" id="text-org384bd62">
<div class="org-src-container">
<pre class="src src-python">os.makedirs(path) <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#22810;&#23618;&#30446;&#24405;</span>
os.mkdir(path)    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#23618;&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7b68205" class="outline-5">
<h5 id="org7b68205">读取文件</h5>
<div class="outline-text-5" id="text-org7b68205">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">output</span> = <span style="color: #4f97d7;">open</span>(<span style="color: #2d9574;">"op.txt"</span>, <span style="color: #2d9574;">"w"</span>)
output.write(<span style="color: #2d9574;">"You&#8217;re still goin&#8217; strong"</span>)
output.close()
</pre>
</div>
</div>
</div>
<div id="outline-container-org78524c4" class="outline-5">
<h5 id="org78524c4">修改文件编码</h5>
<div class="outline-text-5" id="text-org78524c4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python &#32534;&#30721;&#30456;&#20851;&#30340;&#24211;</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> chardet

<span style="color: #7590db;">f</span> = <span style="color: #4f97d7;">open</span>(oldname)
<span style="color: #7590db;">old_content</span> = f.read()
f.close()

<span style="color: #7590db;">old_coding</span> = chardet.detect(old_content)[<span style="color: #2d9574;">'encoding'</span>]
<span style="color: #7590db;">old_content</span> = old_content.decode(old_coding)

<span style="color: #7590db;">f</span> = <span style="color: #4f97d7;">open</span>(oldname, <span style="color: #2d9574;">'w'</span>)
<span style="color: #7590db;">new_content</span> = old_content.encode(new_coding)
f.write(new_content)
f.close()
</pre>
</div>
</div>
</div>
<div id="outline-container-org2971138" class="outline-5">
<h5 id="org2971138">修改文件名称</h5>
<div class="outline-text-5" id="text-org2971138">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">name</span>, <span style="color: #7590db;">ext</span> = os.path.splitext(<span style="color: #4f97d7;">file</span>)
<span style="color: #7590db;">newname</span> = os.path.join(root,name+<span style="color: #2d9574;">".md"</span>)
os.rename(oldname,newname)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf23ef36" class="outline-5">
<h5 id="orgf23ef36">移动文件和目录</h5>
<div class="outline-text-5" id="text-orgf23ef36">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> shutil
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#31227;&#21160;&#25991;&#20214;&#65288;&#30446;&#24405;&#65289;</span>
shutil.move(<span style="color: #2d9574;">"oldpos"</span>,<span style="color: #2d9574;">"newpos"</span>) 
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd05a2d2" class="outline-5">
<h5 id="orgd05a2d2">复制文件和目录</h5>
<div class="outline-text-5" id="text-orgd05a2d2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> shutil
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#22797;&#21046;&#25991;&#20214;:</span>
shutil.copy(<span style="color: #2d9574;">"oldfile"</span>,<span style="color: #2d9574;">"newfile&#8221;)     #oldfile &#21482;&#33021;&#26159;&#25991;&#20214;&#65292;newfile &#21487;&#20197;&#26159;&#25991;&#20214;&#65292;&#20063;&#21487;&#20197;&#26159;&#30446;&#26631;&#30446;&#24405;</span>
<span style="color: #2d9574;">shutil.copyfile("</span>oldfile<span style="color: #2d9574;">","</span>newfile<span style="color: #2d9574;">") #oldfile &#21644; newfile &#37117;&#21482;&#33021;&#26159;&#25991;&#20214;</span>

<span style="color: #2d9574;">#&#36882;&#24402; copy &#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#25991;&#20214;&#21644;&#30446;&#24405;:</span>
<span style="color: #2d9574;">shutil.copytree(src_dir,des_dir)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6a407fd" class="outline-5">
<h5 id="org6a407fd">删除文件和目录</h5>
<div class="outline-text-5" id="text-org6a407fd">
<div class="org-src-container">
<pre class="src src-python">os.remove(<span style="color: #4f97d7;">file</span>)          <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#25991;&#20214;</span>
os.rmdir(empty_dir)      <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21024;&#38500;&#31354;&#30446;&#24405;</span>
os.removedirs(root_dir)  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36882;&#24402;&#21024;&#38500;&#31354;&#30446;&#24405;</span>

<span style="color: #4f97d7; font-weight: bold;">import</span> shutil
shutil.rmtree(root_dir)  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36882;&#24402;&#21024;&#38500;&#30446;&#24405;&#19979;&#30340;&#25152;&#26377;&#25991;&#20214;&#21644;&#30446;&#24405;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc0a8b48" class="outline-3">
<h3 id="orgc0a8b48">压缩文件夹</h3>
<div class="outline-text-3" id="text-orgc0a8b48">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> os
<span style="color: #4f97d7; font-weight: bold;">import</span> zipfile

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">ZipDir</span>(src_dir_path, out_zipfile_path):
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> os.path.exists(src_dir_path):
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"source dir not exist! src_dir_path = "</span> + src_dir_path)
        <span style="color: #4f97d7; font-weight: bold;">return</span>

    <span style="color: #7590db;">zip_handler</span> = zipfile.ZipFile(out_zipfile_path, <span style="color: #2d9574;">'w'</span>)
    <span style="color: #7590db;">source_dir_len</span> = <span style="color: #4f97d7;">len</span>(os.path.dirname(src_dir_path))
    <span style="color: #4f97d7; font-weight: bold;">for</span> parent_dir, dirs, files <span style="color: #4f97d7; font-weight: bold;">in</span> os.walk(ccsproj_res_abs_path):
        <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> files:
            <span style="color: #7590db;">file_path</span> = os.path.join(parent_dir, <span style="color: #4f97d7;">file</span>)
            <span style="color: #7590db;">relative_path</span> = file_path[source_dir_len:].strip(os.path.sep)
            zip_handler.write(file_path, relative_path)
    zip_handler.close()


<span style="color: #7590db;">g_curPath</span> = os.path.split(os.path.realpath(__file__))[0]
ZipDir(g_curPath+<span style="color: #2d9574;">"/testx"</span>, g_curPath+<span style="color: #2d9574;">"/ttt.zip"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org346a08f" class="outline-3">
<h3 id="org346a08f">解析命令行参数</h3>
<div class="outline-text-3" id="text-org346a08f">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#26696; 1</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> optparse <span style="color: #4f97d7; font-weight: bold;">import</span> OptionParser 
<span style="color: #7590db;">parser</span> = OptionParser(usage=<span style="color: #2d9574;">"%prog [options]"</span>)
parser.add_option(<span style="color: #2d9574;">"-m"</span>,<span style="color: #2d9574;">"--machine"</span>,action=<span style="color: #2d9574;">"store"</span>,<span style="color: #4f97d7;">type</span>=<span style="color: #2d9574;">"string"</span>,dest=<span style="color: #2d9574;">"machine"</span>,<span style="color: #4f97d7;">help</span>=<span style="color: #2d9574;">"the machine to be check"</span>)
parser.add_option(<span style="color: #2d9574;">"--OpenUnityProj"</span>, action=<span style="color: #2d9574;">"store"</span>, <span style="color: #4f97d7;">type</span>=<span style="color: #2d9574;">"string"</span>, dest=<span style="color: #2d9574;">"unity_proj_path_arr"</span>, <span style="color: #4f97d7;">help</span>=<span style="color: #2d9574;">"open multi unity projects!"</span>)
(options,args)=parser.parse_args()   
<span style="color: #4f97d7; font-weight: bold;">if</span> options.machine:        
    <span style="color: #4f97d7; font-weight: bold;">print</span> options.machine

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#26696; 2</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-*- coding: utf-8 -*-</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> sys

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">ShowHelper</span>():
    <span style="color: #7590db;">cmd_prefix</span> = <span style="color: #2d9574;">" python ./core_mgr.py "</span>
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"usage :"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i                     #init core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i (ec)emacs-config    #init core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i (se)spacemacs-elpa  #init spacemacs-elpa"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-i (omz)ohmyzsh        #init ohmyzsh"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-u                     #update core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-u (se)spacemacs-elpa  #update spacemacs-elpa"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-c                     #commit core"</span>)
    <span style="color: #4f97d7; font-weight: bold;">print</span>(cmd_prefix+<span style="color: #2d9574;">"-c (se)spacemacs-elpa  #commit spacemacs-elpa"</span>)
    <span style="color: #4f97d7; font-weight: bold;">pass</span>

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>():
    <span style="color: #4f97d7; font-weight: bold;">print</span>(sys.argv)
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">len</span>(sys.argv)&lt;2:
        ShowHelper()
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        <span style="color: #7590db;">opt_type</span> = sys.argv[1]
        <span style="color: #4f97d7; font-weight: bold;">if</span> opt_type==<span style="color: #2d9574;">"-i"</span>:
            <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">len</span>(sys.argv)==2:
                <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"++++ START INIT MY CORE"</span>)
                <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitEmacs()</span>
                <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitOhMyZsh()</span>
                <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"---- END INIT MY CORE"</span>)
            <span style="color: #4f97d7; font-weight: bold;">elif</span> <span style="color: #4f97d7;">len</span>(sys.argv)==3:
                <span style="color: #7590db;">opt_arg</span> = sys.argv[2]
                <span style="color: #4f97d7; font-weight: bold;">if</span> opt_arg==<span style="color: #2d9574;">"ec"</span>:
                    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitEmacsConfig()</span>
                    <span style="color: #4f97d7; font-weight: bold;">pass</span>
                <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_arg==<span style="color: #2d9574;">"se"</span>:
                    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitSpacemacsElpa()</span>
                    <span style="color: #4f97d7; font-weight: bold;">pass</span>
                <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_arg==<span style="color: #2d9574;">"omz"</span>:
                    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">InitOhMyZsh()</span>
                    <span style="color: #4f97d7; font-weight: bold;">pass</span>
                <span style="color: #4f97d7; font-weight: bold;">pass</span>
        <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_type==<span style="color: #2d9574;">"-u"</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"UNSUPPORT -u!"</span>)
        <span style="color: #4f97d7; font-weight: bold;">elif</span> opt_type==<span style="color: #2d9574;">"-c"</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"UNSUPPORT -c!"</span>)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Logic Start</span>
<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">__name__</span> == <span style="color: #2d9574;">"__main__"</span>:
    main()
</pre>
</div>
</div>
</div>
<div id="outline-container-org7893c44" class="outline-3">
<h3 id="org7893c44">Ftp 上传文件</h3>
<div class="outline-text-3" id="text-org7893c44">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">FTPClient</span>(<span style="color: #4f97d7;">object</span>):
    <span style="color: #9f8766;">'''''</span>
<span style="color: #9f8766;">    @note: upload local file or dirs recursively to ftp server</span>
<span style="color: #9f8766;">    '''</span>
    <span style="color: #7590db;">_DataTypeFILE</span> = <span style="color: #2d9574;">'FILE'</span>
    <span style="color: #7590db;">_DataTypeDIR</span>  = <span style="color: #2d9574;">'DIR'</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp = <span style="color: #a45bad;">None</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__del__</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">pass</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">setFtpParams</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, ip, uname, pwd, port=21, timeout=60):
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ip = ip
        <span style="color: #4f97d7; font-weight: bold;">self</span>.uname = uname
        <span style="color: #4f97d7; font-weight: bold;">self</span>.pwd = pwd
        <span style="color: #4f97d7; font-weight: bold;">self</span>.port = port
        <span style="color: #4f97d7; font-weight: bold;">self</span>.timeout = timeout

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">initEnv</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp <span style="color: #4f97d7; font-weight: bold;">is</span> <span style="color: #a45bad;">None</span>:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp = ftplib.FTP()
            <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">'### connect ftp server: %s ...'</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.ip
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.connect(<span style="color: #4f97d7; font-weight: bold;">self</span>.ip, <span style="color: #4f97d7; font-weight: bold;">self</span>.port, <span style="color: #4f97d7; font-weight: bold;">self</span>.timeout)
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.login(<span style="color: #4f97d7; font-weight: bold;">self</span>.uname, <span style="color: #4f97d7; font-weight: bold;">self</span>.pwd)
            <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.getwelcome()

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">clearEnv</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.close()
            <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">'### disconnect ftp server: %s!'</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.ip
            <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp = <span style="color: #a45bad;">None</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">uploadDir</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, localdir=<span style="color: #2d9574;">'./'</span>, remotedir=<span style="color: #2d9574;">'./'</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> os.path.isdir(localdir):
            <span style="color: #4f97d7; font-weight: bold;">return</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.cwd(remotedir)
        <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #4f97d7;">file</span> <span style="color: #4f97d7; font-weight: bold;">in</span> os.listdir(localdir):
            <span style="color: #7590db;">src</span> = os.path.join(localdir, <span style="color: #4f97d7;">file</span>)
            <span style="color: #4f97d7; font-weight: bold;">if</span> os.path.isfile(src):
                <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadFile(src, <span style="color: #4f97d7;">file</span>)
            <span style="color: #4f97d7; font-weight: bold;">elif</span> os.path.isdir(src):
                <span style="color: #4f97d7; font-weight: bold;">try</span>:
                    <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.mkd(<span style="color: #4f97d7;">file</span>)
                <span style="color: #4f97d7; font-weight: bold;">except</span>:
                    sys.stderr.write(<span style="color: #2d9574;">'the dir is exists %s'</span> % <span style="color: #4f97d7;">file</span>)
                <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadDir(src, <span style="color: #4f97d7;">file</span>)
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.cwd(<span style="color: #2d9574;">'..'</span>)

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">uploadFile</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, localpath, remotepath=<span style="color: #2d9574;">'./'</span>):
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> os.path.isfile(localpath):
            <span style="color: #4f97d7; font-weight: bold;">return</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span> <span style="color: #2d9574;">'+++ upload %s to %s:%s'</span> % (localpath, <span style="color: #4f97d7; font-weight: bold;">self</span>.ip, remotepath)
        <span style="color: #4f97d7; font-weight: bold;">self</span>.ftp.storbinary(<span style="color: #2d9574;">'STOR '</span> + remotepath, <span style="color: #4f97d7;">open</span>(localpath, <span style="color: #2d9574;">'rb'</span>))

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__filetype</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, src):
        <span style="color: #4f97d7; font-weight: bold;">if</span> os.path.isfile(src):
            <span style="color: #7590db;">index</span> = src.rfind(<span style="color: #2d9574;">'\\'</span>)
            <span style="color: #4f97d7; font-weight: bold;">if</span> index == -1:
                <span style="color: #7590db;">index</span> = src.rfind(<span style="color: #2d9574;">'/'</span>)
            <span style="color: #4f97d7; font-weight: bold;">return</span> FTPClient._DataTypeFILE, src[index + 1:]
        <span style="color: #4f97d7; font-weight: bold;">elif</span> os.path.isdir(src):
            <span style="color: #4f97d7; font-weight: bold;">return</span> FTPClient._DataTypeDIR, <span style="color: #2d9574;">''</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">upload</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>, src, des=<span style="color: #2d9574;">'/'</span>):
        <span style="color: #7590db;">filetype</span>, <span style="color: #7590db;">filename</span> = <span style="color: #4f97d7; font-weight: bold;">self</span>.__filetype(src)

        <span style="color: #4f97d7; font-weight: bold;">self</span>.initEnv()
        <span style="color: #4f97d7; font-weight: bold;">if</span> filetype == FTPClient._DataTypeDIR:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.srcDir = src
            <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadDir(<span style="color: #4f97d7; font-weight: bold;">self</span>.srcDir, des)
        <span style="color: #4f97d7; font-weight: bold;">elif</span> filetype == FTPClient._DataTypeFILE:
            <span style="color: #4f97d7; font-weight: bold;">self</span>.uploadFile(src, des+filename)
        <span style="color: #4f97d7; font-weight: bold;">self</span>.clearEnv()

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">UploadFileOrDir</span>():
    <span style="color: #7590db;">appDirPath</span> = g_projPath+<span style="color: #2d9574;">"/build/"</span>+g_platformType
    <span style="color: #7590db;">fileName</span> = g_appName+<span style="color: #2d9574;">"_"</span>+g_buildNO
    <span style="color: #7590db;">localFilePath</span> = <span style="color: #2d9574;">""</span>
    <span style="color: #7590db;">remoteDirPath</span> = <span style="color: #2d9574;">"/GameDistribution/HDX_Dev/"</span>+g_platformType+<span style="color: #2d9574;">"/"</span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> g_platformType == <span style="color: #2d9574;">"PC"</span>:
        <span style="color: #7590db;">fileName</span> = fileName + <span style="color: #2d9574;">".zip"</span>
    <span style="color: #4f97d7; font-weight: bold;">elif</span> g_platformType == <span style="color: #2d9574;">"IOS"</span>:
        <span style="color: #7590db;">fileName</span> = fileName + <span style="color: #2d9574;">".ipa"</span>
    <span style="color: #4f97d7; font-weight: bold;">elif</span> g_platformType == <span style="color: #2d9574;">"Android"</span>:
        <span style="color: #7590db;">fileName</span> = fileName + <span style="color: #2d9574;">".apk"</span>
    <span style="color: #7590db;">localFilePath</span> = g_projPath+<span style="color: #2d9574;">"/build/"</span>+fileName
    <span style="color: #7590db;">ftpClient</span> = FTPClient()
    ftpClient.setFtpParams(<span style="color: #2d9574;">'dd-pc'</span>, <span style="color: #2d9574;">'sa'</span>, <span style="color: #2d9574;">''</span>)
    LogInfo(<span style="color: #2d9574;">"upload local file = "</span> + localFilePath)
    LogInfo(<span style="color: #2d9574;">"upload remote dir = "</span> + remoteDirPath)
    ftpClient.upload(os.path.realpath(localFilePath), remoteDirPath)
</pre>
</div>
</div>
<div id="outline-container-orgede2540" class="outline-4">
<h4 id="orgede2540">参考链接：</h4>
<div class="outline-text-4" id="text-orgede2540">
<ul class="org-ul">
<li><a href="http://effbot.org/librarybook/ftplib.htm">http://effbot.org/librarybook/ftplib.htm</a><br /></li>
<li><a href="http://blog.csdn.net/xudacheng06/article/details/13613647">http://blog.csdn.net/xudacheng06/article/details/13613647</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org699bf5f" class="outline-3">
<h3 id="org699bf5f">subprocess 使用</h3>
<div class="outline-text-3" id="text-org699bf5f">
</div>
<div id="outline-container-org54c18da" class="outline-4">
<h4 id="org54c18da">执行 svn 更新</h4>
<div class="outline-text-4" id="text-org54c18da">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> subprocess

<span style="color: #7590db;">sys_command_list</span> = [<span style="color: #2d9574;">"svn"</span>]
sys_command_list.append(<span style="color: #2d9574;">"update"</span>)
sys_command_list.append(<span style="color: #2d9574;">"xxx/my-svn-path"</span>)
subprocess.call(sys_command_list)
</pre>
</div>
</div>
</div>
<div id="outline-container-org900054f" class="outline-4">
<h4 id="org900054f">获得文件夹属性</h4>
<div class="outline-text-4" id="text-org900054f">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> subprocess

<span style="color: #7590db;">result</span> = subprocess.check_output(<span style="color: #2d9574;">"attrib "</span>+folder,shell=<span style="color: #a45bad;">True</span>)
<span style="color: #7590db;">result_list</span> = result.decode(<span style="color: #2d9574;">"utf-8"</span>).split(<span style="color: #2d9574;">' '</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9253567" class="outline-3">
<h3 id="org9253567">面向对象编程</h3>
<div class="outline-text-3" id="text-org9253567">
</div>
<div id="outline-container-orgd0da6bb" class="outline-4">
<h4 id="orgd0da6bb">包</h4>
</div>
<div id="outline-container-org838893c" class="outline-4">
<h4 id="org838893c">模块</h4>
<div class="outline-text-4" id="text-org838893c">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">A.py</span>
<span style="color: #7590db;">AElem</span> = 100

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">BElem</span>(): <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"BElem"</span>)

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">CElem</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
        <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"C init"</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1. &#24341;&#29992;&#21478;&#19968;&#20010;&#25991;&#20214; A.py &#20013;&#30340;&#20803;&#32032; AElem,&#20803;&#32032; BElem</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> AElem <span style="color: #4f97d7; font-weight: bold;">from</span> A
<span style="color: #4f97d7; font-weight: bold;">import</span> BElem <span style="color: #4f97d7; font-weight: bold;">from</span> A
<span style="color: #4f97d7; font-weight: bold;">import</span> CElem <span style="color: #4f97d7; font-weight: bold;">from</span> A

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2. &#24341;&#29992;&#21478;&#19968;&#20010;&#25991;&#20214; A.py &#20013;&#30340;&#25152;&#26377;&#31867;</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 1 &#21487;&#20197;&#30452;&#25509;&#35775;&#38382; A &#20013;&#30340;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> A <span style="color: #4f97d7; font-weight: bold;">import</span> *
<span style="color: #4f97d7; font-weight: bold;">print</span>(AElem)

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2 &#38656;&#35201;&#36890;&#36807; A &#26469;&#35775;&#38382; A &#20013;&#30340;&#20803;&#32032;</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> A
<span style="color: #4f97d7; font-weight: bold;">print</span>(A.AElem)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3. &#36890;&#36807; __all__ &#23450;&#20041;&#23548;&#20986;&#30340;&#27169;&#22359;&#20869;&#23481;</span>
<span style="color: #4f97d7;">__all__</span> = [<span style="color: #2d9574;">'bar'</span>, <span style="color: #2d9574;">'baz'</span>]

<span style="color: #7590db;">waz</span> = 5
<span style="color: #7590db;">bar</span> = 10
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">baz</span>(): <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'baz'</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4. &#20174;&#25351;&#23450;&#36335;&#24452; import &#27169;&#22359;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">https://stackoverflow.com/questions/67631/how-to-import-a-module-given-the-full-path</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python 3.5</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> importlib.util
<span style="color: #7590db;">spec</span> = importlib.util.spec_from_file_location(<span style="color: #2d9574;">"module.name"</span>, <span style="color: #2d9574;">"/path/to/file.py"</span>)
<span style="color: #7590db;">foo</span> = importlib.util.module_from_spec(spec)
spec.loader.exec_module(foo)
foo.MyClass()

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python 2</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 1</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> imp
<span style="color: #7590db;">gsvn</span> = imp.load_source(<span style="color: #2d9574;">"gsvn"</span>, os.path.realpath(os.path.dirname(__file__)) + <span style="color: #2d9574;">"/../gsvn.py"</span>)
gsvn.update()

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> os
<span style="color: #4f97d7; font-weight: bold;">import</span> imp
imp.load_source(<span style="color: #2d9574;">"log"</span>, os.path.realpath(os.path.dirname(__file__)) + <span style="color: #2d9574;">"/../log.py"</span>)
<span style="color: #4f97d7; font-weight: bold;">from</span> log <span style="color: #4f97d7; font-weight: bold;">import</span> *
log_info(<span style="color: #2d9574;">"HelloWorld!"</span>)

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">5. &#38169;&#35823;&#30340; import &#27169;&#22359;</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312; A.py &#29238;&#32423;&#30446;&#24405;&#20013;&#23384;&#22312; D.py&#65292;&#19979;&#38754;&#20195;&#30721;&#20986;&#38169;&#30340;&#21407;&#22240;&#22312;&#20110;&#65292;&#30456;&#23545;&#36335;&#24452; import &#21482;&#23545; package &#26377;&#25928;</span>

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Error 1 :</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> ../D

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Error 2 :</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> ../D <span style="color: #4f97d7; font-weight: bold;">import</span> *

<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">Error 3 :</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> .. <span style="color: #4f97d7; font-weight: bold;">import</span> D
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf812331" class="outline-4">
<h4 id="orgf812331">面向对象编程</h4>
<div class="outline-text-4" id="text-orgf812331">
</div>
<div id="outline-container-org1bbd381" class="outline-5">
<h5 id="org1bbd381">python 的构造和析构函数为固定的名字。</h5>
<div class="outline-text-5" id="text-org1bbd381">
<div class="org-src-container">
<pre class="src src-python">&#26500;&#36896;&#20989;&#25968;---------------------   __init__( <span style="color: #4f97d7; font-weight: bold;">self</span> )
&#26512;&#26500;&#20989;&#25968;---------------------   __del__( <span style="color: #4f97d7; font-weight: bold;">self</span> )
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd0c2328" class="outline-5">
<h5 id="orgd0c2328">python 的静态成员 静态成员函数 普通成员函数</h5>
<div class="outline-text-5" id="text-orgd0c2328">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#25104;&#21592;&#21464;&#37327;&#23450;&#20041;&#22312;&#31867;&#20316;&#29992;&#22495;&#20013;:</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Test</span>:
    <span style="color: #7590db;">static_var</span>=<span style="color: #2d9574;">""</span>
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#21442;&#25968;&#19981;&#21547; self:</span>
<span style="color: #ce537a; font-weight: bold;">@staticmethod</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">StaticFunc1</span>():
    <span style="color: #2aa1ae; background-color: #292e34;">###</span>
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#21442;&#25968;&#19981;&#21547; self, &#21253;&#21547; cls &#26041;&#20415;&#35843;&#29992;&#20854;&#20182;&#38745;&#24577;&#20989;&#25968;:</span>
<span style="color: #ce537a; font-weight: bold;">@classmethod</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">StaticFunc2</span>(cls):
    cls.StaticFunc1()
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26222;&#36890;&#25104;&#21592;&#20989;&#25968;&#31532;&#19968;&#20010;&#21442;&#25968;&#20026; self</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">MemberF</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
    <span style="color: #2aa1ae; background-color: #292e34;">###</span>
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2f535a4" class="outline-5">
<h5 id="org2f535a4">python 的封装（private public protected）</h5>
<div class="outline-text-5" id="text-org2f535a4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31169;&#26377;&#30340;&#21464;&#37327;&#65306;</span>
```
<span style="color: #4f97d7; font-weight: bold;">self</span>.__pvar
```
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31169;&#26377;&#30340;&#20989;&#25968;&#65306;</span>
```
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__pfunc</span>(<span style="color: #4f97d7; font-weight: bold;">self</span>):
    <span style="color: #2aa1ae; background-color: #292e34;">###</span>
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org81af89a" class="outline-5">
<h5 id="org81af89a">python 类的继承</h5>
<div class="outline-text-5" id="text-org81af89a">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">A</span>:        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#31867; A</span>

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">B</span>:         <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#31867; B</span>

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">C</span>(A, B):   <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#32487;&#25215;&#31867; A &#21644; B</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6bd2f79" class="outline-5">
<h5 id="org6bd2f79">参考资料</h5>
<div class="outline-text-5" id="text-org6bd2f79">
<p>
Python 面向对象编程 <a href="http://www.runoob.com/python/python-object.html">http://www.runoob.com/python/python-object.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org0d67e56" class="outline-4">
<h4 id="org0d67e56">MISC</h4>
<div class="outline-text-4" id="text-org0d67e56">
<ol class="org-ol">
<li>脚本执行完暂停<br /></li>
</ol>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> os
os.system(<span style="color: #2d9574;">'pause'</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga5c7e2d" class="outline-3">
<h3 id="orga5c7e2d">异常处理</h3>
<div class="outline-text-3" id="text-orga5c7e2d">
</div>
<div id="outline-container-orgc83102c" class="outline-4">
<h4 id="orgc83102c">通用异常错误打印</h4>
<div class="outline-text-4" id="text-orgc83102c">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">try</span>:
    subprocess.check_output(cmd_str, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
<span style="color: #4f97d7; font-weight: bold;">except</span> <span style="color: #ce537a; font-weight: bold;">Exception</span>, e:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(<span style="color: #2d9574;">"ERROR: "</span> + e)
</pre>
</div>
</div>
</div>
<div id="outline-container-org479db4c" class="outline-4">
<h4 id="org479db4c">subprocess 异常处理</h4>
<div class="outline-text-4" id="text-org479db4c">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">try</span>:
    subprocess.check_output(cmd_str, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
<span style="color: #4f97d7; font-weight: bold;">except</span> subprocess.CalledProcessError, e:
    log_error(<span style="color: #2d9574;">"output = "</span> + <span style="color: #4f97d7;">str</span>(e.output))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfe58fd6" class="outline-4">
<h4 id="orgfe58fd6">参考资料</h4>
<div class="outline-text-4" id="text-orgfe58fd6">
<ul class="org-ul">
<li><a href="http://www.runoob.com/python/python-exceptions.html">http://www.runoob.com/python/python-exceptions.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org99d7f14" class="outline-3">
<h3 id="org99d7f14">World-Excel 处理</h3>
<div class="outline-text-3" id="text-org99d7f14">
</div>
<div id="outline-container-org1bb6eab" class="outline-4">
<h4 id="org1bb6eab">安装使用的库</h4>
<div class="outline-text-4" id="text-org1bb6eab">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22788;&#29702; word &#25991;&#20214;&#30340;&#24211;</span>
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">python2 &#23433;&#35013; docx</span>
pip install docx 
<span style="color: #2aa1ae; background-color: #292e34;">## </span><span style="color: #2aa1ae; background-color: #292e34;">python3 &#23433;&#35013; python-docx</span>
pip install python-docx 
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35835; excel &#30340;&#24211;</span>
pip install xlrd
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20889; excel &#30340;&#24211;</span>
pip install xlwt
</pre>
</div>
</div>
</div>
<div id="outline-container-org376ea47" class="outline-4">
<h4 id="org376ea47">docx</h4>
<div class="outline-text-4" id="text-org376ea47">
</div>
<div id="outline-container-orgdc6cf97" class="outline-5">
<h5 id="orgdc6cf97">docx</h5>
<div class="outline-text-5" id="text-orgdc6cf97">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> docx

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_docx</span>(file_name):
    <span style="color: #7590db;">d</span> = docx.opendocx(file_name)
    <span style="color: #7590db;">doc</span> = docx.getdocumenttext(d)
    <span style="color: #4f97d7; font-weight: bold;">return</span> doc

<span style="color: #7590db;">doc</span> = get_docx(<span style="color: #2d9574;">'tt.docx'</span>)
<span style="color: #4f97d7; font-weight: bold;">print</span>(doc)  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986;&#34892;&#25968;&#65306;1075</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> d <span style="color: #4f97d7; font-weight: bold;">in</span> doc[:5]:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(d) <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21360;&#21069; 5 &#34892;</span>

<span style="color: #2d9574;">'''&#36755;&#20986;&#65306;</span>
<span style="color: #2d9574;">&#19968;&#12289;&#34917;&#30410;&#20043;&#21058;</span>
<span style="color: #2d9574;">1&#65294;&#22235;&#21531;&#23376;&#27748;</span>
<span style="color: #2d9574;">&#22235;&#21531;&#23376;&#27748;&#20013;&#21644;&#20041;&#65292;&#21442;&#26415;&#33583;&#33491;&#29976;&#33609;&#27604;</span>
<span style="color: #2d9574;">&#30410;&#20197;&#22799;&#38472;&#21517;&#20845;&#21531;&#65292;&#31067;&#30192;&#34917;&#27668;&#38451;&#34394;&#39285;</span>
<span style="color: #2d9574;">&#38500;&#21364;&#21322;&#22799;&#21517;&#24322;&#21151;&#65292;&#25110;&#21152;&#39321;&#30722;&#32963;&#23506;&#20351;</span>
<span style="color: #2d9574;">'''</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org67da6ee" class="outline-5">
<h5 id="org67da6ee">python-docx</h5>
<div class="outline-text-5" id="text-org67da6ee">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> docx
<span style="color: #4f97d7; font-weight: bold;">from</span> docx <span style="color: #4f97d7; font-weight: bold;">import</span> Document
<span style="color: #7590db;">path</span> = <span style="color: #2d9574;">"C:\\Users\\Administrator\\Desktop\\word.docx"</span>
<span style="color: #7590db;">document</span> = Document(path)
<span style="color: #4f97d7; font-weight: bold;">for</span> paragraph <span style="color: #4f97d7; font-weight: bold;">in</span> document.paragraphs:
    <span style="color: #4f97d7; font-weight: bold;">print</span>(paragraph.text)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org200f4ab" class="outline-4">
<h4 id="org200f4ab">xlrd</h4>
</div>
<div id="outline-container-orgd9b9df2" class="outline-4">
<h4 id="orgd9b9df2">xlwt</h4>
<div class="outline-text-4" id="text-orgd9b9df2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> xlwt

<span style="color: #7590db;">wb</span> = xlwt.Workbook(encoding = <span style="color: #2d9574;">'utf-8'</span>)
<span style="color: #7590db;">ws</span> = wb.add_sheet(<span style="color: #2d9574;">"Data"</span>, cell_overwrite_ok=<span style="color: #a45bad;">True</span>)
ws.write(0,0,<span style="color: #2d9574;">"row0 colum0 value"</span>)
ws.write(1,0,<span style="color: #2d9574;">"row1 colum0 value"</span>)
ws.save(<span style="color: #2d9574;">"test.xls"</span>)
</pre>
</div>
</div>

<div id="outline-container-org1cf6438" class="outline-5">
<h5 id="org1cf6438">xlwt 写入 Excel 文件后，打开时提示文件后缀错误</h5>
<div class="outline-text-5" id="text-org1cf6438">
<p>
xlwt 只能写 xls 文件，不能写 xlsm 文件，所以保存文件时，后缀名应该使用 xls<br />
</p>
</div>
</div>
<div id="outline-container-org4230393" class="outline-5">
<h5 id="org4230393">ValueError: column index (256) not an int in range(256)</h5>
<div class="outline-text-5" id="text-org4230393">
<p>
xls 类型的文件，最大只支持 256 列，xlsm 文件可以支持更多列。改用 xlsmwriter 模块来实现写入 xlsm 文件。<br />
<a href="https://www.cnblogs.com/z-x-y/p/9639702.html">https://www.cnblogs.com/z-x-y/p/9639702.html</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org383fd3d" class="outline-4">
<h4 id="org383fd3d">xlsmwriter</h4>
<div class="outline-text-4" id="text-org383fd3d">
<p>
<a href="https://xlsxwriter.readthedocs.io/">https://xlsxwriter.readthedocs.io/</a><br />
</p>
</div>
<div id="outline-container-org240074c" class="outline-5">
<h5 id="org240074c">安装</h5>
<div class="outline-text-5" id="text-org240074c">
<div class="org-src-container">
<pre class="src src-shell">pip install XlsxWriter
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb3ded38" class="outline-5">
<h5 id="orgb3ded38">使用</h5>
<div class="outline-text-5" id="text-orgb3ded38">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> xlsxwriter

<span style="color: #7590db;">wb</span> = xlsxwriter.Workbook(<span style="color: #2d9574;">"xxx.xlsx"</span>)
<span style="color: #7590db;">ws</span> = wb.add_worksheet()
<span style="color: #7590db;">row_num</span> = 1
<span style="color: #4f97d7; font-weight: bold;">for</span> row_id,row <span style="color: #4f97d7; font-weight: bold;">in</span> rows_dict.items():
    ws.write(row_num, 0, row_id)
    <span style="color: #4f97d7; font-weight: bold;">for</span> column_name,column_value <span style="color: #4f97d7; font-weight: bold;">in</span> row.items():
        <span style="color: #4f97d7; font-weight: bold;">if</span> column_name <span style="color: #4f97d7; font-weight: bold;">not</span> <span style="color: #4f97d7; font-weight: bold;">in</span> g_column_info_dict:
            <span style="color: #7590db;">g_column_info_dict</span>[column_name] = (g_column_counter, column_value[1])
            <span style="color: #7590db;">g_column_counter</span> = g_column_counter + 1
        <span style="color: #7590db;">column_num</span> = (g_column_info_dict[column_name])[0]
        ws.write(row_num,column_num, column_value[0])
    <span style="color: #7590db;">row_num</span> = row_num + 1
<span style="color: #4f97d7; font-weight: bold;">for</span> column_name,column_info <span style="color: #4f97d7; font-weight: bold;">in</span> g_column_info_dict.items():
    <span style="color: #7590db;">column_num</span> = column_info[0]
    ws.write(0, column_num, column_name+<span style="color: #2d9574;">"  "</span>+column_info[1])
wb.close()
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd3a1c8a" class="outline-2">
<h2 id="orgd3a1c8a">Misc</h2>
<div class="outline-text-2" id="text-orgd3a1c8a">
</div>
<div id="outline-container-org6aa2ee6" class="outline-3">
<h3 id="org6aa2ee6">python 版本管理器</h3>
<div class="outline-text-3" id="text-org6aa2ee6">
</div>
<div id="outline-container-org515673f" class="outline-4">
<h4 id="org515673f">pyen</h4>
<div class="outline-text-4" id="text-org515673f">
<p>
如果已经安装了 python，可以将已经安装的 copy 到 d:/Applications/Python/.pyenv/pyenv-win/versions 目录下，目录名称改为 python 版本号，便于识别不同版本。手动添加版本，需要执行如下操作<br />
</p>
<div class="org-src-container">
<pre class="src src-shell">pyenv rehash
</pre>
</div>
</div>
<div id="outline-container-org65861b0" class="outline-5">
<h5 id="org65861b0">安装</h5>
<div class="outline-text-5" id="text-org65861b0">
<ul class="org-ul">
<li>Windows 版本安装请参考下面官方链接：<br />
<a href="https://github.com/pyenv-win/pyenv-win">https://github.com/pyenv-win/pyenv-win</a><br /></li>
<li>其他版本<br />
<a href="https://github.com/pyenv/pyenv">https://github.com/pyenv/pyenv</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org0e782ce" class="outline-5">
<h5 id="org0e782ce">使用</h5>
<div class="outline-text-5" id="text-org0e782ce">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#26597;&#30475;&#24403;&#21069;&#29256;&#26412;&#20449;&#24687;</span>
pyenv versions

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622;&#24403;&#21069;&#20840;&#23616;&#20351;&#29992;&#30340;&#29256;&#26412;</span>
pyenv global 3.7.2

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622;&#39033;&#30446;&#23616;&#37096;&#29256;&#26412;</span>
pyenv local 3.7.2

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Alias &#21487;&#25191;&#34892;&#25991;&#20214;&#65288;&#27599;&#27425;&#23433;&#35013;&#21487;&#25191;&#34892;&#25991;&#20214;&#21518;&#65292;&#37117;&#38656;&#35201;&#25191;&#34892;&#35813;&#21629;&#20196;&#65289;</span>
pyenv rehash

</pre>
</div>
</div>
</div>
<div id="outline-container-org4b869e1" class="outline-5">
<h5 id="org4b869e1">错误处理</h5>
<div class="outline-text-5" id="text-org4b869e1">
</div>
<div id="outline-container-org974061a" class="outline-6">
<h6 id="org974061a">pyenv Fatal error in launcher: Unable to create process using</h6>
<div class="outline-text-6" id="text-org974061a">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25191;&#34892;&#19979;&#38754;&#21629;&#20196;&#65292;&#25552;&#31034;&#22914;&#39064;&#38169;&#35823;</span>
pip install twisted
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#19979;&#38754;&#21629;&#20196;&#20195;&#26367;&#19978;&#38754;&#21629;&#20196;</span>
python -m pip install twisted
</pre>
</div>

<p>
<a href="https://stackoverflow.com/questions/24627525/fatal-error-in-launcher-unable-to-create-process-using-c-program-files-x86">https://stackoverflow.com/questions/24627525/fatal-error-in-launcher-unable-to-create-process-using-c-program-files-x86</a><br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org229c502" class="outline-4">
<h4 id="org229c502">rbenv</h4>
<div class="outline-text-4" id="text-org229c502">
<p>
<a href="https://github.com/mislav/anyenv">https://github.com/mislav/anyenv</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org89e0fde" class="outline-3">
<h3 id="org89e0fde">python 编辑器</h3>
<div class="outline-text-3" id="text-org89e0fde">
</div>
<div id="outline-container-org14c45b4" class="outline-4">
<h4 id="org14c45b4">PyCharm</h4>
<div class="outline-text-4" id="text-org14c45b4">
<p>
参考 InitMyCore 中 InitJetBrainsIDE 部分的配置方法<br />
</p>

<p>
<a href="https://www.jetbrains.com/pycharm">https://www.jetbrains.com/pycharm</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org1d3e96e" class="outline-3">
<h3 id="org1d3e96e">easy_install 安装插件</h3>
<div class="outline-text-3" id="text-org1d3e96e">
<p>
安装 Python 后，easy_install 默认会被安装到 C:Python\Python27\Scripts 目录下<br />
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20999;&#25442;&#21040; eazy_install &#25152;&#22312;&#30340;&#30446;&#24405; &#25191;&#34892;&#19979;&#38754;&#21629;&#20196;</span>
easy_install.exe xlrd
</pre>
</div>
</div>
</div>
<div id="outline-container-org787edfc" class="outline-3">
<h3 id="org787edfc">pip 安装插件</h3>
<div class="outline-text-3" id="text-org787edfc">
<p>
安装 Python 后，pip 默认会被安装到 C:Python\Python27\Scripts 目录下<br />
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20999;&#25442;&#21040; pip &#25152;&#22312;&#30340;&#30446;&#24405; &#25191;&#34892;&#19979;&#38754;&#21629;&#20196;</span>
pip install pyinstaller
</pre>
</div>
</div>
</div>
<div id="outline-container-org59a014c" class="outline-3">
<h3 id="org59a014c">离线安装插件</h3>
<div class="outline-text-3" id="text-org59a014c">
</div>
<div id="outline-container-orgba57c9d" class="outline-4">
<h4 id="orgba57c9d">下载需要安装的插件</h4>
<div class="outline-text-4" id="text-orgba57c9d">
<p>
在线搜索并下载你需要的第三方库：网址 <a href="https://pypi.org/project/">https://pypi.org/project/</a><br />
</p>
</div>
</div>
<div id="outline-container-orgf31b1c7" class="outline-4">
<h4 id="orgf31b1c7">安装插件</h4>
<div class="outline-text-4" id="text-orgf31b1c7">
<p>
安装 whl 包：pip install  **.whl（前提是要安装好 pip 和 wheel）<br />
安装 tar.gz 包：cd 到解压后路径,python setup.py install（安装 pip 和 wheel 都可以参照这种方法）<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgb99e977" class="outline-3">
<h3 id="orgb99e977">将 python 脚本转化为 exe 可执行文件</h3>
<div class="outline-text-3" id="text-orgb99e977">
<div class="org-src-container">
<pre class="src src-shell">  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21253; python &#33050;&#26412;</span>
  pyinstaller yourprogram.py
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21253; python &#33050;&#26412;&#20026;&#19968;&#20010; exe &#25991;&#20214;</span>
  pyinstaller -F make_proto.py

  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">pyinstaller &#25991;&#26723;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Pyinstaller &#29992;&#20110;&#25171;&#21253; Python</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23433;&#35013;&#21629;&#20196;&#65306;pip install PyInstaller</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25171;&#21253;&#21629;&#20196;&#65306;pyinstaller -F -w myfile.py</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20837;&#21442;&#25968;&#30340;&#21547;&#20041;:</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-F &#34920;&#31034;&#29983;&#25104;&#21333;&#20010;&#21487;&#25191;&#34892;&#25991;&#20214;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-w &#34920;&#31034;&#21435;&#25481;&#25511;&#21046;&#21488;&#31383;&#21475;&#65292;&#36825;&#22312; GUI &#30028;&#38754;&#26102;&#38750;&#24120;&#26377;&#29992;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-p &#34920;&#31034;&#20320;&#33258;&#24049;&#33258;&#23450;&#20041;&#38656;&#35201;&#21152;&#36733;&#30340;&#31867;&#36335;&#24452;&#65292;&#19968;&#33324;&#24773;&#20917;&#19979;&#29992;&#19981;&#21040;</span>
  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-i &#34920;&#31034;&#21487;&#25191;&#34892;&#25991;&#20214;&#30340;&#22270;&#26631; </span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Tips:</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">-F &#21629;&#20196;&#29983;&#25104;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#22312;&#21551;&#21160;&#26102;&#20250;&#33457;&#24456;&#38271;&#26102;&#38388;&#12290;</span>
</pre>
</div>

<ul class="org-ul">
<li>官网 <a href="http://www.pyinstaller.org">http://www.pyinstaller.org</a><br /></li>
<li>文档 <a href="https://pyinstaller.readthedocs.io/en/stable/">https://pyinstaller.readthedocs.io/en/stable/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org52024ca" class="outline-3">
<h3 id="org52024ca">修改 Python 脚本文件编码</h3>
<div class="outline-text-3" id="text-org52024ca">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;&#25991;&#20214;&#21069;&#21152;&#19979;&#38754;&#20195;&#30721;&#65306;</span>
 -*- coding: utf-8 -*- 
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
