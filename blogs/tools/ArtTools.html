<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-05-24 Wed 14:56 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ArtTools</title>
<meta name="generator" content="Org Mode" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
         <meta name="viewport" content="width=device-width, initial-scale=1" />
         <link rel="stylesheet" title="Standard" href="https://wolfand11.github.io/res/worg_theme/css/worg.css" type="text/css" />
         <link rel="alternate stylesheet" title="Zenburn" href="https://wolfand11.github.io/res/worg_theme/css/worg-zenburn.css" type="text/css" />
         <link rel="alternate stylesheet" title="Classic" href="https://wolfand11.github.io/res/worg_theme/css/worg-classic.css" type="text/css" />
         <link rel="icon" href="https://wolfand11.github.io/res/favicon.ico" type="image/ico" />
         <script type="text/javascript" src="https://wolfand11.github.io/res/blog-tools.js"></script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://wolfand11.github.io"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">ArtTools</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org907cb67">photoshop</a>
<ul>
<li><a href="#org8b42db8">基本操作</a>
<ul>
<li><a href="#org1c12801">工作区</a></li>
<li><a href="#org71370f8">参考线使用</a>
<ul>
<li><a href="#org55a38a6">显示/隐藏 参考线</a></li>
<li><a href="#org695356c">查看参考线坐标信息</a></li>
</ul>
</li>
<li><a href="#org6c18b0c">鼠标处位置、颜色信息</a></li>
<li><a href="#org9675071">颜色设置</a></li>
<li><a href="#org42821c4">参考资料</a></li>
</ul>
</li>
<li><a href="#orgc52ea9c">Usage</a>
<ul>
<li><a href="#org03a7941">将 alpha 固化到 rgb 通道</a></li>
<li><a href="#org4e924ed">存储为 TGA 格式</a></li>
</ul>
</li>
<li><a href="#org073d3e7">Script</a>
<ul>
<li><a href="#org43950f7">Base</a>
<ul>
<li><a href="#org0215d5f">object to string</a></li>
<li><a href="#org4726e1a">异常处理</a></li>
<li><a href="#orgbdd715d">GUI</a>
<ul>
<li><a href="#orga6f0676">hello world</a></li>
<li><a href="#org0af6724">modal dialog</a></li>
<li><a href="#org0378b0a">non modal dialog</a></li>
<li><a href="#orgcca6d42">ui elements</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org64598de">UseCase</a>
<ul>
<li><a href="#orgaf7b506">File &amp; Directory</a>
<ul>
<li><a href="#org9f24a33">选择目录</a></li>
</ul>
</li>
<li><a href="#orgfbfd7e9">遍历 layer groups，layers</a>
<ul>
<li><a href="#org85ffff7">遍历 layer groups，处理 layer group 内的每个 layer</a></li>
<li><a href="#org8a1ddde">遍历不属于 layer groups 内的 layers</a></li>
<li><a href="#orga97081a">遍历所有 layers</a></li>
</ul>
</li>
<li><a href="#orgc693eaf">录制 Action 为 Script</a>
<ul>
<li><a href="#orgf261484">ScriptingListener 插件安装</a></li>
<li><a href="#orge1da649">ScriptingListener 插件使用</a></li>
</ul>
</li>
<li><a href="#orgd7f9521">导出 Layers 为 PNG</a></li>
</ul>
</li>
<li><a href="#org416ee0b">Tools</a></li>
<li><a href="#org050ebec">参考资料</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org92676c6">GIMP</a>
<ul>
<li><a href="#orgc5be0cd">Base</a>
<ul>
<li><a href="#orgc9fa395">显示鼠标信息面板</a></li>
<li><a href="#org73d3f81">添加 Alpha 通道</a></li>
<li><a href="#org65e2ac6">填充 Alpha 通道</a></li>
</ul>
</li>
<li><a href="#org82379a8">Usage</a>
<ul>
<li><a href="#org5f28ffb">为图片中物体添加描边</a></li>
<li><a href="#org4d29e3d">彩色图变黑白图</a></li>
<li><a href="#org25ae25d">径向模糊</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcaa39a3">3ds max</a>
<ul>
<li><a href="#orgee4d8b2">基本操作</a>
<ul>
<li>
<ul>
<li><a href="#org8c4075b">显示 Scene Explorer</a></li>
<li><a href="#orgb9a0e79">查看模型使用的材质球</a></li>
<li><a href="#org4377b20">查看骨骼层级结构</a></li>
<li><a href="#orgc79208e">查看修改顶点颜色</a></li>
<li><a href="#org29ebffb">按照顶点颜色显示模型</a></li>
<li><a href="#org8ab7afe">如何查看骨骼的绑定权重？</a>
<ul>
<li><a href="#org8ae2dd8">查看权重分布</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgefd923a">建模</a>
<ul>
<li><a href="#org9b0514c">Q&amp;A</a>
<ul>
<li><a href="#org529d0a0">如何创建一个地球模型，并赋予贴图？</a></li>
<li><a href="#org4022a23"><span class="todo TODO">TODO</span> 一个角色如何使用多个材质球？</a></li>
<li><a href="#orgb29761c">如何查看模型的 UV 展开?</a></li>
<li><a href="#org0fc079a">如何显示模型的法线？</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org13b3a09">动画</a>
<ul>
<li><a href="#org8198b44">基础知识</a></li>
<li><a href="#org1808858">骨骼绑定步骤</a>
<ul>
<li><a href="#org32a6271">分析模型</a></li>
<li><a href="#org5a390df">分析模型需要活动的部位和道具</a>
<ul>
<li><a href="#org3135682">CS 人形骨骼自带</a></li>
<li><a href="#org0591610">Bones 骨骼</a></li>
</ul>
</li>
<li><a href="#org3483a6c">骨骼配置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3b6fcc6">MaxScript</a>
<ul>
<li><a href="#orgee02792">基础语法</a>
<ul>
<li><a href="#org4415a35">if</a></li>
<li><a href="#org32303ca">for 循环</a></li>
<li><a href="#orgf2c79a4">string</a></li>
<li><a href="#orga1b5087">数组</a></li>
<li><a href="#orgd58a70e">结构体</a></li>
</ul>
</li>
<li><a href="#org8c9febf">各种功能</a>
<ul>
<li><a href="#org0eceb48">文件操作</a></li>
<li><a href="#org0bfa9c8">和 3dsmax 系统界面交互</a></li>
<li><a href="#orge861487">读写配置文件</a></li>
<li><a href="#org38fb215">遍历</a></li>
</ul>
</li>
<li><a href="#org5a323f6">Tips</a>
<ul>
<li><a href="#org83ff539">print 比较诡异</a></li>
<li><a href="#org5c548e0">maxscript 变量不分大小写</a></li>
<li><a href="#orgcaac15b">删除老的 macroscript</a></li>
<li><a href="#org4871867">maxscript &#x2013;Type error: Call needs function or class, got:undefined</a></li>
<li><a href="#orgf1be2ff">&#x2013; No ""eof"" function for undefined &lt;&lt;</a></li>
<li><a href="#org46d3ee6">Runtime error: Cannot directly set animation context time - use "at time&#x2026;".</a></li>
</ul>
</li>
<li><a href="#org952d902">参考资料</a></li>
</ul>
</li>
<li><a href="#org9c0ae3d">ERROR</a></li>
<li><a href="#org9005ee8">参考资料</a>
<ul>
<li><a href="#orgbbc1c61">基础</a></li>
<li><a href="#org63b469a">建模</a></li>
<li><a href="#orgc198a5a">动画</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1a462c8">Tools</a></li>
</ul>
</div>
</div>
<div class="HTML" id="org123a35e">
<p>
记录一些美术工具的使用方法。<br />
&lt;!&#x2013; more &#x2013;&gt;<br />
</p>

</div>

<div id="outline-container-org907cb67" class="outline-2">
<h2 id="org907cb67">photoshop</h2>
<div class="outline-text-2" id="text-org907cb67">
</div>
<div id="outline-container-org8b42db8" class="outline-3">
<h3 id="org8b42db8">基本操作</h3>
<div class="outline-text-3" id="text-org8b42db8">
</div>
<div id="outline-container-org1c12801" class="outline-4">
<h4 id="org1c12801">工作区</h4>
<div class="outline-text-4" id="text-org1c12801">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">鼠标滚轮</td>
<td class="org-left">上下移动工作区</td>
</tr>

<tr>
<td class="org-left">Ctrl+鼠标滚轮</td>
<td class="org-left">左右移动工作区</td>
</tr>

<tr>
<td class="org-left">窗口/工作区/复位基本功能</td>
<td class="org-left">复位工作区</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org71370f8" class="outline-4">
<h4 id="org71370f8">参考线使用</h4>
<div class="outline-text-4" id="text-org71370f8">
</div>
<div id="outline-container-org55a38a6" class="outline-5">
<h5 id="org55a38a6">显示/隐藏 参考线</h5>
<div class="outline-text-5" id="text-org55a38a6">
<p>
菜单 视图/显示/参考线 快捷键 Ctrl+;<br />
</p>
</div>
</div>

<div id="outline-container-org695356c" class="outline-5">
<h5 id="org695356c">查看参考线坐标信息</h5>
<div class="outline-text-5" id="text-org695356c">
<p>
打开标尺线(Ctrl+r)，查看参考线和标尺交点的值。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org6c18b0c" class="outline-4">
<h4 id="org6c18b0c">鼠标处位置、颜色信息</h4>
<div class="outline-text-4" id="text-org6c18b0c">
<p>
菜单 窗口/信息 打开，信息面板。<br />
</p>
</div>
</div>
<div id="outline-container-org9675071" class="outline-4">
<h4 id="org9675071">颜色设置</h4>
<div class="outline-text-4" id="text-org9675071">
<p>
菜单 编辑/颜色设置 打开，颜色设置对话框。<br />
</p>

<ul class="org-ul">
<li>Adobe PhotoShop 中的色彩管理设置 <a href="https://www.colortell.com/3436.html">https://www.colortell.com/3436.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org42821c4" class="outline-4">
<h4 id="org42821c4">参考资料</h4>
<div class="outline-text-4" id="text-org42821c4">
<ul class="org-ul">
<li><a href="https://helpx.adobe.com/photoshop/user-guide.html">https://helpx.adobe.com/photoshop/user-guide.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc52ea9c" class="outline-3">
<h3 id="orgc52ea9c">Usage</h3>
<div class="outline-text-3" id="text-orgc52ea9c">
</div>
<div id="outline-container-org03a7941" class="outline-4">
<h4 id="org03a7941">将 alpha 固化到 rgb 通道</h4>
<div class="outline-text-4" id="text-org03a7941">
<ol class="org-ol">
<li>复制当前图层得到新的图层<br /></li>
<li>将 alpha 通道转化为选区，反向选择<br /></li>
<li>Ctrl+X 裁切选中区域，隐藏 alpha 通道，就可以将 alpha 固化到 rgb 通道<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org4e924ed" class="outline-4">
<h4 id="org4e924ed">存储为 TGA 格式</h4>
<div class="outline-text-4" id="text-org4e924ed">
<p>
菜单 File/Save a Copy，选择 TGA 格式。<br />
</p>

<ul class="org-ul">
<li><a href="https://community.adobe.com/t5/photoshop-ecosystem-discussions/unable-to-export-as-tga/td-p/11576348">https://community.adobe.com/t5/photoshop-ecosystem-discussions/unable-to-export-as-tga/td-p/11576348</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org073d3e7" class="outline-3">
<h3 id="org073d3e7">Script</h3>
<div class="outline-text-3" id="text-org073d3e7">
</div>
<div id="outline-container-org43950f7" class="outline-4">
<h4 id="org43950f7">Base</h4>
<div class="outline-text-4" id="text-org43950f7">
</div>
<div id="outline-container-org0215d5f" class="outline-5">
<h5 id="org0215d5f">object to string</h5>
<div class="outline-text-5" id="text-org0215d5f">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">args</span> = dialog();
alert(args.toSource());
</pre>
</div>
</div>
</div>
<div id="outline-container-org4726e1a" class="outline-5">
<h5 id="org4726e1a">异常处理</h5>
<div class="outline-text-5" id="text-org4726e1a">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">try</span>
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">......</span>
}
<span style="color: #4f97d7; font-weight: bold;">catch</span>(e)
{
    alert(e);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbdd715d" class="outline-5">
<h5 id="orgbdd715d">GUI</h5>
<div class="outline-text-5" id="text-orgbdd715d">
</div>
<div id="outline-container-orga6f0676" class="outline-6">
<h6 id="orga6f0676">hello world</h6>
<div class="outline-text-6" id="text-orga6f0676">
<div class="org-src-container">
<pre class="src src-js">#target photoshop

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">try</span>
    {
        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">args</span> = dialog();
        alert(args.toSource());
    }
    <span style="color: #4f97d7; font-weight: bold;">catch</span>(e)
    {
        alert(e)
    }
}
main();

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">dialog</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">win</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Window</span>(<span style="color: #2d9574;">"dialog"</span>, <span style="color: #2d9574;">"HelloWorld"</span>)

    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">informational text</span>
    win.add(<span style="color: #2d9574;">"statictext"</span>, <span style="color: #a45bad;">undefined</span>, <span style="color: #2d9574;">"test label"</span>)

    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">test edit text</span>
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">textA</span> = win.add(<span style="color: #2d9574;">"edittext"</span>, <span style="color: #a45bad;">undefined</span>, <span style="color: #2d9574;">""</span>)
    textA.characters = 5;
    textA.active = <span style="color: #a45bad;">true</span>;

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">textB</span> = win.add(<span style="color: #2d9574;">"edittext"</span>, <span style="color: #a45bad;">undefined</span>, <span style="color: #2d9574;">""</span>)
    textB.characters = 10;
    textB.active = <span style="color: #a45bad;">true</span>;

    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">test btn</span>
    win.add(<span style="color: #2d9574;">"button"</span>, <span style="color: #a45bad;">undefined</span>, <span style="color: #2d9574;">"OK"</span>)
    <span style="color: #4f97d7; font-weight: bold;">if</span>(win.show()==1)
    {
        <span style="color: #4f97d7; font-weight: bold;">return</span> { <span style="color: #2d9574;">"textA"</span>:textA.text, <span style="color: #2d9574;">"textB"</span>:textB.text }
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org0af6724" class="outline-6">
<h6 id="org0af6724">modal dialog</h6>
<div class="outline-text-6" id="text-org0af6724">
<div class="org-src-container">
<pre class="src src-js">#target photoshop

<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">GlobalVar</span> = {
    <span style="color: #2d9574;">"appVersion"</span> : 0,
    <span style="color: #2d9574;">"rLabel"</span> : <span style="color: #a45bad;">null</span>,
    <span style="color: #2d9574;">"gLabel"</span> : <span style="color: #a45bad;">null</span>,
    <span style="color: #2d9574;">"bLabel"</span> : <span style="color: #a45bad;">null</span>,
};

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">try</span>
    {
        showWindow ();
    }
    <span style="color: #4f97d7; font-weight: bold;">catch</span>(e)
    {
        alert(e)
    }
}
main();

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">showWindow</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">res</span> = <span style="color: #2d9574;">"dialog { alignChildren: 'fill', \</span>
<span style="color: #2d9574;">        text : 'Dialog',\</span>
<span style="color: #2d9574;">        info: Panel { orientation: 'column', alignChildren:'right', \</span>
<span style="color: #2d9574;">            text: 'Color Helper', \</span>
<span style="color: #2d9574;">            name: Group { orientation: 'row', \</span>
<span style="color: #2d9574;">                r: StaticText { text:'R:0' }, \</span>
<span style="color: #2d9574;">                g: StaticText { text:'G:0' }, \</span>
<span style="color: #2d9574;">                b: StaticText { text:'B:0' }, \</span>
<span style="color: #2d9574;">            } \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">        workInfo: Panel { orientation: 'column', \</span>
<span style="color: #2d9574;">            text: 'Work Info', \</span>
<span style="color: #2d9574;">            name: Group { orientation: 'row', \</span>
<span style="color: #2d9574;">                s: StaticText { text:'Company name:' }, \</span>
<span style="color: #2d9574;">                e: EditText { characters: 30 }, \</span>
<span style="color: #2d9574;">                checkBox1: Checkbox { text: 'CheckBox 1', value: true }, \</span>
<span style="color: #2d9574;">                radio1: RadioButton { text: 'RadioButton', value: true }\</span>
<span style="color: #2d9574;">            } \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">        buttons: Group { orientation: 'row', alignment: 'right', \</span>
<span style="color: #2d9574;">            cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">    }"</span>;

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">win</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Window</span>( res );
    win.center();
    GlobalVar.rLabel = win.info.name.r;
    GlobalVar.gLabel = win.info.name.g;
    GlobalVar.bLabel = win.info.name.b;

    win.buttons.cancelBtn.onClick = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {
        <span style="color: #4f97d7; font-weight: bold;">return</span> win.close();
    };
    win.workInfo.name.radio1.onClick = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {

    };

    win.show();
    <span style="color: #4f97d7; font-weight: bold;">return</span> win;
}
</pre>
</div>

<ul class="org-ul">
<li><a href="https://extendscript.docsforadobe.dev/user-interface-tools/automatic-layout.html">https://extendscript.docsforadobe.dev/user-interface-tools/automatic-layout.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org0378b0a" class="outline-6">
<h6 id="org0378b0a">non modal dialog</h6>
<div class="outline-text-6" id="text-org0378b0a">
<p>
dialog 为模态对话框<br />
palette 为非模态对话框<br />
</p>

<p>
palette 显示后会立即返回，因此，需要 while 循环，保持对话框不被关掉。palette 对话框中，EditText 控件不可用，需要弹出 dialog 来展示 EditText 控件。<br />
</p>

<div class="org-src-container">
<pre class="src src-js">#target photoshop

<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">GlobalVar</span> = {
    <span style="color: #2d9574;">"appVersion"</span> : 0,
    <span style="color: #2d9574;">"rLabel"</span> : <span style="color: #a45bad;">null</span>,
    <span style="color: #2d9574;">"gLabel"</span> : <span style="color: #a45bad;">null</span>,
    <span style="color: #2d9574;">"bLabel"</span> : <span style="color: #a45bad;">null</span>,
    <span style="color: #2d9574;">"aLabel"</span> : <span style="color: #a45bad;">null</span>,
    <span style="color: #2d9574;">"posX"</span> : 0,
    <span style="color: #2d9574;">"posY"</span> : 0,
};

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">try</span>
    {
        showWindow ();
    }
    <span style="color: #4f97d7; font-weight: bold;">catch</span>(e)
    {
        alert(e)
    }
}
main();

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">showInputPosWindow</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">res</span> = <span style="color: #2d9574;">"dialog { alignChildren: 'fill', \</span>
<span style="color: #2d9574;">        text : 'Dialog',\</span>
<span style="color: #2d9574;">        info: Panel { orientation: 'column', alignChildren:'right', \</span>
<span style="color: #2d9574;">            text: 'Input Pos', \</span>
<span style="color: #2d9574;">            pos: Group { orientation: 'row', \</span>
<span style="color: #2d9574;">                xText: StaticText { text:'X: ' }, x: EditText { text:'1', characters: 8},\</span>
<span style="color: #2d9574;">                yText: StaticText { text:'Y: ' }, y: EditText { text:'1', characters: 8},\</span>
<span style="color: #2d9574;">            }, \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">        buttons: Group { orientation: 'row', alignment: 'right', \</span>
<span style="color: #2d9574;">            okBtn: Button { text:'OK', properties:{name:'ok'} }, \</span>
<span style="color: #2d9574;">            cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">    }"</span>;

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">posX</span> = GlobalVar.posX;
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">posY</span> = GlobalVar.posY;
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">win</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Window</span>( res );
    win.center();
    win.buttons.okBtn.onClick = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {
        GlobalVar.posX = posX;
        GlobalVar.posY = posY;
        win.close();
    };

    win.info.pos.x.text = posX;
    win.info.pos.x.text = posY;
    win.info.pos.x.onChange = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {
        posX = Number(win.info.pos.x.text)
        <span style="color: #4f97d7; font-weight: bold;">if</span>(isNaN (GlobalVar.posX))
        {
            posX = 0;
            win.info.pos.x.text = <span style="color: #2d9574;">'0'</span>;
        }
    };
    win.info.pos.y.onChange = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {
        posY = Number(win.info.pos.y.text)
        <span style="color: #4f97d7; font-weight: bold;">if</span>(isNaN (posY))
        {
            posY = 0;
            win.info.pos.y.text = <span style="color: #2d9574;">'0'</span>;
        }
    };
    win.show();
}

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">showWindow</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">res</span> = <span style="color: #2d9574;">"palette { alignChildren: 'fill', \</span>
<span style="color: #2d9574;">        text : 'Dialog',\</span>
<span style="color: #2d9574;">        info: Panel { orientation: 'column', alignChildren:'right', \</span>
<span style="color: #2d9574;">            text: 'Color Helper', \</span>
<span style="color: #2d9574;">            pos: Group { orientation: 'row', \</span>
<span style="color: #2d9574;">                x: StaticText { text:'X:      ', preferredSize:[60,18]}, \</span>
<span style="color: #2d9574;">                y: StaticText { text:'Y:      ', preferredSize:[60,18]}, \</span>
<span style="color: #2d9574;">            }, \</span>
<span style="color: #2d9574;">            rgbValue : Group { orientation: 'row', \</span>
<span style="color: #2d9574;">                r: StaticText { text:'R:     0', preferredSize:[60,18]}, \</span>
<span style="color: #2d9574;">                g: StaticText { text:'G:     0', preferredSize:[60,18]}, \</span>
<span style="color: #2d9574;">                b: StaticText { text:'B:     0', preferredSize:[60,18]}, \</span>
<span style="color: #2d9574;">                a: StaticText { text:'A:     0', preferredSize:[60,18]}, \</span>
<span style="color: #2d9574;">            } \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">        buttons: Group { orientation: 'row', alignment: 'right', \</span>
<span style="color: #2d9574;">            inputPosBtn: Button { text:'Input Pos', properties:{name:'ok'} }, \</span>
<span style="color: #2d9574;">            cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \</span>
<span style="color: #2d9574;">        }, \</span>
<span style="color: #2d9574;">    }"</span>;

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">win</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Window</span>( res );
    win.center();
    GlobalVar.rLabel = win.info.rgbValue.r;
    GlobalVar.gLabel = win.info.rgbValue.g;
    GlobalVar.bLabel = win.info.rgbValue.b;
    GlobalVar.aLabel = win.info.rgbValue.a;

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">isClosed</span> = <span style="color: #a45bad;">false</span>;
    win.buttons.inputPosBtn.onClick = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {
        showInputPosWindow();
        RefreshRGB();
    };
    win.buttons.cancelBtn.onClick = <span style="color: #4f97d7; font-weight: bold;">function</span>()
    {
        isClosed = <span style="color: #a45bad;">true</span>;
    };

    <span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">RefreshPosUI</span>()
    {
        win.info.pos.x.text = <span style="color: #2d9574;">"X: "</span> + GlobalVar.posX;
        win.info.pos.y.text = <span style="color: #2d9574;">"Y: "</span> + GlobalVar.posY;
    }

    <span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">RefreshRGB</span>()
    {
        RefreshPosUI();

        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">pointSample</span> = app.activeDocument.colorSamplers.add([GlobalVar.posX, GlobalVar.posY]);
        GlobalVar.rLabel.text = <span style="color: #2d9574;">"R:"</span> + pointSample.color.rgb.red;
        GlobalVar.gLabel.text = <span style="color: #2d9574;">"G:"</span> + pointSample.color.rgb.green;
        GlobalVar.bLabel.text = <span style="color: #2d9574;">"B:"</span> + pointSample.color.rgb.blue;
        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">alpha</span> = 0;
        <span style="color: #4f97d7; font-weight: bold;">if</span>(activeDocument!=<span style="color: #a45bad;">null</span> &amp;&amp; activeDocument.activeLayer!=<span style="color: #a45bad;">null</span>)
        {
            alpha = activeDocument.activeLayer.opacity;
        }
        GlobalVar.aLabel.text = <span style="color: #2d9574;">"A:"</span> + alpha;
        pointSample.remove();
    }

    RefreshRGB();
    win.show();

    <span style="color: #4f97d7; font-weight: bold;">while</span>(!isClosed)
    {
        app.refresh();
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcca6d42" class="outline-6">
<h6 id="orgcca6d42">ui elements</h6>
<div class="outline-text-6" id="text-orgcca6d42">
<ul class="org-ul">
<li><a href="https://extendscript.docsforadobe.dev/user-interface-tools/control-objects.html#control-objects">https://extendscript.docsforadobe.dev/user-interface-tools/control-objects.html#control-objects</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org64598de" class="outline-4">
<h4 id="org64598de">UseCase</h4>
<div class="outline-text-4" id="text-org64598de">
</div>
<div id="outline-container-orgaf7b506" class="outline-5">
<h5 id="orgaf7b506">File &amp; Directory</h5>
<div class="outline-text-5" id="text-orgaf7b506">
</div>
<div id="outline-container-org9f24a33" class="outline-6">
<h6 id="org9f24a33">选择目录</h6>
<div class="outline-text-6" id="text-org9f24a33">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">outFolder</span> = Folder(oldPath).selectDlg(<span style="color: #2d9574;">"Select Export Path"</span>);
<span style="color: #4f97d7; font-weight: bold;">if</span> (!outFolder.exists) {
    outFolder.create();
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfbfd7e9" class="outline-5">
<h5 id="orgfbfd7e9">遍历 layer groups，layers</h5>
<div class="outline-text-5" id="text-orgfbfd7e9">
</div>
<div id="outline-container-org85ffff7" class="outline-6">
<h6 id="org85ffff7">遍历 layer groups，处理 layer group 内的每个 layer</h6>
<div class="outline-text-6" id="text-org85ffff7">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">for</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">a</span>=0; a&lt;doc.layerSets.length; a++)
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">lname</span> = doc.layerSets[a].name;
    <span style="color: #4f97d7; font-weight: bold;">if</span> (lname.substr(-4) == <span style="color: #2d9574;">".png"</span>)
    {
        saveLayer(doc.layers.getByName(lname), lname, oldPath, <span style="color: #a45bad;">true</span>);
    }
    <span style="color: #4f97d7; font-weight: bold;">else</span>
    {
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">recursive</span>
        scanLayerSets(doc.layerSets[a]);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org8a1ddde" class="outline-6">
<h6 id="org8a1ddde">遍历不属于 layer groups 内的 layers</h6>
<div class="outline-text-6" id="text-org8a1ddde">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">for</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">j</span>=0; j&lt;doc.artLayers.length; j++)
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">name</span> = doc.artLayers[j].name;
    <span style="color: #4f97d7; font-weight: bold;">if</span> (name.substr(-4) == <span style="color: #2d9574;">".png"</span>)
    {
        saveLayer(el.layers.getByName(name), name, oldPath, <span style="color: #a45bad;">false</span>);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orga97081a" class="outline-6">
<h6 id="orga97081a">遍历所有 layers</h6>
<div class="outline-text-6" id="text-orga97081a">
<div class="org-src-container">
<pre class="src src-js"><span style="color: #4f97d7; font-weight: bold;">for</span> (i = 0; i &lt; doc.layers.length; i++)
{
    <span style="color: #4f97d7; font-weight: bold;">if</span> (doc.layers[i].visible)
    {
        foundVisible = <span style="color: #a45bad;">true</span>
        <span style="color: #4f97d7; font-weight: bold;">break</span>
    }
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc693eaf" class="outline-5">
<h5 id="orgc693eaf">录制 Action 为 Script</h5>
<div class="outline-text-5" id="text-orgc693eaf">
</div>
<div id="outline-container-orgf261484" class="outline-6">
<h6 id="orgf261484">ScriptingListener 插件安装</h6>
<div class="outline-text-6" id="text-orgf261484">
<ol class="org-ol">
<li>关闭 PS<br /></li>
<li>下载 ScriptingListener 插件，并解压 <a href="https://download.adobe.com/pub/adobe/photoshop/win/13.x/Win_Scripting_Plug-In.zip">https://download.adobe.com/pub/adobe/photoshop/win/13.x/Win_Scripting_Plug-In.zip</a><br /></li>
<li>将 Scripting Utilites 目录下的 ScriptListener.8li 文件 Copy 到下面路径<br />
macOS: Applications\Adobe Photoshop [Photoshop_version]\Plug-ins\<br />
Windows: Program Files\Adobe\Adobe Photoshop [Photoshop_version]\Plug-ins\<br /></li>
<li>重启 PS<br /></li>
</ol>

<p>
插件下载地址 <a href="https://helpx.adobe.com/photoshop/kb/downloadable-plugins-and-content.html#ScriptingListenerplugin">https://helpx.adobe.com/photoshop/kb/downloadable-plugins-and-content.html#ScriptingListenerplugin</a><br />
官网说明文档 <a href="https://github.com/Adobe-CEP/CEP-Resources/blob/master/Documentation/Product%20specific%20Documentation/Photoshop%20Scripting/photoshop-scripting-guide-2020.pdf">https://github.com/Adobe-CEP/CEP-Resources/blob/master/Documentation/Product%20specific%20Documentation/Photoshop%20Scripting/photoshop-scripting-guide-2020.pdf</a><br />
</p>
</div>
</div>
<div id="outline-container-orge1da649" class="outline-6">
<h6 id="orge1da649">ScriptingListener 插件使用</h6>
<div class="outline-text-6" id="text-orge1da649">
<p>
安装 ScriptingListener 插件后，在 PS 中的操作会被录制到桌面的日志文件中。文件名为 ScriptingListenerJS.log 和 ScriptingListenerVB.log<br />
</p>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">=======================================================</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23545;&#22270;&#29255;&#36827;&#34892;&#39034;&#26102;&#38024;&#26059;&#36716; 90</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idRtte</span> = charIDToTypeID( <span style="color: #2d9574;">"Rtte"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">desc315</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionDescriptor</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idnull</span> = charIDToTypeID( <span style="color: #2d9574;">"null"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">ref7</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionReference</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idDcmn</span> = charIDToTypeID( <span style="color: #2d9574;">"Dcmn"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idOrdn</span> = charIDToTypeID( <span style="color: #2d9574;">"Ordn"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idFrst</span> = charIDToTypeID( <span style="color: #2d9574;">"Frst"</span> );
ref7.putEnumerated( idDcmn, idOrdn, idFrst );
desc315.putReference( idnull, ref7 );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idAngl</span> = charIDToTypeID( <span style="color: #2d9574;">"Angl"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idAng</span> = charIDToTypeID( <span style="color: #2d9574;">"#Ang"</span> );
desc315.putUnitDouble( idAngl, idAng, 90.000000 );
executeAction( idRtte, desc315, DialogModes.NO );

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">=======================================================</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36873;&#20013; ps-test1 layer</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idslct</span> = charIDToTypeID( <span style="color: #2d9574;">"slct"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">desc325</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionDescriptor</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idnull</span> = charIDToTypeID( <span style="color: #2d9574;">"null"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">ref8</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionReference</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idLyr</span> = charIDToTypeID( <span style="color: #2d9574;">"Lyr "</span> );
ref8.putName( idLyr, <span style="color: #2d9574;">"ps-test1"</span> );
desc325.putReference( idnull, ref8 );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idMkVs</span> = charIDToTypeID( <span style="color: #2d9574;">"MkVs"</span> );
desc325.putBoolean( idMkVs, <span style="color: #a45bad;">false</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idLyrI</span> = charIDToTypeID( <span style="color: #2d9574;">"LyrI"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">list8</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionList</span>();
list8.putInteger( 3 );
desc325.putList( idLyrI, list8 );
executeAction( idslct, desc325, DialogModes.NO );


</pre>
</div>

<div class="org-src-container">
<pre class="src src-js"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#24403;&#21069;&#28608;&#27963;&#30340;layer duplicate &#21040;&#26032;&#30340;&#25991;&#26723;&#20013;&#65292;&#24182;&#28608;&#27963;&#26032;&#30340;&#25991;&#26723;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">=======================================================</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idMk</span> = charIDToTypeID( <span style="color: #2d9574;">"Mk  "</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">desc253</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionDescriptor</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idnull</span> = charIDToTypeID( <span style="color: #2d9574;">"null"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">ref4</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionReference</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idDcmn</span> = charIDToTypeID( <span style="color: #2d9574;">"Dcmn"</span> );
ref4.putClass( idDcmn );
desc253.putReference( idnull, ref4 );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idNm</span> = charIDToTypeID( <span style="color: #2d9574;">"Nm  "</span> );
desc253.putString( idNm, <span style="color: #2d9574;">"""new-ps-test1"""</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idUsng</span> = charIDToTypeID( <span style="color: #2d9574;">"Usng"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">ref5</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionReference</span>();
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idLyr</span> = charIDToTypeID( <span style="color: #2d9574;">"Lyr "</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idOrdn</span> = charIDToTypeID( <span style="color: #2d9574;">"Ordn"</span> );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idTrgt</span> = charIDToTypeID( <span style="color: #2d9574;">"Trgt"</span> );
ref5.putEnumerated( idLyr, idOrdn, idTrgt );
desc253.putReference( idUsng, ref5 );
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idVrsn</span> = charIDToTypeID( <span style="color: #2d9574;">"Vrsn"</span> );
desc253.putInteger( idVrsn, 5 );
executeAction( idMk, desc253, DialogModes.NO );
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd7f9521" class="outline-5">
<h5 id="orgd7f9521">导出 Layers 为 PNG</h5>
<div class="outline-text-5" id="text-orgd7f9521">
<div class="org-src-container">
<pre class="src src-js">#target photoshop

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">main</span>(){
    <span style="color: #4f97d7; font-weight: bold;">if</span>(!documents.length) <span style="color: #4f97d7; font-weight: bold;">return</span>;
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">doc</span> = activeDocument;
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">oldPath</span> = activeDocument.path;

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">outFolder</span> = Folder(oldPath).selectDlg(<span style="color: #2d9574;">"Select Export Path"</span>);
    <span style="color: #4f97d7; font-weight: bold;">if</span>(outFolder==<span style="color: #a45bad;">null</span>)
    {
        alert(<span style="color: #2d9574;">"Cancle Export Operation!"</span>);
        <span style="color: #4f97d7; font-weight: bold;">return</span>;
    }

    <span style="color: #4f97d7; font-weight: bold;">for</span> (i = 0; i &lt; doc.layers.length; i++)
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (doc.layers[i].visible)
        {
            <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">name</span> = doc.layers[i].name;
            saveLayer(doc.layers.getByName(name), name, oldPath, <span style="color: #a45bad;">false</span>);
        }
    }

    <span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">saveLayer</span>(<span style="color: #7590db;">layer</span>, <span style="color: #7590db;">lname</span>, <span style="color: #7590db;">path</span>, <span style="color: #7590db;">shouldMerge</span>) {
        activeDocument.activeLayer = layer;
        duplayer();

        activeDocument.trim(TrimType.TRANSPARENT, <span style="color: #a45bad;">true</span>, <span style="color: #a45bad;">true</span>, <span style="color: #a45bad;">true</span>, <span style="color: #a45bad;">true</span>);
        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">saveFile</span>= File(path +<span style="color: #2d9574;">"/out/"</span>+lname+<span style="color: #2d9574;">".png"</span>);
        SavePNG(saveFile);
        app.activeDocument.close(SaveOptions.DONOTSAVECHANGES);
    }
};

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">duplayer</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idMk</span> = charIDToTypeID( <span style="color: #2d9574;">"Mk  "</span> );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">desc253</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionDescriptor</span>();
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idnull</span> = charIDToTypeID( <span style="color: #2d9574;">"null"</span> );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">ref4</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionReference</span>();
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idDcmn</span> = charIDToTypeID( <span style="color: #2d9574;">"Dcmn"</span> );
    ref4.putClass( idDcmn );
    desc253.putReference( idnull, ref4 );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idNm</span> = charIDToTypeID( <span style="color: #2d9574;">"Nm  "</span> );
    desc253.putString( idNm, activeDocument.activeLayer.name);
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idUsng</span> = charIDToTypeID( <span style="color: #2d9574;">"Usng"</span> );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">ref5</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ActionReference</span>();
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idLyr</span> = charIDToTypeID( <span style="color: #2d9574;">"Lyr "</span> );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idOrdn</span> = charIDToTypeID( <span style="color: #2d9574;">"Ordn"</span> );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idTrgt</span> = charIDToTypeID( <span style="color: #2d9574;">"Trgt"</span> );
    ref5.putEnumerated( idLyr, idOrdn, idTrgt );
    desc253.putReference( idUsng, ref5 );
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">idVrsn</span> = charIDToTypeID( <span style="color: #2d9574;">"Vrsn"</span> );
    desc253.putInteger( idVrsn, 5 );
    executeAction( idMk, desc253, DialogModes.NO );
};

main();

<span style="color: #4f97d7; font-weight: bold;">function</span> <span style="color: #bc6ec5; font-weight: bold;">SavePNG</span>(<span style="color: #7590db;">saveFile</span>){
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">pngOpts</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">ExportOptionsSaveForWeb</span>;
    pngOpts.format = SaveDocumentType.PNG
    pngOpts.PNG8 = <span style="color: #a45bad;">false</span>;
    pngOpts.transparency = <span style="color: #a45bad;">true</span>;
    pngOpts.interlaced = <span style="color: #a45bad;">false</span>;
    pngOpts.quality = 100;
    activeDocument.exportDocument(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">File</span>(saveFile),ExportType.SAVEFORWEB,pngOpts);
}
</pre>
</div>

<ul class="org-ul">
<li><a href="https://github.com/antipalindrome/Photoshop-Export-Layers-to-Files-Fast">https://github.com/antipalindrome/Photoshop-Export-Layers-to-Files-Fast</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org416ee0b" class="outline-4">
<h4 id="org416ee0b">Tools</h4>
<div class="outline-text-4" id="text-org416ee0b">
<ul class="org-ul">
<li>ExtendScript Highlights <a href="https://marketplace.visualstudio.com/items?itemName=hennamann.jsx">https://marketplace.visualstudio.com/items?itemName=hennamann.jsx</a><br /></li>
<li>ExtendScript Debugger <a href="https://marketplace.visualstudio.com/items?itemName=Adobe.extendscript-debug">https://marketplace.visualstudio.com/items?itemName=Adobe.extendscript-debug</a><br /></li>
<li>ExtendScript-Toolkit <a href="https://github.com/Adobe-CEP/CEP-Resources/tree/master/ExtendScript-Toolkit">https://github.com/Adobe-CEP/CEP-Resources/tree/master/ExtendScript-Toolkit</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org050ebec" class="outline-4">
<h4 id="org050ebec">参考资料</h4>
<div class="outline-text-4" id="text-org050ebec">
<ul class="org-ul">
<li>Photoshop Scripting <a href="https://github.com/Adobe-CEP/CEP-Resources/tree/master/Documentation/Product%20specific%20Documentation/Photoshop%20Scripting">https://github.com/Adobe-CEP/CEP-Resources/tree/master/Documentation/Product%20specific%20Documentation/Photoshop%20Scripting</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org92676c6" class="outline-2">
<h2 id="org92676c6">GIMP</h2>
<div class="outline-text-2" id="text-org92676c6">
</div>
<div id="outline-container-orgc5be0cd" class="outline-3">
<h3 id="orgc5be0cd">Base</h3>
<div class="outline-text-3" id="text-orgc5be0cd">
</div>
<div id="outline-container-orgc9fa395" class="outline-4">
<h4 id="orgc9fa395">显示鼠标信息面板</h4>
<div class="outline-text-4" id="text-orgc9fa395">
<p>
Windows/Dockable Dialogs/Pointer<br />
</p>
</div>
</div>
<div id="outline-container-org73d3f81" class="outline-4">
<h4 id="org73d3f81">添加 Alpha 通道</h4>
<div class="outline-text-4" id="text-org73d3f81">
<p>
右键点击图层，选择添加 Alpha 通道<br />
</p>


<div id="orgdf46803" class="figure">
<p><img src="./ArtTools/020120_gimp_add_alpha.png" alt="020120_gimp_add_alpha.png" width="300px" /><br />
</p>
</div>

<ul class="org-ul">
<li><a href="https://docs.gimp.org/2.2/zh_CN/gimp-layer-alpha-add.html">https://docs.gimp.org/2.2/zh_CN/gimp-layer-alpha-add.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org65e2ac6" class="outline-4">
<h4 id="org65e2ac6">填充 Alpha 通道</h4>
<div class="outline-text-4" id="text-org65e2ac6">
<ol class="org-ol">
<li>选择要填充的区域<br /></li>
<li>右键点击图层，选择 Add Layer Mask, 弹框中选择 Layer's alpha channel<br /></li>
<li>使用 Bucket Fill Tool 进行填充<br /></li>
<li>右键点击图层，选择 Apply Layer Mask<br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org82379a8" class="outline-3">
<h3 id="org82379a8">Usage</h3>
<div class="outline-text-3" id="text-org82379a8">
</div>
<div id="outline-container-org5f28ffb" class="outline-4">
<h4 id="org5f28ffb">为图片中物体添加描边</h4>
<div class="outline-text-4" id="text-org5f28ffb">
<ul class="org-ul">
<li><a href="https://linuxhint.com/outline-image-gimp/">https://linuxhint.com/outline-image-gimp/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org4d29e3d" class="outline-4">
<h4 id="org4d29e3d">彩色图变黑白图</h4>
<div class="outline-text-4" id="text-org4d29e3d">
<ul class="org-ul">
<li><a href="https://jingyan.baidu.com/article/7f41ecec124621183d095c9b.html">https://jingyan.baidu.com/article/7f41ecec124621183d095c9b.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org25ae25d" class="outline-4">
<h4 id="org25ae25d">径向模糊</h4>
<div class="outline-text-4" id="text-org25ae25d">
<p>
Filters"-&gt;"Blur"-&gt;"Zoom Motion blur"<br />
</p>
<ul class="org-ul">
<li><a href="https://gist.github.com/maxired/a3bf532a44b2dbc39875">https://gist.github.com/maxired/a3bf532a44b2dbc39875</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgcaa39a3" class="outline-2">
<h2 id="orgcaa39a3">3ds max</h2>
<div class="outline-text-2" id="text-orgcaa39a3">
</div>
<div id="outline-container-orgee4d8b2" class="outline-3">
<h3 id="orgee4d8b2">基本操作</h3>
<div class="outline-text-3" id="text-orgee4d8b2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">快捷键</th>
<th scope="col" class="org-left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">按下鼠标滚轮拖动</td>
<td class="org-left">拖动视图</td>
</tr>

<tr>
<td class="org-left">Alt+按下鼠标滚轮拖动</td>
<td class="org-left">旋转视图</td>
</tr>

<tr>
<td class="org-left">Alt+w</td>
<td class="org-left">最大化、最小化视图切换</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-left">重置视角, 也可以点击右上角方向指示图标，再点击图标左上位置的小图标</td>
</tr>

<tr>
<td class="org-left">g</td>
<td class="org-left">显示、隐藏场景中网格线</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">按名称选择物体</td>
</tr>

<tr>
<td class="org-left">l t f u p</td>
<td class="org-left">左-顶-前-正交-透视视图切换</td>
</tr>

<tr>
<td class="org-left">F3</td>
<td class="org-left">线框模式显示切换</td>
</tr>

<tr>
<td class="org-left">F4</td>
<td class="org-left">EdgedFaces 模式显示切换</td>
</tr>

<tr>
<td class="org-left">按下 Shift 移动选中物体</td>
<td class="org-left">复制选中物体</td>
</tr>

<tr>
<td class="org-left">Shift +g</td>
<td class="org-left">隐藏几何体，只显示骨骼</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org8c4075b" class="outline-5">
<h5 id="org8c4075b">显示 Scene Explorer</h5>
<div class="outline-text-5" id="text-org8c4075b">
<p>
方法 1：Main toolbar &gt; Toggle Scene Explorer<br />
方法 2：Menu bar &gt; Tool Menu &gt; Scene Explorer<br />
</p>
</div>
</div>
<div id="outline-container-orgb9a0e79" class="outline-5">
<h5 id="orgb9a0e79">查看模型使用的材质球</h5>
<div class="outline-text-5" id="text-orgb9a0e79">
<p>
菜单 Rendering/Material Explorer<br />
</p>
</div>
</div>
<div id="outline-container-org4377b20" class="outline-5">
<h5 id="org4377b20">查看骨骼层级结构</h5>
<div class="outline-text-5" id="text-org4377b20">
<p>
方法 1：Main toolbar &gt; Schematic View<br />
方法 2：Menu bar &gt; Graph Editors menu &gt; New Schematic View<br />
</p>
</div>
</div>
<div id="outline-container-orgc79208e" class="outline-5">
<h5 id="orgc79208e">查看修改顶点颜色</h5>
<div class="outline-text-5" id="text-orgc79208e">
<p>
ModifierList / VertexPaint<br />
</p>
</div>
</div>
<div id="outline-container-org29ebffb" class="outline-5">
<h5 id="org29ebffb">按照顶点颜色显示模型</h5>
<div class="outline-text-5" id="text-org29ebffb">
<ul class="org-ul">
<li>Step1  Display / Display Properties/ Vertex Colors<br /></li>
<li>Step2  Display / Display Color/ Shaded - Object Color<br /></li>
<li>Step3  场景显示模式切换为 Shaded<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org8ab7afe" class="outline-5">
<h5 id="org8ab7afe">如何查看骨骼的绑定权重？</h5>
<div class="outline-text-5" id="text-org8ab7afe">
</div>
<div id="outline-container-org8ae2dd8" class="outline-6">
<h6 id="org8ae2dd8">查看权重分布</h6>
<div class="outline-text-6" id="text-org8ae2dd8">
<ul class="org-ul">
<li>Step0 选中蒙皮的模型<br /></li>
<li>Step1 选中 Modify 选项卡<br /></li>
<li>Step2 在 Modify Stack 中展开 Skin,选中 Envelope<br /></li>
<li>Step3 在 Parameters 中的 Bones 列表中选择需要查看的骨骼<br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgefd923a" class="outline-3">
<h3 id="orgefd923a">建模</h3>
<div class="outline-text-3" id="text-orgefd923a">
</div>
<div id="outline-container-org9b0514c" class="outline-4">
<h4 id="org9b0514c">Q&amp;A</h4>
<div class="outline-text-4" id="text-org9b0514c">
</div>
<div id="outline-container-org529d0a0" class="outline-5">
<h5 id="org529d0a0">如何创建一个地球模型，并赋予贴图？</h5>
<div class="outline-text-5" id="text-org529d0a0">
<ul class="org-ul">
<li>参考资料 <a href="https://jingyan.baidu.com/article/1e5468f936373c484961b7da.html">https://jingyan.baidu.com/article/1e5468f936373c484961b7da.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org4022a23" class="outline-5">
<h5 id="org4022a23"><span class="todo TODO">TODO</span> 一个角色如何使用多个材质球？</h5>
</div>
<div id="outline-container-orgb29761c" class="outline-5">
<h5 id="orgb29761c">如何查看模型的 UV 展开?</h5>
<div class="outline-text-5" id="text-orgb29761c">
<ul class="org-ul">
<li>选中模型<br /></li>
<li>选中修改选项卡 （Modify）<br /></li>
<li>在 Modify List 中选择 Unwrap UVW<br /></li>
<li>在 EditUVs 选项组中，点击 Open UV Editor<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org0fc079a" class="outline-5">
<h5 id="org0fc079a">如何显示模型的法线？</h5>
<div class="outline-text-5" id="text-org0fc079a">
<p>
<a href="http://www.moxingyun.com/news/detail-jichu-1008798368.html">http://www.moxingyun.com/news/detail-jichu-1008798368.html</a><br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org13b3a09" class="outline-3">
<h3 id="org13b3a09">动画</h3>
<div class="outline-text-3" id="text-org13b3a09">
</div>
<div id="outline-container-org8198b44" class="outline-4">
<h4 id="org8198b44">基础知识</h4>
<div class="outline-text-4" id="text-org8198b44">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">关键帧类型</th>
<th scope="col" class="org-left">颜色</th>
<th scope="col" class="org-left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Planted Key (踩踏/固定关键帧)</td>
<td class="org-left">橙色</td>
<td class="org-left">站军姿 等动作，为保持一动不动时使用</td>
</tr>

<tr>
<td class="org-left">Sliding Key(滑动关键点)</td>
<td class="org-left">黄色</td>
<td class="org-left">走路、跑步等运动中任何一直接触地面的部位都用滑动关键帧</td>
</tr>

<tr>
<td class="org-left">Free Key(自由关键帧)</td>
<td class="org-left">黑色</td>
<td class="org-left">运动中不会一直接触地面的部位都用自由关键帧</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org1808858" class="outline-4">
<h4 id="org1808858">骨骼绑定步骤</h4>
<div class="outline-text-4" id="text-org1808858">
</div>
<div id="outline-container-org32a6271" class="outline-5">
<h5 id="org32a6271">分析模型</h5>
<div class="outline-text-5" id="text-org32a6271">
<p>
性别 女<br />
个性 豪放<br />
职业 坦克(肉盾) 保护队友 控制<br />
形体 人形 两足(无残缺)<br />
</p>
</div>
</div>
<div id="outline-container-org5a390df" class="outline-5">
<h5 id="org5a390df">分析模型需要活动的部位和道具</h5>
<div class="outline-text-5" id="text-org5a390df">
</div>
<div id="outline-container-org3135682" class="outline-6">
<h6 id="org3135682">CS 人形骨骼自带</h6>
<div class="outline-text-6" id="text-org3135682">
<p>
手<br />
脚<br />
头<br />
躯干<br />
</p>
</div>
</div>
<div id="outline-container-org0591610" class="outline-6">
<h6 id="org0591610">Bones 骨骼</h6>
<div class="outline-text-6" id="text-org0591610">
<p>
盾牌<br />
武器<br />
头发<br />
飘带(衣服的裙摆)<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org3483a6c" class="outline-5">
<h5 id="org3483a6c">骨骼配置</h5>
<div class="outline-text-5" id="text-org3483a6c">
<ol class="org-ol">
<li>确定骨骼重心 与模型重心吻合<br /></li>
<li>配置腰或者腿骨骼 让骨骼关节和模型关节吻合<br /></li>
<li>根据模型布线来确定躯干<br /></li>
<li>确定肩 骨骼肩膀末端（靠近胸的一端）的旋转点要在模型锁骨位置，前端与模型大臂相吻合<br /></li>
<li>配置手臂，手，手指<br /></li>
<li>配置头<br /></li>
</ol>
</div>
</div>
</div>
</div>

<div id="outline-container-org3b6fcc6" class="outline-3">
<h3 id="org3b6fcc6">MaxScript</h3>
<div class="outline-text-3" id="text-org3b6fcc6">
</div>
<div id="outline-container-orgee02792" class="outline-4">
<h4 id="orgee02792">基础语法</h4>
<div class="outline-text-4" id="text-orgee02792">
</div>
<div id="outline-container-org4415a35" class="outline-5">
<h5 id="org4415a35">if</h5>
<div class="outline-text-5" id="text-org4415a35">
<div class="org-src-container">
<pre class="src src-maxscript">-- if
if a&lt;b do
(
	-- ...
)

-- if then else
if a&lt;b then
(
	-- ...
)
else
(
	-- ...
)
</pre>
</div>
</div>
</div>
<div id="outline-container-org32303ca" class="outline-5">
<h5 id="org32303ca">for 循环</h5>
<div class="outline-text-5" id="text-org32303ca">
<div class="org-src-container">
<pre class="src src-maxscript">方式一
for i= 1 to tagInfoArr.count do
(
    local tagID = GetIDByName tagInfoArr[i].name
    if tagID==-1 do
    (
        tagID = FrameTagManager.CreateNewTag tagInfoArr[i].name 0
    )
    tagInfoArr[i].id = tagID
)
方式二
for i in 1 to tagInfoArr.count by 2 do
(
    local startTime = FrameTagManager.GetTimeByID tagInfoArr[i].id
    local endTime = FrameTagManager.GetTimeByID tagInfoArr[i+1].id
    local dur = endTime - startTime
    format "i=% dur=%\n" i dur
    if dur&gt;0 do
    (
        configStr = "\n"
        continue
    )
)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf2c79a4" class="outline-5">
<h5 id="orgf2c79a4">string</h5>
<div class="outline-text-5" id="text-orgf2c79a4">
<div class="org-src-container">
<pre class="src src-maxscript">-- 字符串转 float
"12.1" as float
-- 字符串替换
substituteString srcStr oldStr newStr
local csvFileName = substituteString maxFileName ".max" ".csv"
-- 字符串查找
local tmpIdx = findString tagName endTagNameSuffix
return tmpIdx!=undefined
</pre>
</div>
<p>
<a href="http://docs.autodesk.com/3DSMAX/16/ENU/MAXScript-Help/index.html?url=files/GUID-A6A60FC7-6206-4FFC-80E2-0EF8544BE2C4.htm,topicNumber=d30e158996">http://docs.autodesk.com/3DSMAX/16/ENU/MAXScript-Help/index.html?url=files/GUID-A6A60FC7-6206-4FFC-80E2-0EF8544BE2C4.htm,topicNumber=d30e158996</a><br />
</p>
</div>
</div>
<div id="outline-container-orga1b5087" class="outline-5">
<h5 id="orga1b5087">数组</h5>
<div class="outline-text-5" id="text-orga1b5087">
<div class="org-src-container">
<pre class="src src-maxscript">-- 定义数组
a = #(1,2,3,4)
-- 数组连接
join a #(5,6,7,8)
-- 打印数组元素个数
print a.count
-- 数组排序
fn CompareFunc lhs rhs =
(
    case of
    (
        (lhs.startTime &lt; rhs.startTime):-1
        (lhs.startTime &gt; rhs.startTime):1
        default:0
    )
)
qsort tagInfoArr CompareFunc
</pre>
</div>
<ul class="org-ul">
<li>参考资料 <a href="http://docs.autodesk.com/3DSMAX/15/ENU/MAXScript-Help/index.html?url=files/GUID-A5B54C67-BFDD-45C0-9D6B-E6869817282A.htm,topicNumber=d30e171865">http://docs.autodesk.com/3DSMAX/15/ENU/MAXScript-Help/index.html?url=files/GUID-A5B54C67-BFDD-45C0-9D6B-E6869817282A.htm,topicNumber=d30e171865</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgd58a70e" class="outline-5">
<h5 id="orgd58a70e">结构体</h5>
<div class="outline-text-5" id="text-orgd58a70e">
<div class="org-src-container">
<pre class="src src-maxscript">-- 定义结构体 person
Struct person (name, height, age, sex)

-- 定义结构体实例
Bill = person name:"Bill" height:72 age:34 sex:#male
Joe = person name:"Joseph" sex:#male

-- 封装方法
struct myGlobals
(
	myVar1 = undefined,
	myVar2 = undefined,
	myVar3 = undefined,
	mytext = undefined,

	fn run filename =
	(
		mytext = "I'm yours, master!"
		filein filename
	)
)
global myInstance = myGlobals()
myInstance.run "slave.ms"
</pre>
</div>
<ul class="org-ul">
<li>参考资料 <a href="http://help.autodesk.com/view/3DSMAX/2016/ENU/?guid=__files_GUID_A35C74C5_1721_4B19_9FC4_E1CD6563505B_htm">http://help.autodesk.com/view/3DSMAX/2016/ENU/?guid=__files_GUID_A35C74C5_1721_4B19_9FC4_E1CD6563505B_htm</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8c9febf" class="outline-4">
<h4 id="org8c9febf">各种功能</h4>
<div class="outline-text-4" id="text-org8c9febf">
</div>
<div id="outline-container-org0eceb48" class="outline-5">
<h5 id="org0eceb48">文件操作</h5>
<div class="outline-text-5" id="text-org0eceb48">
<div class="org-src-container">
<pre class="src src-maxscript">-- 打开 csv 文件
filePath = getOpenFileName types:"Excel(*.csv)|*.csv|"
</pre>
</div>
<p>
<a href="https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2017/ENU/MAXScript-Help/files/GUID-D4B43A33-8342-4BC9-80AB-91460861D37C-htm.html">https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2017/ENU/MAXScript-Help/files/GUID-D4B43A33-8342-4BC9-80AB-91460861D37C-htm.html</a><br />
<a href="https://www.vfxarabia.co/read-external-text-file">https://www.vfxarabia.co/read-external-text-file</a><br />
</p>
</div>
</div>
<div id="outline-container-org0bfa9c8" class="outline-5">
<h5 id="org0bfa9c8">和 3dsmax 系统界面交互</h5>
<div class="outline-text-5" id="text-org0bfa9c8">
<div class="org-src-container">
<pre class="src src-maxscript">-- 显示动画时间配置框
max time config
</pre>
</div>
<p>
<a href="http://docs.autodesk.com/3DSMAX/16/ENU/MAXScript-Help/index.html?url=files/GUID-846B6AB0-EFF6-43E5-8A67-8D348FF78A57.htm,topicNumber=d30e724211">http://docs.autodesk.com/3DSMAX/16/ENU/MAXScript-Help/index.html?url=files/GUID-846B6AB0-EFF6-43E5-8A67-8D348FF78A57.htm,topicNumber=d30e724211</a><br />
</p>
</div>
</div>
<div id="outline-container-orge861487" class="outline-5">
<h5 id="orge861487">读写配置文件</h5>
<div class="outline-text-5" id="text-orge861487">
<div class="org-src-container">
<pre class="src src-maxscript">fn SetBoolINISetting key value=
(
-- 		print ("--" + value)
    setINISetting hdxINIFile hdxINISection key value
),

fn GetBoolINISetting key=
(
    local value = getINISetting hdxINIFile hdxINISection key
-- 		print ("--" + value)
    return value=="true"
),
</pre>
</div>
</div>
</div>
<div id="outline-container-org38fb215" class="outline-5">
<h5 id="org38fb215">遍历</h5>
</div>
</div>
<div id="outline-container-org5a323f6" class="outline-4">
<h4 id="org5a323f6">Tips</h4>
<div class="outline-text-4" id="text-org5a323f6">
</div>
<div id="outline-container-org83ff539" class="outline-5">
<h5 id="org83ff539">print 比较诡异</h5>
<div class="outline-text-5" id="text-org83ff539">
<div class="org-src-container">
<pre class="src src-maxscript">print "hello -&gt;" + "world"
-- output: 输出两次
-- "hello -&gt;"
-- "hello -&gt;world"

print("hello -&gt;" + "world")
-- output: 输出两次
-- "hello -&gt;world"
-- "hello -&gt;world"
</pre>
</div>
</div>
</div>
<div id="outline-container-org5c548e0" class="outline-5">
<h5 id="org5c548e0">maxscript 变量不分大小写</h5>
<div class="outline-text-5" id="text-org5c548e0">
<div class="org-src-container">
<pre class="src src-maxscript">-- 下面会重名
local tmpIdx = 1
local TmpIdx = 2
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcaac15b" class="outline-5">
<h5 id="orgcaac15b">删除老的 macroscript</h5>
<div class="outline-text-5" id="text-orgcaac15b">
<p>
删除#userScripts 目录下的脚本即可。<br />
#userScripts 的值为 "C:\Users\&lt;UserName&gt;\AppData\Local\Autodesk\3dsMax\&lt;ReleaseNumber&gt; - 64bit\ENU\scripts"<br />
<a href="https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2015/ENU/MAXScript-Help/files/GUID-F7577416-051E-478C-BB5D-81243BAAC8EC-htm.html">https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2015/ENU/MAXScript-Help/files/GUID-F7577416-051E-478C-BB5D-81243BAAC8EC-htm.html</a><br />
</p>
</div>
</div>
<div id="outline-container-org4871867" class="outline-5">
<h5 id="org4871867">maxscript &#x2013;Type error: Call needs function or class, got:undefined</h5>
<div class="outline-text-5" id="text-org4871867">
<p>
安装 maxscript 后，重启 3ds max，执行安装的脚本，报错：maxscript &#x2013;Type error: Call needs function or class, got:undefined<br />
解决方案：<br />
将脚本放到 C:\Program Files\Autodesk\3ds Max 2014\stdplugs\stdscripts 目录下安装就可以了<br />
</p>
</div>
</div>
<div id="outline-container-orgf1be2ff" class="outline-5">
<h5 id="orgf1be2ff">&#x2013; No ""eof"" function for undefined &lt;&lt;</h5>
<div class="outline-text-5" id="text-orgf1be2ff">
<p>
打开文件时报如上错误。<br />
解决方案：<br />
查看被打开的文件是否被其他程序打开了，将其他程序关闭再执行。<br />
</p>
</div>
</div>
<div id="outline-container-org46d3ee6" class="outline-5">
<h5 id="org46d3ee6">Runtime error: Cannot directly set animation context time - use "at time&#x2026;".</h5>
<div class="outline-text-5" id="text-org46d3ee6">
<div class="org-src-container">
<pre class="src src-maxscript">-- 不能直接设置 currentTime
currentTime = 10
-- 需要使用 sliderTime
sliderTime = 10
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org952d902" class="outline-4">
<h4 id="org952d902">参考资料</h4>
<div class="outline-text-4" id="text-org952d902">
<ul class="org-ul">
<li>官方语言参考 <a href="http://help.autodesk.com/view/3DSMAX/2015/ENU/?guid=__files_GUID_6FC81BE7_58FF_4C63_8362_0BDCFA9F904C_htm">http://help.autodesk.com/view/3DSMAX/2015/ENU/?guid=__files_GUID_6FC81BE7_58FF_4C63_8362_0BDCFA9F904C_htm</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org9c0ae3d" class="outline-3">
<h3 id="org9c0ae3d">ERROR</h3>
</div>
<div id="outline-container-org9005ee8" class="outline-3">
<h3 id="org9005ee8">参考资料</h3>
<div class="outline-text-3" id="text-org9005ee8">
</div>
<div id="outline-container-orgbbc1c61" class="outline-4">
<h4 id="orgbbc1c61">基础</h4>
<div class="outline-text-4" id="text-orgbbc1c61">
<ul class="org-ul">
<li>3ds max9 自学教程 <a href="https://jingyan.baidu.com/season/45515">https://jingyan.baidu.com/season/45515</a><br /></li>
<li>3ds max 制作简单动画 <a href="https://jingyan.baidu.com/article/91f5db1bcd438e1c7e05e370.html">https://jingyan.baidu.com/article/91f5db1bcd438e1c7e05e370.html</a><br /></li>
<li>3ds max 官方参考  <a href="https://www.autodesk.com/cn/3dsmax/2012help/index.html">https://www.autodesk.com/cn/3dsmax/2012help/index.html</a><br /></li>
<li>3ds max 导出 fbx 到 unity <a href="http://www.cnblogs.com/wantnon/p/4564522.html">http://www.cnblogs.com/wantnon/p/4564522.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org63b469a" class="outline-4">
<h4 id="org63b469a">建模</h4>
<div class="outline-text-4" id="text-org63b469a">
<ul class="org-ul">
<li>Zbrush-次时代 游戏角色建模 <a href="https://study.163.com/course/courseMain.htm?courseId=1002859005">https://study.163.com/course/courseMain.htm?courseId=1002859005</a><br /></li>
<li>次世代游戏角色模型制作 <a href="https://study.163.com/course/introduction.htm?courseId=910003#/courseDetail?tab=1">https://study.163.com/course/introduction.htm?courseId=910003#/courseDetail?tab=1</a><br /></li>
<li>3D 游戏角色模型—将军制作流程 <a href="http://blog.sina.com.cn/s/blog_9f9269470101l0rd.html">http://blog.sina.com.cn/s/blog_9f9269470101l0rd.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgc198a5a" class="outline-4">
<h4 id="orgc198a5a">动画</h4>
<div class="outline-text-4" id="text-orgc198a5a">
<ul class="org-ul">
<li>用电脑制作 3D 动画详细过程是怎样的? <a href="https://www.zhihu.com/question/31554729">https://www.zhihu.com/question/31554729</a><br /></li>
<li>茶壶动画制作 <a href="https://v.qq.com/x/cover/k4cc6kvbc7bi0qj/y1415xd6w3n.html">https://v.qq.com/x/cover/k4cc6kvbc7bi0qj/y1415xd6w3n.html</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org1a462c8" class="outline-2">
<h2 id="org1a462c8">Tools</h2>
<div class="outline-text-2" id="text-org1a462c8">
<ul class="org-ul">
<li>aseprite 像素风制作工具 <a href="https://github.com/aseprite/aseprite">https://github.com/aseprite/aseprite</a><br /></li>
<li>SpriteIlluminator 2d normal 制作工具 <a href="https://www.codeandweb.com/spriteilluminator">https://www.codeandweb.com/spriteilluminator</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="vssue"></div>
        <link rel="stylesheet" href="https://unpkg.com/vssue/dist/vssue.min.css">
        <script src="https://unpkg.com/vue@2.7.10/dist/vue.runtime.min.js"></script>
        <script src="https://unpkg.com/vssue/dist/vssue.github.min.js"></script>
        <script>
          new Vue({
            el: '#vssue',
            render: h => h('Vssue', {
              props: {
                // 在这里设置当前页面对应的 Issue 标题
                title: 'ArtTools',

                // 在这里设置你使用的平台的 OAuth App 配置
                options: {
                    owner: 'wolfand11',
                    repo: 'blog_comments',
                    clientId: 'a02b49185d85859cb92c',
                    clientSecret: '6f123085c6f1ce339e2517d24e5b099fa1dc9c85', // 只有在使用某些平台时需要
                },
              }
            })
          })
        </script>
</div>
</body>
</html>