<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-11-28 Tue 17:24 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Houdini</title>
<meta name="generator" content="Org Mode" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
         <meta name="viewport" content="width=device-width, initial-scale=1" />
         <link rel="stylesheet" title="Standard" href="https://wolfand11.github.io/res/worg_theme/css/worg.css" type="text/css" />
         <link rel="alternate stylesheet" title="Zenburn" href="https://wolfand11.github.io/res/worg_theme/css/worg-zenburn.css" type="text/css" />
         <link rel="alternate stylesheet" title="Classic" href="https://wolfand11.github.io/res/worg_theme/css/worg-classic.css" type="text/css" />
         <link rel="icon" href="https://wolfand11.github.io/res/favicon.ico" type="image/ico" />
         <script type="text/javascript" src="https://wolfand11.github.io/res/blog-tools.js"></script>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://wolfand11.github.io"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">Houdini</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org27d3ba1">Houdini</a>
<ul>
<li><a href="#org7f3ef42">基本信息 配置</a>
<ul>
<li><a href="#org253ce73">安装 SIDEFX LABS</a></li>
<li><a href="#org0c85ba7">安装 Unity Houdini Plugin</a></li>
<li><a href="#org9694218">安装 Unreal Houdini Plugin</a></li>
</ul>
</li>
<li><a href="#orge2d50e8">基本操作</a></li>
<li><a href="#org2d30eb9">Houdini 模块说明</a></li>
<li><a href="#orgf9aee42">变量</a></li>
<li><a href="#orga3a5def">函数</a></li>
<li><a href="#org5fa2683">参考资料</a></li>
</ul>
</li>
<li><a href="#orge66367d">Expressions</a>
<ul>
<li><a href="#org8120b87">参考资料</a></li>
</ul>
</li>
<li><a href="#org74df09c">Vex</a>
<ul>
<li><a href="#orgb181a8d">Base</a>
<ul>
<li><a href="#orga6cb43f">data type</a>
<ul>
<li><a href="#org599ee03">struct</a>
<ul>
<li><a href="#orgc9baba4">struct function</a></li>
<li><a href="#org24c3c78">mantra specific type</a></li>
</ul>
</li>
<li><a href="#org3ebed32">type casting</a>
<ul>
<li><a href="#orga1941bb">variable casting</a></li>
<li><a href="#org9e9f817">function casting</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcb1d0cf">operator</a>
<ul>
<li><a href="#orgdff7d77">Dot Operator</a></li>
<li><a href="#org63cef95">Comparisons Operator</a></li>
<li><a href="#orgfce7708">Precedence Table 优先级表格</a></li>
<li><a href="#org609cd17">Operator type interactions</a></li>
</ul>
</li>
<li><a href="#org7d00c60">statements</a>
<ul>
<li><a href="#org9859441">语句块</a></li>
<li><a href="#org92d50d6">loop and flow control</a>
<ul>
<li><a href="#org616913c">do loop</a></li>
<li><a href="#org921ea10">for loop</a></li>
<li><a href="#org32142a9">foreach loop</a></li>
<li><a href="#orga451da8">while loop</a></li>
<li><a href="#orgeba4ebc">Other looping statements</a></li>
<li><a href="#orgeaf500e">if break continue return</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0c0dd1c">comment</a></li>
<li><a href="#org43f5c8e">context</a></li>
<li><a href="#orgce0ee9e">function</a>
<ul>
<li><a href="#org807e4c2">built-in function</a></li>
<li><a href="#org528f50a">user defined function</a></li>
<li><a href="#orgfba2eb1">Main (context) function</a></li>
<li><a href="#org7bf969b">User interface pragmas</a></li>
</ul>
</li>
<li><a href="#orga65682a">参考资料</a></li>
</ul>
</li>
<li><a href="#orgfb99fc0">Vex Expressions</a>
<ul>
<li><a href="#org0f63dbf">Overview</a></li>
<li><a href="#org2177843">Why VEX for ad-hoc modifications? 为什么使用 Vex 来实现专门的修改？</a></li>
<li><a href="#org6eee3a9">Syntax</a></li>
<li><a href="#org92dbefa">Accessing parameter values</a></li>
<li><a href="#org5171408">Accessing geometry attributes and info</a>
<ul>
<li><a href="#orgf1cd5d0">Accessing attributes on other inputs</a></li>
<li><a href="#orgcb3a6ed">Declaring attributes</a></li>
<li><a href="#orgd91e9dc">Indexing variables</a>
<ul>
<li><a href="#orgdeae7c0">@elemnum</a></li>
<li><a href="#orgd739a70">@numelem</a></li>
<li><a href="#org64caf92">@ptnum</a></li>
<li><a href="#org91e1c25">@primnum</a></li>
<li><a href="#org7520e87">@vtxnum</a></li>
<li><a href="#org69cf501">@numpt</a></li>
<li><a href="#org1f02633">@numprim</a></li>
<li><a href="#org5c4bf8a">@vtxnum</a></li>
<li><a href="#org8e3e076">@numvtx</a></li>
<li><a href="#orga3fd7df">TIPS</a></li>
</ul>
</li>
<li><a href="#org235924d">Accessing globals</a></li>
</ul>
</li>
<li><a href="#org07d6d2b">Creating geometry</a></li>
<li><a href="#orga49a85b">Geometry traversal functions</a></li>
<li><a href="#orgeb60290">Accessing group membership</a></li>
<li><a href="#org49230e7">User-defined functions</a></li>
<li><a href="#org0f5e6c1">Includes</a></li>
<li><a href="#orge0335b9">Gotchas 陷阱</a></li>
<li><a href="#org87754fd">Tips</a></li>
<li><a href="#orgcf9fdf2">Troubleshooting error messages</a>
<ul>
<li><a href="#org6097741">Syntax error, unexpected '}', expecting ';'</a></li>
<li><a href="#org14713bc">SRead-only expression given for read/write parameter</a></li>
<li><a href="#org8c11fa4">Syntax error, unexpected identifier, expecting '}'.</a></li>
<li><a href="#org8d153e4">使用 $F 动画没生效</a></li>
<li><a href="#org66fea71">将 vector 属性赋值给其他属性时，z 分量的值错误</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org70a3816">Usage</a></li>
<li><a href="#org3312eb5">参考资料</a></li>
</ul>
</li>
<li><a href="#orga4f7063">Usage</a>
<ul>
<li><a href="#org5120337">修改项目路径</a></li>
<li><a href="#org827f238">预览 uv, 预览 vertex color R 通道</a></li>
<li><a href="#orga23b186">Tex to Vertex Color</a></li>
<li><a href="#org25ccc49">Copy vertex color from neareat point</a></li>
<li><a href="#org85b676c">hipnc 文件转 hip 文件</a></li>
</ul>
</li>
<li><a href="#orgc633607">Case Study</a>
<ul>
<li><a href="#org2da8a88">Official</a>
<ul>
<li><a href="#orgd965469">modeling</a>
<ul>
<li><a href="#org503e0c1">ERROR Bracelet Case - chain 链接到手环上时，chain 大小非常小</a></li>
<li><a href="#org45096f7">ERROR Bracelet Case - chain 有些暗</a></li>
</ul>
</li>
<li><a href="#orgbe65b4f">character rigging</a></li>
<li><a href="#org0a202f9">game development</a>
<ul>
<li><a href="#orgf1c4eb1">Realtime FX</a>
<ul>
<li><a href="#org90ca7b0">magic-projectile-fx-for-unity</a></li>
<li><a href="#org5940f9f">destruction-fx-for-realtime</a></li>
<li><a href="#orga677ff8">procedural-stream</a></li>
</ul>
</li>
<li><a href="#orgb52b613">Unity</a>
<ul>
<li><a href="#orga508601">guard-tower</a></li>
<li><a href="#orgecdf8e0">sci-fi-level-design</a></li>
<li><a href="#orgf0d2ae9">vertex animation textures in unity</a></li>
<li><a href="#org53c5277">flowmaps</a></li>
</ul>
</li>
<li><a href="#orgf5b32a0">Unreal</a>
<ul>
<li><a href="#org8add100">procedural desert</a></li>
</ul>
</li>
<li><a href="#org2407ba8">World Building</a>
<ul>
<li><a href="#org3b4a451">The Complete A-Z Terrain Handbook</a></li>
</ul>
</li>
<li><a href="#org4e1e221">Game Tools</a></li>
<li><a href="#org06a8d80">Common</a>
<ul>
<li><a href="#orgb16a4ff">imposter</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3e17527">visual effects</a>
<ul>
<li><a href="#org32633b3">Pyro FX</a></li>
<li><a href="#orgc8d4cd0">Fluids</a>
<ul>
<li><a href="#org41d8129">Crashing Wave</a></li>
<li><a href="#org12991d4">CallofDuty Oceans</a></li>
</ul>
</li>
<li><a href="#org5387ea3">Destruction FX</a></li>
</ul>
</li>
<li><a href="#org796982d">character fx</a>
<ul>
<li><a href="#org81c68e7">Cloth</a>
<ul>
<li><a href="#orgb3d8244">Vellum Workflow Concepts</a></li>
<li><a href="#org6cab2fc">Fix Unreal Cloth from Going Crazy</a></li>
</ul>
</li>
<li><a href="#orgcd9f764">Hair&amp;Fur</a></li>
<li><a href="#org56c9951">Crowds</a></li>
</ul>
</li>
<li><a href="#orgca4a9e3">pipeline</a>
<ul>
<li><a href="#orgd142653">PDG (procedural dependency graph)</a></li>
<li><a href="#org161bec6">Vex</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8b2e815">ERROR</a>
<ul>
<li>
<ul>
<li><a href="#org66950ab">Visualizer 不显示 Visualizers 选项卡</a></li>
<li><a href="#org87173d6">Houdini 场景中灰白色为蓝色</a></li>
<li><a href="#org002ab8b">Houdini BakeTexture Error</a>
<ul>
<li><a href="#org035d1a3">结果为白色图</a></li>
<li><a href="#orga1c9cca">结果为黑色图</a>
<ul>
<li><a href="#org9de6f09">case 1</a></li>
<li><a href="#orgf76bdb9">case 2</a></li>
<li><a href="#org137d6d8">case 3</a></li>
</ul>
</li>
<li><a href="#orgb76b245">烘培报错</a>
<ul>
<li><a href="#orgad21479">case 1</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0b30b57">ERROR Failed to save output to file "UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 17: invalid start byte</a></li>
<li><a href="#org331c730">line Sweep follow curve error</a>
<ul>
<li><a href="#orga5788d5">ERROR 1</a></li>
<li><a href="#orgdf344ae">ERROR 2</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd389ac6">参考资料</a></li>
</ul>
</div>
</div>
<p>
Vex note.<br />
</p>
<div class="HTML" id="org48b7b41">
<p>
&lt;!&#x2013; more &#x2013;&gt;<br />
</p>

</div>
<div id="outline-container-org27d3ba1" class="outline-2">
<h2 id="org27d3ba1">Houdini</h2>
<div class="outline-text-2" id="text-org27d3ba1">
</div>
<div id="outline-container-org7f3ef42" class="outline-3">
<h3 id="org7f3ef42">基本信息 配置</h3>
<div class="outline-text-3" id="text-org7f3ef42">
<p>
license 存储路径<br />
</p>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/faq/question/where-are-the-license-files-located/">https://www.sidefx.com/faq/question/where-are-the-license-files-located/</a><br /></li>
</ul>

<p>
保存当前窗口布局<br />
</p>

<div id="orgbef5738" class="figure">
<p><img src="./Houdini/save-desktop-layout.png" alt="save-desktop-layout.png" width="800px" /><br />
</p>
</div>
</div>

<div id="outline-container-org253ce73" class="outline-4">
<h4 id="org253ce73">安装 SIDEFX LABS</h4>
<div class="outline-text-4" id="text-org253ce73">

<div id="org2fbe0f3" class="figure">
<p><img src="./Houdini/sidefxlabs-install.png" alt="sidefxlabs-install.png" width="600px" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org0c85ba7" class="outline-4">
<h4 id="org0c85ba7">安装 Unity Houdini Plugin</h4>
<div class="outline-text-4" id="text-org0c85ba7">
<p>
去 github 下载 plugin，将 plugin copy 到 TestProj/Assets/Plugins/目录下。<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/sideeffects/HoudiniEngineForUnity">https://github.com/sideeffects/HoudiniEngineForUnity</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org9694218" class="outline-4">
<h4 id="org9694218">安装 Unreal Houdini Plugin</h4>
<div class="outline-text-4" id="text-org9694218">
<p>
去 github 下载 plugin，目录名称改为 HoudiniEngine。将 plugin copy 到 TestProj/Plugins/Runtime/ 目录下。<br />
打开 UE 工程，会提示是否编译。选择 Yes 之后，需要等待很长一段时间。最终编译结果会放在 TestProj\Plugins\Runtime\HoudiniEngine\Binaries\Win64 目录下。<br />
</p>

<ul class="org-ul">
<li><a href="https://github.com/sideeffects/HoudiniEngineForUnreal">https://github.com/sideeffects/HoudiniEngineForUnreal</a><br /></li>
<li><a href="https://www.bilibili.com/read/cv16472917">https://www.bilibili.com/read/cv16472917</a><br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orge2d50e8" class="outline-3">
<h3 id="orge2d50e8">基本操作</h3>
<div class="outline-text-3" id="text-orge2d50e8">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">分类</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Desktop/SaveCurrentDesktop</td>
<td class="org-left">保存当前窗口布局</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Enter</td>
<td class="org-left">进入物体编辑模式</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Ctrl+b</td>
<td class="org-left">当前窗口全屏显示</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">ESC</td>
<td class="org-left">进入视图编辑模式</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Alt + Mouse</td>
<td class="org-left">编辑模式进行视图操作</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Ctrl+Box</td>
<td class="org-left">在原点创建 Box</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Mouse Middle Click</td>
<td class="org-left">显示 Node 变量的值</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Ctrl+Mouse Middle Click</td>
<td class="org-left">变量恢复默认值</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">shift+w</td>
<td class="org-left">开启/关闭 线框模式</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">hold c / v / x</td>
<td class="org-left">View 视图中长按 c / v / x，打开扇形菜单</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">m</td>
<td class="org-left">move 切换世界/物体坐标系</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Node</td>
<td class="org-left">Shift+s</td>
<td class="org-left">节点连线变圆滑</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Node</td>
<td class="org-left">Shift+l</td>
<td class="org-left">自动布局选中的节点</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Node</td>
<td class="org-left">hold y</td>
<td class="org-left">剪断连线</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Node</td>
<td class="org-left">Alt Drag Node</td>
<td class="org-left">复制节点</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">VOP Node</td>
<td class="org-left">Mouse Middle Click Input</td>
<td class="org-left">VOP 节点输入 Promote Parameter</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Tips：<br />
</p>
<ul class="org-ul">
<li>Global UI Scale 设置: Edit/Preferences/Global UI Scale<br /></li>
<li>radial 菜单中，可以查看扇形菜单的快捷键。c 对应 current， v 对应 view，x 对应 snap<br /></li>
<li>DisplayOptions/Guides/Origin gnomon (View 视图中显示坐标轴) (快捷键 d 显示 DisplayOptions)<br /></li>
</ul>


<div id="org522bef8" class="figure">
<p><img src="./Houdini/houdini-DisplayOptions.jpg" alt="houdini-DisplayOptions.jpg" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org2d30eb9" class="outline-3">
<h3 id="org2d30eb9">Houdini 模块说明</h3>
<div class="outline-text-3" id="text-org2d30eb9">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">缩写</th>
<th scope="col" class="org-left">全称</th>
<th scope="col" class="org-left">默认路径</th>
<th scope="col" class="org-left">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Obj</td>
<td class="org-left">object</td>
<td class="org-left">/obj</td>
<td class="org-left">物体模块</td>
</tr>

<tr>
<td class="org-left">SOP</td>
<td class="org-left">surface operation</td>
<td class="org-left"><i>obj</i></td>
<td class="org-left">表明操作模块</td>
</tr>

<tr>
<td class="org-left">POP</td>
<td class="org-left">particles operation</td>
<td class="org-left"><i>part</i></td>
<td class="org-left">粒子模块</td>
</tr>

<tr>
<td class="org-left">DOP</td>
<td class="org-left">dynamics operation</td>
<td class="org-left">/dynamics</td>
<td class="org-left">动力学模块</td>
</tr>

<tr>
<td class="org-left">shop</td>
<td class="org-left">shader operation</td>
<td class="org-left">/shop</td>
<td class="org-left">材质模块</td>
</tr>

<tr>
<td class="org-left">VOP</td>
<td class="org-left">Vector operation</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">向量模块</td>
</tr>

<tr>
<td class="org-left">CHOP</td>
<td class="org-left">channel operation</td>
<td class="org-left">/ch</td>
<td class="org-left">动画和声音通道模块</td>
</tr>

<tr>
<td class="org-left">COP</td>
<td class="org-left">compositing operation</td>
<td class="org-left">/img</td>
<td class="org-left">合成模块</td>
</tr>

<tr>
<td class="org-left">ROP</td>
<td class="org-left">render outputs</td>
<td class="org-left">/out</td>
<td class="org-left">渲染输出模块</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf9aee42" class="outline-3">
<h3 id="orgf9aee42">变量</h3>
<div class="outline-text-3" id="text-orgf9aee42">
<pre class="example" id="org0842f60">
$FF 帧数
$T  时间

@Time         时间
@P            位置
@V            速度
@ptnum        点索引
@pscale       点的缩放
@primnum      面索引

@group_x      定义组
</pre>

<p>
Houdini 的默认单位是 1 米，即网格线的一格。默认重量是 1KG。<br />
</p>
</div>
</div>

<div id="outline-container-orga3a5def" class="outline-3">
<h3 id="orga3a5def">函数</h3>
<div class="outline-text-3" id="text-orga3a5def">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">opname("..")</td>
<td class="org-left">当前节点的名称</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5fa2683" class="outline-3">
<h3 id="org5fa2683">参考资料</h3>
<div class="outline-text-3" id="text-org5fa2683">
<ul class="org-ul">
<li>官网教程 <a href="https://www.sidefx.com/learn/">https://www.sidefx.com/learn/</a><br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orge66367d" class="outline-2">
<h2 id="orge66367d">Expressions</h2>
<div class="outline-text-2" id="text-orge66367d">
</div>
<div id="outline-container-org8120b87" class="outline-3">
<h3 id="org8120b87">参考资料</h3>
<div class="outline-text-3" id="text-org8120b87">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/network/expressions.html">https://www.sidefx.com/docs/houdini/network/expressions.html</a><br /></li>
<li><a href="https://www.sidefx.com/docs/houdini/expressions/index.html">https://www.sidefx.com/docs/houdini/expressions/index.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org74df09c" class="outline-2">
<h2 id="org74df09c">Vex</h2>
<div class="outline-text-2" id="text-org74df09c">
</div>
<div id="outline-container-orgb181a8d" class="outline-3">
<h3 id="orgb181a8d">Base</h3>
<div class="outline-text-3" id="text-orgb181a8d">
</div>
<div id="outline-container-orga6cb43f" class="outline-4">
<h4 id="orga6cb43f">data type</h4>
<div class="outline-text-4" id="text-orga6cb43f">
<p>
Vex 引擎可以在 32 位 或 64 位模式下运行。32 位模式下，所有 floats,vectors,以及 integers 都是 32 位的，64 位模式下，则都为 64 位。<br />
为方便肉眼识别,数之间可以使用下划线分割。如：1_000_000, 1.000_000_000_999<br />
{ {1,0,0,0}, {0,1,0,0}, {0,0,1,0}, {0,0,0,1} }<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Type</th>
<th scope="col" class="org-left">Definition</th>
<th scope="col" class="org-left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">int</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">21, -3, 0x31, 0b1001, 0212, 1_000_000</td>
</tr>

<tr>
<td class="org-left">float</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">21.3, -3.2, 1.0, 0.000_000_1</td>
</tr>

<tr>
<td class="org-left">vector2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">{0,0}, {0.3,0.5}</td>
</tr>

<tr>
<td class="org-left">vector</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">vector4</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">{0,0,0,1}, {0.3,0.5,-0.5,0.2}</td>
</tr>

<tr>
<td class="org-left">array</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">{ 1, 2, 3, 4, 5, 6, 7, 8 }</td>
</tr>

<tr>
<td class="org-left">struct</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">matrix2</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">{ {1,0}, {0,1} }</td>
</tr>

<tr>
<td class="org-left">matrix3</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">{ {1,0,0}, {0,1,0}, {0,0,1} }</td>
</tr>

<tr>
<td class="org-left">matrix</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">{ {1,0,0,0}, {0,1,0,0}, {0,0,1,0}, {0,0,0,1} }</td>
</tr>

<tr>
<td class="org-left">string</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">"hello world"</td>
</tr>

<tr>
<td class="org-left">dict</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">bsdf</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org599ee03" class="outline-5">
<h5 id="org599ee03">struct</h5>
<div class="outline-text-5" id="text-org599ee03">
<p>
使用 struct 可以定义结构体，和 c++11 类似，结构体成员可以进行成员初始化。结构体会隐式定义两个构造函数，一个以初始化参数为参数（参数顺序和成员定义顺序一致），一个不携带任何参数，其将所有成员设置为默认值。<br />
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #2d9574;">&lt;math.h&gt;</span>

<span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">basis</span> {
    <span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">i</span>, <span style="color: #7590db;">j</span>, <span style="color: #7590db;">k</span>;
}

<span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">bases</span> {
    <span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #7590db;">m</span>, <span style="color: #7590db;">n</span>, <span style="color: #7590db;">o</span>;
    <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">description</span>;
}

<span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">values</span> {
    <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">uninitialized</span>;        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Uninitialized member data</span>
    <span style="color: #ce537a; font-weight: bold;">int</span>        <span style="color: #7590db;">ival</span> = 3;
    <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">fval</span> = 3.14;
    <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">aval</span>[] = { 1, 2, 3, 4.5 };
}

<span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #bc6ec5; font-weight: bold;">rotate</span>(<span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #7590db;">b</span>; <span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">axis</span>; <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">amount</span>) {
    <span style="color: #ce537a; font-weight: bold;">matrix</span> <span style="color: #7590db;">m</span> = 1;
    rotate(m, amount, axis);
    <span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #7590db;">result</span> = b;
    result.i *= m;
    result.j *= m;
    result.k *= m;
    <span style="color: #4f97d7; font-weight: bold;">return</span> result;
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Declare struct variables</span>
<span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #7590db;">b0</span>;        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Initialize using default values (i.e. 0 in this case)</span>
<span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #7590db;">b1</span> = basis({1,0,0}, {0,1,0}, {0,0,1});        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Initialize using constructor</span>
<span style="color: #ce537a; font-weight: bold;">basis</span> <span style="color: #7590db;">b2</span> = { {1,0,0}, {0,1,0}, {0,0,1} };         <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Initialize as explicit struct</span>
b1 = rotate(b1, {0,0,1}, M_PI/6);
</pre>
</div>
</div>

<div id="outline-container-orgc9baba4" class="outline-6">
<h6 id="orgc9baba4">struct function</h6>
<div class="outline-text-6" id="text-orgc9baba4">
<ul class="org-ul">
<li>在结构体函数内部，可以使用 this 引用结构体实例<br /></li>
<li>在结构体函数内部，可以直接引用结构体字段<br /></li>
<li>使用 -&gt; 符号在一个结构体实例上调用结构体函数<br /></li>
</ul>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">randsampler</span> {
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Fields</span>
    <span style="color: #ce537a; font-weight: bold;">int</span>        <span style="color: #7590db;">seed</span>;

    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Methods</span>
    <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #bc6ec5; font-weight: bold;">sample</span>()
    {
        this-&gt;print();

        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Struct functions can refer to fields by name</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> random(seed++);
    }

    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Methods</span>
    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">print</span>()
    {
        printf(<span style="color: #2d9574;">"seed = %d"</span>, seed);
    }
}

<span style="color: #ce537a; font-weight: bold;">cvex</span> <span style="color: #bc6ec5; font-weight: bold;">shader</span>()
{
    <span style="color: #ce537a; font-weight: bold;">randsampler</span> <span style="color: #7590db;">sampler</span> = randsampler(11);
    <span style="color: #4f97d7; font-weight: bold;">for</span> (<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = 0; i &lt; 10; i++)
    {
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Use -&gt; to call methods on struct instances</span>
        printf(<span style="color: #2d9574;">"%f\n"</span>, sampler-&gt;sample());
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org24c3c78" class="outline-6">
<h6 id="org24c3c78">mantra specific type</h6>
<div class="outline-text-6" id="text-org24c3c78">
<p>
mantra 有一些预定义的 struct 类型。如下：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">type</th>
<th scope="col" class="org-left">desc</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">light</td>
<td class="org-left">在定义在 shading context 中。其表示光源。</td>
</tr>

<tr>
<td class="org-left">material</td>
<td class="org-left">在定义在 shading context 中。这是一个不透明的结构体，其表示赋给对象的材质</td>
</tr>

<tr>
<td class="org-left">lpeaccumulator</td>
<td class="org-left">在定义在 shading context 中。其表示 Light Path Expressions 的 Accumulator</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org3ebed32" class="outline-5">
<h5 id="org3ebed32">type casting</h5>
<div class="outline-text-5" id="text-org3ebed32">
</div>
<div id="outline-container-orga1941bb" class="outline-6">
<h6 id="orga1941bb">variable casting</h6>
<div class="outline-text-6" id="text-orga1941bb">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">a</span>, <span style="color: #7590db;">b</span>;
<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">c</span>;
c = a / b;                <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36825;&#37324;&#25191;&#34892;&#30340;&#26159;&#25972;&#25968;&#38500;&#27861;</span>
c = (<span style="color: #ce537a; font-weight: bold;">float</span>)a / (<span style="color: #ce537a; font-weight: bold;">float</span>)b;  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36825;&#37324;&#25191;&#34892;&#30340;&#26159;&#28014;&#28857;&#25968;&#38500;&#27861;</span>
</pre>
</div>

<p>
类型转换会生成额外的指令，这可能会导致性能问题。<br />
</p>
</div>
</div>
<div id="outline-container-org9e9f817" class="outline-6">
<h6 id="org9e9f817">function casting</h6>
<div class="outline-text-6" id="text-org9e9f817">
<p>
vex 调用函数不仅会依据参数类型，还会考虑返回值类型。对于参数类型相同，返回值不同的两个函数，可以 cast function。将函数调用直接赋值给一个变量时，cast function 是隐式执行的。<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">float</span>  <span style="color: #bc6ec5; font-weight: bold;">noise</span>(vector );
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #bc6ec5; font-weight: bold;">noise</span>(<span style="color: #ce537a; font-weight: bold;">vector</span> );

<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">n</span>;
n = noise(noise(P));           <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25324;&#21495;&#20869;&#30340;noise &#21487;&#20197;&#35843;&#29992;float&#36820;&#22238;&#20540;&#29256;&#26412;&#65292;&#20063;&#21487;&#20197;&#35843;&#29992; vector &#36820;&#22238;&#20540;&#29256;&#26412;&#65292;&#22240;&#27492;&#20250;&#25253;&#38169;</span>
                               <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26368;&#22806;&#23618;noise &#20989;&#25968;&#30340;cast&#26159;&#38544;&#24335;&#25191;&#34892;&#30340;</span>
n = noise(vector(noise(P)));   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25351;&#23450;&#25324;&#21495;&#20869;&#30340;noise &#35843;&#29992;vector &#36820;&#22238;&#20540;&#29256;&#26412;</span>

<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">n1</span> = vector(noise(P));  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36825;&#37324;&#30340;cast&#21487;&#20197;&#30465;&#30053;</span>
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">n2</span> = noise(P);          <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">cast&#26159;&#38544;&#24335;&#25191;&#34892;&#30340;</span>
</pre>
</div>

<p>
cast function 不会执行任何类型转换，其只是选择一个合适的函数来调用，因此，其不会带来额外的性能消耗。<br />
</p>

<p>
尽可能使用 function casting，而只在需要的时候使用 variable casting。<br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgcb1d0cf" class="outline-4">
<h4 id="orgcb1d0cf">operator</h4>
<div class="outline-text-4" id="text-orgcb1d0cf">
<p>
VEX 和 C 语言的操作符基本相同，下面列出存在差异的地方：<br />
</p>
<ul class="org-ul">
<li>支持 vectors 或 points 之间的相乘。相乘方式为逐元素相乘（非 dot 或 cross）<br /></li>
<li>很多非标量类型的操作符是有定义的。例如：vector 和 matrix 相乘表示使用 matrix 对 vector 进行变换<br /></li>
<li><p>
使用操作符将不同类型的两个变量组合在一起的模棱两可情况下，结果类型为第二个变量的类型。如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-c">  <span style="color: #ce537a; font-weight: bold;">int</span> + vector = vector
</pre>
</div></li>
</ul>
</div>

<div id="outline-container-orgdff7d77" class="outline-5">
<h5 id="orgdff7d77">Dot Operator</h5>
<div class="outline-text-5" id="text-orgdff7d77">
<p>
.xx to reference the [0][0] element<br />
.zz to reference the [2][2] element<br />
.ax to reference the [3][0] element<br />
</p>

<p>
v.zyx is equivalent to set(v.z, v.y, v.x)<br />
v4.bgab is equivalent to set(v4.b, v4.g, v4.a, v4.b)<br />
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19981;&#33021;&#36171;&#20540;&#32473;&#19968;&#20010;swizzed vecotor, &#19979;&#38754;&#20195;&#30721;&#26159;&#38169;&#35823;&#30340;</span>
v.zyx = b;
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;swizzed vector&#36827;&#34892;&#36171;&#20540;&#65292; &#19979;&#38754;&#20195;&#30721;&#26159;&#27491;&#30830;&#30340;</span>
v = b.zyx;
</pre>
</div>
</div>
</div>
<div id="outline-container-org63cef95" class="outline-5">
<h5 id="org63cef95">Comparisons Operator</h5>
<div class="outline-text-5" id="text-org63cef95">
<p>
~= 为 string match 操作符，其与 match 函数等价。<br />
逻辑操作符和位操作符只对整数有定义。<br />
</p>
</div>
</div>
<div id="outline-container-orgfce7708" class="outline-5">
<h5 id="orgfce7708">Precedence Table 优先级表格</h5>
<div class="outline-text-5" id="text-orgfce7708">
<p>
请查阅原文档。<br />
</p>
</div>
</div>
<div id="outline-container-org609cd17" class="outline-5">
<h5 id="org609cd17">Operator type interactions</h5>
<div class="outline-text-5" id="text-org609cd17">
<ul class="org-ul">
<li>操作符作用于一个 float 和一个 int 时，结果的类型为左边操作数的类型。<br />
float * int = float, while int * float = int.<br /></li>
<li>vector 和 标量值相加、相乘、或相减， Vex 返回 vector 类型<br />
{1.0, 2.0, 3.0} * 2.0 == {2.0, 4.0, 6.0}<br /></li>
<li>尺寸不同的 vector 相加、相乘、或相减，Vex 返回尺寸更大的 vector 类型。缺失的分量按照 {0.0, 0.0, 0.0, 1.0} 进行填充。<br />
{1.0, 2.0} * {2.0, 3.0, 4.0, 5.0} == {2.0, 6.0, 0.0, 5.0}<br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org7d00c60" class="outline-4">
<h4 id="org7d00c60">statements</h4>
<div class="outline-text-4" id="text-org7d00c60">
<p>
vex 支持类似 c 一样的语句。<br />
</p>
</div>
<div id="outline-container-org9859441" class="outline-5">
<h5 id="org9859441">语句块</h5>
<div class="outline-text-5" id="text-org9859441">
<p>
{}  表示语句块<br />
</p>
</div>
</div>
<div id="outline-container-org92d50d6" class="outline-5">
<h5 id="org92d50d6">loop and flow control</h5>
<div class="outline-text-5" id="text-org92d50d6">
</div>
<div id="outline-container-org616913c" class="outline-6">
<h6 id="org616913c">do loop</h6>
<div class="outline-text-6" id="text-org616913c">
<p>
do statement [while (condition)]<br />
</p>

<p>
Tips: do 后面的语句至少执行一次<br />
</p>
</div>
</div>
<div id="outline-container-org921ea10" class="outline-6">
<h6 id="org921ea10">for loop</h6>
<div class="outline-text-6" id="text-org921ea10">
<p>
for (init; condition; change) statement<br />
</p>
</div>
</div>
<div id="outline-container-org32142a9" class="outline-6">
<h6 id="org32142a9">foreach loop</h6>
<div class="outline-text-6" id="text-org32142a9">
<p>
foreach (value; array) statement<br />
foreach (index, value; array) statement<br />
</p>
</div>
</div>
<div id="outline-container-orga451da8" class="outline-6">
<h6 id="orga451da8">while loop</h6>
<div class="outline-text-6" id="text-orga451da8">
<p>
while (condition) statement<br />
</p>
</div>
</div>
<div id="outline-container-orgeba4ebc" class="outline-6">
<h6 id="orgeba4ebc">Other looping statements</h6>
<div class="outline-text-6" id="text-orgeba4ebc">
</div>
<ul class="org-ul">
<li><a id="orgab31e34"></a>illuminance<br />
<div class="outline-text-7" id="text-orgab31e34">
<p>
循环遍历场景中所有光源，为每个光源调用 light shader，从而设置 Cl 和 L 全局变量。<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5; font-weight: bold;">illuminance</span>(position, [axis], [angle], [light_typemask], [lightmask])
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Here, Cl and L will be set to the value/direction for the</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">current light source.</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">To force the shadow shader to be called, use:</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">shadow(Cl);</span>
}
</pre>
</div>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/functions/illuminance.html">https://www.sidefx.com/docs/houdini/vex/functions/illuminance.html</a><br /></li>
</ul>
</div>
</li>
<li><a id="org51ac3ed"></a>gather<br />
<div class="outline-text-7" id="text-org51ac3ed">
<p>
发射 Rays 到场景中，rays 碰到 surfaces，执行 surfaces 的 shaders，返回 surface 信息<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5; font-weight: bold;">gather</span>(<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">origin</span>, <span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">direction</span>, ...)
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Statements for rays that hit other surfaces</span>
} <span style="color: #4f97d7; font-weight: bold;">else</span> {
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Statements for rays which didn't hit any surface</span>
}
</pre>
</div>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/functions/gather.html">https://www.sidefx.com/docs/houdini/vex/functions/gather.html</a><br /></li>
</ul>
</div>
</li>
<li><a id="orgec126a5"></a>forpoints<br />
<div class="outline-text-7" id="text-orgec126a5">
<p>
image3d context 中， 对于特定类型的几何体(metaball 或 粒子)，可以遍历影响空间中一点的所有特定类型的几何体<br />
forpoints ( position [, distance] )<br />
{<br />
}<br />
</p>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/functions/forpoints.html">https://www.sidefx.com/docs/houdini/vex/functions/forpoints.html</a><br /></li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgeaf500e" class="outline-6">
<h6 id="orgeaf500e">if break continue return</h6>
<div class="outline-text-6" id="text-orgeaf500e">
<p>
和 c 语言中一样。<br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org0c0dd1c" class="outline-4">
<h4 id="org0c0dd1c">comment</h4>
<div class="outline-text-4" id="text-org0c0dd1c">
<p>
和 c 语言中一样。<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">this is a comment</span>

<span style="color: #2aa1ae; background-color: #292e34;">/*</span>
<span style="color: #2aa1ae; background-color: #292e34;">comment multi lines</span>
<span style="color: #2aa1ae; background-color: #292e34;">comment multi lines</span>
<span style="color: #2aa1ae; background-color: #292e34;">*/</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org43f5c8e" class="outline-4">
<h4 id="org43f5c8e">context</h4>
<div class="outline-text-4" id="text-org43f5c8e">
<p>
Vex 程序是针对特定 context 的。例如，控制物体表面颜色的 shader (vex 编写的 shader 程序)是专门用于 surface context 的。确定来自一个光源的照度的 shader 则是专门用于 light contex 的。创建或过滤通道数据的 vex 程序是专门用于 chop context 的。<br />
</p>

<p>
context 会影响哪些函数、语句以及全局变量是可用的。<br />
</p>
</div>
</div>
<div id="outline-container-orgce0ee9e" class="outline-4">
<h4 id="orgce0ee9e">function</h4>
<div class="outline-text-4" id="text-orgce0ee9e">
</div>
<div id="outline-container-org807e4c2" class="outline-5">
<h5 id="org807e4c2">built-in function</h5>
<div class="outline-text-5" id="text-org807e4c2">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/functions/index.html">https://www.sidefx.com/docs/houdini/vex/functions/index.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org528f50a" class="outline-5">
<h5 id="org528f50a">user defined function</h5>
<div class="outline-text-5" id="text-org528f50a">
<ul class="org-ul">
<li>用户函数必须在使用之前声明<br /></li>
<li>编译器会自动将函数变为 inline，因此不能递归。可以使用 shader calls 来实现递归算法。<br /></li>
<li>和 RenderMan shading language 一样，传递给用户函数的参数都是引用，因此用户函数对参数的修改会影响外面变量。使用 const 关键字可以强制参数为只读，使用 export 关键字可以保证用户会向一个输出参数中写入值。<br /></li>
<li>用户函数的个数没有限制<br /></li>
<li>用户函数中可以直接访问全局变量。但是，最好将全局变量当作函数参数传递到其中，这样用户函数可以适用于不同的 context(有些全局函数只存在与某些 context)。<br /></li>
<li>可以在一个函数内定义另一个函数<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgfba2eb1" class="outline-5">
<h5 id="orgfba2eb1">Main (context) function</h5>
<div class="outline-text-5" id="text-orgfba2eb1">
<p>
一个 vex 程序必须包含一个函数，其返回值类型为 context 名称。这个函数就是该 vex 程序的 main 函数。编译器期望每个文件有一个 main 函数。这个函数应该完成计算任何所需信息和修改全局变量的工作（通过调用内置和/或用户定义的函数）。不过你不需要使用 return 语句从上下文函数返回值。<br />
</p>

<p>
上下文函数的参数（如果有）成为了程序的用户界面， 例如引用 VEX 程序的着色节点的参数。<br />
</p>

<p>
如果几何属性与上下文函数的参数同名，则该属性将覆盖参数的值。 这使的你可以将属性绘制到几何体上以控制 VEX 代码。VEX 以一种特殊的方式处理上下文函数的参数。 可以使用与变量同名的几何属性覆盖参数的值。 除了这种特殊情况，参数应该被认为是着色器范围内的“常量”。 这意味着修改参数值是非法的。 如果发生这种情况，编译器将生成错误。你可以使用 export 关键字来标记你希望在原始几何上修改的参数。<br />
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">surface</span>
<span style="color: #bc6ec5; font-weight: bold;">noise_surf</span>(<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">clr</span> = {1,1,1}; <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">frequency</span> = 1; export <span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">nml</span> = {0,0,0})
{
    Cf = clr * (<span style="color: #ce537a; font-weight: bold;">float</span>(<span style="color: #7590db;">noise</span>(<span style="color: #ce537a; font-weight: bold;">frequency</span> * <span style="color: #7590db;">P</span>)) + 0.5) * diffuse(normalize(N));
    nml = normalize(N)*0.5 + 0.5;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org7bf969b" class="outline-5">
<h5 id="org7bf969b">User interface pragmas</h5>
<div class="outline-text-5" id="text-org7bf969b">
<p>
使用 pragma 可以为程序生成用户界面。例如：你可以指定频率应该是具有特定范围的滑块，将 clr 视为一种颜色（给它一个颜色选择器 UI）。<br />
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#pragma</span> opname        noise_surf
<span style="color: #bc6ec5;">#pragma</span> oplabel        <span style="color: #2d9574;">"Noisy Surface"</span>

<span style="color: #bc6ec5;">#pragma</span> label    clr            <span style="color: #2d9574;">"Color"</span>
<span style="color: #bc6ec5;">#pragma</span> label    frequency    <span style="color: #2d9574;">"Frequency"</span>

<span style="color: #bc6ec5;">#pragma</span> hint    clr            color
<span style="color: #bc6ec5;">#pragma</span> range    frequency    0.1 10

<span style="color: #ce537a; font-weight: bold;">surface</span> <span style="color: #bc6ec5; font-weight: bold;">noise_surf</span>(<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">clr</span> = {1,1,1}; <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">frequency</span> = 1; export <span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">nml</span> = {0,0,0})
{
    Cf = clr * (<span style="color: #ce537a; font-weight: bold;">float</span>(<span style="color: #7590db;">noise</span>(<span style="color: #ce537a; font-weight: bold;">frequency</span> * <span style="color: #7590db;">P</span>)) + 0.5) * diffuse(normalize(N));
    nml = normalize(N)*0.5 + 0.5;
}
</pre>
</div>

<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/pragmas.html">https://www.sidefx.com/docs/houdini/vex/pragmas.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orga65682a" class="outline-4">
<h4 id="orga65682a">参考资料</h4>
<div class="outline-text-4" id="text-orga65682a">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/lang.html">https://www.sidefx.com/docs/houdini/vex/lang.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgfb99fc0" class="outline-3">
<h3 id="orgfb99fc0">Vex Expressions</h3>
<div class="outline-text-3" id="text-orgfb99fc0">
</div>
<div id="outline-container-org0f63dbf" class="outline-4">
<h4 id="org0f63dbf">Overview</h4>
<div class="outline-text-4" id="text-org0f63dbf">
<p>
Houdini 中的很多节点可以让你写一段 vex 代码。例如：Attrib Wrangle 几何节点； Geometry Wrangle, 以及 Gas Field Wrangle 动力学节点和粒子动力学节点。这些 vex 表达式会在每个经过该节点的元素上执行。这些代码可以读取节点参数、几何属性、或者可以设置特定变量或修改输入几何的值。<br />
</p>

<p>
Tip:<br />
Python SOP 类似，但是其允许你使用 python 代码来编辑几何。<br />
</p>
</div>
</div>
<div id="outline-container-org2177843" class="outline-4">
<h4 id="org2177843">Why VEX for ad-hoc modifications? 为什么使用 Vex 来实现专门的修改？</h4>
<div class="outline-text-4" id="text-org2177843">
<p>
出于性能原因，Houdini 正朝着使用 VEX 对属性进行专门的几何修改，而不是使用 HScript 表达式对局部变量和外部通道引用进行操作。<br />
</p>

<p>
与 HScript 表达式和局部变量相比，使用 VEX 和属性具有主要的性能优势。它运行速度更快，并自动支持线程和并行计算。直接处理属性而不是局部变量实际上具有一些易用性优势，因为局部变量的命名可能与底层属性的名称不一致，并且在节点之间不一致。<br />
</p>

<p>
在 HScript 表达式中，获取尚未在节点中设置局部变量映射的属性的值是一件苦差事（例如，point(opinputpath(".",0), $PT, "my_var", 0))。在 VEX 中，这要容易得多：v@my_var。由于 Houdini 中的技术工作通常围绕属性展开，这实际上可以使 VEX 表达式比等效的 HScript 表达式简单得多。与在后面节点上使用外部引用前面节点上的数据相比， 将有关属性的信息通过网络传递本质上对并行处理更友好。<br />
</p>

<p>
目前，已编译的 SOP 块内 VEX 操作已经被支持，但使用了局部变量的 HScript 无法被编译。VEX 已经有了大多数 HScript 表达式函数的等价物，并且更容易用于数组和字符串处理等事情，具有类似 Python 的数组/字符串切片和类似 Python 的字典等便利设施。<br />
</p>

<p>
随着用户处理越来越大、越来越复杂的几何形状，线程和并行处理对于获得可接受的性能变得越来越重要。这个简单的事实就是为什么 VEX 只会更广泛地用于替代 HScript 表达式以进行临时几何操作的原因。<br />
</p>

<p>
HScript 可能总是可用于某些比 VEX 更方便的工作。然而，对于几何操作，wrangling 和 VEX/VOP 是发展方向，学习新的工作流程是值得的。<br />
</p>
</div>
</div>

<div id="outline-container-org6eee3a9" class="outline-4">
<h4 id="org6eee3a9">Syntax</h4>
<div class="outline-text-4" id="text-org6eee3a9">
<p>
vex snippet 参数允许你输入 VEX 代码片段。<br />
</p>

<p>
VEX 有 context 的概念。 某些函数仅在某些 context 中可用（例如，访问几何信息的函数在 SOP context 下可以使用）。 VEX snippet 在 CVEX context 中运行。<br />
</p>
</div>
</div>
<div id="outline-container-org92dbefa" class="outline-4">
<h4 id="org92dbefa">Accessing parameter values</h4>
<div class="outline-text-4" id="text-org92dbefa">
<p>
在 vex snippet 中，你可以将参数的内部名称作为变来来对节点上的参数值进行读写。在参数编辑器中，鼠标悬停在参数名上，tooltip 会显示参数的内部名称。例如，Particle Color DOP 中，Color 参数的内部名称为 color.<br />
</p>

<p>
多分量参数通过 vector 来进行访问。例如，Position 参数的内部内部名称为 t。可以使用 dot 操作符来访问参数的各个分量。<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">set the translation</span>
t = {0, 1, 0};
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">move one unit along the x axis</span>
t.x = t.x + 1;
</pre>
</div>

<p>
Tips: 使用用户定义的参数，需要使用 chv vex 函数。<br />
</p>
</div>
</div>
<div id="outline-container-org5171408" class="outline-4">
<h4 id="org5171408">Accessing geometry attributes and info</h4>
<div class="outline-text-4" id="text-org5171408">
<p>
在 vex snippet 中，你可以使用 @attribute_name 来对属性值进行读写。例如，可以使用 @P 来对 P（position）属性进行读写。<br />
</p>

<p>
Particle DOPs 中可以访问粒子属性，但是不能修改。通过改变参数值来影响每个粒子, 具体可以参考如下文档。<br />
</p>
<ul class="org-ul">
<li>writing particle VEX expressions <a href="https://www.sidefx.com/docs/houdini/dopparticles/vexpressions.html">https://www.sidefx.com/docs/houdini/dopparticles/vexpressions.html</a><br /></li>
</ul>

<p>
在 Volume Wrangle node 中，你可以使用 @volume_name 来读写一个 volume。<br />
</p>

<p>
如果你对一个 @attribute 进行写入，而该属性不存在，Houdini 将会创建该属性。(Volume Wrange node 不会已这种方式创建新的 volumes)<br />
</p>

<p>
Houdini 提供了一些类似属性的变量，你可以在 vex snippet 中使用他们。@elemnum 包含当前当前被处理的元素的编号。 @numelem 包含几何或列表中的所有元素的数量。更多信息如下：<br />
<a href="#orgd91e9dc">Indexing variables</a><br />
</p>

<p>
一些节点会提供额外的类似属性的变量，你可以读取。例如，在 Volume Wrangle node, 你可以使用 @center 获得 volume 的中心位置。<br />
</p>

<p>
Houdini 知道一些常用的属性如何转换为对应的 vex 数据类型。下面列表类出了 Houdini 会自动进行转换的属性。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">VEX type</td>
<td class="org-left">Attribute names</td>
</tr>

<tr>
<td class="org-left">vector (3 floats)</td>
<td class="org-left">@P, @accel, @Cd, @N, @scale, @force, @rest, @torque, @up, @uv, @v @center, @dPdx, @dPdy, @dPdz (see Volume Wrangle).</td>
</tr>

<tr>
<td class="org-left">vector4 (4 floats)</td>
<td class="org-left">@backtrack, @orient, @rot</td>
</tr>

<tr>
<td class="org-left">int</td>
<td class="org-left">@id, @nextid, @pstate @elemnum, @ptnum, @primnum, @vtxnum, @numelem, @numpt, @numprim, @numvtx (see indexing variables below).</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">@group_* (see accessing group membership below). @ix, @iy, @iz, @resx, @resy, @resz (see Volume Wrangle).</td>
</tr>

<tr>
<td class="org-left">string</td>
<td class="org-left">@name, @instance</td>
</tr>
</tbody>
</table>

<p>
Tips:<br />
使用 @opinput 访问不同输入上的属性时, 上面的自动转换无法工作，依然需要手动指定属性类型。<br />
</p>

<p>
除此之外，Houdini 将所有其他 @ 引用的属性都当作 float 类型，除非你指定一个不同的类型。指定类型的方法如下：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">VEX type</td>
<td class="org-left">Syntax</td>
</tr>

<tr>
<td class="org-left">float</td>
<td class="org-left">f@name</td>
</tr>

<tr>
<td class="org-left">vector2 (2 floats)</td>
<td class="org-left">u@name</td>
</tr>

<tr>
<td class="org-left">vector (3 floats)</td>
<td class="org-left">v@name</td>
</tr>

<tr>
<td class="org-left">vector4 (4 floats)</td>
<td class="org-left">p@name</td>
</tr>

<tr>
<td class="org-left">int</td>
<td class="org-left">i@name</td>
</tr>

<tr>
<td class="org-left">matrix2 (2×2 floats)</td>
<td class="org-left">2@name</td>
</tr>

<tr>
<td class="org-left">matrix3 (3×3 floats)</td>
<td class="org-left">3@name</td>
</tr>

<tr>
<td class="org-left">matrix (4×4 floats)</td>
<td class="org-left">4@name</td>
</tr>

<tr>
<td class="org-left">string</td>
<td class="org-left">s@name</td>
</tr>

<tr>
<td class="org-left">dict</td>
<td class="org-left">d@name</td>
</tr>

<tr>
<td class="org-left">array (int)</td>
<td class="org-left">i[]@name</td>
</tr>

<tr>
<td class="org-left">array (float)</td>
<td class="org-left">f[]@name</td>
</tr>

<tr>
<td class="org-left">array (vector)</td>
<td class="org-left">v[]@name</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgf1cd5d0" class="outline-5">
<h5 id="orgf1cd5d0">Accessing attributes on other inputs</h5>
<div class="outline-text-5" id="text-orgf1cd5d0">
<p>
如果节点有多个输入可以按照 (type)@opinput(inputnum)_attributeName 来访问，inputnum 从 0 开始。例如： v@opinput1_P 表示第二个输入的 P 属性。<br />
</p>

<p>
节点可以有一个“Attribute to Match”参数，让你可以根据属性的值匹配“相同”的元素。例如，如果你使用 id 作为“Attribute to Match”，并且你正在处理属性 id 设置为 12 的多边形，那么@opinput1_P 将在第二个输入中为你提供多边形上的 P 属性，该多边形的 id 设置也为 12。<br />
</p>
</div>
</div>

<div id="outline-container-orgcb3a6ed" class="outline-5">
<h5 id="orgcb3a6ed">Declaring attributes</h5>
<div class="outline-text-5" id="text-orgcb3a6ed">
<p>
在使用属性前可以通过声明为其指定默认值，如下<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">float</span> @mass = 1;
vector @up = {0, 1, 0};
</pre>
</div>

<p>
这样做有两个好处：<br />
</p>
<ul class="org-ul">
<li>其给属性一个默认值。如果属性存在，则默认赋值会被忽略；若不存在，则会使用默认赋值。<br /></li>
<li>其指定了属性的类型。之后使用就可以使用@up 而不必使用 v@up。<br /></li>
</ul>

<p>
Tips:<br />
不能在赋值操作符右侧执行任何计算。例如：<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">float</span> @inverse_pi = 1/3.1415926;     <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Error</span>
<span style="color: #ce537a; font-weight: bold;">float</span> @mass = 1 / area;              <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Error</span>
vector @up = set(0, 1, 0);           <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Error</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd91e9dc" class="outline-5">
<h5 id="orgd91e9dc">Indexing variables</h5>
<div class="outline-text-5" id="text-orgd91e9dc">
<p>
大多数 vex snippet 涉及循环几何中的所有点/基元。 你还可以循环从零到某个限制的数字列表。 了解你正在循环的列表中当前元素的数量以及列表中元素的总数通常很有用。<br />
</p>
</div>
<div id="outline-container-orgdeae7c0" class="outline-6">
<h6 id="orgdeae7c0">@elemnum</h6>
<div class="outline-text-6" id="text-orgdeae7c0">
<p>
当前元素的编号。<br />
</p>

<p>
使用@elemnum 更加通用。如果你知道正在对点进行操作，则使用@ptnum 更清晰，但如果你更改为对图元或顶点进行操作时，代码将无法工作。<br />
</p>
</div>
</div>
<div id="outline-container-orgd739a70" class="outline-6">
<h6 id="orgd739a70">@numelem</h6>
<div class="outline-text-6" id="text-orgd739a70">
<p>
当前几何体或列表中的元素总数。<br />
</p>

<p>
使用@numelem 更加通用。如果你知道正在对点进行操作，则使用@numpt 更清晰，但如果你更改为对图元或顶点进行操作时，代码将无法工作。<br />
</p>
</div>
</div>
<div id="outline-container-org64caf92" class="outline-6">
<h6 id="org64caf92">@ptnum</h6>
<div class="outline-text-6" id="text-org64caf92">
<p>
如果代码在点上循环, 这是当前点的编号。如果在顶点上循环，这是顶点连接到的点。<br />
</p>

<p>
Tips:<br />
如果在图元上循环，这是图元上第 0 个顶点的点。<br />
</p>
</div>
</div>

<div id="outline-container-org91e1c25" class="outline-6">
<h6 id="org91e1c25">@primnum</h6>
<div class="outline-text-6" id="text-org91e1c25">
<p>
如果在图元上循环， 这是当前图元的编号。如果在顶点上循环，这是拥有该顶点的图元。如果循环点，这是一个包含点的图元，如果没有图元，则为 -1。<br />
</p>

<p>
Tips:<br />
如果一个点位于多个图元中，则返回哪一个是任意的。<br />
</p>
</div>
</div>
<div id="outline-container-org7520e87" class="outline-6">
<h6 id="org7520e87">@vtxnum</h6>
<div class="outline-text-6" id="text-org7520e87">
<p>
如果在顶点上循环，这是当前顶点的顶点编号。如果在点上循环，这是一个连接到该点的顶点，如果没有顶点连接，则为 -1。<br />
</p>

<p>
Tips:<br />
如果不止一个顶点连接到这一点，则返回哪个顶点是任意的。如果在图元上循环，它是图元的第 0 个顶点。<br />
</p>
</div>
</div>

<div id="outline-container-org69cf501" class="outline-6">
<h6 id="org69cf501">@numpt</h6>
<div class="outline-text-6" id="text-org69cf501">
<p>
如果在 prim 上循环时，表示当前几何体上的总点数。<br />
</p>
</div>
</div>

<div id="outline-container-org1f02633" class="outline-6">
<h6 id="org1f02633">@numprim</h6>
<div class="outline-text-6" id="text-org1f02633">
<p>
如果在 prim 上循环时，表示当前几何体上的 prim 总数。<br />
</p>
</div>
</div>

<div id="outline-container-org5c4bf8a" class="outline-6">
<h6 id="org5c4bf8a">@vtxnum</h6>
<div class="outline-text-6" id="text-org5c4bf8a">
<p>
线性顶点数。 这将计算几何中的所有顶点，从 0 到几何中的顶点总数 - 1)。它不同于顶点的图元索引，后者是顶点在它所属的图元中的编号。<br />
</p>

<p>
这个顶点所在的 prim 的 prim 编号在@primnum 中。要获得启用任意线性顶点索引的图元数，请使用 vertexprim。 要将线性顶点索引转换为它所属的图元中的顶点索引，请使用 vertexprimindex。 循环遍历顶点时，当前图元中的顶点数在@numvtx 中。 要获取任意图元上的顶点数，请使用图元编号调用 primvertexcount。<br />
</p>

<p>
例如，如果你想将曲线上多个顶点的顶点属性设置为沿曲线的比例值，可以如下操作：<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;"># Take</span> linear vertex index and convert to primitive index
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">vtx</span> = vertexprimindex(0, @vtxnum)

<span style="color: #bc6ec5;"># Set</span> an attribute to the vertex number divided by the last index, <span style="color: #ce537a; font-weight: bold;">so</span> <span style="color: #7590db;">the</span>
<span style="color: #bc6ec5;"># values</span> range from 0.0 to 1.0 along the length of the polycurve
f@prop = vtx / (<span style="color: #ce537a; font-weight: bold;">float</span>(@numvtx) - 1)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8e3e076" class="outline-6">
<h6 id="org8e3e076">@numvtx</h6>
<div class="outline-text-6" id="text-org8e3e076">
<p>
循环遍历顶点时，当前图元中的顶点数。<br />
</p>
</div>
</div>


<div id="outline-container-orga3fd7df" class="outline-6">
<h6 id="orga3fd7df">TIPS</h6>
<div class="outline-text-6" id="text-orga3fd7df">
<p>
最后一个元素的元素编号是@numelem - 1，因为第一项编号为 0。<br />
</p>

<p>
例如，要获取当前点附近的点列表：<br />
int nbors[] = neighbours(0，@ptnum)<br />
</p>

<p>
要从曲线上当前点对面的点读取属性：<br />
vector opposite_color = point(0, "Cd", (@numpt - 1) - @ptnum )<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org235924d" class="outline-5">
<h5 id="org235924d">Accessing globals</h5>
<div class="outline-text-5" id="text-org235924d">
<p>
和 HScrit 表达式不同，你无法使用 $F 这样的全局变量。在 VOP 中，你可以从 Globals 节点连接变量(如 Time 和 Frame)，以在 VEX 片段中使用它们。你可以使用下列这些隐式变量：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">@Time</td>
<td class="org-left">Float time ($T)</td>
</tr>

<tr>
<td class="org-left">@Frame</td>
<td class="org-left">Float frame ($FF)</td>
</tr>

<tr>
<td class="org-left">@SimTime</td>
<td class="org-left">Float simulation time ($ST), only present in DOP contexts.</td>
</tr>

<tr>
<td class="org-left">@SimFrame</td>
<td class="org-left">Float simulation frame ($SF), only present in DOP contexts.</td>
</tr>

<tr>
<td class="org-left">@TimeInc</td>
<td class="org-left">Float time step (1/$FPS)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org07d6d2b" class="outline-4">
<h4 id="org07d6d2b">Creating geometry</h4>
<div class="outline-text-4" id="text-org07d6d2b">
<p>
在特定节点中(如 Attrib Wrangle 节点)，你可以使用 vex snippets 创建几何体。<br />
</p>

<p>
addpoint, addprim, addvertex 函数可用于创建 points, primitives, 以及 verteices。使用 setattrib 和 setprimvertex 可以修改几何体。使用 removepoint removeprim 可以删除几何。使用 setpointgroup setprimgroup 可以设置组关系。使用 setprimintrinsic 来修改 primitives 的 intrinsic 属性。<br />
</p>

<p>
使用绑定变量（例如@name = val）在当前元素上设置属性比使用 setattrib 更快。 仅当您需要在其他元素上设置属性时才使用 setattrib。 如果您正在使用 setattrib 并修改来自不同来源的点时，需要将 mode 参数设置为 add 以合成结果。<br />
</p>

<p>
几何创建功能可以并行运行。 在你的 VEX 代码遍历所有现有几何图形后，所有更改都会排队并应用。 这意味着 setattrib 将覆盖你通过绑定变量所做的更改（例如 @name = val）。<br />
</p>

<p>
几何创建函数的第一个参数是“几何句柄”，其指定创建的目的地（这主要用于支持写入文件，作为写入当前几何的一种扩展）。 使用 geoself() 作为第一个参数来指定当前几何。如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5; font-weight: bold;">addpoint</span>(<span style="color: #ce537a; font-weight: bold;">geoself</span>(), {0, 1, 0});
</pre>
</div>

<p>
addprim 函数可以生成一个多边形(polygon)或折线(polyline)。如果创建多边形，你必须使用 addvertex 将顶点加入到 primitive。如果多边形只有 points 没有 vertices，Houdini 可能会 crash。<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">p1</span> = addpoint(geoself(), {0, 1, 0});
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">p2</span> = addpoint(geoself(), {1, 1, 0});
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">p3</span> = addpoint(geoself(), {1, 1, 1});

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">prim</span> = addprim(geoself(), <span style="color: #2d9574;">"poly"</span>);
<span style="color: #bc6ec5; font-weight: bold;">addvertex</span>(<span style="color: #ce537a; font-weight: bold;">geoself</span>(), prim, p1);
<span style="color: #bc6ec5; font-weight: bold;">addvertex</span>(<span style="color: #ce537a; font-weight: bold;">geoself</span>(), prim, p2);
<span style="color: #bc6ec5; font-weight: bold;">addvertex</span>(<span style="color: #ce537a; font-weight: bold;">geoself</span>(), prim, p3);
</pre>
</div>

<p>
你可以使用 vertexpoint、pointvertex、vertexprim、vertexnext、vertexprev 和 primvertexcount 检查几何的拓扑。<br />
</p>

<p>
你可以使用 pc* 函数（pcopen、pcnumfound、pciterate、pcimport 等）从点云(point cloud)文件中读取数据。<br />
</p>
</div>
</div>
<div id="outline-container-orga49a85b" class="outline-4">
<h4 id="orga49a85b">Geometry traversal functions</h4>
<div class="outline-text-4" id="text-orga49a85b">
<p>
请参考下面文档<br />
</p>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/vex/geometry.html">https://www.sidefx.com/docs/houdini/vex/geometry.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgeb60290" class="outline-4">
<h4 id="orgeb60290">Accessing group membership</h4>
<div class="outline-text-4" id="text-orgeb60290">
<p>
使用 @group_groupname 这种特殊虚拟属性，你可以获取或设置当前元素的分组。<br />
</p>

<p>
你可以通过 @group_name == 1 来检查当前点/边/基元/粒子是否在指定命名的分组中。<br />
</p>

<p>
你可以通过设置 @group_name 虚拟属性将当前点/边/基元添加或删除到组中。 将属性设置为 1（或任何非零值）会将当前元素置于该组中。 将该属性设置为 0 会从该组中删除当前元素。<br />
</p>
</div>
</div>
<div id="outline-container-org49230e7" class="outline-4">
<h4 id="org49230e7">User-defined functions</h4>
<div class="outline-text-4" id="text-org49230e7">
<p>
在 vex snippet 中可以定义自己的函数, 如下：<br />
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #bc6ec5; font-weight: bold;">mysquare</span>(<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">a</span>)
{
    <span style="color: #4f97d7; font-weight: bold;">return</span> a * a;
}

windresist = mysquare(windresist);
</pre>
</div>
</div>
</div>
<div id="outline-container-org0f5e6c1" class="outline-4">
<h4 id="org0f5e6c1">Includes</h4>
<div class="outline-text-4" id="text-org0f5e6c1">
<p>
#include 指令用于引入其他文件。<br />
</p>

<p>
确定是否存在用于属性绑定的参数是通过在预处理完成后简单扫描代码来完成的。这种预处理只在 code snippets 上完成； 但是，并且不处理任何#include 文件。 因此它可能会被依赖于#includes 的#ifdef 指令混淆。<br />
</p>
</div>
</div>
<div id="outline-container-orge0335b9" class="outline-4">
<h4 id="orge0335b9">Gotchas 陷阱</h4>
<div class="outline-text-4" id="text-orge0335b9">
<ul class="org-ul">
<li>每个语句必须以分号 (;) 结尾！<br /></li>
<li><i>/ 和 /* &#x2026; *</i> 可用于注释。<br /></li>
<li>在 VEX 中，诸如 sin 和 cos 之类的三角函数使用弧度，而不是度数。<br /></li>
<li>使用@v.x 而不是$VX 来操作一个 vector 的属性。 也就是说，你获得的是一个 @v 向量值，可以使用点符号访问其中的 x、y 或 z 分量，而不是获得三个单独的分开的变量 $VX、$VY 和 $VZ。<br /></li>
<li>rand 应用于向量变量时会产生向量噪声。<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org87754fd" class="outline-4">
<h4 id="org87754fd">Tips</h4>
<div class="outline-text-4" id="text-org87754fd">
<ul class="org-ul">
<li>Ctrl+Enter 可以提交 vex snippet。<br /></li>
<li>每帧都会执行 vex snippet。（如果是在 simulation 网络中，每个 time step 都会执行）<br /></li>
<li><p>
可以使用 return，更早地离开 vex snippet.<br />
</p>
<div class="org-src-container">
<pre class="src src-c">  <span style="color: #4f97d7; font-weight: bold;">if</span> (@age &gt; 0) <span style="color: #4f97d7; font-weight: bold;">return</span>;

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">If @age was &gt; 0, we returned above, so this line</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">only runs for particles where @age == 0</span>
  windresist = 0;
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orgcf9fdf2" class="outline-4">
<h4 id="orgcf9fdf2">Troubleshooting error messages</h4>
<div class="outline-text-4" id="text-orgcf9fdf2">
</div>
<div id="outline-container-org6097741" class="outline-5">
<h5 id="org6097741">Syntax error, unexpected '}', expecting ';'</h5>
<div class="outline-text-5" id="text-org6097741">
<div class="org-src-container">
<pre class="src src-c">force += 2            <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27599;&#20010;&#35821;&#21477;&#24517;&#39035;&#20197; ; &#32467;&#23614;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org14713bc" class="outline-5">
<h5 id="org14713bc">SRead-only expression given for read/write parameter</h5>
<div class="outline-text-5" id="text-org14713bc">
<div class="org-src-container">
<pre class="src src-c">@v += force;          <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Particle &#33410;&#28857;&#26080;&#27861;&#20462;&#25913;particle&#23646;&#24615;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8c11fa4" class="outline-5">
<h5 id="org8c11fa4">Syntax error, unexpected identifier, expecting '}'.</h5>
<div class="outline-text-5" id="text-org8c11fa4">
<div class="org-src-container">
<pre class="src src-c">x = { 0, @y, 0};      <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;vector&#26500;&#36896;&#20989;&#25968;&#20013;&#19981;&#33021;&#20351;&#29992;&#21487;&#21464;&#21442;&#25968;&#12290;&#24212;&#35813;&#20351;&#29992;set(0, @y, 0);</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8d153e4" class="outline-5">
<h5 id="org8d153e4">使用 $F 动画没生效</h5>
<div class="outline-text-5" id="text-org8d153e4">
<div class="org-src-container">
<pre class="src src-c">x = set(0, $F, 0);    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">VOP&#32593;&#32476;&#19981;&#20381;&#36182;&#20110;&#26102;&#38388;&#65292;&#22240;&#27492;&#21160;&#30011;&#19981;&#20250;&#29983;&#25928;. &#20351;&#29992; @Frame &#20195;&#26367;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org66fea71" class="outline-5">
<h5 id="org66fea71">将 vector 属性赋值给其他属性时，z 分量的值错误</h5>
<div class="outline-text-5" id="text-org66fea71">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">attr8 &#20026; vector &#31867;&#22411;</span>
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">tmp</span> = @attr8;
v@uv4 = set(tmp.x, tmp.y, 0);
v@uv5 = set(tmp.z, 0, 0);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#38656;&#35201;&#25351;&#23450; attr8 &#20026; vector, &#19979;&#38754;&#30340;&#20195;&#30721;&#23601;&#26159;&#27491;&#30830;&#30340;</span>
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">tmp</span> = v@attr8;
v@uv4 = set(tmp.x, tmp.y, 0);
v@uv5 = set(tmp.z, 0, 0);
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org70a3816" class="outline-3">
<h3 id="org70a3816">Usage</h3>
</div>
<div id="outline-container-org3312eb5" class="outline-3">
<h3 id="org3312eb5">参考资料</h3>
</div>
</div>
<div id="outline-container-orga4f7063" class="outline-2">
<h2 id="orga4f7063">Usage</h2>
<div class="outline-text-2" id="text-orga4f7063">
</div>
<div id="outline-container-org5120337" class="outline-3">
<h3 id="org5120337">修改项目路径</h3>
<div class="outline-text-3" id="text-org5120337">
<p>
File/Set Project  选择.hip 文件做在目录即可。<br />
</p>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/docs/houdini/basics/project.html">https://www.sidefx.com/docs/houdini/basics/project.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org827f238" class="outline-3">
<h3 id="org827f238">预览 uv, 预览 vertex color R 通道</h3>
<div class="outline-text-3" id="text-org827f238">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">tmpUV3</span> = @uv3;
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">tmpUV4</span> = @uv4;
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">tmpUV5</span> = @uv5;
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">tmpUV6</span> = @uv6;
v@ColorR = set(@Cd.x, @Cd.x, @Cd.x) * 3;
v@ColorG = set(@Cd.y, @Cd.y, @Cd.y) * 3;
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">c</span>;
c = set(tmpUV5.x, tmpUV5.y, tmpUV5.z);
c = c * 2.0;
v@Color2 = c;
c = set(tmpUV3.x, tmpUV3.y, 0);
v@NoiseUV2 = c;
c = set(tmpUV4.x, tmpUV4.y, 0);
v@NoiseUV3 = c;
</pre>
</div>
</div>
</div>
<div id="outline-container-orga23b186" class="outline-3">
<h3 id="orga23b186">Tex to Vertex Color</h3>
<div class="outline-text-3" id="text-orga23b186">
<p>
方案 1:<br />
使用 attribfrommap 节点，将 texture 转化为顶点属性。<br />
</p>

<p>
方案 2:<br />
</p>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/forum/topic/54115/?page=1#post-243157">https://www.sidefx.com/forum/topic/54115/?page=1#post-243157</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org25ccc49" class="outline-3">
<h3 id="org25ccc49">Copy vertex color from neareat point</h3>
<div class="outline-text-3" id="text-org25ccc49">
<div class="org-src-container">
<pre class="src src-c">@Cd = set(0.5, 0.5, 0);
<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">posprim</span>;
<span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">nearPUV</span>;
<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">maxdist</span> = 10;
<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">dist</span> = xyzdist(1, @P, posprim, nearPUV, maxdist);
<span style="color: #4f97d7; font-weight: bold;">if</span>(dist&lt;0.1)
{
    <span style="color: #ce537a; font-weight: bold;">vector</span> <span style="color: #7590db;">nearColor</span> = primuv(1, <span style="color: #2d9574;">"Cd"</span>, posprim, nearPUV);
    @Cd = nearColor;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org85b676c" class="outline-3">
<h3 id="org85b676c">hipnc 文件转 hip 文件</h3>
<div class="outline-text-3" id="text-org85b676c">
<ul class="org-ul">
<li><a href="https://kiko3d.wordpress.com/2015/03/19/converting-houdini-not-commercial-files/">https://kiko3d.wordpress.com/2015/03/19/converting-houdini-not-commercial-files/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc633607" class="outline-2">
<h2 id="orgc633607">Case Study</h2>
<div class="outline-text-2" id="text-orgc633607">
</div>
<div id="outline-container-org2da8a88" class="outline-3">
<h3 id="org2da8a88">Official</h3>
<div class="outline-text-3" id="text-org2da8a88">
</div>
<div id="outline-container-orgd965469" class="outline-4">
<h4 id="orgd965469">modeling</h4>
<div class="outline-text-4" id="text-orgd965469">
<ul class="org-ul">
<li>Bracelet <a href="https://www.sidefx.com/tutorials/houdini-friendship-bracelet-tutorial/">https://www.sidefx.com/tutorials/houdini-friendship-bracelet-tutorial/</a><br /></li>
<li>House <a href="https://www.sidefx.com/tutorials/procedural-house/">https://www.sidefx.com/tutorials/procedural-house/</a><br /></li>
<li>Knife <a href="https://www.sidefx.com/tutorials/knife-modeling-basics/">https://www.sidefx.com/tutorials/knife-modeling-basics/</a><br /></li>
<li>Firewatch <a href="https://www.sidefx.com/tutorials/houdini-185-firewatch-project-building-the-base-tower/">https://www.sidefx.com/tutorials/houdini-185-firewatch-project-building-the-base-tower/</a><br /></li>
</ul>
</div>
<div id="outline-container-org503e0c1" class="outline-5">
<h5 id="org503e0c1">ERROR Bracelet Case - chain 链接到手环上时，chain 大小非常小</h5>
<div class="outline-text-5" id="text-org503e0c1">
<p>
需要在 pathdeform 之前设置 pscale = 1<br />
</p>
</div>
</div>
<div id="outline-container-org45096f7" class="outline-5">
<h5 id="org45096f7">ERROR Bracelet Case - chain 有些暗</h5>
</div>
</div>
<div id="outline-container-orgbe65b4f" class="outline-4">
<h4 id="orgbe65b4f">character rigging</h4>
<div class="outline-text-4" id="text-orgbe65b4f">
<ul class="org-ul">
<li>Rig Fur Dude with KineFX <a href="https://www.sidefx.com/tutorials/foundations-rig-fur-dude-with-kinefx/">https://www.sidefx.com/tutorials/foundations-rig-fur-dude-with-kinefx/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org0a202f9" class="outline-4">
<h4 id="org0a202f9">game development</h4>
<div class="outline-text-4" id="text-org0a202f9">
</div>
<div id="outline-container-orgf1c4eb1" class="outline-5">
<h5 id="orgf1c4eb1">Realtime FX</h5>
<div class="outline-text-5" id="text-orgf1c4eb1">
</div>
<div id="outline-container-org90ca7b0" class="outline-6">
<h6 id="org90ca7b0">magic-projectile-fx-for-unity</h6>
<div class="outline-text-6" id="text-org90ca7b0">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/magic-projectile-fx-for-unity/">https://www.sidefx.com/tutorials/magic-projectile-fx-for-unity/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org5940f9f" class="outline-6">
<h6 id="org5940f9f">destruction-fx-for-realtime</h6>
<div class="outline-text-6" id="text-org5940f9f">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/destruction-fx-for-realtime/">https://www.sidefx.com/tutorials/destruction-fx-for-realtime/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orga677ff8" class="outline-6">
<h6 id="orga677ff8">procedural-stream</h6>
<div class="outline-text-6" id="text-orga677ff8">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/procedural-stream-part-1/">https://www.sidefx.com/tutorials/procedural-stream-part-1/</a>  <a href="https://dokaitutorials.com/procedural-stream-1/">https://dokaitutorials.com/procedural-stream-1/</a><br /></li>
<li><a href="https://www.sidefx.com/tutorials/procedural-stream-part-2/">https://www.sidefx.com/tutorials/procedural-stream-part-2/</a>  <a href="https://dokaitutorials.com/procedural-stream-2/">https://dokaitutorials.com/procedural-stream-2/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb52b613" class="outline-5">
<h5 id="orgb52b613">Unity</h5>
<div class="outline-text-5" id="text-orgb52b613">
</div>
<div id="outline-container-orga508601" class="outline-6">
<h6 id="orga508601">guard-tower</h6>
<div class="outline-text-6" id="text-orga508601">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/learn/collections/guard-tower/">https://www.sidefx.com/learn/collections/guard-tower/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgecdf8e0" class="outline-6">
<h6 id="orgecdf8e0">sci-fi-level-design</h6>
<div class="outline-text-6" id="text-orgecdf8e0">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/learn/collections/sci-fi-level-design/">https://www.sidefx.com/learn/collections/sci-fi-level-design/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgf0d2ae9" class="outline-6">
<h6 id="orgf0d2ae9">vertex animation textures in unity</h6>
<div class="outline-text-6" id="text-orgf0d2ae9">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/vertex-animation-textures-in-unity/">https://www.sidefx.com/tutorials/vertex-animation-textures-in-unity/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org53c5277" class="outline-6">
<h6 id="org53c5277">flowmaps</h6>
<div class="outline-text-6" id="text-org53c5277">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/flowmaps-houdini-for-games/">https://www.sidefx.com/tutorials/flowmaps-houdini-for-games/</a><br /></li>
<li><a href="https://simonschreibt.de/gat/river/">https://simonschreibt.de/gat/river/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgf5b32a0" class="outline-5">
<h5 id="orgf5b32a0">Unreal</h5>
<div class="outline-text-5" id="text-orgf5b32a0">
</div>
<div id="outline-container-org8add100" class="outline-6">
<h6 id="org8add100">procedural desert</h6>
<div class="outline-text-6" id="text-org8add100">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/procedural-desert/">https://www.sidefx.com/tutorials/procedural-desert/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2407ba8" class="outline-5">
<h5 id="org2407ba8">World Building</h5>
<div class="outline-text-5" id="text-org2407ba8">
</div>
<div id="outline-container-org3b4a451" class="outline-6">
<h6 id="org3b4a451">The Complete A-Z Terrain Handbook</h6>
<div class="outline-text-6" id="text-org3b4a451">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/the-complete-a-z-terrain-handbook/">https://www.sidefx.com/tutorials/the-complete-a-z-terrain-handbook/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org4e1e221" class="outline-5">
<h5 id="org4e1e221">Game Tools</h5>
</div>
<div id="outline-container-org06a8d80" class="outline-5">
<h5 id="org06a8d80">Common</h5>
<div class="outline-text-5" id="text-org06a8d80">
</div>
<div id="outline-container-orgb16a4ff" class="outline-6">
<h6 id="orgb16a4ff">imposter</h6>
<div class="outline-text-6" id="text-orgb16a4ff">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/game-tools-imposter-textures/">https://www.sidefx.com/tutorials/game-tools-imposter-textures/</a><br /></li>
</ul>
</div>
<ul class="org-ul">
<li><a id="orgade25ce"></a>Error 烘培的 base color map 偏黑, normal map 不正确<br />
<div class="outline-text-7" id="text-orgade25ce">
<p>
TODO<br />
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org3e17527" class="outline-4">
<h4 id="org3e17527">visual effects</h4>
<div class="outline-text-4" id="text-org3e17527">
</div>
<div id="outline-container-org32633b3" class="outline-5">
<h5 id="org32633b3">Pyro FX</h5>
</div>
<div id="outline-container-orgc8d4cd0" class="outline-5">
<h5 id="orgc8d4cd0">Fluids</h5>
<div class="outline-text-5" id="text-orgc8d4cd0">
</div>
<div id="outline-container-org41d8129" class="outline-6">
<h6 id="org41d8129">Crashing Wave</h6>
<div class="outline-text-6" id="text-org41d8129">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/tutorials/crashing-wave/">https://www.sidefx.com/tutorials/crashing-wave/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org12991d4" class="outline-6">
<h6 id="org12991d4">CallofDuty Oceans</h6>
<div class="outline-text-6" id="text-org12991d4">
<p>
我们需要使用 Houdini 生成下面两组贴图：<br />
looping tiling open ocean texture set<br />
looping tiling breaking waves texture set<br />
</p>

<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=mMKViq1Bv8M&amp;t=49s">https://www.youtube.com/watch?v=mMKViq1Bv8M&amp;t=49s</a><br /></li>
</ul>
</div>
<ul class="org-ul">
<li><a id="org3f3db9f"></a>create looping tiling open ocean texture set<br />
<div class="outline-text-7" id="text-org3f3db9f">
<p>
使用 Houdini 烘培 Ocean Evaluate 每一帧会得到下面三张图片：<br />
执行 obj/ocean_surface/ocean_preview(nodeType:Ocean Evaluate) Export to Texture/Save to Disk 可以烘培 displacement map<br />
</p>

<p>
为 obj/ocean_surface 指定材质，创建 out/bake_open_ocean(nodeType:Bake Texture) 来烘培 normal map 和 foam map<br />
</p>
</div>

<ul class="org-ul">
<li><a id="org3bb3d13"></a>ERROR img/Mosaic 节点不显示图片<br />
<div class="outline-text-8" id="text-org3bb3d13">
<p>
img/input(nodeType:File) 的输入为所有帧，所以需要将 timeline 回到第一帧。<br />
</p>
</div>
</li>
<li><a id="org87a53c2"></a>ERROR img/Mosaic 节点显示图片少一部分<br />
<div class="outline-text-8" id="text-org87a53c2">
<p>
img/input(nodeType:File) 节点 File 菜单中点击 Reload Sequence 按钮<br />
</p>
</div>
</li>
<li><a id="orga2c64fb"></a>ERROR ROP File Output 节点输出图片不正确<br />
<div class="outline-text-8" id="text-orga2c64fb">
<p>
case1:<br />
img/input(nodeType:File) 的输入为所有帧，所以 img/rop_comp1(nodeType:ROP File Output) 不需要渲染 1-24 帧，只需要渲染当前帧，且 timeline 当前帧为第一帧。<br />
case2:<br />
img/rop_comp1(nodeType:ROP File Output)的输入需要链接到 img/mosaic1(nodeType:Mosaic) 的输出<br />
</p>
</div>
</li>
</ul>
</li>
<li><a id="org322dee8"></a>create looping tiling breaking waves texture set<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org5387ea3" class="outline-5">
<h5 id="org5387ea3">Destruction FX</h5>
</div>
</div>
<div id="outline-container-org796982d" class="outline-4">
<h4 id="org796982d">character fx</h4>
<div class="outline-text-4" id="text-org796982d">
</div>
<div id="outline-container-org81c68e7" class="outline-5">
<h5 id="org81c68e7">Cloth</h5>
<div class="outline-text-5" id="text-org81c68e7">
</div>
<div id="outline-container-orgb3d8244" class="outline-6">
<h6 id="orgb3d8244">Vellum Workflow Concepts</h6>
<div class="outline-text-6" id="text-orgb3d8244">
<ul class="org-ul">
<li>Vellum Workflow Concepts <a href="https://www.sidefx.com/tutorials/vellum-workflow-concepts/">https://www.sidefx.com/tutorials/vellum-workflow-concepts/</a><br /></li>
<li>mixamo 免费模型和动画下载 <a href="https://www.mixamo.com/">https://www.mixamo.com/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org6cab2fc" class="outline-6">
<h6 id="org6cab2fc">Fix Unreal Cloth from Going Crazy</h6>
<div class="outline-text-6" id="text-org6cab2fc">
<ul class="org-ul">
<li>fix unreal cloth from going crazy <a href="https://www.sidefx.com/tutorials/how-i-fix-unreal-cloth-from-going-crazy-simulate-in-houdini-2/">https://www.sidefx.com/tutorials/how-i-fix-unreal-cloth-from-going-crazy-simulate-in-houdini-2/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgcd9f764" class="outline-5">
<h5 id="orgcd9f764">Hair&amp;Fur</h5>
</div>
<div id="outline-container-org56c9951" class="outline-5">
<h5 id="org56c9951">Crowds</h5>
</div>
</div>
<div id="outline-container-orgca4a9e3" class="outline-4">
<h4 id="orgca4a9e3">pipeline</h4>
<div class="outline-text-4" id="text-orgca4a9e3">
</div>
<div id="outline-container-orgd142653" class="outline-5">
<h5 id="orgd142653">PDG (procedural dependency graph)</h5>
</div>
<div id="outline-container-org161bec6" class="outline-5">
<h5 id="org161bec6">Vex</h5>
</div>
</div>
</div>
</div>
<div id="outline-container-org8b2e815" class="outline-2">
<h2 id="org8b2e815">ERROR</h2>
<div class="outline-text-2" id="text-org8b2e815">
</div>
<div id="outline-container-org66950ab" class="outline-4">
<h4 id="org66950ab">Visualizer 不显示 Visualizers 选项卡</h4>
<div class="outline-text-4" id="text-org66950ab">

<div id="orgab968e7" class="figure">
<p><img src="./Houdini/houdini_visualize_attribute.png" alt="houdini_visualize_attribute.png" width="800px" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org87173d6" class="outline-4">
<h4 id="org87173d6">Houdini 场景中灰白色为蓝色</h4>
<div class="outline-text-4" id="text-org87173d6">
<p>
由于模型正反面反了导致。使用 reverse node 可以反转模型。<br />
</p>

<ul class="org-ul">
<li><a href="https://www.sidefx.com/forum/topic/60323/">https://www.sidefx.com/forum/topic/60323/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org002ab8b" class="outline-4">
<h4 id="org002ab8b">Houdini BakeTexture Error</h4>
<div class="outline-text-4" id="text-org002ab8b">
</div>
<div id="outline-container-org035d1a3" class="outline-5">
<h5 id="org035d1a3">结果为白色图</h5>
<div class="outline-text-5" id="text-org035d1a3">
<p>
进入 BakeTexture node，在 baking 选项中，取消 Disable Lighting/Emission<br />
</p>
<ul class="org-ul">
<li><a href="https://www.sidefx.com/forum/topic/61112/">https://www.sidefx.com/forum/topic/61112/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orga1c9cca" class="outline-5">
<h5 id="orga1c9cca">结果为黑色图</h5>
<div class="outline-text-5" id="text-orga1c9cca">
</div>
<div id="outline-container-org9de6f09" class="outline-6">
<h6 id="org9de6f09">case 1</h6>
<div class="outline-text-6" id="text-org9de6f09">
<p>
使用 Assemble 节点。<br />
</p>
</div>
</div>
<div id="outline-container-orgf76bdb9" class="outline-6">
<h6 id="orgf76bdb9">case 2</h6>
<div class="outline-text-6" id="text-orgf76bdb9">
<p>
指定高模<br />
</p>
</div>
</div>
<div id="outline-container-org137d6d8" class="outline-6">
<h6 id="org137d6d8">case 3</h6>
<div class="outline-text-6" id="text-org137d6d8">
<p>
remove unused attributes<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgb76b245" class="outline-5">
<h5 id="orgb76b245">烘培报错</h5>
<div class="outline-text-5" id="text-orgb76b245">
</div>
<div id="outline-container-orgad21479" class="outline-6">
<h6 id="orgad21479">case 1</h6>
<div class="outline-text-6" id="text-orgad21479">
<p>
非商业版本，最大只能烘培 512x512 大小<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org0b30b57" class="outline-4">
<h4 id="org0b30b57">ERROR Failed to save output to file "UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 17: invalid start byte</h4>
<div class="outline-text-4" id="text-org0b30b57">
<p>
检查 houdini hip 或 hipc 文件是否包含了中文或者乱码。<br />
</p>
</div>
</div>
<div id="outline-container-org331c730" class="outline-4">
<h4 id="org331c730">line Sweep follow curve error</h4>
<div class="outline-text-4" id="text-org331c730">
</div>
<div id="outline-container-orga5788d5" class="outline-5">
<h5 id="orga5788d5">ERROR 1</h5>
<div class="outline-text-5" id="text-orga5788d5">

<div id="org923ac86" class="figure">
<p><img src="./Houdini/error_sweep_line-cross.png" alt="error_sweep_line-cross.png" width="250px" /><br />
</p>
</div>

<p>
设置 curve 的 up 属性可以修复该问题。<br />
</p>
</div>
</div>
<div id="outline-container-orgdf344ae" class="outline-5">
<h5 id="orgdf344ae">ERROR 2</h5>
</div>
</div>
</div>
<div id="outline-container-orgd389ac6" class="outline-2">
<h2 id="orgd389ac6">参考资料</h2>
<div class="outline-text-2" id="text-orgd389ac6">
<ul class="org-ul">
<li><a href="https://www.sidefx.com/learn/">https://www.sidefx.com/learn/</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="vssue"></div>
        <link rel="stylesheet" href="https://unpkg.com/vssue/dist/vssue.min.css">
        <script src="https://unpkg.com/vue@2.7.10/dist/vue.runtime.min.js"></script>
        <script src="https://unpkg.com/vssue/dist/vssue.github.min.js"></script>
        <script>
          new Vue({
            el: '#vssue',
            render: h => h('Vssue', {
              props: {
                // 在这里设置当前页面对应的 Issue 标题
                title: 'Houdini',

                // 在这里设置你使用的平台的 OAuth App 配置
                options: {
                    owner: 'wolfand11',
                    repo: 'blog_comments',
                    clientId: 'a02b49185d85859cb92c',
                    clientSecret: '6f123085c6f1ce339e2517d24e5b099fa1dc9c85', // 只有在使用某些平台时需要
                },
              }
            })
          })
        </script>
</div>
</body>
</html>