<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-12-13 周日 15:19 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Unity Note</title>
<meta name="generator" content="Org mode" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
           <meta name="viewport" content="width=device-width, initial-scale=1" />
           <link rel="stylesheet" title="Standard" href="https://wolfand11.gitee.io/res/css/worg.css" type="text/css" />
           <link rel="alternate stylesheet" title="Zenburn" href="https://wolfand11.gitee.io/res/css/worg-zenburn.css" type="text/css" />
           <link rel="alternate stylesheet" title="Classic" href="https://wolfand11.gitee.io/res/css/worg-classic.css" type="text/css" />
           <link rel="icon" href="https://wolfand11.gitee.io/res/favicon.ico" type="image/ico" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="https://wolfand11.gitee.io"> HOME </a>
</div><div id="content">
<h1 class="title">Unity Note</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf532ebc">Scripts</a>
<ul>
<li><a href="#org06ed129">Scene</a>
<ul>
<li><a href="#org682a5a1">Active Scene</a></li>
</ul>
</li>
<li><a href="#orgaf33219">Object</a>
<ul>
<li><a href="#org504403b">Destroy</a></li>
<li><a href="#org18d79d0">DontDestroyOnLoad</a></li>
</ul>
</li>
<li><a href="#orgda0c7a7">GameObject</a>
<ul>
<li><a href="#org85311c0">GameObject.Find(string childName) 静态成员方法</a></li>
<li><a href="#orgb908905">GetComponent GetComponents</a></li>
<li><a href="#orga51f4a7">GameObject 定义的其他成员方法</a>
<ul>
<li><a href="#org45078d6">Tips:</a></li>
</ul>
</li>
<li><a href="#org2183861">GameObject 和 Transform</a></li>
<li><a href="#org2b0bef0">Get all DontDestroyOnLoad GameObjects</a></li>
</ul>
</li>
<li><a href="#org20000e9">Transform</a>
<ul>
<li><a href="#org20bcdb5">transform.Find(string childName)</a></li>
<li><a href="#org9dd38b2">transform.root</a></li>
<li><a href="#org285b46e">设置节点关系</a></li>
<li><a href="#org7be9728">SetParent(parentTransform,worldPositionStays)</a></li>
<li><a href="#orgb025b42">GetComponent(s) GetComponent(s)InChildren GetComponent(s)InParent</a></li>
<li><a href="#org6aadb97">Vector2.Angle Vector2.SignedAngle</a></li>
<li><a href="#org0f11a54">transform.localEulerAngles</a>
<ul>
<li><a href="#org7865865">unity 为左手坐标系，所以旋转的正方向通过左手原则来定</a></li>
<li><a href="#orge147d6b">transform.localEulerAngles 与 transfrom.localRotation.eulerAngles</a></li>
</ul>
</li>
<li><a href="#orgcb320c3">transform.LookAt</a></li>
<li><a href="#org279ed3b">遍历子节点</a>
<ul>
<li><a href="#orga330f83">遍历直接子节点</a></li>
<li><a href="#orgef4356b">遍历所有子节点</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org04e9e6f">RectTransform</a></li>
<li><a href="#org7110a07">Matrix4x4</a>
<ul>
<li><a href="#org9389c35">Matrix4x4.TRS</a></li>
<li><a href="#org44d93b6">将 Matrix4x4 分解为 Translate Rotation Scale 矩阵</a></li>
<li><a href="#org74542c0">参考资料</a></li>
</ul>
</li>
<li><a href="#org725b085">Quaternion Euler</a>
<ul>
<li><a href="#org7ef78b5">Quaternion 的结合性</a></li>
<li><a href="#org87d16f1">欧拉角旋转</a>
<ul>
<li><a href="#org8e6ed06">术语</a></li>
<li><a href="#org3c02080">localEulerAngle</a>
<ul>
<li><a href="#org6fc36ec">为什么修改 localEulerAngle.xyz 中的一个另外两个保持为 0 时，始终都是围绕本地对应坐标轴旋转？</a></li>
<li><a href="#orgaa93f3a">为什么修改 localEulerAngle.z 时，始终都是围绕本地 z 轴旋转？</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8f75299">旋转向量</a></li>
<li><a href="#org122a961">旋转的差和叠加</a></li>
<li><a href="#org2ad0f97">本地旋转和全局旋转之间的转换 不同坐标系之间旋转的转换</a>
<ul>
<li><a href="#org84e428e">关于 localRotation 和 rotation：下面代码中为什么会输出 True？</a></li>
<li><a href="#org8b18228">参考资料</a></li>
</ul>
</li>
<li><a href="#orgb4b5316">绕父节点旋转</a>
<ul>
<li><a href="#orgc9e780a">子节点的本地坐标系方向不变</a></li>
<li><a href="#orgddf2d06">子节点的本地坐标系做对应旋转</a></li>
</ul>
</li>
<li><a href="#orgcf67714">绕本地坐标轴旋转</a></li>
</ul>
</li>
<li><a href="#org3d3a56f">MonoBehavior</a>
<ul>
<li><a href="#org7842d25">各种函数函数触发时机</a>
<ul>
<li><a href="#org39e56bb">同一个对象上各函数触发顺序</a></li>
<li><a href="#org39f4c2c">不同对象各函数触发顺序</a></li>
<li><a href="#orgedb0622">参考文档</a></li>
</ul>
</li>
<li><a href="#org6395259">单例 MonoBehavior</a></li>
<li><a href="#org2355c8d">public 变量赋值顺序</a></li>
<li><a href="#orgeba1741">Update 细节</a></li>
</ul>
</li>
<li><a href="#org1e093f8">Resource</a>
<ul>
<li><a href="#org8f5189a">Load</a></li>
</ul>
</li>
<li><a href="#org319828e">Animator Animation Avatar</a>
<ul>
<li><a href="#orgf9e7a16">播放动画控制</a>
<ul>
<li><a href="#org530a34d">循环播放动画</a>
<ul>
<li><a href="#org98fd38d">Animation</a></li>
<li><a href="#org00d3ae3">Animator</a></li>
</ul>
</li>
<li><a href="#org270a324">暂停播放 恢复播放</a></li>
<li><a href="#org21a52d3">判断动画是否正在播放 判断动画是否播放完</a></li>
<li><a href="#org494cedb">添加删除动画消息</a>
<ul>
<li><a href="#orgba9b719">Animation</a></li>
<li><a href="#org0ca6ff3">Animator</a></li>
</ul>
</li>
<li><a href="#orgaf1d87d">从某个时间点开始播放动画</a></li>
</ul>
</li>
<li><a href="#org80fb16d">动画的整体流程是怎样的？Skinning 是发生在什么时候？</a></li>
<li><a href="#org4586ef0">表情动画实现</a></li>
<li><a href="#org7333566">动画中 Rig/Root Node 和 Animation/Motion/RootMotionNode 的差别</a>
<ul>
<li><a href="#org3831e7b">参考资料</a></li>
</ul>
</li>
<li><a href="#org06a5ca1">Animator Humanoid 是如何支持不同体型角色复用同一套动画的？</a></li>
<li><a href="#org6a48372">Animator Humanoid 如何支持飘带动画？</a></li>
<li><a href="#org5e6af5a">Avatar 里面存储的是什么数据？Avatar 的作用是 什么？</a>
<ul>
<li><a href="#org75c646c">Avatar 中存储的数据</a>
<ul>
<li><a href="#orgdd9f801">Generic Avatar</a></li>
<li><a href="#org314d4a3">Humanoid Avatar</a></li>
</ul>
</li>
<li><a href="#org549f271">Avatar Rigging Skinning 术语</a></li>
<li><a href="#orga771b6d">Generic Avatar</a>
<ul>
<li><a href="#orgcc13e2f">Root Node</a></li>
<li><a href="#org1ce54cb">参考资料</a></li>
</ul>
</li>
<li><a href="#org0135740">Humanoid Avatar</a>
<ul>
<li><a href="#orge18dd7b">Body Transform</a></li>
<li><a href="#orgbdd92af">Root Motion Node</a></li>
<li><a href="#orga88944c">参考资料</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8ef9e1c">AnimatorState.WriteDefaults</a></li>
<li><a href="#orgffa98e2">参考文档</a></li>
</ul>
</li>
<li><a href="#org977aad5">Attributes</a>
<ul>
<li><a href="#orgcbec6ab">RuntimeInitializeOnLoadMethod</a></li>
<li><a href="#orgc0fbc10">Inspector Attributes</a>
<ul>
<li><a href="#orgc63ef08">Range</a></li>
<li><a href="#orge874812">字段序列化和显示</a></li>
<li><a href="#org06c035a">添加 Reset 操作</a></li>
<li><a href="#orgc1d731f">添加 Header 添加空格</a></li>
<li><a href="#org5f70838">颜色选择</a></li>
</ul>
</li>
<li><a href="#org0ad0213">指定依赖某个组件</a></li>
<li><a href="#org6879f0c">System.Serializable</a></li>
<li><a href="#org3718c60">自定义属性显示名字</a></li>
<li><a href="#org5ce5975">自定义属性只读</a></li>
<li><a href="#org5e62cfc">参考资料</a></li>
</ul>
</li>
<li><a href="#org64f20e2">Ray</a>
<ul>
<li><a href="#org88aba7a">使用射线来实现拾取物体</a></li>
</ul>
</li>
<li><a href="#org92a14f0">Sprite SpriteAtlas</a>
<ul>
<li><a href="#orgad10c43">Sprite.textureRect Sprite.textureRectOffset</a></li>
</ul>
</li>
<li><a href="#orga8cc14c">Coroutine</a></li>
<li><a href="#org8d2b1c6">Dir File Path</a>
<ul>
<li><a href="#orgdfd93b1">Application.absoluteURL</a></li>
<li><a href="#org5136d92">Application.dataPath</a></li>
<li><a href="#orgecca440">Application.persistentDataPath</a></li>
<li><a href="#org1db6614">Application.streamingAssetsPath</a></li>
<li><a href="#orgb064ce8">Application.temporaryCachePath</a></li>
<li><a href="#org9157742">获取项目根目录</a></li>
</ul>
</li>
<li><a href="#org946dc23">Camera</a>
<ul>
<li><a href="#orgaa06b0b">判断物体是否在摄像机视野内</a></li>
</ul>
</li>
<li><a href="#orgc03caf9">Mesh MeshRenderer SkinnedMeshRenderer</a>
<ul>
<li><a href="#org44431ff">Mesh</a>
<ul>
<li><a href="#org85a801d">关于 Mesh</a>
<ul>
<li><a href="#org7d47624">Mesh.vertices</a></li>
<li><a href="#orgfb713e0">Mesh.bindposes</a></li>
<li><a href="#org0767fbe">Mesh.boneWeights</a></li>
</ul>
</li>
<li><a href="#orgffc93d1">代码创建 QuadMesh</a></li>
<li><a href="#orgb0ccf7d">Mesh vertices normals bindposes 数据修改</a></li>
</ul>
</li>
<li><a href="#org8d2a00f">SkinnedMeshRenderer</a>
<ul>
<li><a href="#org919e38b">SkinnedMeshRenderer 和 骨架</a></li>
<li><a href="#orgb6e786d">SkinnedMeshRenderer 和 Mesh</a></li>
<li><a href="#orga6030c0">SkinnedMeshRenderer.sharedMesh</a></li>
<li><a href="#orgdb70823">SkinnedMeshRenderer 序列化</a>
<ul>
<li><a href="#org4f1b297">SkinnedMeshRenderer Public 属性</a></li>
<li><a href="#org742d76e">方案 1</a></li>
<li><a href="#org7c8fd05">方案 2</a></li>
<li><a href="#org7e9052a">方案 3</a></li>
<li><a href="#orgc7f6451">方案 4</a></li>
<li><a href="#orgc2bf998">方案 5</a></li>
<li><a href="#org8d066e8">方案比较</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgda9330c">当模型只有一个骨骼时，SkinMesh 和 Mesh 的运算效率相差大吗？</a></li>
</ul>
</li>
<li><a href="#org509259e">Lod LodGroup</a>
<ul>
<li><a href="#org849c819">Lod.screenRelativeTransitionHeight</a></li>
<li><a href="#orgb0b627e">Quality.LodBias</a></li>
<li><a href="#orgf940b80">Misc</a>
<ul>
<li><a href="#org5d59c70">同一个 Renderer 可以在不同的 Lod 中</a></li>
</ul>
</li>
<li><a href="#orge687db8">参考资料</a></li>
</ul>
</li>
<li><a href="#org0961223">Materials</a>
<ul>
<li><a href="#org7b3a87b">使用 shaderMaterial 编辑器下每次运行，材质都被修改</a></li>
</ul>
</li>
<li><a href="#org04eb3c0">Graphics</a>
<ul>
<li><a href="#org4d8c93f">CommandBuffer</a>
<ul>
<li><a href="#org5edcb81">简介</a></li>
<li><a href="#org7d66b85">对于只执行一次的 CommandBuffer 要如何 FrameDebuger？</a></li>
</ul>
</li>
<li><a href="#org2ea1607">Texture2D UV 坐标</a></li>
<li><a href="#org03dfd6e">将材质来渲染贴图并保存起来</a></li>
</ul>
</li>
<li><a href="#orgb90a3e6">Screen And Resolution</a></li>
<li><a href="#orgf21d1eb">Misc</a>
<ul>
<li><a href="#org95da6d7">如何在编辑器中实时查看脚本私有变量的值？</a></li>
<li><a href="#org52267aa">如何将 Texture2D 保存为 png 图片？</a></li>
<li><a href="#org58d684b">如何计算 FPS 并显示出来？</a></li>
<li><a href="#org1812dbe">PlayerPrefs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf2a6f28">Editor</a>
<ul>
<li><a href="#org52c84df">EditorExtension</a>
<ul>
<li><a href="#orgadc833a">Update/Redraw SceneView</a></li>
<li><a href="#orga451a65">添加菜单命令</a>
<ul>
<li><a href="#org3d49d8c">快捷键规则</a></li>
<li><a href="#org06c9fac">Example</a></li>
</ul>
</li>
<li><a href="#org15edea0">执行菜单命令</a></li>
<li><a href="#org7a1544d">Engine 命名空间下执行 Editor 命名空间下代码</a></li>
<li><a href="#org835f44c">CustomEditor</a>
<ul>
<li><a href="#orgfa615ad">自定义 Inspector</a></li>
<li><a href="#org98029f7">自定义属性通过选择文件来赋值</a></li>
<li><a href="#org666463e">自定义 Inspector 显示 List</a>
<ul>
<li><a href="#orgb2a6502">方案 1 不自定义化 List 的显示</a></li>
<li><a href="#org55f9440">方案 2 自定义 List 的显示</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org694b22d">EditorWindow</a>
<ul>
<li><a href="#org6fcd6da">EditorGUILayout</a></li>
<li><a href="#org1203795">如何在 EditorWindow 中绘制模型？</a></li>
</ul>
</li>
<li><a href="#orgca82511">实时应用被编辑的变量</a></li>
<li><a href="#org05afb5c">Tools</a>
<ul>
<li><a href="#org3638400">复制资源</a></li>
<li><a href="#orgfb86019">设置 Animator 的 AnimationClip loop 属性</a></li>
<li><a href="#orgb2e25fc">代码设置 CacheServer</a></li>
<li><a href="#org56b9966">按照指定条件获取工程中的资源</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0f6e057">ModelImporter</a>
<ul>
<li><a href="#orgd52014c">MeshCompression</a></li>
<li><a href="#orgf3c1997">Animation Compression</a></li>
<li><a href="#orgc742396">Optimize Mesh</a></li>
<li><a href="#orgb9e9ad9">Preserve Hierarchy</a></li>
</ul>
</li>
<li><a href="#org7d44bb6">Misc</a>
<ul>
<li><a href="#org8f319d0">Path</a>
<ul>
<li><a href="#org568f5ed">EditorApplication.applicationContentsPath</a></li>
<li><a href="#orgbcfdb09">EditorApplication.applicationPath</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org36a5afc">Build</a>
<ul>
<li><a href="#org7761ccb">自定义宏</a></li>
<li><a href="#org396615d">Unity 命令行</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5b6db72">Usage</a>
<ul>
<li><a href="#org508a446">prefab</a>
<ul>
<li><a href="#orgf233d7c">取消预制体关联</a></li>
</ul>
</li>
<li><a href="#org0497b8a">search</a></li>
</ul>
</li>
<li><a href="#orge27307a">Optimize</a>
<ul>
<li><a href="#org3e53a61">Optimizing Graphics Performance</a>
<ul>
<li><a href="#org8493adb">where are the graphics costs</a>
<ul>
<li><a href="#org5defd96">典型的瓶颈以及检测他们的方法</a>
<ul>
<li><a href="#org05886c1">GPU 通常会受到填充率和内存带宽的限制:</a></li>
<li><a href="#orgb748d2f">CPU 通常会受到需要被渲染的批处理的数量的限制</a></li>
<li><a href="#orgf760576">不是渲染的问题，无论是在 GPU 还是 CPU 上。</a></li>
<li><a href="#org293e718">GPU 有很多顶点需要处理。多少个顶点是可以接受的，这一点取决于 GPU 以及顶点着色器的复杂度。</a></li>
<li><a href="#org939659e">对于一些需要在 CPU 进行的顶点处理，CPU 也有很多顶点需要处理。</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org84ce040">CPU optimization</a>
<ul>
<li>
<ul>
<li><a href="#org0b59e62">使用手动方式或者 Unity 的 draw call 批处理方式，将靠近的物体组合在一起。</a></li>
<li><a href="#org5e35e0b">游戏物体使用尽可能少的材质，将不同的贴图放到一张更大的贴图地图中。</a></li>
<li><a href="#org4e9a0d2">尽可能少使用导致多次渲染物体的效果（例如，反射、阴影、基于像素的光照等等）</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org57d11e3">GPU: Optimizing Model Geometry</a>
<ul>
<li>
<ul>
<li><a href="#org0911518">不要使用任何多余的不必要的三角形</a></li>
<li><a href="#org2ecbb33">保持 UV 贴图接缝和硬边缘的数目越少越好</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org30de4ed">Lighting Performance</a>
<ul>
<li>
<ul>
<li><a href="#org74bea59">光照贴图要运行的更快（比基于像素的光照快 2-3 倍）</a></li>
<li><a href="#orgc7b439e">并且看上去效果要更好，因为你可以烘焙的全局照明而且光照贴图可以平滑化结果。</a></li>
</ul>
</li>
<li><a href="#orgf5302f4">Lights in forward rendering</a></li>
</ul>
</li>
<li><a href="#org3c1e57f">GPU: Texture Compression and Mipmaps</a>
<ul>
<li><a href="#org7db01e5">Use Texture Mip Maps</a></li>
</ul>
</li>
<li><a href="#org69d9474">LOD and Per-Layer Cull Distances</a></li>
<li><a href="#org23d8ec9">Realtime Shadows</a></li>
<li><a href="#org8795a3f">GPU: Tips for writing high-performance shaders</a>
<ul>
<li><a href="#orgb6918fb">Complex mathematical operations</a></li>
<li><a href="#org17c7e58">Floating point operations</a></li>
</ul>
</li>
<li><a href="#org37f62b1">Simple Checklist to make Your Game Faster</a></li>
</ul>
</li>
<li><a href="#orga8d99b6">Draw Call Batching</a>
<ul>
<li><a href="#org70a64b8">Materials</a></li>
<li><a href="#org891036a">Dynamic Batching</a>
<ul>
<li><a href="#org3503d8b">Tips:</a></li>
</ul>
</li>
<li><a href="#org121a408">Static Batching</a></li>
<li><a href="#org231b25f">Other batching tips</a></li>
</ul>
</li>
<li><a href="#orgcb8f7bc">Modeling characters for optimal performance</a>
<ul>
<li><a href="#orgf1d3b87">使用单个蒙皮网格渲染</a></li>
<li><a href="#orgfdc9067">使用尽可能少的材质</a></li>
<li><a href="#org1d23604">使用尽可能少的骨骼</a></li>
<li><a href="#org4145853">多边形数目</a></li>
<li><a href="#org9ee4ec0">保持正向运动和反向运动分开</a></li>
</ul>
</li>
<li><a href="#org62c721c">Optimizing Shader Load Time</a>
<ul>
<li><a href="#orga796781">Shader build time stripping</a></li>
<li><a href="#org02868d5">Default Unity shader loading behavior</a></li>
<li><a href="#org0abaab7">Shader Variant Collections</a></li>
</ul>
</li>
<li><a href="#org8dcbb40">Animation Optimize</a>
<ul>
<li><a href="#orgb75f881">MecanimPeformanceandOptimization</a></li>
<li><a href="#org92f2dd0">参考文档</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org59adb94">Android Platform</a>
<ul>
<li><a href="#orgbb8e336">开发环境</a></li>
</ul>
</li>
<li><a href="#orgc5caf2a">Q&amp;A</a>
<ul>
<li><a href="#org35220de">激活 GameObject 和激活 Component 分别使用什么方法？</a></li>
<li><a href="#org30f3131">删除 GameObject 和删除 Component 分别使用什么方法？</a></li>
<li><a href="#org34df9fd">Unity 中插件下载目录在哪儿？</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
该文章记录了翻译的 Unity 官方文档，以及学习过程中总结的文档<br />
相关代码放在: <a href="https://github.com/wolfand11/StudyProjects/tree/master/SDK/Unity">https://github.com/wolfand11/StudyProjects/tree/master/SDK/Unity</a><br />
</p>

<div class="HTML">
<p>
&lt;!&#x2013; more &#x2013;&gt;<br />
</p>

</div>
<div id="outline-container-orgf532ebc" class="outline-2">
<h2 id="orgf532ebc">Scripts</h2>
<div class="outline-text-2" id="text-orgf532ebc">
</div>
<div id="outline-container-org06ed129" class="outline-3">
<h3 id="org06ed129">Scene</h3>
<div class="outline-text-3" id="text-org06ed129">
<p>
SceneManager.SceneManager.GetActiveScene().GetRootGameObjects()不会返回被标记为不被销毁的对象。<br />
</p>
</div>
<div id="outline-container-org682a5a1" class="outline-4">
<h4 id="org682a5a1">Active Scene</h4>
<div class="outline-text-4" id="text-org682a5a1">
<p>
激活的的场景被用于<br />
<a href="https://docs.unity3d.com/ScriptReference/SceneManagement.SceneManager.SetActiveScene.html">https://docs.unity3d.com/ScriptReference/SceneManagement.SceneManager.SetActiveScene.html</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgaf33219" class="outline-3">
<h3 id="orgaf33219">Object</h3>
<div class="outline-text-3" id="text-orgaf33219">
<p>
Object 中的几个静态方法。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Destroy</td>
<td class="org-left">删除一个 <b>游戏对象</b> 或 <b>组件</b> 或 <b>资源</b> .</td>
</tr>

<tr>
<td class="org-left">DestroyImmediate</td>
<td class="org-left">立即删除对象. 强烈建议使用 Destroy 代替此方法.</td>
</tr>

<tr>
<td class="org-left">DontDestroyOnLoad</td>
<td class="org-left">在加载一个新场景时，该对象不被自动销毁</td>
</tr>

<tr>
<td class="org-left">FindObjectOfType</td>
<td class="org-left">返回第一个被加载的 <b>激活的</b> Type 类型的对象.</td>
</tr>

<tr>
<td class="org-left">FindObjectsOfType</td>
<td class="org-left">返回所有被加载的 <b>激活的</b> Type 类型的对象.</td>
</tr>

<tr>
<td class="org-left">Instantiate</td>
<td class="org-left">克隆原始对象并返回克隆体.</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org504403b" class="outline-4">
<h4 id="org504403b">Destroy</h4>
<div class="outline-text-4" id="text-org504403b">
<ol class="org-ol">
<li>调用 Destroy 后，会先调用被删除对象的 OnDisable 然后再调用 OnDestroy<br /></li>
<li>如果 Object.Destroy(obj)中的 obj 为组件，会先将该组件从 GameObject 上移除，然后销毁该组件；如果 obj 为一个 GameObject，会删除该游戏对象、它的所有组件、以及它 transform 中记录的所有子节点。<br /></li>
<li>调用 Destory 后，并不会立即销毁对象，会延迟到当前 Update 执行结束以后，但在渲染之前会销毁。<br />
如果在 OnEnable 中调用 Destroy，会立即触发 OnDisable 方法，但是不会立即触发 OnDestroy 方法， <b>当前所有对象</b> 的 OnEnable 执行结束后才调用 OnDestroy。<br />
如果在 Start 中调用 Destroy，会立即触发 OnDisable 方法，但是不会立即触发 OnDestroy 方法， <b>当前所有对象</b> 的 Start 执行结束后才调用 OnDestroy。<br />
如果在 Update 中调用 Destory，会立即触发 OnDisable 方法，但是不会立即触发 OnDestroy 方法， <b>当前所有对象</b> 的 Update 执行结束后才调用 OnDestroy。<br />
如果在 LateUpdate 中调用 Destroy，会立即触发 OnDisable 方法，但是不会立即触发 OnDestroy 方法， <b>当前所有对象</b> 的 LateUpdate 执行结束后才调用 OnDestroy。<br />
如果在 OnPostRender 中调用 Destroy，会立即触发 OnDisable 方法，但是不会立即触发 OnDestroy 方法， <b>当前对象</b> 的 OnPostRender 执行结束后才调用 OnDestroy。<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org18d79d0" class="outline-4">
<h4 id="org18d79d0">DontDestroyOnLoad</h4>
<div class="outline-text-4" id="text-org18d79d0">
<p>
DontDestroyOnLoad 只对场景中的 Root GameObjects 或他们上的组件有效。<br />
创建一个空对象，然后对其调用 DontDestroyOnLoad 可以将该对象变为当前场景的 Root GameObject。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgda0c7a7" class="outline-3">
<h3 id="orgda0c7a7">GameObject</h3>
<div class="outline-text-3" id="text-orgda0c7a7">
</div>
<div id="outline-container-org85311c0" class="outline-4">
<h4 id="org85311c0">GameObject.Find(string childName) 静态成员方法</h4>
<div class="outline-text-4" id="text-org85311c0">
<ol class="org-ol">
<li>需要注意的是该方法会循环查找整个场景树的节点(根节点和子节点都会查找)。找到第一个名称为 childName 的节点。<br /></li>
<li>该方法会返回标记为不被销毁的对象。<br /></li>
<li>该方法只返回被激活的对象，如果 gameObject 没有被激活，则不会返回。<br /></li>
</ol>
</div>
</div>
<div id="outline-container-orgb908905" class="outline-4">
<h4 id="orgb908905">GetComponent GetComponents</h4>
<div class="outline-text-4" id="text-orgb908905">
<p>
<a href="#orgc96868c">No description for this link</a><br />
</p>
</div>
</div>
<div id="outline-container-orga51f4a7" class="outline-4">
<h4 id="orga51f4a7">GameObject 定义的其他成员方法</h4>
<div class="outline-text-4" id="text-orga51f4a7">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-left">功能</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">AddComponent</td>
<td class="org-left">添加一个类名称为 className 的组件到当前对象上.</td>
</tr>

<tr>
<td class="org-left">BroadcastMessage</td>
<td class="org-left">调用当前对象以及其子对象上每个 MonoBehavior 上的名字单位 methodName 的方法</td>
</tr>

<tr>
<td class="org-left">CompareTag</td>
<td class="org-left">判断 gameObject 的 tag 与参数的 tag 相同 ?</td>
</tr>

<tr>
<td class="org-left">GetComponent</td>
<td class="org-left">获取当前对象的指定类型的组件,不存在返回 null</td>
</tr>

<tr>
<td class="org-left">GetComponentInChildren</td>
<td class="org-left">获取当前对象或其子对象的指定类型的组件，不存在返回 null（遍历行为是以深度为优先的）</td>
</tr>

<tr>
<td class="org-left">GetComponentInParent</td>
<td class="org-left">获取当前对象或其父对象的指定类型的组件，不存在返回 null</td>
</tr>

<tr>
<td class="org-left">GetComponents</td>
<td class="org-left">获取当前对象的所有组件</td>
</tr>

<tr>
<td class="org-left">GetComponentsInChildren</td>
<td class="org-left">获取当前对象或其子对象的指定类型的所有组件。</td>
</tr>

<tr>
<td class="org-left">GetComponentsInParent</td>
<td class="org-left">获取当前对象或其父对象的指定类型的所有组件。</td>
</tr>

<tr>
<td class="org-left">SendMessage</td>
<td class="org-left">调用当前对象上每个 MonoBehavior 上的名字为 methodName 的方法</td>
</tr>

<tr>
<td class="org-left">SendMessageUpwards</td>
<td class="org-left">调用当前对象以及其父对象上每个 MonoBehavior 上的名字单位 methodName 的方法</td>
</tr>

<tr>
<td class="org-left">SetActive</td>
<td class="org-left">激活/不激活 当前对象</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org45078d6" class="outline-5">
<h5 id="org45078d6">Tips:</h5>
<div class="outline-text-5" id="text-org45078d6">
<p>
GetComponentInChildren(Type compType);<br />
GetComponentsInChildren(Type compType);<br />
GetComponentInParent(Type compType);<br />
GetComponentsInParent(Type compType);<br />
需要注意的是<br />
1 上面 4 个方法会先在当前对象中寻找 CompType 类型的组件。<br />
2 方面 4 个方法会循环查找所有子节点或父节点<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org2183861" class="outline-4">
<h4 id="org2183861">GameObject 和 Transform</h4>
<div class="outline-text-4" id="text-org2183861">
<p>
new 出来的 GameObject 对象会自带一个 Transform 组件<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">obj</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GameObject</span>();
<span style="color: #4f97d7; font-weight: bold;">if</span> (obj.transform!=<span style="color: #a45bad;">null</span>)
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"exist transform"</span>);
}
<span style="color: #4f97d7; font-weight: bold;">else</span>
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"not exist"</span>);
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19978;&#38754;&#30340;&#20195;&#30721;&#20250;&#36755;&#20986; exist transform</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2b0bef0" class="outline-4">
<h4 id="org2b0bef0">Get all DontDestroyOnLoad GameObjects</h4>
<div class="outline-text-4" id="text-org2b0bef0">
<ol class="org-ol">
<li><p>
无论是编辑器版还是 App 版都无法通过下面代码获取所有的 DontDestroyOnLoad GameObject<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DestroyDontDestroyOnLoadGameObjects</span>()
{
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25552;&#31034;&#26080;&#27861;&#25214;&#21040; DontDestroyOnLoad &#22330;&#26223;</span>
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">dontDestoyOnLoadScene</span> = SceneManager.<span style="color: #bc6ec5; font-weight: bold;">GetSceneByName</span>(<span style="color: #2d9574;">"DontDestroyOnLoad"</span>);
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">dontDestroyOnLoadGameObjects</span> = dontDestoyOnLoadScene.<span style="color: #bc6ec5; font-weight: bold;">GetRootGameObjects</span>();
    <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">dontdestroyGameObject</span> <span style="color: #4f97d7; font-weight: bold;">in</span> dontDestroyOnLoadGameObjects)
    {
        Destroy(gameObject);
    }
}
</pre>
</div></li>
<li><p>
在编辑器模式下可以使用如下代码来获取所有 DontDestroyOnLoad GameObject<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DestroyAllDontDestroyOnLoadObjects</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">go</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GameObject</span>(<span style="color: #2d9574;">"Sacrificial Lamb"</span>);
    DontDestroyOnLoad(go);

    <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #bc6ec5; font-weight: bold;">root</span> <span style="color: #4f97d7; font-weight: bold;">in</span> go.scene.<span style="color: #bc6ec5; font-weight: bold;">GetRootGameObjects</span>())
        Destroy(root);
}
</pre>
</div></li>
<li><p>
在 App 版中，可以使用如下方法<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">DontDestroyOnLoadManager</span>
{
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;GameObject&gt; <span style="color: #7590db;">_ddolObjects</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;GameObject&gt;();

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DontDestroyOnLoad</span>(<span style="color: #4f97d7; font-weight: bold;">this</span> GameObject go) {
        UnityEngine.Object.<span style="color: #bc6ec5; font-weight: bold;">DontDestroyOnLoad</span>(<span style="color: #ce537a; font-weight: bold;">go</span>);
        _ddolObjects.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #ce537a; font-weight: bold;">go</span>);
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DestroyAll</span>() {
        <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">go</span> <span style="color: #4f97d7; font-weight: bold;">in</span> _ddolObjects)
            <span style="color: #4f97d7; font-weight: bold;">if</span>(go != <span style="color: #a45bad;">null</span>)
                UnityEngine.Object.<span style="color: #bc6ec5; font-weight: bold;">Destroy</span>(<span style="color: #ce537a; font-weight: bold;">go</span>);

        _ddolObjects.<span style="color: #bc6ec5; font-weight: bold;">Clear</span>();
    }
}
</pre>
</div></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org20000e9" class="outline-3">
<h3 id="org20000e9">Transform</h3>
<div class="outline-text-3" id="text-org20000e9">
</div>
<div id="outline-container-org20bcdb5" class="outline-4">
<h4 id="org20bcdb5">transform.Find(string childName)</h4>
<div class="outline-text-4" id="text-org20bcdb5">
<ul class="org-ul">
<li>Find 方法不是递归查找子节点的，它只查询直接子节点(不会查找自己)。<br /></li>
<li>Find 方法可以传递子节点的相对路径 例如：“child1/child1_1”<br /></li>
<li>Find 方法可以返回没有被激活的子节点<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org9dd38b2" class="outline-4">
<h4 id="org9dd38b2">transform.root</h4>
<div class="outline-text-4" id="text-org9dd38b2">
<p>
该方法返回 transform 的 Root 节点。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">/*</span>
<span style="color: #2aa1ae; background-color: #292e34;">UIScene &#20013;&#30340;&#32467;&#26500;&#22914;&#19979;</span>
<span style="color: #2aa1ae; background-color: #292e34;">-Canvas</span>
<span style="color: #2aa1ae; background-color: #292e34;">--MainUI</span>
<span style="color: #2aa1ae; background-color: #292e34;">---PlayerIcon</span>
<span style="color: #2aa1ae; background-color: #292e34;">PlayerIcon.transform.root &#36820;&#22238;&#30340;&#26159; Canvas</span>
<span style="color: #2aa1ae; background-color: #292e34;">*/</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org285b46e" class="outline-4">
<h4 id="org285b46e">设置节点关系</h4>
<div class="outline-text-4" id="text-org285b46e">
<p>
SetAsFirstSibling	将 transform 放置到本地 transform 列表最前。<br />
SetAsLastSibling	将 transform 放置到本地 transform 列表最后。<br />
SetParent	将 transfrom 设置为当前 transform 的父节点.<br />
</p>
</div>
</div>
<div id="outline-container-org7be9728" class="outline-4">
<h4 id="org7be9728">SetParent(parentTransform,worldPositionStays)</h4>
<div class="outline-text-4" id="text-org7be9728">
<p>
需要注意下面几点：<br />
</p>
<ul class="org-ul">
<li>该方法为 Transform 对象的方法，GameObject 没有该方法<br /></li>
<li>该方法的第一个参数必须为 Transform 对象，不能为 GameObject<br /></li>
<li>该方法的第二个参数默认值为 True，表示对象世界坐标不变，此时对象的 localPosition、localScale、localEulerAngles 可能是会被改变<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgb025b42" class="outline-4">
<h4 id="orgb025b42">GetComponent(s) GetComponent(s)InChildren GetComponent(s)InParent</h4>
<div class="outline-text-4" id="text-orgb025b42">
<p>
<a id="orgc96868c"></a><br />
</p>
<ul class="org-ul">
<li>Component 类和 GameObject 类都有 GetComponent 方法<br /></li>
<li><p>
NGUI 中有如下继承关系 UIWidget-&gt;UIBasicSprite-&gt;UISprite，如果 GameObject 上绑定的组件中只有 Transform、UISprite，那么 GetComponent&lt;UIWidget&gt;()可以返回其上的 UISprite 组件。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">widget</span> = GetComponent&lt;UIWidget&gt;();
<span style="color: #4f97d7; font-weight: bold;">if</span> ( widget != <span style="color: #a45bad;">null</span> )
{
    Debug.Log ( <span style="color: #2d9574;">"&#20174; UIImage &#19978;&#33719;&#21462; UIWidget &#25104;&#21151; --- "</span> + widget.ToString ( ) );
}
<span style="color: #4f97d7; font-weight: bold;">else</span>
{
    Debug.Log ( <span style="color: #2d9574;">"&#20174; UIImage &#19978;&#33719;&#21462; UIWidget &#22833;&#36133; "</span> );
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19978;&#38754;&#30340;&#20195;&#30721;&#20250;&#36755;&#20986;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20174; UIImage &#19978;&#33719;&#21462; UIWidget &#25104;&#21151; --- Sprite (UISprite)</span>
</pre>
</div></li>
<li><p>
遍历 GameObject 上的所有组件<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#20004;&#31181;&#25928;&#26524;&#26159;&#19968;&#26679;&#30340;</span>
<span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #bc6ec5; font-weight: bold;">t</span> <span style="color: #4f97d7; font-weight: bold;">in</span> gameObject.<span style="color: #bc6ec5; font-weight: bold;">GetComponents</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(Component)))
{
    Debug.Log (t.<span style="color: #bc6ec5; font-weight: bold;">ToString</span>( ));
}

<span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">t</span> <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7; font-weight: bold;">this</span>.GetComponents&lt;Component&gt;( ))
{
    Debug.Log (t.<span style="color: #bc6ec5; font-weight: bold;">ToString</span>( ));
}
</pre>
</div></li>
<li>GetComponentInChildren(Type t) GetComponentInParent(Type t) 只返回激活状态的 GameObject 上的组件<br /></li>
<li>GetComponentsInChildren(Type t, bool includeInactive=false) GetComponentsInParent(Type t, bool includeInactive=false) 该函数会返回自己<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org6aadb97" class="outline-4">
<h4 id="org6aadb97">Vector2.Angle Vector2.SignedAngle</h4>
<div class="outline-text-4" id="text-org6aadb97">
<p>
该函数只会返回正值<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">Vector2</span> <span style="color: #7590db;">originDir</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(0, 1);
<span style="color: #ce537a; font-weight: bold;">Vector2</span> <span style="color: #7590db;">targetDir</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(1, 0);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"y-&gt;x  "</span> + Vector2.<span style="color: #bc6ec5; font-weight: bold;">Angle</span>(originDir, targetDir).<span style="color: #bc6ec5; font-weight: bold;">ToString</span>());
targetDir = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(-1, 0);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"y-&gt;-x "</span> + Vector2.<span style="color: #bc6ec5; font-weight: bold;">Angle</span>(originDir, targetDir).<span style="color: #bc6ec5; font-weight: bold;">ToString</span>());
targetDir = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(0, -1);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"y-&gt;-y "</span> + Vector2.<span style="color: #bc6ec5; font-weight: bold;">Angle</span>(originDir, targetDir).<span style="color: #bc6ec5; font-weight: bold;">ToString</span>());
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#26159;&#36755;&#20986;&#32467;&#26524;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">y-&gt;x  90</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">y-&gt;-x 90</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">y-&gt;-y 180</span>

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#20195;&#30721;&#26159;&#38169;&#35823;&#30340; ERROR  &#24212;&#35813;&#20351;&#29992; Vector2.SignedAngle &#26469;&#33719;&#21462;&#27491;&#30830;&#30340;&#24102;&#31526;&#21495;&#30340;&#26059;&#36716;&#35282;&#24230;</span>
<span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">rotation</span> = Vector2.<span style="color: #bc6ec5; font-weight: bold;">Angle</span>(originDir,targetDir);
<span style="color: #4f97d7; font-weight: bold;">if</span> (targetDir.x &lt; originDir.x)
{
    rotation = -rotation;
}
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22312; Unity &#20013; &#27491;&#30340;&#26059;&#36716;&#24230;&#25968;&#34920;&#31034; &#27839;&#30528;&#26059;&#36716;&#36724;&#30340;&#26041;&#21521;&#30475; &#26159;&#36870;&#26102;&#38024;&#26059;&#36716;&#65292;&#27839;&#30528;&#26059;&#36716;&#36724;&#30340;&#21453;&#26041;&#21521;&#30475; &#26159; &#39034;&#26102;&#38024;&#26059;&#36716;&#12290;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0f11a54" class="outline-4">
<h4 id="org0f11a54">transform.localEulerAngles</h4>
<div class="outline-text-4" id="text-org0f11a54">
</div>
<div id="outline-container-org7865865" class="outline-5">
<h5 id="org7865865">unity 为左手坐标系，所以旋转的正方向通过左手原则来定</h5>
<div class="outline-text-5" id="text-org7865865">
<p>
transform.localEulerAngles.x 表示绕 x 轴旋转的角度<br />
transform.localEulerAngles.y 表示绕 y 轴旋转的角度<br />
transform.localEulerAngles.z 表示绕 z 轴旋转的角度<br />
</p>
</div>
</div>
<div id="outline-container-orge147d6b" class="outline-5">
<h5 id="orge147d6b">transform.localEulerAngles 与 transfrom.localRotation.eulerAngles</h5>
<div class="outline-text-5" id="text-orge147d6b">
<p>
这个两个属性获得的值是相等的。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgcb320c3" class="outline-4">
<h4 id="orgcb320c3">transform.LookAt</h4>
<div class="outline-text-4" id="text-orgcb320c3">
<p>
public void LookAt(Transform target, Vector3 worldUp = Vector3.up);<br />
public void LookAt(Vector3 worldPosition, Vector3 worldUp = Vector3.up);<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622; gObj &#26397;&#21521;&#21069;&#26041;&#21521;&#19978; 30 &#24230;&#26041;&#21521;</span>
<span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">dir</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(Math.<span style="color: #bc6ec5; font-weight: bold;">Cos</span>(30*Math.PI/180),Math.<span style="color: #bc6ec5; font-weight: bold;">Cin</span>(30*Math.PI/180),0);
gObj.transfrom.<span style="color: #bc6ec5; font-weight: bold;">LookAt</span>(Transform.<span style="color: #bc6ec5; font-weight: bold;">TransformDirection</span>(dir));
</pre>
</div>
</div>
</div>
<div id="outline-container-org279ed3b" class="outline-4">
<h4 id="org279ed3b">遍历子节点</h4>
<div class="outline-text-4" id="text-org279ed3b">
</div>
<div id="outline-container-orga330f83" class="outline-5">
<h5 id="orga330f83">遍历直接子节点</h5>
<div class="outline-text-5" id="text-orga330f83">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#20004;&#31181;&#36941;&#21382;&#26041;&#27861;&#26159;&#31561;&#20215;&#30340;</span>
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #ce537a; font-weight: bold;">Transform</span> <span style="color: #7590db;">trans</span> <span style="color: #4f97d7; font-weight: bold;">in</span> transform)
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"---&gt; "</span> + trans.name);
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">transform.childCount disabled &#29366;&#24577;&#30340;&#23376;&#33410;&#28857;&#20063;&#21253;&#21547;&#22312;&#20869;</span>
<span style="color: #4f97d7; font-weight: bold;">for</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">i</span>=0; i&lt;transform.childCount; i++)
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"---&gt; "</span> + transform.<span style="color: #bc6ec5; font-weight: bold;">GetChild</span>(i).name);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgef4356b" class="outline-5">
<h5 id="orgef4356b">遍历所有子节点</h5>
<div class="outline-text-5" id="text-orgef4356b">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#35813;&#26041;&#27861;&#20250;&#36820;&#22238;&#33258;&#24049;, &#33258;&#24049;&#20026;&#31532;&#19968;&#20010;</span>
<span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">trans</span> <span style="color: #4f97d7; font-weight: bold;">in</span> GetComponentsInChildren&lt;Transform&gt;(<span style="color: #a45bad;">true</span>))
{
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"child = "</span> + trans.name);
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org04e9e6f" class="outline-3">
<h3 id="org04e9e6f">RectTransform</h3>
<div class="outline-text-3" id="text-org04e9e6f">
<p>
请参考下面链接内容：<br />
<a href=".UnityGUI.html#orga813b70">.UnityGUI.html#orga813b70</a><br />
</p>
</div>
</div>
<div id="outline-container-org7110a07" class="outline-3">
<h3 id="org7110a07">Matrix4x4</h3>
<div class="outline-text-3" id="text-org7110a07">
<p>
unity 中的矩阵是列主序的，采用矩阵左乘法。<br />
</p>
</div>
<div id="outline-container-org9389c35" class="outline-4">
<h4 id="org9389c35">Matrix4x4.TRS</h4>
<div class="outline-text-4" id="text-org9389c35">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">pos</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(10, 5, 20);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">TRS &#34920;&#31034;&#20808;&#32553;&#25918;&#21518;&#26059;&#36716;&#20877;&#20301;&#31227;</span>
<span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">newPos1</span> = Matrix4x4.<span style="color: #bc6ec5; font-weight: bold;">TRS</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(5,10,-5), Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(45,45,45), Vector3.one).<span style="color: #bc6ec5; font-weight: bold;">MultiplyPoint</span>(pos);
<span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">newPos2</span> = (Matrix4x4.<span style="color: #bc6ec5; font-weight: bold;">Translate</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(5, 10, -5)) * Matrix4x4.<span style="color: #bc6ec5; font-weight: bold;">Rotate</span>(Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(45, 45, 45))).<span style="color: #bc6ec5; font-weight: bold;">MultiplyPoint</span>(pos);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"newPos1==newPos2 "</span> + (newPos1==newPos2));  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986; True</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org44d93b6" class="outline-4">
<h4 id="org44d93b6">将 Matrix4x4 分解为 Translate Rotation Scale 矩阵</h4>
<div class="outline-text-4" id="text-org44d93b6">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">Matrix4x4</span>[] <span style="color: #7590db;">bparr</span> = smr.sharedMesh.bindposes;
<span style="color: #ce537a; font-weight: bold;">Matrix4x4</span> <span style="color: #7590db;">l2p</span> = bparr[testBoneParentIdx] * bparr[testBoneIdx].inverse;
<span style="color: #ce537a; font-weight: bold;">Matrix4x4</span> <span style="color: #7590db;">p2l</span> = l2p.inverse;
<span style="color: #ce537a; font-weight: bold;">Matrix4x4</span> <span style="color: #7590db;">p2lS</span> = Matrix4x4.<span style="color: #bc6ec5; font-weight: bold;">Scale</span>(p2l.lossyScale);
<span style="color: #ce537a; font-weight: bold;">Matrix4x4</span> <span style="color: #7590db;">p2lR</span> = Matrix4x4.<span style="color: #bc6ec5; font-weight: bold;">Rotate</span>(p2l.rotation);
<span style="color: #ce537a; font-weight: bold;">Matrix4x4</span> <span style="color: #7590db;">p2lT</span> = p2l * p2lS.inverse * p2lR.inverse;
</pre>
</div>
</div>
</div>
<div id="outline-container-org74542c0" class="outline-4">
<h4 id="org74542c0">参考资料</h4>
<div class="outline-text-4" id="text-org74542c0">
<ul class="org-ul">
<li><a href="https://docs.unity3d.com/ScriptReference/Matrix4x4.html">https://docs.unity3d.com/ScriptReference/Matrix4x4.html</a><br /></li>
<li><a href="http://www.mamicode.com/info-detail-1082848.html">http://www.mamicode.com/info-detail-1082848.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org725b085" class="outline-3">
<h3 id="org725b085">Quaternion Euler</h3>
<div class="outline-text-3" id="text-org725b085">
</div>
<div id="outline-container-org7ef78b5" class="outline-4">
<h4 id="org7ef78b5">Quaternion 的结合性</h4>
<div class="outline-text-4" id="text-org7ef78b5">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20808;&#25353;&#29031; a &#26059;&#36716;&#65292;&#28982;&#21518;&#25353;&#29031; b &#26059;&#36716;&#65292;&#21487;&#20197;&#24471;&#21040; c &#34920;&#31034;&#30340;&#26059;&#36716;</span>
<span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">c</span> = a * b;
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"c = "</span> + c.eulerAngles);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Quaternion &#30340;&#20056;&#31215;&#36816;&#31639;&#22797;&#21512;&#32467;&#21512;&#24459;</span>
<span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">d</span> = a * b * c = a * (b * c);
</pre>
</div>
</div>
</div>
<div id="outline-container-org87d16f1" class="outline-4">
<h4 id="org87d16f1">欧拉角旋转</h4>
<div class="outline-text-4" id="text-org87d16f1">
</div>
<div id="outline-container-org8e6ed06" class="outline-5">
<h5 id="org8e6ed06">术语</h5>
<div class="outline-text-5" id="text-org8e6ed06">
<ul class="org-ul">
<li>Yaw   偏航角，绕 Y 轴旋转<br /></li>
<li>Pitch 俯仰角，绕 X 轴旋转<br /></li>
<li>Roll  翻滚角，绕 Z 轴旋转<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org3c02080" class="outline-5">
<h5 id="org3c02080">localEulerAngle</h5>
<div class="outline-text-5" id="text-org3c02080">
<p>
transform.localEulerAngle 返回的是 0-360 范围内的值。在执行旋转角度叠加时，为了支持负数角度，应该将角度范围转换到[-180,180]。<br />
localEulerAngle 表示将父节点的坐标轴按照 先围绕父节点的坐标系的 z 轴旋转 localEulerAngle.z，然后绕父节点坐标系的 x 轴旋转 localEulerAngle.x，最后绕父节点坐标系的 y 轴旋转 localEulerAngle.y.<br />
</p>
</div>
<div id="outline-container-org6fc36ec" class="outline-6">
<h6 id="org6fc36ec">为什么修改 localEulerAngle.xyz 中的一个另外两个保持为 0 时，始终都是围绕本地对应坐标轴旋转？</h6>
<div class="outline-text-6" id="text-org6fc36ec">
<p>
当 localEulerAngle 的三个分量 x,y,z 中其中两个保持为 0，修改另外一个时，始终都是围绕父节点的对应坐标轴旋转，而此时本地坐标轴和父节点坐标轴是一致的，所以同时也围绕本地对应坐标轴旋转。<br />
</p>
</div>
</div>

<div id="outline-container-orgaa93f3a" class="outline-6">
<h6 id="orgaa93f3a">为什么修改 localEulerAngle.z 时，始终都是围绕本地 z 轴旋转？</h6>
<div class="outline-text-6" id="text-orgaa93f3a">
<p>
当 localEulerAngle 的三个分量中 x,y 固定不变(其值可以为除 90 度以外的任意值)，修改 z 时，因为 x,y 固定不变，先绕父节点坐标系的 z 轴旋转 localEulerAngle.z 后，并不会改变本地坐标系中 z 的方向，随后绕父节点坐标系进行 x 轴方向和 y 轴方向的旋转值固定的话，本地坐标系的 z 轴方向变化是相同的。所以，保持 x，y 固定，修改 z，始终都是围绕本地 z 轴旋转。<br />
</p>

<ul class="org-ul">
<li><a href="https://docs.unity3d.com/ScriptReference/Transform-localEulerAngles.html">https://docs.unity3d.com/ScriptReference/Transform-localEulerAngles.html</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org8f75299" class="outline-4">
<h4 id="org8f75299">旋转向量</h4>
<div class="outline-text-4" id="text-org8f75299">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">Vector2</span> <span style="color: #7590db;">dir</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(1, 0);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"old dir = "</span> + dir);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26397;&#21521; z &#36724;&#27491;&#26041;&#21521;&#35266;&#23519;&#26102;&#65292;&#36870;&#26102;&#38024;&#26059;&#36716;&#20026;&#27491;</span>
dir = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(0, 0, 90) * dir;
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"new dir = "</span> + dir);

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">old dir = (1,0)</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">new dir = (0,1)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org122a961" class="outline-4">
<h4 id="org122a961">旋转的差和叠加</h4>
<div class="outline-text-4" id="text-org122a961">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">a</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(30, 30, 0);
<span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">b</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(10, 10, 30);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26059;&#36716;&#30340;&#21472;&#21152;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20808;&#25353;&#29031; a &#26059;&#36716;&#65292;&#28982;&#21518;&#25353;&#29031; b &#26059;&#36716;&#65292;&#21487;&#20197;&#24471;&#21040; c &#34920;&#31034;&#30340;&#26059;&#36716;</span>
<span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">c</span> = a * b;
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"c = "</span> + c.eulerAngles);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26059;&#36716;&#30340;&#24046;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20808;&#25353; c &#26059;&#36716;&#65292;&#28982;&#21518;&#25353;&#29031; b &#34920;&#31034;&#30340;&#26059;&#36716;&#30340;&#21453;&#21521;&#26059;&#36716;&#65292;&#21487;&#20197;&#24471;&#21040; a &#34920;&#31034;&#30340;&#26059;&#36716;</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">tA</span> = c * Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Inverse</span>(b);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#38169;&#35823;&#30340;&#26059;&#36716;&#24046;</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">tB</span> = c * Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Inverse</span>(a);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26059;&#36716;&#30340;&#24046;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20808;&#25353; a &#34920;&#31034;&#30340;&#26059;&#36716;&#30340;&#21453;&#21521;&#26059;&#36716;&#65292;&#28982;&#21518;&#25353;&#29031; c &#26059;&#36716;&#65292;&#21487;&#20197;&#24471;&#21040; b &#34920;&#31034;&#30340;&#26059;&#36716;</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">tB1</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Inverse</span>(a) * c;
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"tA==a "</span> + (tA == a));   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986; True</span>
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"tB==b "</span> + (tB == b));   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986; False</span>
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"tB1==b "</span> + (tB1 == b)); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36755;&#20986; True</span>
</pre>
</div>
<ul class="org-ul">
<li><a href="https://answers.unity.com/questions/130510/add-or-substract-two-quaternionsrotations.html">https://answers.unity.com/questions/130510/add-or-substract-two-quaternionsrotations.html</a><br /></li>
<li><a href="https://docs.unity3d.com/ScriptReference/Quaternion-operator_multiply.html">https://docs.unity3d.com/ScriptReference/Quaternion-operator_multiply.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org2ad0f97" class="outline-4">
<h4 id="org2ad0f97">本地旋转和全局旋转之间的转换 不同坐标系之间旋转的转换</h4>
<div class="outline-text-4" id="text-org2ad0f97">
<p>
<a id="orge07144f"></a><br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#20840;&#23616;&#22352;&#26631;&#31995;&#30340;&#26059;&#36716;&#36716;&#21270;&#20026;&#26412;&#22320;&#22352;&#26631;&#31995;&#26059;&#36716;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">this will transform WorldRotation to Target's local space</span>
<span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">LocalRotation</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Inverse</span>(Target.transform.rotation) * WorldRotation;

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;&#26412;&#22320;&#26059;&#36716;&#36716;&#21270;&#20026;&#20840;&#23616;&#26059;&#36716;</span>
<span style="color: #ce537a; font-weight: bold;">Quaternion</span> <span style="color: #7590db;">WorldRot</span> = Target.transform.rotation * LocalRot;

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#26159;&#27979;&#35797;&#20195;&#30721; transform &#20026; testNode1 &#21644; testNode2 &#20849;&#21516;&#30340;&#29238;&#33410;&#28857;</span>
<span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">pos</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(10, 5, 20);
testNode1 = (Transform)GGameObject.<span style="color: #bc6ec5; font-weight: bold;">Find</span>(transform, <span style="color: #2d9574;">"GObj1"</span>, <span style="color: #4f97d7; font-weight: bold;">typeof</span>(Transform), <span style="color: #a45bad;">true</span>);
testNode1.localPosition = pos;
testNode2 = (Transform)GGameObject.<span style="color: #bc6ec5; font-weight: bold;">Find</span>(transform, <span style="color: #2d9574;">"GObj2"</span>, <span style="color: #4f97d7; font-weight: bold;">typeof</span>(Transform), <span style="color: #a45bad;">true</span>);
testNode2.localPosition = pos;

testNode1.localRotation = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(15, 10, 40);
testNode2.rotation = transform.rotation * Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(15, 10, 40);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"1 testNode1.rotation == testNode2.rotation "</span> + (testNode1.rotation == testNode2.rotation)); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">print True</span>

testNode1.rotation = transform.rotation * Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(25, 20, 50);
testNode2.localRotation = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Inverse</span>(transform.rotation) * testNode1.rotation;
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"2 testNode1.rotation == testNode2.rotation "</span> + (testNode1.rotation == testNode2.rotation)); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">print True</span>

testNode1.localRotation *= Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(15, 10, 40);
testNode2.rotation *= Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(15, 10, 40);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"3 testNode1.rotation == testNode2.rotation "</span> + (testNode1.rotation == testNode2.rotation)); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">print True</span>
</pre>
</div>
</div>
<div id="outline-container-org84e428e" class="outline-5">
<h5 id="org84e428e">关于 localRotation 和 rotation：下面代码中为什么会输出 True？</h5>
<div class="outline-text-5" id="text-org84e428e">
<p>
该段代码是上面代码的一小部分，完整代码请参考 <a href="#orge07144f">No description for this link</a><br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">testNode1.localRotation *= Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(15, 10, 40);
testNode2.rotation *= Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(15, 10, 40);
Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"3 testNode1.rotation == testNode2.rotation "</span> + (testNode1.rotation == testNode2.rotation)); <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">print True</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b18228" class="outline-5">
<h5 id="org8b18228">参考资料</h5>
<div class="outline-text-5" id="text-org8b18228">
<ul class="org-ul">
<li><a href="https://answers.unity.com/questions/275565/what-is-the-rotation-equivalent-of-inversetransfor.html">https://answers.unity.com/questions/275565/what-is-the-rotation-equivalent-of-inversetransfor.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb4b5316" class="outline-4">
<h4 id="orgb4b5316">绕父节点旋转</h4>
<div class="outline-text-4" id="text-orgb4b5316">
</div>
<div id="outline-container-orgc9e780a" class="outline-5">
<h5 id="orgc9e780a">子节点的本地坐标系方向不变</h5>
<div class="outline-text-5" id="text-orgc9e780a">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">rot</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(0, 5 * Time.deltaTime, 0);
transform.localPosition = rot * transform.localPosition;
</pre>
</div>
</div>
</div>
<div id="outline-container-orgddf2d06" class="outline-5">
<h5 id="orgddf2d06">子节点的本地坐标系做对应旋转</h5>
<div class="outline-text-5" id="text-orgddf2d06">
<p>
如果初始时，子节点 forward 方向指向父节点，则在旋转情况下，子节点 forward 方向也保持指向父节点<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">rot</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">Euler</span>(0, 5 * Time.deltaTime, 0);
transform.localPosition = rot * transform.localPosition;
transform.localRotation *= rot;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgcf67714" class="outline-4">
<h4 id="orgcf67714">绕本地坐标轴旋转</h4>
<div class="outline-text-4" id="text-orgcf67714">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">rot</span> = Quaternion.<span style="color: #bc6ec5; font-weight: bold;">AngleAxis</span>(5 * Time.deltaTime, Vector3.up);
transform.rotation *= rot; <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">transform.localRotation *= rot; &#20351;&#29992; localRotation &#20063;&#21487;&#20197;</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org3d3a56f" class="outline-3">
<h3 id="org3d3a56f">MonoBehavior</h3>
<div class="outline-text-3" id="text-org3d3a56f">
</div>
<div id="outline-container-org7842d25" class="outline-4">
<h4 id="org7842d25">各种函数函数触发时机</h4>
<div class="outline-text-4" id="text-org7842d25">
</div>
<div id="outline-container-org39e56bb" class="outline-5">
<h5 id="org39e56bb">同一个对象上各函数触发顺序</h5>
<div class="outline-text-5" id="text-org39e56bb">
<ol class="org-ol">
<li><p>
调用顺序如下<br />
</p>
<pre class="example">
OnValidate -&gt; OnValidate-&gt; Awake -&gt; OnEnable -&gt; Start -&gt; 
FixedUpdate -&gt; Update-&gt; LateUpdate -&gt; 
(OnPreRender -&gt; OnPostRender -&gt; OnRenderImage)
-&gt; OnDisable -&gt; OnDestroy -&gt; OnValidate
</pre></li>
<li>只有 Camera 下的脚本会触发 OnPreRender -&gt; OnPostRender -&gt; OnRenderImage<br /></li>
<li>只有在编辑器模式下才会触发 OnValidate<br /></li>
<li>不同摄像机下的脚本中 OnPreRender -&gt; OnPostRender -&gt; OnRenderImage 的触发是连续的，即 A 摄像机脚本中的 OnPreRender -&gt; OnPostRender -&gt; OnRenderImage 都触发完后，才触发 B 摄像机脚本中的这些方法。<br /></li>
<li><p>
Awake 比 标记为 RuntimeInitializeOnLoadMethod 的静态函数先调用<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Test</span>:<span style="color: #ce537a; font-weight: bold;">MonoBehavior</span>
{
    <span style="color: #4f97d7; font-weight: bold;">static</span> Test()
    {
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">CLR &#20445;&#35777;&#22312;&#31867;&#30340;&#20854;&#20182;&#25805;&#20316;&#20043;&#21069;&#36816;&#34892;&#38745;&#24577;&#26500;&#36896;&#26041;&#27861;&#12290;</span>
        Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"Static Constructor-----------------------  "</span>);
    }
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Awake</span>()
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"Awake -----------------------------------  "</span>);
    }

    [<span style="color: #ce537a; font-weight: bold;">RuntimeInitializeOnLoadMethod</span>]
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> Initialize()
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"RuntimeInitializeOnLoadMethod ------------  "</span>);
    }
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19978;&#38754;&#30340;&#20195;&#30721; &#20808;&#25191;&#34892; Awake&#65292;&#21518;&#25191;&#34892; Initialize</span>
</pre>
</div></li>
</ol>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MonoBehaviourTest</span> : <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">counter</span> = 1;

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#33050;&#26412;&#23454;&#20363;&#34987;&#21152;&#36733;&#26102;&#35843;&#29992;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Awake is called when the script instance is being loaded.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Awake</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} Awake"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#24403;&#33050;&#26412;&#20026; enabled&#65292;&#22312;&#20219;&#20309; Update &#26041;&#27861;&#31532;&#19968;&#27425;&#35843;&#29992;&#20043;&#21069;&#65292;&#20250;&#35843;&#29992; Start</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Start is called on the frame when a script is enabled just before any of</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">the Update methods is called the first time.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Start</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} Start"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#37325;&#32622;&#40664;&#35748;&#20540;&#65292;&#23558;&#33050;&#26412;&#32452;&#20214;&#21024;&#38500;&#65292;&#20877;&#28155;&#21152;&#26102;&#20250;&#35843;&#29992;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Reset to default values.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Reset</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} Reset"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#24403;&#23545;&#35937;&#21464;&#20026; enabled &#25110; active &#26102;&#65292;&#35843;&#29992; OnEnable</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">This function is called when the object becomes enabled and active.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnEnable</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnEnable"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Monobehaviour &#21464;&#20026; Disabled &#25110; Inactive &#26102;&#65292;&#20250;&#35843;&#29992; OnDisable</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">This function is called when the behaviour becomes disabled () or inactive.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnDisable</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnDisable"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">MonoBehaviour &#34987;&#38144;&#27585;&#26102;&#20250;&#35843;&#29992; OnDestroy</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">This function is called when the MonoBehaviour will be destroyed.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnDestroy</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnDestroy"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#24403;&#33050;&#26412;&#21152;&#36733; &#25110;&#32773; inspector &#38754;&#26495;&#19978;&#30340;&#20540;&#34987;&#20462;&#25913;&#26102;&#20250;&#35843;&#29992; OnValidate</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">This function is called when the script is loaded or a value is</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">changed in the inspector (Called in the editor only).</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnValidate</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnValidate"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnPreRender is called before a camera starts rendering the scene.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnPreRender</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnPreRender"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnPostRender is called after a camera finished rendering the scene.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnPostRender</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnPostRender"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnRenderImage is called after all rendering is complete to render image.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnRenderImage</span> (<span style="color: #ce537a; font-weight: bold;">RenderTexture</span> <span style="color: #7590db;">src</span>, <span style="color: #ce537a; font-weight: bold;">RenderTexture</span> <span style="color: #7590db;">dest</span>)
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnRenderImage"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524;&#29289;&#20307;&#26159;&#21487;&#35265;&#30340;&#65292;&#27599;&#20010;&#25668;&#20687;&#26426;&#35302;&#21457;&#19968;&#27425; OnWillRenderObject &#30340;&#35843;&#29992;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnWillRenderObject is called once for each camera if the object is visible.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnWillRenderObject</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnWillRenderObject"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#24403;&#21069;&#30340; collider/rigidbody &#21644;&#21478;&#22806;&#30340; collider/rigidbody &#24320;&#22987;&#25509;&#35302;&#26102;&#65292;&#20250;&#35843;&#29992; OnCollisionEnter</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnCollisionEnter is called when this collider/rigidbody has begun touching another</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">rigidbody/collider.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnCollisionEnter</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnCollisionEnter"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#24403;&#21069;&#30340; collider/rigidbody &#21644;&#21478;&#22806;&#30340; collider/rigidbody &#20572;&#27490;&#25509;&#35302;&#26102;&#65292;&#20250;&#35843;&#29992; OnCollisionExit</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnCollisionExit is called when this collider/rigidbody has stopped touching another</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">rigidbody/collider.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnCollisionExit</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnCollisionExit"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27599;&#19968;&#20010;&#21644;&#20854;&#20182; collider/rigidbody &#26377;&#25509;&#35302;&#30340; collider/rigidbody &#37117;&#20250;&#22312;&#27599;&#24103;&#20013;&#35302;&#21457; OnCollisionStay &#30340;&#35843;&#29992;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">OnCollisionStay is called once per frame for every collider/rigidbody that is touching</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">rigidbody/collider.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnCollisionStay</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnCollisionStay"</span>, counter++));
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnTriggerEnter</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnTriggerEnter"</span>, counter++));
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnTriggerExit</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnTriggerExit"</span>, counter++));
  }

  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnTriggerStay</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} OnTriggerStay"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524; MonoBehaviour &#29366;&#24577;&#20026; enabled&#65292;&#21017;&#20197;&#22266;&#23450;&#30340;&#24103;&#29575;&#35843;&#29992;&#27492;&#20989;&#25968;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">This function is called every fixed framerate frame, if the MonoBehaviour is enabled.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">FixedUpdate</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} FixedUpdate"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524; MonoBehaviour &#29366;&#24577;&#20026; enabled&#65292;&#21017;&#20197;&#22266;&#23450;&#30340;&#24103;&#29575;&#35843;&#29992;&#27492;&#20989;&#25968;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Update is called every frame, if the MonoBehaviour is enabled.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Update</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} Update"</span>, counter++));
  }

  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524; MonoBehaviour &#29366;&#24577;&#20026; enabled&#65292;&#21017;&#20197;&#27599;&#24103;&#37117;&#20250;&#35843;&#29992;&#27492;&#20989;&#25968;</span>
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">LateUpdate is called every frame, if the Behaviour is enabled.</span>
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">LateUpdate</span> ()
  {
    GLogUtility.LogInfo (<span style="color: #ce537a; font-weight: bold;">string</span>.Format (<span style="color: #2d9574;">"{0} LateUpdate"</span>, counter++));
  }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org39f4c2c" class="outline-5">
<h5 id="org39f4c2c">不同对象各函数触发顺序</h5>
<div class="outline-text-5" id="text-org39f4c2c">
<ul class="org-ul">
<li>Camera Awake/Enable/Update/LateUpdate 顺序按照 depth 越大越优先<br /></li>
<li>Camera 渲染顺序按照 depth 越小越优先，即 Camera depth 值小的先触发 OnPreRender -&gt; OnPostRender -&gt; OnRenderImage<br /></li>
<li>Camera Disable 和 Destroy 执行顺序没有什么规律<br /></li>
<li>普通对象和 Camera 的事件触发顺序也没有什么规律<br /></li>
<li>只有对象身上有 Mesh 时，才会触发 OnWillRenderObject<br /></li>
</ul>
<p>
场景中有如下对象树，其各个对象的脚本中函数触发如下描述：<br />
</p>
<pre class="example">
场景对象树：
Cube2
Camera-depth1
Camera-depth0
Camera-depth2
Cube1
	--&gt;Cube1.1

对象函数触发顺序：
// --------------------
Cube1.1 -Awake
Cube1.1 -OnEnable
Cube2   -Awake
Cube2   -OnEnable
Camera3 -Awake
Camera3 -Enable
Camera2 -Awake
Camera2 -Enable
Camera1 -Awake
Camera1 -Enable
Cube1   -Awake
Cube1   -Enable

// --------------------
Cube1.1 -Start
Cube2   -Start
Camera3 -Start
Camera2 -Start
Camera1 -Start
Cube1   -Start

// --------------------
Cube1.1 -Update
Cube2   -Update
Camera3 -Update
Camera2 -Update
Camera1 -Update
Cube1   -Update

// --------------------
Cube1.1 -LateUpdate
Cube2   -LateUpdate
Camera3 -LateUpdate
Camera2 -LateUpdate
Camera1 -LateUpdate
Cube1   -LateUpdate

// -------------------- Camera 渲染
Cube1   -OnWillRenderObject
Cube2   -OnWillRenderObject
Cube1.1 -OnWillRenderObject

Camera1 -OnPreRender
Camera1 -OnPostRender
Camera1 -OnRenderImage

Cube1   -OnWillRenderObject
Cube2   -OnWillRenderObject
Cube1.1 -OnWillRenderObject

Camera2 -OnPreRender
Camera2 -OnPostRender
Camera2 -OnRenderImage

Cube1   -OnWillRenderObject
Cube2   -OnWillRenderObject
Cube1.1 -OnWillRenderObject

Camera3 -OnPreRender
Camera3 -OnPostRender
Camera3 -OnRenderImage

// -------------------- Disable 以上节点的父节点
Cube2   -OnDisable
Camera3 -OnDisable
Camera1 -OnDisable
Cube1.1 -OnDisable
Cube1   -OnDisable
Camera2 -OnDisable

// -------------------- 编辑器停止运行
Cube2   -OnDisable
Camera3 -OnDisable
Camera1 -OnDisable
Cube1.1 -OnDisable
Cube1   -OnDisable
Camera2 -OnDisable

Cube2   -OnDestroy
Camera3 -OnDestroy
Camera1 -OnDestroy
Cube1   -OnDestroy
Cube1.1 -OnDestroy
Camera2 -OnDestroy
</pre>
</div>
</div>
<div id="outline-container-orgedb0622" class="outline-5">
<h5 id="orgedb0622">参考文档</h5>
<div class="outline-text-5" id="text-orgedb0622">
<p>
<a href="https://docs.unity3d.com/Manual/ExecutionOrder.html">https://docs.unity3d.com/Manual/ExecutionOrder.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org6395259" class="outline-4">
<h4 id="org6395259">单例 MonoBehavior</h4>
<div class="outline-text-4" id="text-org6395259">
<p>
单例 MonoBehavior 被添加到多个 GameObject 上后，对于每个 GameObject，都分别实例化了一个 MonoBehavior 对象，这些对象和你自己实例化的单例不是同一个对象。<br />
创建 MonoBehavior 单例是不被允许的，会提示下面错误:<br />
</p>
<pre class="example">
You are trying to create a MonoBehaviour using the 'new' keyword.  This is not allowed.  MonoBehaviours can only be added using AddComponent().  Alternatively, your script can inherit from ScriptableObject or no base class at all
</pre>
</div>
</div>
<div id="outline-container-org2355c8d" class="outline-4">
<h4 id="org2355c8d">public 变量赋值顺序</h4>
<div class="outline-text-4" id="text-org2355c8d">
<p>
public 变量的赋值顺序按照 初始化语句、构造函数、编辑器赋值的顺序。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Test</span>:<span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
  <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">value2</span> = 10;

  <span style="color: #4f97d7; font-weight: bold;">public</span> Test ()
  {
    Debug.Log (<span style="color: #2d9574;">"Test value2 = "</span> + value2.ToString ());

    value2 = 11;
  }

  <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Awake</span> ()
  {
    Debug.Log (<span style="color: #2d9574;">"Awake value2 = "</span> + value2.ToString ());
  }

  <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Start</span> ()
  {
    Debug.Log (<span style="color: #2d9574;">"Start value2 = "</span> + value2.ToString ());
  }
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Output</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Test value2 = 10    //&#26500;&#36896;&#20989;&#25968;&#20013;&#35835;&#30340;&#20540;&#20026; &#21021;&#22987;&#21270;&#35821;&#21477;&#20013;&#36171;&#30340;&#20540;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Awake value2 = 120  //&#22312;&#32534;&#36753;&#22120;&#20013;&#35774;&#32622;&#20102; value2 &#30340;&#20540;&#20026; 120, &#25152;&#20197;&#32534;&#36753;&#22120;&#36171;&#20540;&#22312; Awake &#20043;&#21069;&#25191;&#34892;&#30340;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Start value2 = 120</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeba1741" class="outline-4">
<h4 id="orgeba1741">Update 细节</h4>
<div class="outline-text-4" id="text-orgeba1741">
<p>
<a href="https://blogs.unity3d.com/cn/2015/12/23/1k-update-calls/">https://blogs.unity3d.com/cn/2015/12/23/1k-update-calls/</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org1e093f8" class="outline-3">
<h3 id="org1e093f8">Resource</h3>
<div class="outline-text-3" id="text-org1e093f8">
</div>
<div id="outline-container-org8f5189a" class="outline-4">
<h4 id="org8f5189a">Load</h4>
<div class="outline-text-4" id="text-org8f5189a">
<p>
需要注意一下两点<br />
1 使用 Resource.Load 时，其中参数不能填写后缀名，否则返回 null.<br />
2 通过 Resource.Load 返回的是 Prefab 本身，需要对其实例化才能使用。否则会报下面的错误<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">obj</span> = Resources.Load (<span style="color: #2d9574;">"UI/Root_bg"</span>) <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">GameObject</span>;
obj.transform.<span style="color: #bc6ec5; font-weight: bold;">SetParent</span>(rootUI);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19978;&#38754;&#20195;&#30721;&#20250;&#24341;&#21457;&#19979;&#38754;&#38169;&#35823;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Setting the parent of a transform which resides in a prefab is disabled to prevent data corruption.</span>

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27491;&#30830;&#30340;&#20570;&#27861;&#22914;&#19979;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Instantiate &#26159; Object &#30340;&#38745;&#24577;&#26041;&#27861;</span>
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">obj</span> = Instantiate(Resources.<span style="color: #bc6ec5; font-weight: bold;">Load</span>(<span style="color: #2d9574;">"UI/Root_bg"</span>)) <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">GameObject</span>;
obj.transform.<span style="color: #bc6ec5; font-weight: bold;">SetParent</span>(rootUI);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org319828e" class="outline-3">
<h3 id="org319828e">Animator Animation Avatar</h3>
<div class="outline-text-3" id="text-org319828e">
</div>
<div id="outline-container-orgf9e7a16" class="outline-4">
<h4 id="orgf9e7a16">播放动画控制</h4>
<div class="outline-text-4" id="text-orgf9e7a16">
</div>
<div id="outline-container-org530a34d" class="outline-5">
<h5 id="org530a34d">循环播放动画</h5>
<div class="outline-text-5" id="text-org530a34d">
</div>
<div id="outline-container-org98fd38d" class="outline-6">
<h6 id="org98fd38d">Animation</h6>
<div class="outline-text-6" id="text-org98fd38d">
<pre class="example">
Normal Loop
- 方案 1: 在 AnimationClip 级别上的实现
设置 AnimationClip 的 WrapMode=Loop
设置 Animation 的 WrapMode=Default
- 方案 2: 在 Animation 级别上的实现
设置 Animation 的 WrapMode=Loop

ClampForever
- AnimationClip 的 WrapMode=ClampForever
- Animation 的 WrapMode=ClampForever

PingPong
- AnimationClip 的 WrapMode=PingPong
- 设置 Animation 的 WrapMode=PingPong
</pre>
</div>
</div>
<div id="outline-container-org00d3ae3" class="outline-6">
<h6 id="org00d3ae3">Animator</h6>
<div class="outline-text-6" id="text-org00d3ae3">
<pre class="example">
Normal Loop
- 方案 1: 在 AnimationClip 级别上的实现
勾选 AnimationClip 的 Loop 选项
- 方案 2: 在 AnimationController 级别上的实现
在 AnimationController 中创建两个动画状态: LoopPartA LoopPartB,设置 LoopPartA 可以转换到 LoopPartB，LoopPartB 可以转换到 LoopPartA

PingPong: 在 AnimationController 级别上的实现
在 AnimationController 中创建两个动画状态: LoopPartA LoopPartB,设置 LoopPartA 可以转换到 LoopPartB，LoopPartB 可以转换到 LoopPartA,设置 LoopPartB 的 speed=-1
</pre>
</div>
</div>
</div>
<div id="outline-container-org270a324" class="outline-5">
<h5 id="org270a324">暂停播放 恢复播放</h5>
<div class="outline-text-5" id="text-org270a324">
<div class="org-src-container">
<pre class="src src-csharp">  <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DoPauseOrResume</span>()
  {
      <span style="color: #4f97d7; font-weight: bold;">if</span>(animation!=<span style="color: #a45bad;">null</span>)
      {
          animation[animation.clip.name].speed = IsPause?0:1;
      }
      <span style="color: #4f97d7; font-weight: bold;">if</span>(animator!=<span style="color: #a45bad;">null</span>)
      {
          <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 1</span>
          animator.speed = IsPause?0:1;
          <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#26041;&#27861; 2</span>
          animator.<span style="color: #bc6ec5; font-weight: bold;">SetFloat</span>(<span style="color: #2d9574;">"InAnimSpeed"</span>, IsPause ? 0 : 1);
      }
  }

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25773;&#25918;&#23436;&#21518;&#20572;&#30041;&#22312;&#31532;&#19968;&#24103;</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25773;&#25918;&#23436;&#21518;&#20572;&#30041;&#22312;&#26368;&#21518;&#19968;&#24103;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org21a52d3" class="outline-5">
<h5 id="org21a52d3">判断动画是否正在播放 判断动画是否播放完</h5>
<div class="outline-text-5" id="text-org21a52d3">
<p>
animation.isPlaying<br />
AnimationClip 为 ClampForever 时，播放完毕该值会一直为 True.<br />
AnimationClip 为 Once Clamp 时，播放完毕该值会为 False.<br />
</p>

<p>
Animator 中没有判断动画是否在播放的方法.<br />
</p>
</div>
</div>
<div id="outline-container-org494cedb" class="outline-5">
<h5 id="org494cedb">添加删除动画消息</h5>
<div class="outline-text-5" id="text-org494cedb">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #bc6ec5; font-weight: bold;">IsExistEvent</span>(<span style="color: #ce537a; font-weight: bold;">AnimationClip</span> <span style="color: #7590db;">clip</span>, <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">funcName</span>, <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">time</span>)
{
    <span style="color: #4f97d7; font-weight: bold;">foreach</span>(<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">evt</span> <span style="color: #4f97d7; font-weight: bold;">in</span> clip.events)
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span>(evt.functionName == funcName)
        {
            <span style="color: #4f97d7; font-weight: bold;">if</span>(Mathf.<span style="color: #bc6ec5; font-weight: bold;">Abs</span>(time - evt.time) &lt; 0.0001f)
            {
                Debug.<span style="color: #bc6ec5; font-weight: bold;">LogWarning</span>(<span style="color: #2d9574;">"funcName exist! bug time not equal!"</span>);
            }
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">true</span>;
        }
    }

    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">false</span>;
}

<span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #bc6ec5; font-weight: bold;">AddEvent</span>(<span style="color: #ce537a; font-weight: bold;">AnimationClip</span> <span style="color: #7590db;">clip</span>, <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">funcName</span>, <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">time</span>=-1)
{
    <span style="color: #4f97d7; font-weight: bold;">if</span>(clip==<span style="color: #a45bad;">null</span>)<span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">false</span>;
    <span style="color: #4f97d7; font-weight: bold;">if</span>(IsExistEvent())<span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">false</span>;

    <span style="color: #4f97d7; font-weight: bold;">if</span>(time &lt; 0)
    {
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36890;&#36807; CrossFade &#26041;&#24335;&#25773;&#25918;&#21160;&#30011;&#26102;&#65292;&#22914;&#26524; time=clip.length &#26377;&#26102;&#20505;&#20250;&#26080;&#27861;&#35302;&#21457;&#20107;&#20214;</span>
        time = clip.length * 0.95;
    }
    <span style="color: #ce537a; font-weight: bold;">AnimationEvent</span> <span style="color: #7590db;">evt</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">AnimationEvent</span>();
    evt.time = time;
    evt.functionName = funcName;
    clip.<span style="color: #bc6ec5; font-weight: bold;">AddEvent</span>(evt);
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">true</span>;
}
</pre>
</div>
</div>
<div id="outline-container-orgba9b719" class="outline-6">
<h6 id="orgba9b719">Animation</h6>
</div>
<div id="outline-container-org0ca6ff3" class="outline-6">
<h6 id="org0ca6ff3">Animator</h6>
</div>
</div>
<div id="outline-container-orgaf1d87d" class="outline-5">
<h5 id="orgaf1d87d">从某个时间点开始播放动画</h5>
</div>
</div>
<div id="outline-container-org80fb16d" class="outline-4">
<h4 id="org80fb16d">动画的整体流程是怎样的？Skinning 是发生在什么时候？</h4>
<div class="outline-text-4" id="text-org80fb16d">
<p>
使用 Unity 的 Profiler 工具，添加 CPU Profiler，进行 Profile，然后分析 Timeline 数据，可以看到 Unity 内部函数的调用先后顺序，从而大体上了解 Unity 一帧的执行流程。<br />
</p>
</div>
</div>
<div id="outline-container-org4586ef0" class="outline-4">
<h4 id="org4586ef0">表情动画实现</h4>
<div class="outline-text-4" id="text-org4586ef0">
<p>
BaseLayer 设置如下：<br />
Mask 设置为空, Blending 类型设置为 Override<br />
<img src="./UnityNote/006_exp_anim_01.jpg" alt="006_exp_anim_01.jpg" /><br />
</p>

<p>
NewLayer 设置如下<br />
Mask 设置为 Face(只包含脸部骨架)，Blending 类型设置为 Override，Weight 设置为 1<br />
<img src="./UnityNote/006_exp_anim_02.jpg" alt="006_exp_anim_02.jpg" /><br />
</p>

<p>
具体实现可以参考 BaiduYun/UnitySample/ExpAnim<br />
</p>
</div>
</div>
<div id="outline-container-org7333566" class="outline-4">
<h4 id="org7333566">动画中 Rig/Root Node 和 Animation/Motion/RootMotionNode 的差别</h4>
<div class="outline-text-4" id="text-org7333566">
<p>
通常情况下是逻辑控制角色的 TRS 属性，使用 RootMotion 时，动画会将 RootNode 的 TRS 变化应用到播放动画的节点上，从而实现动画对角色的控制。<br />
</p>

<p>
Rig/Root Node 用于指定 Generic 模型的 Body Transform，Humanoid 模型的 Body Transform 是在 Avatar Configure 中指定的 Hips 骨骼。<br />
Animation/Motion/RootMotionNode 用于指定特定动画对应的 Root Motion Node，播放该动画时，会完全使用选择的 Root Motion Node 来驱动播放动画的 GameObject。<br />
</p>
</div>
<div id="outline-container-org3831e7b" class="outline-5">
<h5 id="org3831e7b">参考资料</h5>
<div class="outline-text-5" id="text-org3831e7b">
<ul class="org-ul">
<li>UE4 官方文档 <a href="https://docs.unrealengine.com/en-US/Engine/Animation/RootMotion">https://docs.unrealengine.com/en-US/Engine/Animation/RootMotion</a><br /></li>
<li>Unity RootMotion 使用 <a href="https://www.cnblogs.com/wantnon/p/5163513.html">https://www.cnblogs.com/wantnon/p/5163513.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org06a5ca1" class="outline-4">
<h4 id="org06a5ca1">Animator Humanoid 是如何支持不同体型角色复用同一套动画的？</h4>
<div class="outline-text-4" id="text-org06a5ca1">
<p>
通过将动画中 Translation 数据按照当前体型相对于目标体型的比例进行调整，使目标体型的动画数据适配当前体型。<br />
</p>
<ul class="org-ul">
<li>参考资料<br />
<ul class="org-ul">
<li>AnimationRetargeting <a href="https://docs.unrealengine.com/en-us/Engine/Animation/AnimationRetargeting">https://docs.unrealengine.com/en-us/Engine/Animation/AnimationRetargeting</a><br /></li>
<li>unity 人物动画 retarget 的原理是什么？<a href="https://www.zhihu.com/question/274681700">https://www.zhihu.com/question/274681700</a><br /></li>
<li>动画重定向技术分析和 Unity 中的应用 <a href="https://zhuanlan.zhihu.com/p/25064011">https://zhuanlan.zhihu.com/p/25064011</a><br /></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org6a48372" class="outline-4">
<h4 id="org6a48372">Animator Humanoid 如何支持飘带动画？</h4>
<div class="outline-text-4" id="text-org6a48372">
<ol class="org-ol">
<li>飘带使用动态骨骼<br /></li>
<li>动画中包含飘带骨骼的运动，导出动画时，在 FBX 导出设置的 Animation 页签下，找到 Mask 选项，勾选飘带骨骼。<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org5e6af5a" class="outline-4">
<h4 id="org5e6af5a">Avatar 里面存储的是什么数据？Avatar 的作用是 什么？</h4>
<div class="outline-text-4" id="text-org5e6af5a">
</div>
<div id="outline-container-org75c646c" class="outline-5">
<h5 id="org75c646c">Avatar 中存储的数据</h5>
<div class="outline-text-5" id="text-org75c646c">
</div>
<div id="outline-container-orgdd9f801" class="outline-6">
<h6 id="orgdd9f801">Generic Avatar</h6>
<div class="outline-text-6" id="text-orgdd9f801">
<pre class="example">
Avatar:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInternal: {fileID: 0}
  m_Name: PlayerGenericAnim_NoRootNodeAvatar
  m_AvatarSize: 9792
  m_Avatar:
    serializedVersion: 3
    m_AvatarSkeleton:
      data:
        m_Node:
        - m_ParentId: -1
          m_AxesId: -1
        - m_ParentId: 0
          m_AxesId: -1
        - m_ParentId: 1
          m_AxesId: -1
        - m_ParentId: 2
          m_AxesId: -1
        m_ID: 00000000b0cb522ca666a49d79f5e13c63c4d454c9983e579e89c8e43677d6de9a2c2e6f9207f2632d7addf3a41ba001a586d7967f516add3812f92c262c9423432ebc5f097add4c8197798b459022cac83a8868ab5baba337a35e9e88079bfe568a31afc0380a324b6cb836ffdd9551ef115b2850b59e485eeec5395df248ba4637954a63600609ba080a443998467c5451bdef72a02807698357be583769700edfbb612376e2c5729650465d990bf079c5d899eff5e72f832d0c65fed3f5971f619a8d62ac7a8bdf8b626d4d6299f671960b229824bf0e1b0ae718d2adc1fec574695e8267cc232f673cabb90bfa38ee4ac5d4a4f17a07a6fe57a523cead5b99bcfa9dff8de59709d7a2f79e698136d5783bd2abc512cd79df0284e6c6ea20f7c5c70da0ecb5319ffe025b47db9387c810bdcc116ed7ded748ea20e54261cc1aa75a776c0aa0c7d14faa8086f21874
        m_AxesArray: []
    m_AvatarSkeletonPose:
      data:
        m_X:
        - t: {x: 0, y: 0, z: 0}
          q: {x: 0, y: 0, z: 0, w: 1}
          s: {x: 1, y: 1, z: 1}
        - t: {x: -0, y: 0, z: 0}
          q: {x: 0, y: -0, z: -0, w: 1}
          s: {x: 1, y: 1, z: 1}
    m_DefaultPose:
      data:
        m_X:
        - t: {x: 0, y: 0, z: 0}
          q: {x: 0, y: 0, z: 0, w: 1}
          s: {x: 1, y: 1, z: 1}
        - t: {x: -0, y: 0, z: 0}
          q: {x: 0, y: -0, z: -0, w: 1}
          s: {x: 1, y: 1, z: 1}
    m_SkeletonNameIDArray: 00000000b0cb522c1106d1decbc10e53b39c853a6d792380a259c107fff3a501a1ae1eb7020e9581e2a1a2517d6fcb3089155abda9f141bce590ce7c58e6a124a8b78ea76073fd7b6a0e4b735a340b1c68cd8f97e6af46532da6fd019202386107aeef228687eb2e0dd3592ae5d836ce904ba6d52fef63b5873e58314256616c17134bc7e54706f627f7b36baaa15772304df975cfbe299875ef2001e3df2776b3c1bafe0990b3679fa0b41072574445c8064ddc5e364aabc535f6db7f64ff42e954f835dfb27b1465e3728df3d375faa860462dda0a83eb803ab9896cf375b6ace1f47816b0fde18080fa96d09e671e6acf6e87fcff69f0cfba1f9175eb1608e3db117fcf4840d37519494ae3294e3dbceda6f406bcaf6d908ca81a91127f75fc093d862c36149b11d48f05f083611701f40d06708898584d6a03c6e54261cc7ee7f03e914d07cc2c080d8b488a2b30
    m_Human:
      data:
        serializedVersion: 2
        m_RootX:
          t: {x: 0, y: 0, z: 0}
          q: {x: 0, y: 0, z: 0, w: 1}
          s: {x: 1, y: 1, z: 1}
        m_Skeleton:
          data:
            m_Node: []
            m_ID: 
            m_AxesArray: []
        m_SkeletonPose:
          data:
            m_X: []
        m_LeftHand:
          data:
            m_HandBoneIndex: ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        m_RightHand:
          data:
            m_HandBoneIndex: ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        m_HumanBoneIndex: ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
        m_HumanBoneMass:
        - 0.14545456
        - 0.12121213
        - 0.12121213
        m_Scale: 1
        m_ArmTwist: 0.5
        m_ForeArmTwist: 0.5
        m_UpperLegTwist: 0.5
        m_LegTwist: 0.5
        m_ArmStretch: 0.05
        m_LegStretch: 0.05
        m_FeetSpacing: 0
        m_HasLeftHand: 0
        m_HasRightHand: 0
        m_HasTDoF: 0
    m_HumanSkeletonIndexArray: 
    m_HumanSkeletonReverseIndexArray: 
    m_RootMotionBoneIndex: -1
    m_RootMotionBoneX:
      t: {x: 0, y: 0, z: 0}
      q: {x: 0, y: 0, z: 0, w: 1}
      s: {x: 1, y: 1, z: 1}
    m_RootMotionSkeleton:
      data:
        m_Node: []
        m_ID: 
        m_AxesArray: []
    m_RootMotionSkeletonPose:
      data:
        m_X: []
    m_RootMotionSkeletonIndexArray: 
  m_TOS:
    0: 
    27270052: Reference/Hips/Spine/Chest/Neck/Head/Jaw
    120103026: Reference/Hips/Spine/Chest/RightShoulder/RightArm/RightForeArm/RightHand/RightHandThumb1
</pre>
</div>
</div>
<div id="outline-container-org314d4a3" class="outline-6">
<h6 id="org314d4a3">Humanoid Avatar</h6>
<div class="outline-text-6" id="text-org314d4a3">
<pre class="example">
Avatar:
  m_ObjectHideFlags: 0
  m_CorrespondingSourceObject: {fileID: 0}
  m_PrefabInternal: {fileID: 0}
  m_Name: PlayerAvatarHumanoidAvatar
  m_AvatarSize: 19412
  m_Avatar:
    serializedVersion: 3
    m_AvatarSkeleton:
      data:
        m_Node:
        - m_ParentId: -1
          m_AxesId: -1
        - m_ParentId: 0
          m_AxesId: -1
        - m_ParentId: 1
          m_AxesId: -1
        - m_ParentId: 2
          m_AxesId: -1
        m_ID: 00000000b0cb522ca666a49d79f5e13c63c4d454c9983e579e89c8e43677d6de9a2c2e6f9207f2632d7addf3a41ba001a586d7967f516add3812f92c262c9423432ebc5f097add4c8197798b459022cac83a8868ab5baba337a35e9e88079bfe568a31afc0380a324b6cb836ffdd9551ef115b2850b59e485eeec5395df248ba4637954a63600609ba080a443998467c5451bdef72a02807698357be583769700edfbb612376e2c5729650465d990bf079c5d899eff5e72f832d0c65fed3f5971f619a8d62ac7a8bdf8b626d4d6299f671960b229824bf0e1b0ae718d2adc1fec574695e8267cc232f673cabb90bfa38ee4ac5d4a4f17a07a6fe57a523cead5b99bcfa9dff8de59709d7a2f79e698136d5783bd2abc512cd79df0284e6c6ea20f7c5c70da0ecb5319ffe025b47db9387c810bdcc116ed7ded748ea20e54261cc1aa75a776c0aa0c7d14faa8086f21874
        m_AxesArray: []
    m_AvatarSkeletonPose:
      data:
        m_X:
        - t: {x: 0, y: 0, z: 0}
          q: {x: 0, y: 0, z: 0, w: 1}
          s: {x: 1, y: 1, z: 1}
        - t: {x: -0, y: 0, z: 0}
          q: {x: 0, y: -0, z: -0, w: 1}
          s: {x: 1, y: 1, z: 1}
    m_DefaultPose:
      data:
        m_X:
        - t: {x: 0, y: 0, z: 0}
          q: {x: 0, y: 0, z: 0, w: 1}
          s: {x: 1, y: 1, z: 1}
        - t: {x: -0, y: 0, z: 0}
          q: {x: 0, y: -0, z: -0, w: 1}
          s: {x: 1, y: 1, z: 1}
    m_SkeletonNameIDArray: 00000000b0cb522c1106d1decbc10e53b39c853a6d792380a259c107fff3a501a1ae1eb7020e9581e2a1a2517d6fcb3089155abda9f141bce590ce7c58e6a124a8b78ea76073fd7b6a0e4b735a340b1c68cd8f97e6af46532da6fd019202386107aeef228687eb2e0dd3592ae5d836ce904ba6d52fef63b5873e58314256616c17134bc7e54706f627f7b36baaa15772304df975cfbe299875ef2001e3df2776b3c1bafe0990b3679fa0b41072574445c8064ddc5e364aabc535f6db7f64ff42e954f835dfb27b1465e3728df3d375faa860462dda0a83eb803ab9896cf375b6ace1f47816b0fde18080fa96d09e671e6acf6e87fcff69f0cfba1f9175eb1608e3db117fcf4840d37519494ae3294e3dbceda6f406bcaf6d908ca81a91127f75fc093d862c36149b11d48f05f083611701f40d06708898584d6a03c6e54261cc7ee7f03e914d07cc2c080d8b488a2b30
    m_Human:
      data:
        serializedVersion: 2
        m_RootX:
          t: {x: 0.0023189595, y: 1.0396271, z: 0.010832548}
          q: {x: 0.009703442, y: 0.00000043533007, z: -0.00004358088, w: 0.9999529}
          s: {x: 1, y: 1, z: 1}
        m_Skeleton:
          data:
            m_Node:
            - m_ParentId: -1
              m_AxesId: -1
            - m_ParentId: 0
              m_AxesId: 0
            - m_ParentId: 1
              m_AxesId: 1
            - m_ParentId: 2
              m_AxesId: 2
            m_ID: b0cb522ca666a49d79f5e13c63c4d454c9983e579e89c8e43677d6de9207f263a41ba00163600609ba080a443998467c5451bdef72a02807698357be583769700edfbb612376e2c5729650465d990bf079c5d899eff5e72f832d0c65fed3f5971f619a8d62ac7a8bdf8b626d4d6299f671960b229824bf0e1b0ae718d2adc1fec574695e8267cc232f673cabb90bfa38ee4ac5d4a4f17a07a6fe57a523cead5b99bcfa9dff8de59709d7a2f79e698136d5783bd2abc512cd79df0284e6c6ea20f7c5c70da0ecb5319ffe025b47db9387c810bdcc116ed7ded748ea20
            m_AxesArray:
            - m_PreQ: {x: -0.4559346, y: -0.5404846, z: 0.4559346, w: 0.5404846}
              m_PostQ: {x: -0.4559346, y: -0.5404846, z: 0.4559346, w: 0.5404846}
              m_Sgn: {x: 1, y: 1, z: 1}
              m_Limit:
                m_Min: {x: -0.6981317, y: -0.6981317, z: -0.6981317}
                m_Max: {x: 0.6981317, y: 0.6981317, z: 0.6981317}
              m_Length: 0.09360148
              m_Type: 1
            - m_PreQ: {x: -0.46550134, y: -0.5322674, z: 0.46550134, w: 0.53226733}
              m_PostQ: {x: -0.46550134, y: -0.5322674, z: 0.46550134, w: 0.53226733}
              m_Sgn: {x: 1, y: 1, z: 1}
              m_Limit:
                m_Min: {x: -0.6981317, y: -0.6981317, z: -0.6981317}
                m_Max: {x: 0.6981317, y: 0.6981317, z: 0.6981317}
              m_Length: 0.16400246
              m_Type: 1
        m_SkeletonPose:
          data:
            m_X:
            - t: {x: 0, y: 0, z: 0}
              q: {x: 0, y: 0, z: 0, w: 1}
              s: {x: 1, y: 1, z: 1}
            - t: {x: 0, y: 0.9782809, z: 0}
              q: {x: -0.0000000026830091, y: 0.000000005820766, z: 3.6379788e-10,
                w: 1}
              s: {x: 1.0000002, y: 1, z: 1.0000002}
        m_LeftHand:
          data:
            m_HandBoneIndex: 200000002100000022000000230000002400000025000000260000002700000028000000290000002a0000002b0000002c0000002d0000002e000000
        m_RightHand:
          data:
            m_HandBoneIndex: 0d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b000000
        m_HumanBoneIndex: 01000000330000002f000000340000003000000035000000310000000200000003000000ffffffff04000000050000001c000000090000001d0000000a0000001e0000000b0000001f0000000c0000003600000032000000060000000700000008000000
        m_HumanBoneMass:
        - 0.14545456
        - 0.12121213
        - 0.12121213
        m_Scale: 1.0396271
        m_ArmTwist: 0.5
        m_ForeArmTwist: 0.5
        m_UpperLegTwist: 0.5
        m_LegTwist: 0.5
        m_ArmStretch: 0.05
        m_LegStretch: 0.05
        m_FeetSpacing: 0
        m_HasLeftHand: 1
        m_HasRightHand: 1
        m_HasTDoF: 0
    m_HumanSkeletonIndexArray: 01000000020000000300000004000000050000000600000007000000090000000b0000002100000022000000230000002400000025000000260000002700000028000000290000002a0000002b0000002c0000002d0000002e0000002f000000300000003100000032000000330000003400000035000000360000003700000038000000390000003a0000003b0000003c0000003d0000003e0000003f000000400000004100000042000000430000004400000045000000460000004700000048000000490000004a0000004b0000004c0000004d0000004e000000
    m_HumanSkeletonReverseIndexArray: ffffffff00000000010000000200000003000000040000000500000006000000ffffffff07000000ffffffff08000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff090000000a0000000b0000000c0000000d0000000e0000000f000000100000001100000012000000130000001400000015000000160000001700000018000000190000001a0000001b0000001c0000001d0000001e0000001f000000200000002100000022000000230000002400000025000000260000002700000028000000290000002a0000002b0000002c0000002d0000002e0000002f00000030000000310000003200000033000000340000003500000036000000ffffffffffffffffffffffffffffffffffffffff
    m_RootMotionBoneIndex: -1
    m_RootMotionBoneX:
      t: {x: 0, y: 0, z: 0}
      q: {x: 0, y: 0, z: 0, w: 1}
      s: {x: 1, y: 1, z: 1}
    m_RootMotionSkeleton:
      data:
        m_Node: []
        m_ID: 
        m_AxesArray: []
    m_RootMotionSkeletonPose:
      data:
        m_X: []
    m_RootMotionSkeletonIndexArray: 
  m_TOS:
    0: 
    27270052: Reference/Hips/Spine/Chest/Neck/Head/Jaw
    120103026: Reference/Hips/Spine/Chest/RightShoulder/RightArm/RightForeArm/RightHand/RightHandThumb1
</pre>
</div>
</div>
</div>
<div id="outline-container-org549f271" class="outline-5">
<h5 id="org549f271">Avatar Rigging Skinning 术语</h5>
<div class="outline-text-5" id="text-org549f271">
<ul class="org-ul">
<li>Avatar 将一套骨架重定向到另一套骨架的接口<br /></li>
<li>Rigging 为 Mesh 创建骨骼关节的骨架层级结构的过程<br /></li>
<li>Skinning 绑定骨骼关节到角色模型的过程<br /></li>
<li><a href="https://docs.unity3d.com/Manual/AnimationGlossary.html">https://docs.unity3d.com/Manual/AnimationGlossary.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orga771b6d" class="outline-5">
<h5 id="orga771b6d">Generic Avatar</h5>
<div class="outline-text-5" id="text-orga771b6d">
<p>
人形模型是一种非常特殊的结构，他包含至少 15 个按照特定方式组织的骨骼，这大致符合一个真实人类的骨架。其他类型的模型属于非人形，非人形模型之间骨骼结构有非常大的差异。Unity 解决非人形模型复杂性的方式是只需要知道骨架的根节点,这个骨骼类似于人形角色的质心。Generic Avatar 只需要映射一个骨骼，因此不需要 Humanoid Avatar 那样复杂的配置流程。<br />
</p>
</div>

<div id="outline-container-orgcc13e2f" class="outline-6">
<h6 id="orgcc13e2f">Root Node</h6>
<div class="outline-text-6" id="text-orgcc13e2f">
<p>
Root Node 相当于 Humanoid 中的 Body Transform<br />
</p>

<p>
因为 Generic 动画的骨骼结构可以是任意的。所以需要指定哪个骨骼是根节点。根节点允许 Unity 在多个 AnimationClip 之间建立一致性，并且在没有“就地”创作的动画之间正确混合（也就是说，整个模型在动画时移动其世界位置）。<br />
指定根节点有助于 Unity 确定骨骼相对于彼此的移动以及世界中根节点的运动。<br />
</p>

<ul class="org-ul">
<li>不指定 Root Node，Root Motion 动画不会起作用<br /></li>
<li>指定了错误的 Root Node，Root Motion 动画的效果是错误的<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org1ce54cb" class="outline-6">
<h6 id="org1ce54cb">参考资料</h6>
<div class="outline-text-6" id="text-org1ce54cb">
<ul class="org-ul">
<li><a href="https://docs.unity3d.com/Manual/GenericAnimations.html">https://docs.unity3d.com/Manual/GenericAnimations.html</a><br /></li>
<li><a href="https://docs.unity3d.com/Manual/FBXImporter-Rig.html">https://docs.unity3d.com/Manual/FBXImporter-Rig.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org0135740" class="outline-5">
<h5 id="org0135740">Humanoid Avatar</h5>
<div class="outline-text-5" id="text-org0135740">
</div>
<div id="outline-container-orge18dd7b" class="outline-6">
<h6 id="orge18dd7b">Body Transform</h6>
<div class="outline-text-6" id="text-orge18dd7b">
<p>
Body Transform 是角色的质心。其被用于 Mecanim 的重定向引擎来提供稳定的模型位移。<br />
</p>
</div>
</div>
<div id="outline-container-orgbdd92af" class="outline-6">
<h6 id="orgbdd92af">Root Motion Node</h6>
<div class="outline-text-6" id="text-orgbdd92af">
<ul class="org-ul">
<li>不指定 Root Motion Node，Root Motion 动画是错误的，播放动画的 GameObject 的位置会和 Root Transform<br /></li>
<li>指定了错误的根节点，Root Motion 动画也是错误的，如果选择的根运动节点没有动画，则角色播放动画后会回到原始位置。<br /></li>
</ul>

<p>
指定了 Root Motion Node 后，Root Transform Rotation/Root Transform Position(Y/XZ) 选项会消失<br />
动画本身的效果没有什么问题，播放动画的 GameObject 的位置会和 RootMotionNode 节点位置重合。<br />
</p>
</div>
</div>

<div id="outline-container-orga88944c" class="outline-6">
<h6 id="orga88944c">参考资料</h6>
<div class="outline-text-6" id="text-orga88944c">
<ul class="org-ul">
<li>Root Motion-how it works <a href="https://docs.unity3d.com/Manual/RootMotion.html">https://docs.unity3d.com/Manual/RootMotion.html</a><br /></li>
<li>Unity 动画系统的 RootMotion <a href="https://zhuanlan.zhihu.com/p/44714595">https://zhuanlan.zhihu.com/p/44714595</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org8ef9e1c" class="outline-4">
<h4 id="org8ef9e1c">AnimatorState.WriteDefaults</h4>
<div class="outline-text-4" id="text-org8ef9e1c">
<p>
官网描述：对于没有做动画的属性，AnimatorState 是否使用默认值来写入该属性。<br />
</p>

<p>
WriteDefaults 的工作方式如下：<br />
</p>
<ol class="org-ol">
<li>当 Animator 初始化的时候，会遍历 AnimatorController 上的所有 clips，收集所有 clips 中做动画的属性，并且从场景中搜集这些属性的当前值，将当前值保存为 Default 值(默认值)。<br /></li>
<li>当播放一个 WriteDefaults 属性设置为 True 的 state 时, 如果当前状态没有对某个属性做动画，则使用 Default 值(默认值)来设置该属性。<br /></li>
</ol>

<p>
<a href="https://forum.unity.com/threads/write-defaults-confusion-bug.392058/">https://forum.unity.com/threads/write-defaults-confusion-bug.392058/</a><br />
<a href="https://blog.csdn.net/rickshaozhiheng/article/details/77838379">https://blog.csdn.net/rickshaozhiheng/article/details/77838379</a><br />
<a href="https://docs.unity3d.com/ScriptReference/Animations.AnimatorState-writeDefaultValues.html">https://docs.unity3d.com/ScriptReference/Animations.AnimatorState-writeDefaultValues.html</a><br />
</p>
</div>
</div>
<div id="outline-container-orgffa98e2" class="outline-4">
<h4 id="orgffa98e2">参考文档</h4>
<div class="outline-text-4" id="text-orgffa98e2">
<p>
Unity-Animator 学习文档 <a href="http://www.cnblogs.com/hont/p/5097407.html">http://www.cnblogs.com/hont/p/5097407.html</a><br />
</p>
</div>
</div>
</div>
<div id="outline-container-org977aad5" class="outline-3">
<h3 id="org977aad5">Attributes</h3>
<div class="outline-text-3" id="text-org977aad5">
</div>
<div id="outline-container-orgcbec6ab" class="outline-4">
<h4 id="orgcbec6ab">RuntimeInitializeOnLoadMethod</h4>
<div class="outline-text-4" id="text-orgcbec6ab">
<p>
设置了[RuntimeInitializeOnLoadMethod]属性的静态函数，在场景加载完成后会被调用(Awake 消息触发之后调用)。<br />
不同文件中的[RuntimeInitializeOnLoadMethod]属性的静态函数调用顺序是不确定的。<br />
</p>
</div>
</div>
<div id="outline-container-orgc0fbc10" class="outline-4">
<h4 id="orgc0fbc10">Inspector Attributes</h4>
<div class="outline-text-4" id="text-orgc0fbc10">
</div>
<div id="outline-container-orgc63ef08" class="outline-5">
<h5 id="orgc63ef08">Range</h5>
<div class="outline-text-5" id="text-orgc63ef08">
<div class="org-src-container">
<pre class="src src-csharp">[Range(0.0f,1.0f)]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">float</span> speedFactor;
[<span style="color: #ce537a; font-weight: bold;">Range</span>(1,5)]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">float</span> blurStopTime = 3.0f;
</pre>
</div>

<p>
float int 类型的属性标记了 Range 属性后，Inspector 上就会变为 slider。<br />
</p>
</div>
</div>
<div id="outline-container-orge874812" class="outline-5">
<h5 id="orge874812">字段序列化和显示</h5>
<div class="outline-text-5" id="text-orge874812">
<p>
Unity 会自动为 Public 变量做序列化，序列化的意思是说再次读取 Unity 时序列化的变量是有值的，不需要你再次去赋值，因为它已经被保存下来。<br />
什么样的值会被显示在面板上？已经被序列化，但是没有用 HideInInspector 标记的值。<br />
[HideInInspector]表示将原本显示在面板上的序列化值隐藏起来。<br />
[SerializeField]表示将原本不会被序列化的私有变量和保护变量可以序列化，这么他们在下次读取时，就是你上次赋值的值。<br />
<a href="http://blog.sina.com.cn/s/blog_697b1b8c0102uxvn.html">http://blog.sina.com.cn/s/blog_697b1b8c0102uxvn.html</a><br />
</p>

<ol class="org-ol">
<li><p>
如果 a 是公有的序列化变量。<br />
</p>
<ul class="org-ul">
<li>如果你想要在面板中看到 a，那么用：<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">a</span>;
</pre>
</div>
<ul class="org-ul">
<li>如果你不想在面板中看到 a，那么用:<br /></li>
</ul>
<div class="org-src-container">
<pre class="src src-csharp">[HideInInspector]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> a;   <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#36825;&#26679; a &#21487;&#20197;&#22312;&#31243;&#24207;&#20013;&#34987;&#20195;&#30721;&#36171;&#20540;&#65292;&#20294;&#19981;&#20250;&#22312;&#38754;&#26495;&#20013;&#30475;&#21040;&#24182;&#25163;&#21160;&#35774;&#32622;&#36171;&#20540;&#12290;</span>
</pre>
</div></li>
<li><p>
如果 a 是私有的序列化变量，你想在面板中读取并保存，那么用:<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">[SerializeField]
<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> a;
</pre>
</div></li>
<li><p>
如果 a 是私有的序列化变量，你想在面板中读取，但是不保存，那么用：<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">[HideInInspector]
[<span style="color: #ce537a; font-weight: bold;">SerializedField</span>]
<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> a;
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">b</span>  { <span style="color: #4f97d7; font-weight: bold;">get</span>{ <span style="color: #4f97d7; font-weight: bold;">return</span> a; } }

<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#28982;&#21518;&#22312; Editor &#20013;&#20462;&#25913;&#26174;&#31034;</span>
EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">LabelField</span>(<span style="color: #2d9574;">"value"</span>,game.B.<span style="color: #bc6ec5; font-weight: bold;">ToString</span>());
</pre>
</div></li>
<li><p>
如果 a 是私有序列化变量，你不想在面板中做任何操作(不想看到，也不想写)，但是想要在程序中给它赋值，那么用。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">[HideInInspector]
[<span style="color: #ce537a; font-weight: bold;">SerializedField</span>]
<span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> a;
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">b</span>{ <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> a; }  <span style="color: #4f97d7; font-weight: bold;">set</span> { a = <span style="color: #a45bad;">value</span>; } }
</pre>
</div></li>
<li><p>
如果 a 需要被外部访问，但是不需要被序列化<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">_a</span>;
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">a</span>{ <span style="color: #4f97d7; font-weight: bold;">get</span> { <span style="color: #4f97d7; font-weight: bold;">return</span> a; }  <span style="color: #4f97d7; font-weight: bold;">set</span> { a = <span style="color: #a45bad;">value</span>; } }
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-org06c035a" class="outline-5">
<h5 id="org06c035a">添加 Reset 操作</h5>
<div class="outline-text-5" id="text-org06c035a">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Sample</span> : <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
    [<span style="color: #ce537a; font-weight: bold;">ContextMenuItem</span>(<span style="color: #2d9574;">"Reset"</span>, <span style="color: #2d9574;">"ResetName"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> name = <span style="color: #2d9574;">"Default"</span>;
    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ResetName</span>() {
        name = <span style="color: #2d9574;">"Default"</span>;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc1d731f" class="outline-5">
<h5 id="orgc1d731f">添加 Header 添加空格</h5>
<div class="outline-text-5" id="text-orgc1d731f">
<p>
可以通过 Header 性质，来将多个属性分组<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">AttributeOperation</span>: <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
    [<span style="color: #ce537a; font-weight: bold;">Header</span>(<span style="color: #2d9574;">"&#39068;&#33394;&#23646;&#24615;&#32452;"</span>)]
    [<span style="color: #ce537a; font-weight: bold;">ColorUsage</span>(<span style="color: #a45bad;">false</span>, <span style="color: #a45bad;">true</span>, 1, 1, 1, 1)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> Color color1;
    [<span style="color: #ce537a; font-weight: bold;">ColorUsage</span>(<span style="color: #a45bad;">false</span>, <span style="color: #a45bad;">true</span>, 1, 0, 0, 1)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> Color color2;
    [<span style="color: #ce537a; font-weight: bold;">ColorUsage</span>(<span style="color: #a45bad;">false</span>, <span style="color: #a45bad;">true</span>, 0, 1, 0, 1)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> Color color3;

    [<span style="color: #ce537a; font-weight: bold;">Space</span>(10)]<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#19978;&#19979;&#23646;&#24615;&#20043;&#38388;&#38548;&#20102; 10 &#20010;&#31354;&#20301;</span>
    [<span style="color: #ce537a; font-weight: bold;">Header</span>(<span style="color: #2d9574;">"&#20854;&#20182;&#23646;&#24615;&#32452;"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> i;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org5f70838" class="outline-5">
<h5 id="org5f70838">颜色选择</h5>
<div class="outline-text-5" id="text-org5f70838">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">AttributeOperation</span>: <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
    [<span style="color: #ce537a; font-weight: bold;">Header</span>(<span style="color: #2d9574;">"&#39068;&#33394;&#38754;&#26495;"</span>)]
    [<span style="color: #ce537a; font-weight: bold;">ColorUsage</span>(<span style="color: #a45bad;">false</span>, <span style="color: #a45bad;">true</span>, 1, 1, 1, 1)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> Color color;
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org0ad0213" class="outline-4">
<h4 id="org0ad0213">指定依赖某个组件</h4>
<div class="outline-text-4" id="text-org0ad0213">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#25351;&#23450; GFancyList &#32452;&#20214;&#20381;&#36182; ScrollPositionController</span>
[RequireComponent(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(ScrollPositionController))]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GFancyList</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6879f0c" class="outline-4">
<h4 id="org6879f0c">System.Serializable</h4>
<div class="outline-text-4" id="text-org6879f0c">
<p>
指定自定义的 class 或 struct 可以被序列化。<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp">[System.Serializable]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">WidgetSlotInfo</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">widgetSlotName</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">string</span>&gt; <span style="color: #7590db;">widgetNameList</span>;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org3718c60" class="outline-4">
<h4 id="org3718c60">自定义属性显示名字</h4>
<div class="outline-text-4" id="text-org3718c60">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Assets\Scenes\CustomVarNameAttribute.cs</span>
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">System.Collections</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">System.Collections.Generic</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">CustomVarNameAttribute</span>: <span style="color: #ce537a; font-weight: bold;">PropertyAttribute</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">showVarName</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> CustomVarNameAttribute(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span>, <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">showVarName</span>=<span style="color: #a45bad;">false</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">this</span>.name = name;
        <span style="color: #4f97d7; font-weight: bold;">this</span>.showVarName = showVarName;
    }
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Assets\Scenes\Editor\CustomVarNameDrawer.cs</span>
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">System.Collections</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">System.Collections.Generic</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEditor</span>;

[<span style="color: #ce537a; font-weight: bold;">CustomPropertyDrawer</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(CustomVarNameAttribute))]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">CustomVarNameDrawer</span> : <span style="color: #ce537a; font-weight: bold;">PropertyDrawer</span>
{
    <span style="color: #ce537a; font-weight: bold;">GUIContent</span> <span style="color: #7590db;">_label</span> = <span style="color: #a45bad;">null</span>;

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnGUI</span>(<span style="color: #ce537a; font-weight: bold;">Rect</span> <span style="color: #7590db;">position</span>, <span style="color: #ce537a; font-weight: bold;">SerializedProperty</span> <span style="color: #7590db;">property</span>, <span style="color: #ce537a; font-weight: bold;">GUIContent</span> <span style="color: #7590db;">label</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span>(_label == <span style="color: #a45bad;">null</span>)
        {
            <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">attri</span> = attribute <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">CustomVarNameAttribute</span>;
            <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">name</span> = <span style="color: #ce537a; font-weight: bold;">string</span>.Empty;
            <span style="color: #4f97d7; font-weight: bold;">if</span>(attri.showVarName)
            {
                name = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"{0} [{1}]"</span>, attri.name , property.name);
            }
            <span style="color: #4f97d7; font-weight: bold;">else</span>
            {
                name = attri.name;
            }
            _label = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GUIContent</span>(name);
        }
        EditorGUI.<span style="color: #bc6ec5; font-weight: bold;">PropertyField</span>(position, property, _label);
    }
}

<span style="color: #2aa1ae; background-color: #292e34;">//</span>
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Test</span> : <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
    [<span style="color: #ce537a; font-weight: bold;">CustomVarNameAttribute</span>(<span style="color: #2d9574;">"&#27979;&#35797;"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> test;
    [<span style="color: #ce537a; font-weight: bold;">CustomVarNameAttribute</span>(<span style="color: #2d9574;">"&#27979;&#35797;"</span>, <span style="color: #a45bad;">true</span>)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> testName;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org5ce5975" class="outline-4">
<h4 id="org5ce5975">自定义属性只读</h4>
<div class="outline-text-4" id="text-org5ce5975">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">//</span>
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">CustomVarReadOnlyAttribute</span> : <span style="color: #ce537a; font-weight: bold;">PropertyAttribute</span> 
{
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span>
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEditor</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;

[<span style="color: #ce537a; font-weight: bold;">CustomPropertyDrawer</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(CustomVarReadOnlyAttribute))]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">CustomVarReadOnlyDrawer</span> : <span style="color: #ce537a; font-weight: bold;">PropertyDrawer</span>
{
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #bc6ec5; font-weight: bold;">GetPropertyHeight</span>(<span style="color: #ce537a; font-weight: bold;">SerializedProperty</span> <span style="color: #7590db;">property</span>, <span style="color: #ce537a; font-weight: bold;">GUIContent</span> <span style="color: #7590db;">label</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">return</span> EditorGUI.<span style="color: #bc6ec5; font-weight: bold;">GetPropertyHeight</span>(property, label, <span style="color: #a45bad;">true</span>);
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnGUI</span>(<span style="color: #ce537a; font-weight: bold;">Rect</span> <span style="color: #7590db;">position</span>, <span style="color: #ce537a; font-weight: bold;">SerializedProperty</span> <span style="color: #7590db;">property</span>, <span style="color: #ce537a; font-weight: bold;">GUIContent</span> <span style="color: #7590db;">label</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">originEnalbe</span> = GUI.enabled;
        GUI.enabled = <span style="color: #a45bad;">false</span>;
        EditorGUI.<span style="color: #bc6ec5; font-weight: bold;">PropertyField</span>(position, property, label, <span style="color: #a45bad;">true</span>);
        GUI.enabled = originEnalbe;
    }
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span>
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Test</span> : <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
    [<span style="color: #ce537a; font-weight: bold;">CustomVarReadOnly</span>]
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">int</span> i = 0;

    [<span style="color: #ce537a; font-weight: bold;">CustomVarReadOnly</span>]
    <span style="color: #4f97d7; font-weight: bold;">public</span> Vector3 t;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5e62cfc" class="outline-4">
<h4 id="org5e62cfc">参考资料</h4>
<div class="outline-text-4" id="text-org5e62cfc">
<ul class="org-ul">
<li>Unity3D Attributes 用法小结 <a href="http://blog.csdn.net/qq_24642743/article/details/75092091">http://blog.csdn.net/qq_24642743/article/details/75092091</a><br /></li>
<li>Unity 特性（Attribute）总览 <a href="https://gameinstitute.qq.com/community/detail/121123">https://gameinstitute.qq.com/community/detail/121123</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org64f20e2" class="outline-3">
<h3 id="org64f20e2">Ray</h3>
<div class="outline-text-3" id="text-org64f20e2">
<p>
Ray 是一个结构体<br />
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">struct</span> <span style="color: #ce537a; font-weight: bold;">Ray</span>
{
    <span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">origin</span>;     <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23556;&#32447;&#21457;&#20986;&#30340;&#21407;&#28857;</span>
    <span style="color: #ce537a; font-weight: bold;">Vector3</span> <span style="color: #7590db;">direction</span>;  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#23556;&#32447;&#21457;&#20986;&#30340;&#26041;&#21521;</span>
}
</pre>
</div>
</div>
<div id="outline-container-org88aba7a" class="outline-4">
<h4 id="org88aba7a">使用射线来实现拾取物体</h4>
<div class="outline-text-4" id="text-org88aba7a">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#20174; main &#25668;&#20687;&#26426;&#25152;&#22312;&#20301;&#32622;&#21457;&#20986;&#19968;&#26465;&#25351;&#21521;&#40736;&#26631;&#20301;&#32622;&#30340;&#23556;&#32447;</span>
ray = Camera.main.<span style="color: #bc6ec5; font-weight: bold;">ScreenPointToRay</span>(Input.mousePosition);
<span style="color: #4f97d7; font-weight: bold;">if</span> (Input.<span style="color: #bc6ec5; font-weight: bold;">GetMouseButtonDown</span>(0))
{
    <span style="color: #ce537a; font-weight: bold;">RaycastHit</span> <span style="color: #7590db;">hit</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524;&#23556;&#32447;&#30896;&#25758;&#21040;&#23545;&#35937;&#65292;&#25226;&#36820;&#22238;&#20449;&#24687;&#20648;&#23384;&#21040; hit &#20013;  </span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> (Physics.<span style="color: #bc6ec5; font-weight: bold;">Raycast</span>(ray, <span style="color: #4f97d7; font-weight: bold;">out</span> <span style="color: #ce537a; font-weight: bold;">hit</span>))
    {
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">&#22914;&#26524;&#30896;&#25758;&#30340;&#23545;&#35937;&#26159; Cube&#65292;&#21017;&#38144;&#27585;&#23427;  </span>
        <span style="color: #4f97d7; font-weight: bold;">if</span> (hit.transform.gameObject.name == <span style="color: #2d9574;">"Cube"</span>)
        {
            Destroy(hit.transform.gameObject);
        }
    }
}
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#32534;&#36753;&#22120;&#20013;&#30340;&#23556;&#32447;&#26816;&#27979;</span>
SceneView.onSceneGUIDelegate += OnSceneGUI;
<span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnSceneGUI</span>(<span style="color: #ce537a; font-weight: bold;">SceneView</span> <span style="color: #7590db;">sceneView</span>)
{
    <span style="color: #4f97d7; font-weight: bold;">if</span> (Event.current.button == 1 &amp;&amp; Event.current.type == EventType.MouseDown)
    {
        <span style="color: #ce537a; font-weight: bold;">Ray</span> <span style="color: #7590db;">ray</span> = HandleUtility.<span style="color: #bc6ec5; font-weight: bold;">GUIPointToWorldRay</span>(Event.current.mousePosition);
        <span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Ray ray = sceneView.camera.</span><span style="color: #bc6ec5; font-weight: bold;">ScreenPointToRay</span><span style="color: #2aa1ae; background-color: #292e34;">(Event.current.mousePosition);</span>
        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">hits</span> = Physics.<span style="color: #bc6ec5; font-weight: bold;">RaycastAll</span>(ray);
        <span style="color: #4f97d7; font-weight: bold;">foreach</span> (<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">hit</span> <span style="color: #4f97d7; font-weight: bold;">in</span> hits)
        {
            <span style="color: #4f97d7; font-weight: bold;">if</span> (hit.transform.tag == selectedTag)
            {
                Selection.activeGameObject = hit.transform.gameObject;
                <span style="color: #4f97d7; font-weight: bold;">break</span>;
            }
        }
    }
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org92a14f0" class="outline-3">
<h3 id="org92a14f0">Sprite SpriteAtlas</h3>
<div class="outline-text-3" id="text-org92a14f0">
</div>
<div id="outline-container-orgad10c43" class="outline-4">
<h4 id="orgad10c43">Sprite.textureRect Sprite.textureRectOffset</h4>
<div class="outline-text-4" id="text-orgad10c43">
<ul class="org-ul">
<li>Sprite.textureRect 表示图集中小图占据的矩形区域<br /></li>
<li>Sprite.textureRectOffset 表示图集中小图占据的矩形区域相对于未打包之前单图时占据的矩形区域的位置偏移。<br /></li>
</ul>

<p>
例如： 假设原始的小图片 T_Lip_001.png 为 256x256, 将 T_Lip_001.png 添加到 SpriteAtlas CharPartTexAtlas 中后，CharPartTexAtlas 图集的大小为 256x256，T_Lip_001.png sprite.textureRect=(0.05,120.08,184.91,55.90)，这表示 T_Lip_001.png 在 CharPartTexAtlas 图集中占据的矩形区域。对应的 sprite.textureRectOffset=(36.1,87.1)，这表示 T_Lip_001.png 打包到大图后，其占据的矩形区域，相对于原来单图时矩形区域的偏移量。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orga8cc14c" class="outline-3">
<h3 id="orga8cc14c">Coroutine</h3>
<div class="outline-text-3" id="text-orga8cc14c">
<p>
MonoBehaviour 的 Start 方法可以为 Coroutine。(Awake OnEnable OnDisable 都不可以是 Coroutine)<br />
</p>
</div>
</div>
<div id="outline-container-org8d2b1c6" class="outline-3">
<h3 id="org8d2b1c6">Dir File Path</h3>
<div class="outline-text-3" id="text-org8d2b1c6">
</div>
<div id="outline-container-orgdfd93b1" class="outline-4">
<h4 id="orgdfd93b1">Application.absoluteURL</h4>
<div class="outline-text-4" id="text-orgdfd93b1">
<p>
返回 web 播放器数据文件的绝对路径（只读）。<br />
Application.absoluteURL 和 Application.srcValue 允许你检测你的 unityWeb 数据文件是否被移动或链接到另一个地方。你可能会希望保护和防止你的数据文件被剽窃。<br />
</p>
</div>
</div>

<div id="outline-container-org5136d92" class="outline-4">
<h4 id="org5136d92">Application.dataPath</h4>
<div class="outline-text-4" id="text-org5136d92">
<p>
返回游戏数据文件的目录（只读）。<br />
</p>
<ul class="org-ul">
<li>Unity Editor: &lt;path to project folder&gt;/Assets<br /></li>
<li>Mac player: &lt;path to player app bundle&gt;/Contents<br /></li>
<li>iOS player: &lt;path to player app bundle&gt;/&lt;AppName.app&gt;/Data (this folder is read only, use Application.persistentDataPath to save data).<br /></li>
<li>Win/Linux player: &lt;path to executablename_Data folder&gt; (note that most Linux installations will be case-sensitive!)<br /></li>
<li>WebGL: The absolute url to the player data file folder (without the actual data file name)<br /></li>
<li>Android: Normally it would point directly to the APK. The exception is if you are running a split binary build in which case it points to the the OBB instead.<br /></li>
</ul>
<p>
在 PC 上，返回的字符串以斜杠"/"为文件夹分隔符。<br />
</p>
</div>
</div>
<div id="outline-container-orgecca440" class="outline-4">
<h4 id="orgecca440">Application.persistentDataPath</h4>
<div class="outline-text-4" id="text-orgecca440">
<p>
返回持久化数据的目录（只读）。<br />
在运行期间期望被保存的数据可以记录在该文件夹下。<br />
发布 iOS 和 Android 时，persistentDataPath 会指向一个设备的公共目录。在每次 App 更新过程中，这个目录下的文件不会被删除。但是，你应该意识到无法安全的防止用户的行为。例如，移除 SD 卡将会使存储到其中的数据无法访问。<br />
当构建 app 的时候，GUID 会基于 BundleID 生成，而且 GUID 是 persistentDataPath 的一部分。如果你在将来的版本中保持同一个 Bundle ID，app 就可以在每次更新后都能继续访问同一个目录。<br />
</p>

<p>
Windows Store Apps: Application.persistentDataPath points to &lt;user&gt;\AppData\Local\Packages\&lt;productname&gt;\LocalState.<br />
</p>
</div>
</div>
<div id="outline-container-org1db6614" class="outline-4">
<h4 id="org1db6614">Application.streamingAssetsPath</h4>
<div class="outline-text-4" id="text-org1db6614">
<p>
返回 StreamingAssets 文件夹的路径（只读）。<br />
如果在项目的 Assets 目录下有一个 StreamingAssets 文件夹，这个目录将会被复制到播放器的构建中，并被存储在 Applicaiton.streamingAssetsPath 指定的路径下。<br />
注意： 在一些平台下无法直接访问 StreamingAssets 文件夹，例如，在 web 平台下是没有文件系统访问的，又比如在 Android 平台下，它会被压缩到.apk 文件中。在这些平台下，Applicaiton.streamingAssetsPath 会返回一个 url 地址，它可以和 WWW 类配合使用，来获取 StreamingAssets 目录下的文件。<br />
</p>
</div>
</div>
<div id="outline-container-orgb064ce8" class="outline-4">
<h4 id="orgb064ce8">Application.temporaryCachePath</h4>
<div class="outline-text-4" id="text-orgb064ce8">
<p>
返回临时数据、缓存目录的路径（只读）。<br />
在该目录下可以存放临时数据。<br />
</p>
</div>
</div>
<div id="outline-container-org9157742" class="outline-4">
<h4 id="org9157742">获取项目根目录</h4>
<div class="outline-text-4" id="text-org9157742">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">projAbsPath</span> = Path.<span style="color: #bc6ec5; font-weight: bold;">GetDirectoryName</span>(Application.dataPath);
<span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">buildAbsPath</span> = projAbsPath + <span style="color: #2d9574;">"/build"</span>;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org946dc23" class="outline-3">
<h3 id="org946dc23">Camera</h3>
<div class="outline-text-3" id="text-org946dc23">
</div>
<div id="outline-container-orgaa06b0b" class="outline-4">
<h4 id="orgaa06b0b">判断物体是否在摄像机视野内</h4>
<div class="outline-text-4" id="text-orgaa06b0b">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #bc6ec5; font-weight: bold;">IsVisibleFrom</span>(<span style="color: #ce537a; font-weight: bold;">Bounds</span> <span style="color: #7590db;">bounds</span>, <span style="color: #ce537a; font-weight: bold;">Camera</span> <span style="color: #7590db;">camera</span>)
{
    <span style="color: #ce537a; font-weight: bold;">Plane</span>[] <span style="color: #7590db;">planes</span> = GeometryUtility.<span style="color: #bc6ec5; font-weight: bold;">CalculateFrustumPlanes</span>(camera);
    <span style="color: #4f97d7; font-weight: bold;">return</span> GeometryUtility.<span style="color: #bc6ec5; font-weight: bold;">TestPlanesAABB</span>(planes, bounds);
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc03caf9" class="outline-3">
<h3 id="orgc03caf9">Mesh MeshRenderer SkinnedMeshRenderer</h3>
<div class="outline-text-3" id="text-orgc03caf9">
</div>
<div id="outline-container-org44431ff" class="outline-4">
<h4 id="org44431ff">Mesh</h4>
<div class="outline-text-4" id="text-org44431ff">
</div>
<div id="outline-container-org85a801d" class="outline-5">
<h5 id="org85a801d">关于 Mesh</h5>
<div class="outline-text-5" id="text-org85a801d">
</div>
<div id="outline-container-org7d47624" class="outline-6">
<h6 id="org7d47624">Mesh.vertices</h6>
<div class="outline-text-6" id="text-org7d47624">
<p>
Mesh.vertices 中记录了模型顶点的坐标，这些坐标值是在模型空间下的值。<br />
</p>
</div>
</div>
<div id="outline-container-orgfb713e0" class="outline-6">
<h6 id="orgfb713e0">Mesh.bindposes</h6>
<div class="outline-text-6" id="text-orgfb713e0">
<p>
Mesh.bindposes[x] 中存储的是模型空间到骨骼空间的变换矩阵。Mesh.bindposes[x].inverse 为骨骼空间到模型空间的变换矩阵。<br />
Mesh.bindposes[x] * Mesh.vertices[y] 为顶点 y 在骨骼 x 空间中的坐标。<br />
CurrentPose[x-&gt;Mesh] * Mesh.bindposes[x] * Mesh.vertices[y] 为顶点 y 在当前姿势下模型空间中的坐标<br />
</p>
</div>
</div>
<div id="outline-container-org0767fbe" class="outline-6">
<h6 id="org0767fbe">Mesh.boneWeights</h6>
<div class="outline-text-6" id="text-org0767fbe">
<p>
Mesh.boneWeights 中记录了模型的每个顶点，对于相关骨骼的权重值。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgffc93d1" class="outline-5">
<h5 id="orgffc93d1">代码创建 QuadMesh</h5>
<div class="outline-text-5" id="text-orgffc93d1">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">Mesh</span> <span style="color: #bc6ec5; font-weight: bold;">CreateQuad</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">quadMesh</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Mesh</span>();
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">vertexPosList</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;Vector3&gt;();
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(-0.5f, 0.5f));
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(0.5f, 0.5f));
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(-0.5f, -0.5f));
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector3</span>(0.5f, -0.5f));
    quadMesh.<span style="color: #bc6ec5; font-weight: bold;">SetVertices</span>(vertexPosList);

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">uvPosList</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;Vector2&gt;();
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(0,1));
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(1,1));
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(0,0));
    vertexPosList.<span style="color: #bc6ec5; font-weight: bold;">Add</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Vector2</span>(1,0));
    quadMesh.<span style="color: #bc6ec5; font-weight: bold;">SetUVs</span>(0, uvPosList);

    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">triangleList</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">int</span>&gt;();
    quadMesh.<span style="color: #bc6ec5; font-weight: bold;">SetTriangles</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">int</span>[] { 0, 1, 2, 2, 1, 3 }, 0);
    <span style="color: #4f97d7; font-weight: bold;">return</span> quadMesh;
}

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">GameObject</span> <span style="color: #bc6ec5; font-weight: bold;">CreateQuadGObj</span>()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">gObj</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GameObject</span>();
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">mf</span> = gObj.AddComponent&lt;MeshFilter&gt;();
    mf.sharedMesh = CreateQuad();
    gObj.AddComponent&lt;MeshRenderer&gt;();
    <span style="color: #4f97d7; font-weight: bold;">return</span> gObj;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb0ccf7d" class="outline-5">
<h5 id="orgb0ccf7d">Mesh vertices normals bindposes 数据修改</h5>
<div class="outline-text-5" id="text-orgb0ccf7d">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">mesh.vertices &#36820;&#22238;&#30340;&#26159;&#19968;&#20010;&#26032;&#30340;&#25968;&#32452;&#65292;&#20462;&#25913;&#36825;&#20010;&#25968;&#32452;&#19981;&#20250;&#25913;&#21464;&#21407;&#22987;&#25968;&#32452;&#65292;&#25152;&#20197;&#38656;&#35201;&#22312;&#20462;&#25913;&#20043;&#21518;&#23558;&#25972;&#20010;&#25968;&#32452;&#36171;&#20540;&#32473; mesh.vertices</span>
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ExampleClass</span> : <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span> {
    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Update</span>() {
        <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#65306; &#27492;&#22788;&#38656;&#35201;&#20351;&#29992; mesh &#32780;&#19981;&#33021;&#20351;&#29992; sharedMesh&#65292;&#21542;&#21017;&#21407;&#22987;&#23548;&#20837;&#30340;&#27169;&#22411;&#25968;&#25454;&#20250;&#34987;&#20462;&#25913;&#12290;</span>
        <span style="color: #ce537a; font-weight: bold;">Mesh</span> <span style="color: #7590db;">mesh</span> = GetComponent&lt;MeshFilter&gt;().mesh;
        <span style="color: #ce537a; font-weight: bold;">Vector3</span>[] <span style="color: #7590db;">vertices</span> = mesh.vertices;
        <span style="color: #ce537a; font-weight: bold;">Vector3</span>[] <span style="color: #7590db;">normals</span> = mesh.normals;
        <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = 0;
        <span style="color: #4f97d7; font-weight: bold;">while</span> (i &lt; vertices.Length) {
            vertices[i] += normals[i] * Mathf.<span style="color: #bc6ec5; font-weight: bold;">Sin</span>(Time.time);
            i++;
        }
        mesh.vertices = vertices;
    }
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8d2a00f" class="outline-4">
<h4 id="org8d2a00f">SkinnedMeshRenderer</h4>
<div class="outline-text-4" id="text-org8d2a00f">
</div>
<div id="outline-container-org919e38b" class="outline-5">
<h5 id="org919e38b">SkinnedMeshRenderer 和 骨架</h5>
<div class="outline-text-5" id="text-org919e38b">
<ul class="org-ul">
<li>将 FBX 拖入场景中，将骨架删除。运行起来后，发现 skinnedMeshRenderer.bones 数组中元素个数没变，但其中的元素都是 null。<br /></li>
<li>为 FBX 开启 GameObject Optimize 优化，将 FBX 拖入场景，发现 skinnedMeshRenderer.bones 数组中元素个数为 0，Mesh 可以正常显示。<br /></li>
<li>为 FBX 开启 GameObject Optimize 优化，将 FBX 拖入场景，删除 Animator 上的 avatar，将 FBX 保存为 prefab，发现模型都不显示了。<br /></li>
<li>将 Skeleton FBX 开启 GameObject Optimize 优化，部件的 FBX 无论是否开启 GameObject Optimize 优化，在 Skeleton 中新建 GameObject 节点并添加 SkinnedMeshRenderer 组件，然后将部件的 mesh 赋值给新加的 SMR，并且为 SMR 设置正确的 rootBone，mesh 都可以正确显示。<br /></li>
<li>Skeleton 开启 GameObject Optimize 优化，头部骨骼全部不保留(或者保留)。运行时或离线时，添加新的头部骨架，脸部模型 Skin 到新添加的头部骨架。此时，动画不会驱动新添加的头部骨架。<br /></li>
<li>参考资料<br />
<ul class="org-ul">
<li>该文档的 Importing skinned Meshes 部分  <a href="https://docs.unity3d.com/Manual/class-SkinnedMeshRenderer.html">https://docs.unity3d.com/Manual/class-SkinnedMeshRenderer.html</a><br /></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgb6e786d" class="outline-5">
<h5 id="orgb6e786d">SkinnedMeshRenderer 和 Mesh</h5>
<div class="outline-text-5" id="text-orgb6e786d">
<ul class="org-ul">
<li>将 Mesh 从 FBX 中分离出来后，Mesh.bindposes 和 Mesh.boneWeights 数据依然保留着。<br /></li>
<li>skinnedMeshRenderer.BakeMesh(newMesh)，newMesh.bindposes 和 newMesh.boneWeights 都为空。<br /></li>
</ul>
</div>
</div>
<div id="outline-container-orga6030c0" class="outline-5">
<h5 id="orga6030c0">SkinnedMeshRenderer.sharedMesh</h5>
<div class="outline-text-5" id="text-orga6030c0">
<p>
通过该接口修改 Mesh 会导致 FBX 中的 Mesh 被修改。所以，应该实例化一个新的 Mesh，在新的 Mesh 上做修改。<br />
</p>
</div>
</div>
<div id="outline-container-orgdb70823" class="outline-5">
<h5 id="orgdb70823">SkinnedMeshRenderer 序列化</h5>
<div class="outline-text-5" id="text-orgdb70823">
</div>
<div id="outline-container-org4f1b297" class="outline-6">
<h6 id="org4f1b297">SkinnedMeshRenderer Public 属性</h6>
<div class="outline-text-6" id="text-org4f1b297">
<p>
<img src="./UnityNote/005_skinmesh_properties.jpg" alt="005_skinmesh_properties.jpg" /><br />
<img src="./UnityNote/005_skinmesh_properties_2.jpg" alt="005_skinmesh_properties_2.jpg" /><br />
几个重要的属性：<br />
SkinnedMeshRenderer.bones                       该数组中存储的骨骼顺序必须和 SkinnedMeshRenderer.sharedMesh 相关属性中使用的骨骼顺序一致。<br />
SkinnedMeshRenderer.sharedMesh                  SkinnedMeshRenderer 使用的 mesh<br />
SkinnedMeshRenderer.mateirals                   渲染模型用到的材质<br />
SkinnedMeshRenderer.rootBone                    用于定义动画的根节点，其他骨骼是相对于该骨骼运动的。<br />
</p>

<p>
Unity 中没有将 SkinnedMeshRenderer 序列化为 Asset，SkinnedMeshRenderer 依附于 Prefab。可以通过下面两种方案来实现 SkinnedMeshRenderer 的序列化。<br />
</p>
</div>
</div>


<div id="outline-container-org742d76e" class="outline-6">
<h6 id="org742d76e">方案 1</h6>
<div class="outline-text-6" id="text-org742d76e">
<p>
可以自己实现 SkinnedMeshRenderer 的序列化，将其保存为如下结构的 Asset<br />
</p>
<pre class="example">
- smr_clothes_xxx 
	- bone_dict = {clothes:[bone1,bone2,......], gauze:[bone1,bone2,......]}
	- mesh_dict = {clothes:MeshObject, gauze:MeshObject}
	- mat_dict = {clothes:[mat1,mat2,......], gauze:[mat1,mat2,......]}
	- root_dict = {clothes:"xxx", gauze:"xxx"}
  - ......

smr_clothes_xxx 保存了一个 clothes fbx 上的所有 SkinnedMeshRenderer。
bone_dict 记录了每个 SkinnedMeshRenderer 的 bones 属性
mesh_dict 记录了每个 SkinnedMeshRenderer 的 shareMesh 属性
mat_dict  记录了每个 SkinnedMeshRenderer 的 materials 属性
root_dict 记录了每个 SkinnedMeshRenderer 的 rootBone 属性

</pre>
</div>
</div>
<div id="outline-container-org7c8fd05" class="outline-6">
<h6 id="org7c8fd05">方案 2</h6>
<div class="outline-text-6" id="text-org7c8fd05">
<p>
SkinnedMeshRender 的所有属性通过 Prefab 来记录<br />
</p>
</div>
</div>
<div id="outline-container-org7e9052a" class="outline-6">
<h6 id="org7e9052a">方案 3</h6>
<div class="outline-text-6" id="text-org7e9052a">
<p>
将 SkinnedMeshRenderer 的 mesh 独立出来存储<br />
将 SkinnedMeshRenderer 的 mats 独立出来存储<br />
SkinnedMeshRender 的其他属性通过 Prefab 来记录<br />
</p>

<p>
将 Mesh 分离出来，加载时再赋值给 SkinnedMeshRenderer 时 rootBone 必须赋值正确，否则模型位置可能不正确。所以如果开启 GameObject Optimize 时，rootBone 节点必须保留。<br />
</p>
</div>
</div>
<div id="outline-container-orgc7f6451" class="outline-6">
<h6 id="orgc7f6451">方案 4</h6>
<div class="outline-text-6" id="text-orgc7f6451">
<p>
Skeleton fbx 开启 GameObject Optimize，保留所有挂点和 SMR 用到的 rootBone 节点。<br />
</p>

<p>
将部件 SkinnedMeshRenderer 的 mesh 独立出来存储<br />
将部件 SkinnedMeshRenderer 的 mats 独立出来存储<br />
将部件 SkinnedMeshRenderer 的 rootBone 独立出来存储<br />
</p>
</div>
</div>
<div id="outline-container-orgc2bf998" class="outline-6">
<h6 id="orgc2bf998">方案 5</h6>
<div class="outline-text-6" id="text-orgc2bf998">
<p>
Skeleton fbx 开启 GameObject Optimize，保留所有挂点和 SMR 用到的 rootBone 节点。<br />
部件 fbx 开启 GameObject Optimize，保留 SMR 用到的 rootBone 节点(这样就不需要单独记录 SMR 用到的 rootBone 节点了)。<br />
</p>

<ul class="org-ul">
<li>部件 fbx 生成 prefab 时，引用 Skeleton 的 avatar。可以减少加载部件时的消耗<br /></li>
</ul>
</div>
</div>
<div id="outline-container-org8d066e8" class="outline-6">
<h6 id="org8d066e8">方案比较</h6>
<div class="outline-text-6" id="text-org8d066e8">
<ul class="org-ul">
<li>方案 1  不采用<br />
<ul class="org-ul">
<li>需要做的工作比较多，需要序列化所有属性<br /></li>
<li>因为 SkinnedMeshRenderer 用到的骨骼是通过存储名称来序列化的，所以这种方案无法支持 GameObject Optimize<br /></li>
</ul></li>
<li>方案 2<br />
<ul class="org-ul">
<li>支持 GameObject Optimize，但是需要在 GameObject Optimize 中保留 SkinnedMeshRenderer 用到的 root bone 节点。<br /></li>
<li><del>支持 GameObject Optimize 后，就无法支持换装了，因为换装需要读取骨架结构来设置 SkinnedMeshRenderer.bones 属性将模型和骨骼关联起来。</del><br />
<ul class="org-ul">
<li>只要 Skeleton 的 FBX 开启了 GameObject Optimize，部件的 FBX 是否开启 GameObject Optimize 都不受影响。<br /></li>
</ul></li>
</ul></li>
<li>方案 3<br />
<ul class="org-ul">
<li>具有和方案 2 一样的优缺点，<br /></li>
<li>此外，将 Mesh 和 Mats 独立出来存储，可以实现按照距离加载不同 lod 级别的资源。<br /></li>
</ul></li>
<li>方案 4<br />
<ul class="org-ul">
<li>只有 Skeleton 是 GameObject，部件都用 Asset 来存储，性能应该是最好的。<br /></li>
<li>需要自定义实现资源预览 资源保存 资源加载 资源释放<br /></li>
</ul></li>
<li>方案 5<br />
<ul class="org-ul">
<li>需要做的工作比较少<br /></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgda9330c" class="outline-4">
<h4 id="orgda9330c">当模型只有一个骨骼时，SkinMesh 和 Mesh 的运算效率相差大吗？</h4>
<div class="outline-text-4" id="text-orgda9330c">
<p>
在 unity 中使用 profile 工具进行了测试，测试结果如下(测试平台为 PC 平台)：<br />
</p>
<ul class="org-ul">
<li>60 个 mesh 对象，<br />
<img src="./UnityNote/005_mesh_cpu01.jpg" alt="005_mesh_cpu01.jpg" /><br />
<img src="./UnityNote/005_mesh_cpu02.jpg" alt="005_mesh_cpu02.jpg" /><br /></li>
<li>60 个 skinMesh 对象 Quality=4<br />
<img src="./UnityNote/005_skinmesh_cpu01.jpg" alt="005_skinmesh_cpu01.jpg" /><br />
<img src="./UnityNote/005_skinmesh_cpu02.jpg" alt="005_skinmesh_cpu02.jpg" /><br /></li>
<li>60 个 skinMesh 对象 Quality=1<br />
<img src="./UnityNote/005_skinmesh_cpu03.jpg" alt="005_skinmesh_cpu03.jpg" /><br />
<img src="./UnityNote/005_skinmesh_cpu04.jpg" alt="005_skinmesh_cpu04.jpg" /><br /></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org509259e" class="outline-3">
<h3 id="org509259e">Lod LodGroup</h3>
<div class="outline-text-3" id="text-org509259e">
</div>
<div id="outline-container-org849c819" class="outline-4">
<h4 id="org849c819">Lod.screenRelativeTransitionHeight</h4>
<div class="outline-text-4" id="text-org849c819">
<p>
该值的范围为[0-1]，表示相对于屏幕的高度。如果 物体当前在屏幕空间中显示的高度 / 屏幕高度 &lt;= Lod.screenRelativeTransitionHeight 时，就会使用当前的 Lod。<br />
</p>
</div>
</div>

<div id="outline-container-orgb0b627e" class="outline-4">
<h4 id="orgb0b627e">Quality.LodBias</h4>
<div class="outline-text-4" id="text-orgb0b627e">
<p>
Quality.LodBias<br />
LOD level 是按照物体在屏幕上的大小来选取的。当物体尺寸介于两个 Lod level 之间时，选择可以偏向于细节多的等级，也可以偏向于细节少的等级，可以通过 Quality.LodBias 来设置这种选择偏好。<br />
Quality.LodBias 是一个 0 到正无穷大的分数。当 0&lt;Quality.LodBias&lt;1 时,选择偏向于低等级的 lod（包含细节多的等级）；当 Quality.LodBias=1 时，选择不偏向任何一方；当 Quality.LodBias&gt;1 时,选择偏向于高等级的 lod（包含细节少的等级）；<br />
</p>

<p>
例如：若设置 Quality.LodBias=2 时，当摄像机到物体的距离变化 50%时，LOD 实际上只变化了 25%<br />
</p>
</div>
</div>
<div id="outline-container-orgf940b80" class="outline-4">
<h4 id="orgf940b80">Misc</h4>
<div class="outline-text-4" id="text-orgf940b80">
</div>
<div id="outline-container-org5d59c70" class="outline-5">
<h5 id="org5d59c70">同一个 Renderer 可以在不同的 Lod 中</h5>
<div class="outline-text-5" id="text-org5d59c70">
<p>
例如 BaiduYun/_Test/LodTest 中，LodTest2 节点 Cube 和 Capsule 交替出现在多个不同的 Lod level 中。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orge687db8" class="outline-4">
<h4 id="orge687db8">参考资料</h4>
<div class="outline-text-4" id="text-orge687db8">
<ul class="org-ul">
<li>Unity 官网 Lod LodGroup 使用 Example <a href="https://docs.unity3d.com/ScriptReference/LODGroup.SetLODs.html">https://docs.unity3d.com/ScriptReference/LODGroup.SetLODs.html</a><br /></li>
<li>Unity 官网 LodGroup 文档 <a href="https://docs.unity3d.com/Manual/class-LODGroup.html">https://docs.unity3d.com/Manual/class-LODGroup.html</a><br /></li>
<li>Quality.LodBias 官方说明文档 <a href="https://docs.unity3d.com/Manual/class-QualitySettings.html">https://docs.unity3d.com/Manual/class-QualitySettings.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org0961223" class="outline-3">
<h3 id="org0961223">Materials</h3>
<div class="outline-text-3" id="text-org0961223">
</div>
<div id="outline-container-org7b3a87b" class="outline-4">
<h4 id="org7b3a87b">使用 shaderMaterial 编辑器下每次运行，材质都被修改</h4>
<div class="outline-text-4" id="text-org7b3a87b">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">Material</span> <span style="color: #bc6ec5; font-weight: bold;">GetMaterial</span>(<span style="color: #ce537a; font-weight: bold;">Renderer</span> <span style="color: #7590db;">render</span>)
{
<span style="color: #bc6ec5;">    #if</span> UNITY_EDITOR
    <span style="color: #4f97d7; font-weight: bold;">return</span> render.material;
<span style="color: #bc6ec5;">    #else</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> render.sharedMaterial;
<span style="color: #bc6ec5;">    #endif</span>
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org04eb3c0" class="outline-3">
<h3 id="org04eb3c0">Graphics</h3>
<div class="outline-text-3" id="text-org04eb3c0">
</div>
<div id="outline-container-org4d8c93f" class="outline-4">
<h4 id="org4d8c93f">CommandBuffer</h4>
<div class="outline-text-4" id="text-org4d8c93f">
</div>
<div id="outline-container-org5edcb81" class="outline-5">
<h5 id="org5edcb81">简介</h5>
<div class="outline-text-5" id="text-org5edcb81">
<p>
CommandBuffer 中保存了一些渲染命令的列表，他们可以在摄像机、灯光渲染的各个时间点被执行，也可以通过 Graphics.ExecuteCommandBuffer 立即执行。<br />
</p>
<ul class="org-ul">
<li>public void Camera.AddCommandBuffer(Rendering.CameraEvent evt, Rendering.CommandBuffer buffer);<br /></li>
<li>public void Light.AddCommandBuffer(Rendering.LightEvent evt, Rendering.CommandBuffer buffer, Rendering.ShadowMapPass shadowPassMask);<br /></li>
<li>public static void Graphics.ExecuteCommandBuffer(Rendering.CommandBuffer buffer);<br /></li>

<li><a href="https://docs.unity3d.com/Manual/GraphicsCommandBuffers.html">https://docs.unity3d.com/Manual/GraphicsCommandBuffers.html</a><br /></li>
</ul>
</div>
</div>

<div id="outline-container-org7d66b85" class="outline-5">
<h5 id="org7d66b85">对于只执行一次的 CommandBuffer 要如何 FrameDebuger？</h5>
<div class="outline-text-5" id="text-org7d66b85">
<p>
在 Monobehavior 的 Update 中执行 CommandBuffer，就可以通过 FrameDebuger 查看了。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org2ea1607" class="outline-4">
<h4 id="org2ea1607">Texture2D UV 坐标</h4>
<div class="outline-text-4" id="text-org2ea1607">
<p>
坐标原点在左下角，下面代码生成的图片为：<br />
<img src="./UnityNote/2020_11_18_texuv.png" alt="2020_11_18_texuv.png" /><br />
</p>

<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">Texture2D</span> <span style="color: #bc6ec5; font-weight: bold;">WriteTexture2D</span>()
{
    <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">texSize</span> = 100;
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">tex</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Texture2D</span>(texSize, texSize);
    <span style="color: #4f97d7; font-weight: bold;">for</span>(<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span>=0; i&lt;texSize; i++)
    {
        <span style="color: #4f97d7; font-weight: bold;">for</span>(<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">j</span>=0; j&lt;texSize; j++)
        {
            <span style="color: #ce537a; font-weight: bold;">Color</span> <span style="color: #7590db;">color</span> = Color.black;
            color.r = (<span style="color: #ce537a; font-weight: bold;">float</span>)i / texSize;
            color.g = (<span style="color: #ce537a; font-weight: bold;">float</span>)j / texSize;
            tex.<span style="color: #bc6ec5; font-weight: bold;">SetPixel</span>(i, j, color);
        }
    }
    tex.<span style="color: #bc6ec5; font-weight: bold;">Apply</span>();
    <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">imgPath</span> = Application.dataPath + <span style="color: #2d9574;">"/../test.png"</span>;
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(imgPath);
    System.IO.File.<span style="color: #bc6ec5; font-weight: bold;">WriteAllBytes</span>(imgPath, tex.<span style="color: #bc6ec5; font-weight: bold;">EncodeToPNG</span>());
    <span style="color: #4f97d7; font-weight: bold;">return</span> tex;
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org03dfd6e" class="outline-4">
<h4 id="org03dfd6e">将材质来渲染贴图并保存起来</h4>
<div class="outline-text-4" id="text-org03dfd6e">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">DrawPng</span>(<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">pngWidth</span>, <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">pngHeight</span>, <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">imgPath</span>, <span style="color: #ce537a; font-weight: bold;">Material</span> <span style="color: #7590db;">mat</span>=<span style="color: #a45bad;">null</span>)
{
    <span style="color: #4f97d7; font-weight: bold;">if</span> (pngWidth &lt; 1 || pngHeight &lt; 1)
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">LogWarning</span>(<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"png size error! w={0} h={1}"</span>, pngWidth, pngHeight));
        <span style="color: #4f97d7; font-weight: bold;">return</span>;
    }
    <span style="color: #4f97d7; font-weight: bold;">if</span>( <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">IsNullOrEmpty</span>(imgPath))
    {
        Debug.<span style="color: #bc6ec5; font-weight: bold;">LogError</span>(<span style="color: #2d9574;">"imgName is nullOrEmpty"</span>);
        <span style="color: #4f97d7; font-weight: bold;">return</span>;
    }

    <span style="color: #ce537a; font-weight: bold;">Rect</span> <span style="color: #7590db;">rect</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Rect</span>(0, 0, pngWidth, pngHeight);
    <span style="color: #ce537a; font-weight: bold;">RenderTexture</span> <span style="color: #7590db;">rt</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">RenderTexture</span>(pngWidth, pngHeight, 0);
    Graphics.<span style="color: #bc6ec5; font-weight: bold;">Blit</span>(mat.mainTexture, rt, mat);

    RenderTexture.active = rt;
    <span style="color: #ce537a; font-weight: bold;">Texture2D</span> <span style="color: #7590db;">tex</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Texture2D</span>((<span style="color: #ce537a; font-weight: bold;">int</span>)rt.width, (<span style="color: #ce537a; font-weight: bold;">int</span>)rt.height, TextureFormat.RGB24, <span style="color: #a45bad;">false</span>);
    tex.<span style="color: #bc6ec5; font-weight: bold;">ReadPixels</span>(rect, 0, 0);
    tex.<span style="color: #bc6ec5; font-weight: bold;">Apply</span>();
    RenderTexture.active = <span style="color: #a45bad;">null</span>;

    System.IO.File.<span style="color: #bc6ec5; font-weight: bold;">WriteAllBytes</span>(imgPath, tex.<span style="color: #bc6ec5; font-weight: bold;">EncodeToPNG</span>());
    GameObject.<span style="color: #bc6ec5; font-weight: bold;">Destroy</span>(rt);
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb90a3e6" class="outline-3">
<h3 id="orgb90a3e6">Screen And Resolution</h3>
<div class="outline-text-3" id="text-orgb90a3e6">
<p>
<a href=".UnityGUI.html#org09f57c8">.UnityGUI.html#org09f57c8</a><br />
</p>
</div>
</div>
<div id="outline-container-orgf21d1eb" class="outline-3">
<h3 id="orgf21d1eb">Misc</h3>
<div class="outline-text-3" id="text-orgf21d1eb">
</div>
<div id="outline-container-org95da6d7" class="outline-4">
<h4 id="org95da6d7">如何在编辑器中实时查看脚本私有变量的值？</h4>
<div class="outline-text-4" id="text-org95da6d7">
<p>
设置 Inspector 的模式为 Debug，在 Inspector 中就会显示私有变量。<br />
同时显示 Debug 类型的 Inspector 和 Normal 类型的 Inspector，还可以查看编辑器编辑的属性所对应的私有变量。<br />
</p>

<p>
Inspector 的 Debug 模式只显示当前类的私有变量，不会显示父类的私有变量。可以通过 GPreviewVar 脚本来查看父类的私有变量。<br />
</p>
</div>
</div>
<div id="outline-container-org52267aa" class="outline-4">
<h4 id="org52267aa">如何将 Texture2D 保存为 png 图片？</h4>
<div class="outline-text-4" id="text-org52267aa">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #ce537a; font-weight: bold;">byte</span>[] <span style="color: #7590db;">bytes</span> = lipSp.texture.<span style="color: #bc6ec5; font-weight: bold;">EncodeToPNG</span>();
File.<span style="color: #bc6ec5; font-weight: bold;">WriteAllBytes</span>(Application.dataPath + <span style="color: #2d9574;">"/../__TEST"</span> +  <span style="color: #2d9574;">".png"</span>, bytes);
</pre>
</div>
</div>
</div>
<div id="outline-container-org58d684b" class="outline-4">
<h4 id="org58d684b">如何计算 FPS 并显示出来？</h4>
<div class="outline-text-4" id="text-org58d684b">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">System.Collections</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">System.Collections.Generic</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine.UI</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine.SceneManagement</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GTestHelper</span> : <span style="color: #ce537a; font-weight: bold;">MonoBehaviour</span>
{
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">_is_inited</span> = <span style="color: #a45bad;">false</span>;

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Text</span> <span style="color: #7590db;">text_fps</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Text</span> <span style="color: #7590db;">text_sceneName</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Button</span> <span style="color: #7590db;">btn_previous</span>;
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">Button</span> <span style="color: #7590db;">btn_next</span>;

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">fpsMeasuringDelta</span> = 2.0f;

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">timePassed</span>;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">m_FrameCount</span> = 0;
    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">float</span> <span style="color: #7590db;">m_FPS</span> = 0.0f;

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">curSceneIndex</span>;

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Awake</span>()
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (_is_inited == <span style="color: #a45bad;">true</span>)
        {
            GameObject.<span style="color: #bc6ec5; font-weight: bold;">DestroyImmediate</span>(gameObject);
            <span style="color: #4f97d7; font-weight: bold;">return</span>;
        }

        _is_inited = <span style="color: #a45bad;">true</span>;
        SceneManager.sceneLoaded += OnSceneLoaded;
    }

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Start</span>()
    {
        gameObject.name = <span style="color: #2d9574;">"__GTestGObj_Canvas__"</span>;
        DontDestroyOnLoad(gameObject);
        timePassed = 0.0f;

        curSceneIndex = 0;
        SetSceneName();
        <span style="color: #4f97d7; font-weight: bold;">if</span> (btn_next != <span style="color: #a45bad;">null</span>)
        {
            btn_next.onClick.<span style="color: #bc6ec5; font-weight: bold;">AddListener</span>(<span style="color: #4f97d7; font-weight: bold;">delegate</span> ()
            {
                ChangeScene(<span style="color: #a45bad;">true</span>);
            });
        }
        <span style="color: #4f97d7; font-weight: bold;">if</span> (btn_previous != <span style="color: #a45bad;">null</span>)
        {
            btn_previous.onClick.<span style="color: #bc6ec5; font-weight: bold;">AddListener</span>(<span style="color: #4f97d7; font-weight: bold;">delegate</span> ()
            {
                ChangeScene(<span style="color: #a45bad;">false</span>);
            });
        }
    }

    <span style="color: #4f97d7; font-weight: bold;">private</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">Update</span>()
    {
        m_FrameCount = m_FrameCount + 1;
        timePassed = timePassed + Time.deltaTime;

        <span style="color: #4f97d7; font-weight: bold;">if</span> (timePassed &gt; fpsMeasuringDelta)
        {
            m_FPS = m_FrameCount / timePassed;

            timePassed = 0.0f;
            m_FrameCount = 0;
            SetFPS();
        }
    }

    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">SetFPS</span>()
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (text_fps != <span style="color: #a45bad;">null</span>)
            text_fps.text = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"FPS: {0}"</span>, m_FPS);

    }

    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">SetSceneName</span>()
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (text_sceneName != <span style="color: #a45bad;">null</span>)
        {
            <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">scene</span> = SceneManager.<span style="color: #bc6ec5; font-weight: bold;">GetActiveScene</span>();
            text_sceneName.text = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"Scene: {0}"</span>, scene.name);
        }
    }

    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">ChangeScene</span>(<span style="color: #ce537a; font-weight: bold;">bool</span> <span style="color: #7590db;">isNext</span>)
    {
        <span style="color: #4f97d7; font-weight: bold;">if</span> (isNext)
        {
            curSceneIndex = (curSceneIndex + 1) % SceneManager.sceneCountInBuildSettings;
        }
        <span style="color: #4f97d7; font-weight: bold;">else</span>
        {
            curSceneIndex = curSceneIndex - 1;
            <span style="color: #4f97d7; font-weight: bold;">if</span> (curSceneIndex &lt; 0)
            {
                curSceneIndex = SceneManager.sceneCountInBuildSettings + curSceneIndex;
            }
        }

        SceneManager.<span style="color: #bc6ec5; font-weight: bold;">LoadScene</span>(curSceneIndex);
    }

    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnSceneLoaded</span>(<span style="color: #ce537a; font-weight: bold;">Scene</span> <span style="color: #7590db;">scene</span>, <span style="color: #ce537a; font-weight: bold;">LoadSceneMode</span> <span style="color: #7590db;">loadSceneMode</span>)
    {
        SetSceneName();
    }
}
</pre>
</div>

<ul class="org-ul">
<li>为什么上面计算出来的 FPS 和 Unity Statistics 面板上显示的 FPS 不同?<br />
<a href="http://forum.china.unity3d.com/thread-3883-1-1.html">http://forum.china.unity3d.com/thread-3883-1-1.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org1812dbe" class="outline-4">
<h4 id="org1812dbe">PlayerPrefs</h4>
<div class="outline-text-4" id="text-org1812dbe">
<p>
PlayerPrefs 存储路径<br />
</p>
<ul class="org-ul">
<li>apk 安装在内置 flash 存储器上时， PlayerPrefs 的位置是\data\data\com.company.product\shared_prefs\com.company.product.xml<br /></li>
<li>apk 安装在内置 SD 卡存储器上时， PlayerPrefs 的位置是/sdcard/Android/data/com.company.product\shared_prefs\com.company.product.xml<br /></li>
<li>在 Mac OS X 上 PlayerPrefs 存储在～/Library/PlayerPrefs 文件夹，名为 unity.[company name].[product name].plist，这里 company 和 product 名是在 Project Setting 中设置的，相同的 plist 用于在编辑器中运行的工程和独立模式.<br /></li>
<li>On iOS, the PlayerPrefs can be found in your app's plist file. It's located at:/Apps/ your app's folder <i>Library/Preferences</i> your app's .plist<br /></li>
<li>在 Windows 独立模式下，PlayerPrefs 被存储在注册表的 HKCU\Software\[company name]\[product name]键下，这里 company 和 product 名是在 Project Setting 中设置的.<br /></li>
<li>在 Windows 编辑器模式下，PlayerPrefs 被存储在注册表的 HKCU\Software\Unity\UnityEditor\[company name]\[product name]键下，这里 company 和 product 名是在 Project Setting 中设置的。<br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf2a6f28" class="outline-2">
<h2 id="orgf2a6f28">Editor</h2>
<div class="outline-text-2" id="text-orgf2a6f28">
</div>
<div id="outline-container-org52c84df" class="outline-3">
<h3 id="org52c84df">EditorExtension</h3>
<div class="outline-text-3" id="text-org52c84df">
</div>
<div id="outline-container-orgadc833a" class="outline-4">
<h4 id="orgadc833a">Update/Redraw SceneView</h4>
<div class="outline-text-4" id="text-orgadc833a">
<div class="org-src-container">
<pre class="src src-csharp">SceneView.<span style="color: #bc6ec5; font-weight: bold;">RepaintAll</span>();
</pre>
</div>
</div>
</div>
<div id="outline-container-orga451a65" class="outline-4">
<h4 id="orga451a65">添加菜单命令</h4>
<div class="outline-text-4" id="text-orga451a65">
<ul class="org-ul">
<li><a href="https://docs.unity3d.com/ScriptReference/MenuItem.html">https://docs.unity3d.com/ScriptReference/MenuItem.html</a><br /></li>
</ul>
</div>
<div id="outline-container-org3d49d8c" class="outline-5">
<h5 id="org3d49d8c">快捷键规则</h5>
<div class="outline-text-5" id="text-org3d49d8c">
<pre class="example">
% = ctrl(windows) / cmd(osx)
# = Shift 
&amp; = Alt 
LEFT/RIGHT/UP/DOWN = 上下左右 
F1…F2 = F... 
HOME, END, PGUP, PGDN = 键盘上的特殊功能键 
特别注意的是，如果是键盘上的普通按键，比如 a~z，则要写成_a ~ _z 这种带_前缀的。
</pre>
</div>
</div>
<div id="outline-container-org06c9fac" class="outline-5">
<h5 id="org06c9fac">Example</h5>
<div class="outline-text-5" id="text-org06c9fac">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Ctrl+Shift+t &#24555;&#25463;&#38190; &#25191;&#34892; Test() &#20989;&#25968;</span>
[MenuItem(GFW/Test _%_#_T)]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> Test()
{
  Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"Test"</span>);
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org15edea0" class="outline-4">
<h4 id="org15edea0">执行菜单命令</h4>
<div class="outline-text-4" id="text-org15edea0">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">https://docs.unity3d.com/ScriptReference/EditorApplication.ExecuteMenuItem.html</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Simple script that lets you create a new</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">scene, create a cube and an empty game object in the scene</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Save the scene and close the editor</span>

<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEditor</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEditor.SceneManagement</span>;

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ExampleClass</span>
{
    [<span style="color: #ce537a; font-weight: bold;">MenuItem</span>(<span style="color: #2d9574;">"Examples/Execute menu items"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> EditorPlaying()
    {
        <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">newScene</span> = EditorSceneManager.<span style="color: #bc6ec5; font-weight: bold;">NewScene</span>(NewSceneSetup.<span style="color: #ce537a; font-weight: bold;">EmptyScene</span>, NewSceneMode.<span style="color: #ce537a; font-weight: bold;">Single</span>);

        EditorApplication.<span style="color: #bc6ec5; font-weight: bold;">ExecuteMenuItem</span>(<span style="color: #2d9574;">"GameObject/3D Object/Cube"</span>);
        EditorApplication.<span style="color: #bc6ec5; font-weight: bold;">ExecuteMenuItem</span>(<span style="color: #2d9574;">"GameObject/Create Empty"</span>);

        EditorSceneManager.<span style="color: #bc6ec5; font-weight: bold;">SaveScene</span>(<span style="color: #ce537a; font-weight: bold;">newScene</span>, <span style="color: #2d9574;">"Assets/MyNewScene.unity"</span>);
        EditorApplication.<span style="color: #bc6ec5; font-weight: bold;">Exit</span>(0);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org7a1544d" class="outline-4">
<h4 id="org7a1544d">Engine 命名空间下执行 Editor 命名空间下代码</h4>
<div class="outline-text-4" id="text-org7a1544d">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Engine namespace </span><span style="color: #a45bad;">code</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GUtility</span>
{
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">FuncName</span> = <span style="color: #2d9574;">""</span>;
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">object</span>&gt; <span style="color: #7590db;">Args</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">List</span>&lt;<span style="color: #ce537a; font-weight: bold;">object</span>&gt;();
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">CallEditorFunc</span>(<span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">funcName</span>, <span style="color: #4f97d7; font-weight: bold;">params</span> <span style="color: #ce537a; font-weight: bold;">object</span>[] <span style="color: #7590db;">args</span>)
    {
<span style="color: #bc6ec5;">#if</span> UNITY_EDITOR
        FuncName = funcName;
        Args.<span style="color: #bc6ec5; font-weight: bold;">Clear</span>();
        Args.<span style="color: #bc6ec5; font-weight: bold;">AddRange</span>(<span style="color: #ce537a; font-weight: bold;">args</span>);
        UnityEditor.EditorApplication.<span style="color: #bc6ec5; font-weight: bold;">ExecuteMenuItem</span>(<span style="color: #2d9574;">"GFW/CallEditorFunc"</span>);
        FuncName = <span style="color: #2d9574;">""</span>;
        Args.<span style="color: #bc6ec5; font-weight: bold;">Clear</span>();
<span style="color: #bc6ec5;">#endif</span>
    }
}

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Editor namespace </span><span style="color: #a45bad;">code</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GEditorUtility</span>
{
    [<span style="color: #ce537a; font-weight: bold;">MenuItem</span>(<span style="color: #2d9574;">"GFW/CallEditorFunc"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> CallEditorFunc()
    {
        <span style="color: #4f97d7; font-weight: bold;">switch</span>(GUtility.FuncName)
        {
            <span style="color: #4f97d7; font-weight: bold;">case</span> <span style="color: #2d9574;">"ExportFbx"</span>:
                <span style="color: #4f97d7; font-weight: bold;">if</span>(GUtility.Args.Count&lt;2)
                {
                    Debug.<span style="color: #bc6ec5; font-weight: bold;">LogError</span>(<span style="color: #2d9574;">"ExportFbx args count &lt; 2"</span>);
                    <span style="color: #4f97d7; font-weight: bold;">return</span>;
                }
                ExportFbx((<span style="color: #ce537a; font-weight: bold;">GameObject</span>)GUtility.Args[0], (<span style="color: #ce537a; font-weight: bold;">string</span>)GUtility.Args[1]);
                <span style="color: #4f97d7; font-weight: bold;">break</span>;
        }
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org835f44c" class="outline-4">
<h4 id="org835f44c">CustomEditor</h4>
<div class="outline-text-4" id="text-org835f44c">
</div>
<div id="outline-container-orgfa615ad" class="outline-5">
<h5 id="orgfa615ad">自定义 Inspector</h5>
<div class="outline-text-5" id="text-orgfa615ad">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">https://docs.unity3d.com/ScriptReference/Editor.html</span>
[CustomEditor (<span style="color: #4f97d7; font-weight: bold;">typeof</span>(MyPlayer))]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MyPlayerEditor</span> : <span style="color: #ce537a; font-weight: bold;">Editor</span> {
  <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">......</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org98029f7" class="outline-5">
<h5 id="org98029f7">自定义属性通过选择文件来赋值</h5>
<div class="outline-text-5" id="text-org98029f7">
<div class="org-src-container">
<pre class="src src-csharp">[CustomEditor(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(GUIParticle))]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">GUIParticleInspector</span> : <span style="color: #ce537a; font-weight: bold;">GBaseInspector</span>
{
    <span style="color: #ce537a; font-weight: bold;">GUIParticle</span> <span style="color: #7590db;">scriptObj</span>;
    UnityEngine.<span style="color: #ce537a; font-weight: bold;">Object</span> <span style="color: #7590db;">particleObj</span>;

    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnEnable</span>()
    {
        scriptObj = GetTarget&lt;<span style="color: #ce537a; font-weight: bold;">GUIParticle</span>&gt;();
        <span style="color: #4f97d7; font-weight: bold;">if</span>(!<span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">IsNullOrEmpty</span>(scriptObj.particlePath))
        {
            <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">tmpPath</span> = <span style="color: #ce537a; font-weight: bold;">string</span>.<span style="color: #bc6ec5; font-weight: bold;">Format</span>(<span style="color: #2d9574;">"{0}/{1}"</span>, GResMgrDefine.ABRootPath, scriptObj.particlePath);
            particleObj = AssetDatabase.LoadAssetAtPath&lt;Object&gt;(tmpPath);
        }
    }

    <span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnInspectorGUI</span>()
    {
        particleObj = EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">ObjectField</span>(<span style="color: #2d9574;">"ParticleFile"</span>, particleObj, <span style="color: #4f97d7; font-weight: bold;">typeof</span>(UnityEngine.Object), <span style="color: #a45bad;">false</span>);
        <span style="color: #4f97d7; font-weight: bold;">if</span>(particleObj==<span style="color: #a45bad;">null</span>)
        {
            scriptObj.particlePath = <span style="color: #2d9574;">""</span>;
        }
        <span style="color: #4f97d7; font-weight: bold;">else</span>
        {
            <span style="color: #ce537a; font-weight: bold;">string</span> <span style="color: #7590db;">tmpPath</span> = AssetDatabase.<span style="color: #bc6ec5; font-weight: bold;">GetAssetPath</span>(particleObj);
            scriptObj.particlePath = tmpPath.<span style="color: #bc6ec5; font-weight: bold;">Replace</span>(GResMgrDefine.ABRootPath+<span style="color: #2d9574;">"/"</span>, <span style="color: #2d9574;">""</span>);
        }
        EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">LabelField</span>(<span style="color: #2d9574;">"ParticleFileURL"</span>, scriptObj.particlePath);

        <span style="color: #4f97d7; font-weight: bold;">if</span> (GUILayout.<span style="color: #bc6ec5; font-weight: bold;">Button</span>(<span style="color: #2d9574;">"Play"</span>))
        {
            Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(scriptObj.particlePath);
            scriptObj.<span style="color: #bc6ec5; font-weight: bold;">Play</span>();
        }
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org666463e" class="outline-5">
<h5 id="org666463e">自定义 Inspector 显示 List</h5>
<div class="outline-text-5" id="text-org666463e">
</div>
<div id="outline-container-orgb2a6502" class="outline-6">
<h6 id="orgb2a6502">方案 1 不自定义化 List 的显示</h6>
<div class="outline-text-6" id="text-orgb2a6502">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">override</span> <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnInspectorGUI</span>()
{
    EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">PropertyField</span>(serializedObject.<span style="color: #bc6ec5; font-weight: bold;">FindProperty</span>(<span style="color: #2d9574;">"_widgetInfoList"</span>), <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GUIContent</span>(<span style="color: #2d9574;">"WidgetInfoList"</span>), <span style="color: #a45bad;">true</span>);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org55f9440" class="outline-6">
<h6 id="org55f9440">方案 2 自定义 List 的显示</h6>
<div class="outline-text-6" id="text-org55f9440">
<ul class="org-ul">
<li>参考资料 <a href="http://va.lent.in/unity-make-your-lists-functional-with-reorderablelist/">http://va.lent.in/unity-make-your-lists-functional-with-reorderablelist/</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org694b22d" class="outline-4">
<h4 id="org694b22d">EditorWindow</h4>
<div class="outline-text-4" id="text-org694b22d">
</div>
<div id="outline-container-org6fcd6da" class="outline-5">
<h5 id="org6fcd6da">EditorGUILayout</h5>
<div class="outline-text-5" id="text-org6fcd6da">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">- &#24320;&#22987;&#19968;&#20010;&#27700;&#24179;&#20998;&#32452;&#65292;&#36820;&#22238;&#35813;&#20998;&#32452;&#30340;&#30697;&#24418;&#21306;&#22495;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">BeginHorizontal Begin a horizontal group and get its rect back.</span>
EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">BeginHorizontal</span>();
EditorGUILayout.EndHorizontal ();

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">- &#22312;&#21069;&#19968;&#20010;&#25511;&#20214;&#21644;&#19979;&#19968;&#20010;&#25511;&#20214;&#20043;&#38388;&#28155;&#21152;&#19968;&#20010;&#23567;&#30340;&#31354;&#34892;</span>
<span style="color: #2aa1ae; background-color: #292e34;">//</span><span style="color: #2aa1ae; background-color: #292e34;">Make a small space between the previous control and the following.</span>
EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">Space</span>();

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">- &#28155;&#21152;&#28378;&#21160;&#26465; &#38480;&#23450;&#28378;&#21160;&#21306;&#22495;</span>
scrollPos = GUI.<span style="color: #bc6ec5; font-weight: bold;">BeginScrollView</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Rect</span>(0, 10, 500, 600), scrollPos, <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Rect</span>(-20, 0, 770, 600));
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">......</span>
GUI.<span style="color: #bc6ec5; font-weight: bold;">EndScrollView</span>();

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">- &#28155;&#21152;&#28378;&#21160;&#26465; &#33258;&#21160;&#21305;&#37197;&#28378;&#21160;&#21306;&#22495;</span>
scrollPos = GUILayout.<span style="color: #bc6ec5; font-weight: bold;">BeginScrollView</span>(scrollPos);
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">......</span>
GUILayout.<span style="color: #bc6ec5; font-weight: bold;">EndScrollView</span>();

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">- &#20462;&#25913;&#23383;&#20307;&#22823;&#23567;&#39068;&#33394;</span>
<span style="color: #ce537a; font-weight: bold;">GUIStyle</span> <span style="color: #7590db;">uiFont</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GUIStyle</span>();
uiFont.normal.background = <span style="color: #a45bad;">null</span>;
uiFont.normal.textColor = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Color</span>(1, 0, 0);
uiFont.fontSize = 20;
GUI.<span style="color: #bc6ec5; font-weight: bold;">Label</span>(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Rect</span>(200, 320, 200, 200), <span style="color: #2d9574;">"UI &#25171;&#21253;"</span>, uiFont);
</pre>
</div>
</div>
</div>
<div id="outline-container-org1203795" class="outline-5">
<h5 id="org1203795">如何在 EditorWindow 中绘制模型？</h5>
<div class="outline-text-5" id="text-org1203795">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEngine</span>;
<span style="color: #4f97d7; font-weight: bold;">using</span> <span style="color: #a45bad;">UnityEditor</span>;

<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Create an editor window which can display a chosen GameObject.</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">Use OnInteractivePreviewGUI to display the GameObject and</span>
<span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">allow it to be interactive.</span>

<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">ExampleClass</span>: <span style="color: #ce537a; font-weight: bold;">EditorWindow</span>
{
    <span style="color: #ce537a; font-weight: bold;">GameObject</span> <span style="color: #7590db;">gameObject</span>;
    <span style="color: #ce537a; font-weight: bold;">Editor</span> <span style="color: #7590db;">gameObjectEditor</span>;

    [<span style="color: #ce537a; font-weight: bold;">MenuItem</span>(<span style="color: #2d9574;">"Example/GameObject Editor"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> ShowWindow()
    {
        GetWindowWithRect&lt;<span style="color: #ce537a; font-weight: bold;">ExampleClass</span>&gt;(<span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">Rect</span>(0, 0, 256, 256));
    }

    <span style="color: #ce537a; font-weight: bold;">void</span> <span style="color: #bc6ec5; font-weight: bold;">OnGUI</span>()
    {
        gameObject = (GameObject) EditorGUILayout.<span style="color: #bc6ec5; font-weight: bold;">ObjectField</span>(gameObject, <span style="color: #4f97d7; font-weight: bold;">typeof</span>(GameObject), <span style="color: #a45bad;">true</span>);

        <span style="color: #ce537a; font-weight: bold;">GUIStyle</span> <span style="color: #7590db;">bgColor</span> = <span style="color: #4f97d7; font-weight: bold;">new</span> <span style="color: #ce537a; font-weight: bold;">GUIStyle</span>();
        bgColor.normal.background = EditorGUIUtility.whiteTexture;

        <span style="color: #4f97d7; font-weight: bold;">if</span> (gameObject != <span style="color: #a45bad;">null</span>)
        {
            <span style="color: #4f97d7; font-weight: bold;">if</span> (gameObjectEditor == <span style="color: #a45bad;">null</span>)
                gameObjectEditor = Editor.<span style="color: #bc6ec5; font-weight: bold;">CreateEditor</span>(gameObject);

            gameObjectEditor.<span style="color: #bc6ec5; font-weight: bold;">OnInteractivePreviewGUI</span>(GUILayoutUtility.<span style="color: #bc6ec5; font-weight: bold;">GetRect</span>(256, 256), bgColor);
        }
    }
}
</pre>
</div>
<ul class="org-ul">
<li>参考资料 <a href="https://docs.unity3d.com/ScriptReference/Editor.OnInteractivePreviewGUI.html">https://docs.unity3d.com/ScriptReference/Editor.OnInteractivePreviewGUI.html</a><br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgca82511" class="outline-4">
<h4 id="orgca82511">实时应用被编辑的变量</h4>
<div class="outline-text-4" id="text-orgca82511">
<div class="org-src-container">
<pre class="src src-csharp">
</pre>
</div>
</div>
</div>
<div id="outline-container-org05afb5c" class="outline-4">
<h4 id="org05afb5c">Tools</h4>
<div class="outline-text-4" id="text-org05afb5c">
</div>
<div id="outline-container-org3638400" class="outline-5">
<h5 id="org3638400">复制资源</h5>
<div class="outline-text-5" id="text-org3638400">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#38754;&#30340;&#20195;&#30721;&#23454;&#29616;&#20102;&#22797;&#21046;&#19968;&#20010;&#22330;&#26223;</span>
[MenuItem(<span style="color: #2d9574;">"GFW/TEST _%_#_T"</span>)]
<span style="color: #4f97d7; font-weight: bold;">public</span> <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> Test()
{
    <span style="color: #4f97d7; font-weight: bold;">var</span> <span style="color: #7590db;">result</span> = AssetDatabase.<span style="color: #bc6ec5; font-weight: bold;">CopyAsset</span>(<span style="color: #2d9574;">"Assets/M_Demo/Scenes/UISceneTemplate.unity"</span>, <span style="color: #2d9574;">"Assets/M_Demo/Scenes/xx.unity"</span>);
    Debug.<span style="color: #bc6ec5; font-weight: bold;">Log</span>(<span style="color: #2d9574;">"Run Test Editor "</span> + result);
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfb86019" class="outline-5">
<h5 id="orgfb86019">设置 Animator 的 AnimationClip loop 属性</h5>
<div class="outline-text-5" id="text-orgfb86019">
<div class="org-src-container">
<pre class="src src-csharp">[MenuItem(<span style="color: #2d9574;">"CustomTools/SetAnimationClipLoop"</span>)]
    <span style="color: #4f97d7; font-weight: bold;">static</span> <span style="color: #ce537a; font-weight: bold;">void</span> SetAnimationClipLoop()
{
    <span style="color: #ce537a; font-weight: bold;">Object</span>[] <span style="color: #7590db;">selectedAsset</span> = Selection.<span style="color: #bc6ec5; font-weight: bold;">GetFiltered</span>(<span style="color: #4f97d7; font-weight: bold;">typeof</span>(Object), SelectionMode.DeepAssets);
    <span style="color: #ce537a; font-weight: bold;">AnimationClip</span> <span style="color: #7590db;">clip</span> = selectedAsset[0] <span style="color: #4f97d7; font-weight: bold;">as</span> <span style="color: #ce537a; font-weight: bold;">AnimationClip</span>;
    <span style="color: #4f97d7; font-weight: bold;">if</span>(clip.legacy)
    {
        clip.wrapMode = WrapMode.Loop;
    }
    <span style="color: #4f97d7; font-weight: bold;">else</span>
    {
        <span style="color: #ce537a; font-weight: bold;">AnimationClipSettings</span> <span style="color: #7590db;">clipSetting</span> = AnimationUtility.<span style="color: #bc6ec5; font-weight: bold;">GetAnimationClipSettings</span>(clip);
        clipSetting.loopTime = !clip.isLooping;
        AnimationUtility.<span style="color: #bc6ec5; font-weight: bold;">SetAnimationClipSettings</span>(clip, clipSetting);
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb2e25fc" class="outline-5">
<h5 id="orgb2e25fc">代码设置 CacheServer</h5>
<div class="outline-text-5" id="text-orgb2e25fc">
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #4f97d7; font-weight: bold;">if</span> (Application.version==<span style="color: #2d9574;">"2018.2.5f1"</span>)
 {
     EditorPrefs.<span style="color: #bc6ec5; font-weight: bold;">SetString</span>(<span style="color: #2d9574;">"CacheServerIPAddress"</span>, <span style="color: #2d9574;">"192.168.0.200:8126"</span>);
     <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">0=local, 1=remote, 2=disable</span>
     EditorPrefs.<span style="color: #bc6ec5; font-weight: bold;">SetInt</span>(<span style="color: #2d9574;">"CacheServerMode"</span>, 1);
 }
</pre>
</div>

<ul class="org-ul">
<li><a href="http://www.evryway.com/Multiple-Unity-Cache-Servers/">http://www.evryway.com/Multiple-Unity-Cache-Servers/</a><br /></li>
<li><a href="https://docs.unity3d.com/Manual/CacheServer.html">https://docs.unity3d.com/Manual/CacheServer.html</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-org56b9966" class="outline-5">
<h5 id="org56b9966">按照指定条件获取工程中的资源</h5>
<div class="outline-text-5" id="text-org56b9966">
<p>
AssetDatabase.FindAssets(string filter, string[] searchInFolders);<br />
filter 可以是 Name Labels Types 的组合。<br />
Types 可以是内置类型也可以是用户自己定义的脚本类。不指定类型或使用 Object 类型表示搜索所有类型的资源。<br />
</p>

<ul class="org-ul">
<li><a href="https://docs.unity3d.com/ScriptReference/AssetDatabase.FindAssets.html">https://docs.unity3d.com/ScriptReference/AssetDatabase.FindAssets.html</a><br /></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org0f6e057" class="outline-3">
<h3 id="org0f6e057">ModelImporter</h3>
<div class="outline-text-3" id="text-org0f6e057">
</div>
<div id="outline-container-orgd52014c" class="outline-4">
<h4 id="orgd52014c">MeshCompression</h4>
<div class="outline-text-4" id="text-orgd52014c">
<p>
默认情况下模型数据精度是 32 位浮点数，修改压缩参数会修改模型数据的精度。<br />
</p>
<ul class="org-ul">
<li><a href="https://forum.unity.com/threads/mesh-compression-what-does-it-actually-do.33073/">https://forum.unity.com/threads/mesh-compression-what-does-it-actually-do.33073/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgf3c1997" class="outline-4">
<h4 id="orgf3c1997">Animation Compression</h4>
<div class="outline-text-4" id="text-orgf3c1997">
<p>
Keyframe.Reduce                减少关键帧<br />
Keyframe.ReduceCompression     减少关键帧并压缩<br />
Keyframe.Optimal               减少关键帧 将曲线转化为直线<br />
</p>

<p>
Animation Compression: Unity 5 <a href="http://nfrechette.github.io/2017/01/30/anim_compression_unity5/">http://nfrechette.github.io/2017/01/30/anim_compression_unity5/</a><br />
</p>
</div>
</div>
<div id="outline-container-orgc742396" class="outline-4">
<h4 id="orgc742396">Optimize Mesh</h4>
<div class="outline-text-4" id="text-orgc742396">
<p>
让 Unity 决定 Mesh 中三角形的排列顺序。Unity 对顶点和索引重新进行排序，从而让 GPU 性能更高<br />
</p>
<ul class="org-ul">
<li><a href="https://forum.unity.com/threads/what-does-optimize-mesh-do.346220/">https://forum.unity.com/threads/what-does-optimize-mesh-do.346220/</a><br /></li>
</ul>
</div>
</div>
<div id="outline-container-orgb9e9ad9" class="outline-4">
<h4 id="orgb9e9ad9">Preserve Hierarchy</h4>
<div class="outline-text-4" id="text-orgb9e9ad9">
<p>
是否保持骨骼结构，通常动画 FBX 应该开启该选项。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org7d44bb6" class="outline-3">
<h3 id="org7d44bb6">Misc</h3>
<div class="outline-text-3" id="text-org7d44bb6">
</div>
<div id="outline-container-org8f319d0" class="outline-4">
<h4 id="org8f319d0">Path</h4>
<div class="outline-text-4" id="text-org8f319d0">
</div>
<div id="outline-container-org568f5ed" class="outline-5">
<h5 id="org568f5ed">EditorApplication.applicationContentsPath</h5>
<div class="outline-text-5" id="text-org568f5ed">
<p>
返回 Unity 编辑器内容的目录。（只读）<br />
该目录下包含多个内置项目，使用编辑器构建播放器时，会用到它们。<br />
例如： 我打印出的这个目录为 D:/Applications/Unity/Editor/Data<br />
</p>
</div>
</div>
<div id="outline-container-orgbcfdb09" class="outline-5">
<h5 id="orgbcfdb09">EditorApplication.applicationPath</h5>
<div class="outline-text-5" id="text-orgbcfdb09">
<p>
返回 Unity 编辑器应用程序的目录。（只读）<br />
例如： 我打印出的这个目录为 D:/Applications/Unity/Editor/Unity.exe<br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org36a5afc" class="outline-3">
<h3 id="org36a5afc">Build</h3>
<div class="outline-text-3" id="text-org36a5afc">
</div>
<div id="outline-container-org7761ccb" class="outline-4">
<h4 id="org7761ccb">自定义宏</h4>
<div class="outline-text-4" id="text-org7761ccb">
<p>
File -&gt; Build Settings -&gt; Player Settings /Other Settings/Scripting Define Symbols<br />
</p>

<p>
<a href="https://docs.unity3d.com/Manual/PlatformDependentCompilation.html">https://docs.unity3d.com/Manual/PlatformDependentCompilation.html</a><br />
</p>
</div>
</div>
<div id="outline-container-org396615d" class="outline-4">
<h4 id="org396615d">Unity 命令行</h4>
<div class="outline-text-4" id="text-org396615d">
<p>
Unity 命令行参数文档  <a href="https://docs.unity3d.com/Manual/CommandLineArguments.html">https://docs.unity3d.com/Manual/CommandLineArguments.html</a><br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org5b6db72" class="outline-2">
<h2 id="org5b6db72">Usage</h2>
<div class="outline-text-2" id="text-org5b6db72">
</div>
<div id="outline-container-org508a446" class="outline-3">
<h3 id="org508a446">prefab</h3>
<div class="outline-text-3" id="text-org508a446">
</div>
<div id="outline-container-orgf233d7c" class="outline-4">
<h4 id="orgf233d7c">取消预制体关联</h4>
<div class="outline-text-4" id="text-orgf233d7c">
<ol class="org-ol">
<li>将 GameObject 拖到 Assets 中的一个临时目录，创建一个临时的 Prefab<br /></li>
<li>执行菜单命令 GameObject/Break Prefab Instance<br /></li>
<li>删除第一步中的临时 Prefab<br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org0497b8a" class="outline-3">
<h3 id="org0497b8a">search</h3>
</div>
</div>
<div id="outline-container-orge27307a" class="outline-2">
<h2 id="orge27307a">Optimize</h2>
<div class="outline-text-2" id="text-orge27307a">
</div>
<div id="outline-container-org3e53a61" class="outline-3">
<h3 id="org3e53a61">Optimizing Graphics Performance</h3>
<div class="outline-text-3" id="text-org3e53a61">
<pre class="example">
翻译自 OptimizingGraphicsPerformance.html
</pre>
<p>
好的性能是很多游戏成功的关键。下面是一些最大化游戏图形渲染速度的简单指导方针。<br />
</p>
</div>
<div id="outline-container-org8493adb" class="outline-4">
<h4 id="org8493adb">where are the graphics costs</h4>
<div class="outline-text-4" id="text-org8493adb">
<p>
哪些地方会有图形消耗?<br />
游戏的图形部分主要会消耗计算机的两大系统：GPU 和 CPU。任何优化的第一准则就是找出性能问题发生在哪儿。因为优化 GPU 和 CPU 的策略会非常不同（甚至是相反的，通常会让 GPU 一次做更多的工作来实现优化，而 CPU 则恰恰相反）<br />
</p>
</div>

<div id="outline-container-org5defd96" class="outline-5">
<h5 id="org5defd96">典型的瓶颈以及检测他们的方法</h5>
<div class="outline-text-5" id="text-org5defd96">
</div>
<div id="outline-container-org05886c1" class="outline-6">
<h6 id="org05886c1">GPU 通常会受到填充率和内存带宽的限制:</h6>
<div class="outline-text-6" id="text-org05886c1">
<p>
是否游戏在低分辨率设备上运行的更快？如果是这样，你很可能是受到了填充率在 GPU 上的限制。<br />
</p>
</div>
</div>
<div id="outline-container-orgb748d2f" class="outline-6">
<h6 id="orgb748d2f">CPU 通常会受到需要被渲染的批处理的数量的限制</h6>
<div class="outline-text-6" id="text-orgb748d2f">
<p>
在 Rendering Statistics 窗口可以检查”batches”的数量。<br />
</p>

<p>
当然，这里只有首要的原则；瓶颈也可能发生在其他什么地方。比较不典型的瓶颈有：<br />
</p>
</div>
</div>
<div id="outline-container-orgf760576" class="outline-6">
<h6 id="orgf760576">不是渲染的问题，无论是在 GPU 还是 CPU 上。</h6>
<div class="outline-text-6" id="text-orgf760576">
<p>
例如你的脚本和物理可能才是真正的问题。用 Profiler 可以将其指出来。<br />
</p>
</div>
</div>
<div id="outline-container-org293e718" class="outline-6">
<h6 id="org293e718">GPU 有很多顶点需要处理。多少个顶点是可以接受的，这一点取决于 GPU 以及顶点着色器的复杂度。</h6>
<div class="outline-text-6" id="text-org293e718">
<p>
通常数据表明，在移动设备上，顶点数目不要超过 10 万个，在 PC 平台上，不要超过几百万个。<br />
</p>
</div>
</div>
<div id="outline-container-org939659e" class="outline-6">
<h6 id="org939659e">对于一些需要在 CPU 进行的顶点处理，CPU 也有很多顶点需要处理。</h6>
<div class="outline-text-6" id="text-org939659e">
<p>
例如，网格蒙皮，布料模拟，特效等。<br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org84ce040" class="outline-4">
<h4 id="org84ce040">CPU optimization</h4>
<div class="outline-text-4" id="text-org84ce040">
<p>
为了渲染屏幕上的任何物体，CPU 必须要做一些工作——计算出哪些光照影响到了这些物体，设置着色器以及他们的参数，发生绘制命令给图形驱动，图形驱动会准备这些命令发送给图形卡（显卡）。所有这些每个物体的 CPU 消耗都不廉价，有很多可见的物体时，消耗会叠加。<br />
所以，如果你有一千个三角形，他们如果都在一个网格内，那将会比每个三角形都有一个独立的网格的情况要高效很多。这两种情况在 GPU 上的消耗是差不多的，但是在 CPU 上，渲染一千个物体和一个物体所做的工作将有很明显差别。<br />
</p>

<p>
为了让 CPU 少做一些工作，最好减少可见物体的数量：<br />
</p>
</div>
<div id="outline-container-org0b59e62" class="outline-6">
<h6 id="org0b59e62">使用手动方式或者 Unity 的 draw call 批处理方式，将靠近的物体组合在一起。</h6>
</div>
<div id="outline-container-org5e35e0b" class="outline-6">
<h6 id="org5e35e0b">游戏物体使用尽可能少的材质，将不同的贴图放到一张更大的贴图地图中。</h6>
</div>
<div id="outline-container-org4e9a0d2" class="outline-6">
<h6 id="org4e9a0d2">尽可能少使用导致多次渲染物体的效果（例如，反射、阴影、基于像素的光照等等）</h6>
<div class="outline-text-6" id="text-org4e9a0d2">
<p>
组合物体到一起从而每个网格最少有几百个三角形并且为整个网格使用一个材质。将两个不共享同一材质的物体合并在一起不会获得任何性能的提升。最常见的需要有多个材质的原因是两个网格使用不同的贴图，所以，为了优化 CPU 性能，你应该保证你组合到一起的物体使用同一个贴图。<br />
</p>

<p>
然而，在正向渲染中，当使用很多基于像素的光照，有很多情况下，将多个物体合并可能不会管用，就像下面的解释。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org57d11e3" class="outline-4">
<h4 id="org57d11e3">GPU: Optimizing Model Geometry</h4>
<div class="outline-text-4" id="text-org57d11e3">
<p>
优化一个模型的几何时，有两个基础的准则：<br />
</p>
</div>
<div id="outline-container-org0911518" class="outline-6">
<h6 id="org0911518">不要使用任何多余的不必要的三角形</h6>
</div>
<div id="outline-container-org2ecbb33" class="outline-6">
<h6 id="org2ecbb33">保持 UV 贴图接缝和硬边缘的数目越少越好</h6>
<div class="outline-text-6" id="text-org2ecbb33">
<p>
需要注意的是图形硬件需要处理的实际的顶点的数目通常和 3D 应用程序导出的顶点的数目是不相同的。模型应用程序通常显示的是几何顶点数目，例如组成模型的不同的角点。然而，对于显卡来说，为了渲染的目的，一些结合顶点需要被分为两个或更多个逻辑顶点。如果一个顶点有多个法线、贴图坐标或顶点颜色，这个顶点就必须被分为多个逻辑顶点。因此，Unity 中的顶点数目总是要比 3D 应用程序所给的顶点数目多。<br />
</p>

<p>
尽管模型中的几何数量大多会影响到 GPU，在 Unity 中一些特性依然会在 CPU 中处理模型，例如网格蒙皮。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org30de4ed" class="outline-4">
<h4 id="org30de4ed">Lighting Performance</h4>
<div class="outline-text-4" id="text-org30de4ed">
<p>
不进行计算的光照总是最快的！只需要使用光照贴图来 bake 静态光照一次，就可以代替每一帧的光照计算。在 Unity 中，生成光照贴图环境的处理过程所花的时间只会比将一个光照放在场景中长一点，但是：<br />
</p>
</div>
<div id="outline-container-org74bea59" class="outline-6">
<h6 id="org74bea59">光照贴图要运行的更快（比基于像素的光照快 2-3 倍）</h6>
</div>
<div id="outline-container-orgc7b439e" class="outline-6">
<h6 id="orgc7b439e">并且看上去效果要更好，因为你可以烘焙的全局照明而且光照贴图可以平滑化结果。</h6>
<div class="outline-text-6" id="text-orgc7b439e">
<p>
在很多情况下，在 shader 和内容中有一些简单的技巧可以代替到处添加光照。例如，可以在 shader 中添加专门的边缘发光计算，来代替添加一个光照直接照射摄像机从而获得边缘发光的效果。<br />
</p>
</div>
</div>
<div id="outline-container-orgf5302f4" class="outline-5">
<h5 id="orgf5302f4">Lights in forward rendering</h5>
<div class="outline-text-5" id="text-orgf5302f4">
<p>
基于像素的动态光照会给每个被影响的像素增加明显的渲染负荷，并且会导致物体在多个阶段中被渲染。在性能低的设备上，例如移动设备或底端 PC GPU 上，需要避免有多于一个的像素光照照明任何一个物体，并且使用光照贴图代替每帧的光照计算来照亮静态物体。基于顶点的动态光照会给顶点变换添加明显的消耗。尽可能避免多个光照照明任何一个给定物体的情况。<br />
如果你使用基于像素的光照，每个网格必须被渲染的次数和它被照明的像素光照的数目是相同的。如果你合并两个相距较远的物体，这将会增加组合物体的有效尺寸。所有的照明了组合物体的任何一部分的像素光照，在渲染过程中都会被考虑，所以需要执行的渲染阶段的数量将会增加。通常渲染组合物体时，需要执行的阶段数目是所有分开的物体的阶段数目的总和，所以组合没有获得任何好处。基于这样的原因，你不应该将分开的比较远的不被同一组像素光照影响的网格合并在一起。<br />
</p>

<p>
在渲染期间，Unity 会找出一个网格周围的所有光照，并且计算其中有哪些光照对物体影响最大。Quality Settings 用来修改有多少光照最终被当做像素光照，以及有多少被当做顶点光照。每个光照会基于它离网格的距离以及它的照明强度来计算它的重要性。更进一步，只从游戏内容来看，一些光照比另外一些要更重要。基于这样的原因，每个光照都有一个 RenderMode 设置，它可以被设置为 Important 或者 Not Important；被标记为 Not Important 的光照通常会有较低的渲染负载。<br />
例如，在一个驾驶游戏中，玩家在黑暗中打开车头灯驾驶。车头灯很可能是游戏中最明显的光源，所以他们的 RenderMode 应该被设置为 Important。另一方面，游戏中一定包含不太重要的等（汽车的尾灯）并且使用像素光照，他们也不会改善可视化效果。这样的灯光应该被设置为 Not Important，从而避免在只能获得很小效果的地方浪费渲染能力。<br />
</p>

<p>
优化基于像素的光照可以同时节省 CPU 和 GPU 消耗：对于额外的物体渲染，CPU 有更少的 draw call 需要做，GPU 有更少的顶点需要处理、更少的像素需要光栅化。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org3c1e57f" class="outline-4">
<h4 id="org3c1e57f">GPU: Texture Compression and Mipmaps</h4>
<div class="outline-text-4" id="text-org3c1e57f">
<p>
使用压缩贴图将会减低你的贴图大小（从而使加载时间更快，内存占用更小）并且可以显著地增加渲染性能。压缩的贴图所使用的内存带宽和未压缩的 32 位 RGBA 贴图所使用的内存带宽相比，只是一小部分。<br />
</p>
</div>
<div id="outline-container-org7db01e5" class="outline-5">
<h5 id="org7db01e5">Use Texture Mip Maps</h5>
<div class="outline-text-5" id="text-org7db01e5">
<p>
首要的规则是，对于在 3D 场景中使用的贴图，应该总是开启 MipMaps 生成。在 GPU 渲染时，就像贴图压缩可以帮助限制贴图数据的数量，一个 mip mapped 贴图可以让 GPU 为更小的三角形使用低分辨率的贴图。<br />
这个规则的唯一的例外是贴图图元以 1 比 1 映射到屏幕像素，例如 UI 元素，或者是在 2D 游戏中。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org69d9474" class="outline-4">
<h4 id="org69d9474">LOD and Per-Layer Cull Distances</h4>
<div class="outline-text-4" id="text-org69d9474">
<p>
在一些游戏中，为了减低 CPU 和 GPU 的负载，积极地剔除比较小的物体可能更合适。例如，小石块和碎片应该在距离很远时变的不可见，然而巨大的建筑却依然可见。<br />
这可以通过 Level Of Detail system 来实现，或者通过在摄像机上手动设置每个层的剔除距离。你可以将小物体放到一个分开的层中并且使用 Camera.layerCullDistances 脚本函数来设置每个层的剔除距离。<br />
</p>
</div>
</div>

<div id="outline-container-org23d8ec9" class="outline-4">
<h4 id="org23d8ec9">Realtime Shadows</h4>
<div class="outline-text-4" id="text-org23d8ec9">
<p>
实时阴影非常的棒，但他们会消耗很多的性能，在 CPU 上会有额外的 draw calls，在 GPU 上也有额外的处理。<br />
更多详细情况，请参阅 Light Performance。<br />
</p>
</div>
</div>

<div id="outline-container-org8795a3f" class="outline-4">
<h4 id="org8795a3f">GPU: Tips for writing high-performance shaders</h4>
<div class="outline-text-4" id="text-org8795a3f">
<p>
毫不夸张地讲，一个高端的 PC GPU 和一个底端的移动设备 GPU 有几百倍的性能差别。即使在同一平台上，也是一样的。在一个 PC 上，一个快速的 GPU 要比一个慢速的集成的 GPU 快几十倍；在移动平台上你也可以看到 GPU 直接的巨大差异。<br />
所以需要记住移动平台和底端 PC 上的 GPU 性能会比你的开发机器低很多。通常着色器需要手动优化来减低计算和贴图读取，从而获得好的性能。例如，内置的 Unity 着色器有他们等价的“mobile”版本，他们会更加高效（但是有一些限制或者近似 - 这使得他们更高效）。<br />
</p>

<p>
下面是一些指导方针，他们对于移动平台和底端 PC 显卡比较重要：<br />
</p>
</div>
<div id="outline-container-orgb6918fb" class="outline-5">
<h5 id="orgb6918fb">Complex mathematical operations</h5>
<div class="outline-text-5" id="text-orgb6918fb">
<p>
超越数学函数（幂函数、指数函数，对数函数，余弦函数，正弦函数，正切函数等）是非常昂贵的，所以一个好的首要规则是每个像素不要超过一个这样的操作。在适用的地方，可以考虑将贴图查询作为可选方案。<br />
尝试编写你自己的规范化、点积、inverse sqrt 操作是不明智的。如果你适用内置的方法，驱动会为你生成更好的代码。<br />
记住 alpha 测试（discard）操作将会是你的片段处理变慢。<br />
</p>
</div>
</div>
<div id="outline-container-org17c7e58" class="outline-5">
<h5 id="org17c7e58">Floating point operations</h5>
<div class="outline-text-5" id="text-org17c7e58">
<p>
在写自定义的着色器时，你应该总是指定浮点数变量的精度。选择尽可能小的浮点数格式来获得最好的性能是至关重要的。操作的精度在很多桌面 GPU 上是完全被忽略的，但是对于很多移动平台的 GPU 却是至关重要的。<br />
如果 shader 是使用 Cg/HLSL 编写的，可以按照下面描述来指定精度：<br />
float - 32 位浮点数格式，适用于顶点变换但它是性能最慢的.<br />
half  - 16 位浮点数格式，适用于贴图 UV 坐标并且比 float 差不多要快 2 倍.<br />
fixed - 10 位浮点数格式，适用于颜色，光照计算和其他高性能操作并且比 float 差不多快 4 倍.<br />
如果 shader 是用 GLSL 编写的，浮点数精度是分别通过 highp、mediump、lowp 来指定的。<br />
关于 shader 性能的更多的详细信息可以在 Shader Performance 页面中找到。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org37f62b1" class="outline-4">
<h4 id="org37f62b1">Simple Checklist to make Your Game Faster</h4>
<div class="outline-text-4" id="text-org37f62b1">
<ul class="org-ul">
<li>在 PC 平台下，依据目标 GPU 不同，保持每帧的顶点数目低于 200k 到 3M<br /></li>
<li>如果你使用内置着色器，请选择移动平台类型或无光照类型。他们可以在非移动平台上也可以很好的运行；他们只是更复杂的着色器的简化版和近似版。<br /></li>
<li>保持每个场景中不同材质的数目比较少，尽量在多个不同的物体之间共享材质。<br /></li>
<li>为不移动的物体设置静态属性，从而允许静态批处理等内部优化。<br /></li>
<li>不要使用不必要的像素光照，应该选择只有一个像素光照可以影响你的几何体。<br /></li>
<li>不要使用不必要的动态光照，应该选择烘焙光照来代替。<br /></li>
<li>如果可以的话尽量使用压缩格式的贴图，另外和 32 位贴图相比优先选择 16 位贴图格式。<br /></li>
<li>不要使用不必要的雾效果。<br /></li>
<li>了解遮挡剔除的好处，在有很多遮挡的静态场景的情况下，使用它来减低可见几何体和 draw calls 的数量.规划你的场景从遮挡剔除中获益。<br /></li>
<li>使用天空盒来伪造远处的几何体。<br /></li>
<li>使用像素着色器或贴图组合器来混合多个贴图从而代替多个阶段的处理。<br /></li>
<li>如果编写自定的着色器，应该总是尽可能使用最小的浮点数格式：<br />
<ol class="org-ol">
<li>fixed / lowp    - 用于颜色，光照信息和法线<br /></li>
<li>half  / mediump - 用于 UV 坐标<br /></li>
<li>float / highp   - 避免在像素着色器中使用，最好用于在顶点着色器中计算位置。<br /></li>
</ol></li>
<li>在像素着色器中，最小化使用复杂的数学运算，例如 pow sin cos 等等。<br /></li>
<li>对于每个片段，尽可能使用少的贴图。<br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orga8d99b6" class="outline-3">
<h3 id="orga8d99b6">Draw Call Batching</h3>
<div class="outline-text-3" id="text-orga8d99b6">
<pre class="example">
翻译自 DrawCallBatching.html
</pre>
<p>
为了将一个物体绘制在屏幕上，引擎必须发送一个绘制调用给图形 API（例如,OpenGL 或 Direct3D）。绘制调用通常是很昂贵的，每一次绘制调用都会有图形 API 做一些重要的工作，导致在 CPU 端有性能负载。这大多数是因为不同的绘制调用之间状态的改变而引起的（例如，切换不同的材质），这导致了图形驱动中，昂贵的生效和变换步骤。<br />
Unity 使用 static batching 来处理这种情况。静态批处理的目标是将尽可能多的网格重新分组到尽可能少的 buffer 中，从而获得更好的性能。这样做的结果是少量的巨大的网格会被渲染，从而代替了大量的低效的小的网格。Unity 会在同样的资源上循环渲染这些资源的不同区间。它为每个 static batched 网格，高效地执行一系列的快速绘制调用。<br />
Unity 中内置的批处理支持比简单地合并几何体到模型中要有很显著的好处。在 Unity5.0 中，开始时只有一个构建的索引缓存区，然后对于大网格的每一个可见的子网格，会提交一个绘制调用。<br />
</p>
</div>
<div id="outline-container-org70a64b8" class="outline-4">
<h4 id="org70a64b8">Materials</h4>
<div class="outline-text-4" id="text-org70a64b8">
<p>
只有共享相同材质的物体才可以被 batch 在一起。所以，如果你想好的 batching，你需要尽可能在多个不同物体之间共享材质。<br />
如果你有两个不同的材质他们只是贴图不同，你可以将这些贴图合并到一个大贴图中（这个处理过程经常被称做贴图地图）。当贴图在同一个贴图地图中时，你就可以用一个材质来代替多个不同材质了。<br />
如果你需要在脚本中访问共享的材质属性，非常重要的一点是修改 Renderer.material 将会创建一个材质副本。而你应该使用 Renderer.sharedMaterial 来保持材质的共享。<br />
</p>
</div>
</div>
<div id="outline-container-org891036a" class="outline-4">
<h4 id="org891036a">Dynamic Batching</h4>
<div class="outline-text-4" id="text-org891036a">
<p>
Unity 可以自动 batch 移动的物体到相同的 draw call 中，条件是他们需要共享相同的材质以及满足一些其他条件。Dynamic batching 是自动进行的并且不需要你的任何额外工作。<br />
</p>
</div>
<div id="outline-container-org3503d8b" class="outline-5">
<h5 id="org3503d8b">Tips:</h5>
<div class="outline-text-5" id="text-org3503d8b">
<ul class="org-ul">
<li>批处理动态物体对于每个顶点都有负荷，所以只会应用于顶点属性总数少于 900 的网格。<br />
<ol class="org-ol">
<li>如果你的着色器使用顶点位置、法线和一个 UV、你可以批处理 300 个顶点；然而，如果你需要使用顶点位置、法线、UV0、UV1 以及切线，你只可以批处理 180 个顶点。<br /></li>
<li>请注意：属性数量限制在未来可能会改变。Please note: attribute count limit might be changed in future<br /></li>
</ol></li>
<li>一般来讲，物体应该使用相同的缩放比例。<br />
非统一缩放对象属于例外；如果很多对象都有不同的非统一缩放，它们依然可以被 batched。<br /></li>
<li>使用不同的材质实例（即使他们相同）将使得物体无法被一起 batched。<br /></li>
<li>使用光照贴图的物体有额外的渲染参数：光照贴图索引以及光照贴图中的偏移和缩放。所以通常来讲动态光照贴图对象应该指定相同的光照贴图位置来支持 batched。<br /></li>
<li>多阶段着色器将会打破批处理。在正向渲染中，几乎所有的 unity 着色器都支持多个光照，实际上是为他们执行额外的阶段。额外的像素光照的绘制调用将不会被 batched。<br /></li>
<li>接收实时阴影的物体也不可以被 batched。<br /></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org121a408" class="outline-4">
<h4 id="org121a408">Static Batching</h4>
<div class="outline-text-4" id="text-org121a408">
<p>
另一方面，静态批处理允许引擎降低任意大小几何体的 draw calls（假如它不会移动并且共享相同的材质）。静态批处理比动态批处理效果更加显著，但是它会使用更多的内存。你应该选择使用静态批处理，因为它只占用少量的 CPU 功能。<br />
</p>

<p>
为了利用静态批处理的优势，你需要显式地指定特定的物体在游戏中是静止的，将不会被移动，旋转和缩放。在 Inspector 面板中勾选 Static 选项即可。<br />
</p>

<p>
使用静态批处理将需要额外的内存来存储组合后的几何体。在静态批处理之前，如果多个物体共享同一个几何体，这是会为每个对象创建一个几何体副本，无论是在编辑器中还是在实际运行中。这可能并不是一个好的主意 - 有时候你必须为一些物体避免使用静态批处理牺牲渲染性能来保持较低的内存占用。例如，在一个稠密的森林关卡中，将树木标记为静态会有很严重的内存影响。<br />
</p>

<p>
在内部实现中，静态批处理将静态物体转换到世界空间，并且建立一个顶点和索引缓冲区。然后，在同一个批处理中的所有可见物体，会执行一系列的廉价的 draw calls，这些 draws 之间几乎没有状态改变。所以，技术上来讲静态批处理并没有节省“3D API draw calls”，但是它节省了不同 draw calls 之间的状态改变（这是非常耗时的一部分）。<br />
</p>
</div>
</div>
<div id="outline-container-org231b25f" class="outline-4">
<h4 id="org231b25f">Other batching tips</h4>
<div class="outline-text-4" id="text-org231b25f">
<p>
目前，只有 Mesh Renderers 和 Particle Systems 是被 batched 的。这意味着网格蒙皮、布料、路径渲染以及其他类型的渲染组件是不被 batched。<br />
</p>

<p>
半透明着色器通常需要以从后到前的顺序渲染物体。Unity 首先会以这样的顺序排列物体，然后尝试将他们批处理（但是，因为必须满足严格的顺序，这就意味着比起不透明物体来讲，只有更少的物体可以批处理）。<br />
</p>

<p>
为了批处理 draw call，手动组合那些互相比较靠近的物体可能是一个比较好的选择。例如，一个放有很多衣物的静态橱柜被组合为一个网格是有意义的，你可以通过 3D 模型应用程序或者是使用 Mesh.CombineMeshes 来实现组合。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-orgcb8f7bc" class="outline-3">
<h3 id="orgcb8f7bc">Modeling characters for optimal performance</h3>
<div class="outline-text-3" id="text-orgcb8f7bc">
<pre class="example">
翻译自 ModelingOptimizedCharacters.html
</pre>
<p>
Below are some tips for designing character models to give optimal rendering speed.<br />
下面是设计角色模型达到最佳渲染速度的一些提示：<br />
</p>
</div>
<div id="outline-container-orgf1d3b87" class="outline-4">
<h4 id="orgf1d3b87">使用单个蒙皮网格渲染</h4>
<div class="outline-text-4" id="text-orgf1d3b87">
<p>
你应该为每个角色只使用一个蒙皮网格渲染。Unity 使用可见性剔除和边界体积更新来优化动画，并且这些优化在只使用了一个 Animation 组件以及一个 Skinned Mesh Renderer 组件的时候才激活。使用两个 Shinned Mesh Renderer 来代替单个 Shinned Mesh Renderer 会导致一个模型的渲染时间几乎翻倍，使用多个网格很少有任何实际优势。<br />
</p>
</div>
</div>
<div id="outline-container-orgfdc9067" class="outline-4">
<h4 id="orgfdc9067">使用尽可能少的材质</h4>
<div class="outline-text-4" id="text-orgfdc9067">
<p>
你应该尽可能降低每个网格使用的材质数目。为一个角色使用多个材质的唯一原因是你需要为角色的不同部位使用不同的着色器。然而，在大多数情况下，每个角色使用 2-3 个材质应该是足够了。<br />
</p>
</div>
</div>
<div id="outline-container-org1d23604" class="outline-4">
<h4 id="org1d23604">使用尽可能少的骨骼</h4>
<div class="outline-text-4" id="text-org1d23604">
<p>
在一个典型的桌面游戏中，一个骨骼层级中大概会使用 15-60 个骨骼。使用的骨骼数目越少，性能会越好。使用 30 个骨骼的话，你可以在桌面平台和移动平台上都获得不错的品质。理性情况下，保证移动平台中骨骼数目少于 30 个，并且在桌面游戏中不要超出 30 个太多。<br />
</p>
</div>
</div>
<div id="outline-container-org4145853" class="outline-4">
<h4 id="org4145853">多边形数目</h4>
<div class="outline-text-4" id="text-org4145853">
<p>
多边形的数目取决于你需要的品质以及你的目标平台。对于移动设备来说，每个网格的多边形介于 300 和 1500 个会有一个好的结果，然而，对于桌面平台来说，理想的范围是 1500 到 4000。在任何给定时间点，如果游戏中有很多角色出现在屏幕上，你可能需要降低每个网格的多边形的数量。<br />
</p>
</div>
</div>
<div id="outline-container-org9ee4ec0" class="outline-4">
<h4 id="org9ee4ec0">保持正向运动和反向运动分开</h4>
<div class="outline-text-4" id="text-org9ee4ec0">
<p>
当动画被导入时，一个模型的反向运动节点会被烘焙到正向运动中作为最终结果，Unity 不需要反向运动节点。然而，如果将他们留在模型中他们会有 CPU 负载，尽管他们不影响动画。你可以依据你的偏好在 Unity 中或者是使用模型工具删除这些冗余的逆向运动节点。理想的情况是，你应该在建模的过程中，保持反向运动和正向运动层级分开，从而在需要删除反向运动节点时会比较容易。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org62c721c" class="outline-3">
<h3 id="org62c721c">Optimizing Shader Load Time</h3>
<div class="outline-text-3" id="text-org62c721c">
<pre class="example">
翻译自 OptimizingShaderLoadTime.html
</pre>
<p>
着色器都是在 GPU 上执行的小程序，加载它们会花费一些时间。通常情况下每个独立的 GPU 程序不会花费太多的加载时间，但是在内部着色器会有很多变体。<br />
例如，标准着色器，如果完全编译的话，最终会是成千上万个稍微不同的 GPU 程序。这造成了两个潜在的问题：<br />
</p>
<ul class="org-ul">
<li>巨大数量的着色器变体增加了游戏编译时间，以及游戏的大小。<br /></li>
<li>在游戏中，加载巨大数量的着色器变体会比较慢，并且占用会内存。<br /></li>
</ul>
</div>
<div id="outline-container-orga796781" class="outline-4">
<h4 id="orga796781">Shader build time stripping</h4>
<div class="outline-text-4" id="text-orga796781">
<p>
着色器编译时间剥离<br />
</p>

<p>
在编译游戏时，Unity 可以检测一些内部的着色器变体不会被游戏用到，并且可以忽略他们。下面两种情况下，会剥离着色器编译时间：<br />
</p>
<ul class="org-ul">
<li>独立的着色器特性，对于使用了#pragma shader_feature 的着色器。如果在使用的材质中，没有用到这个特定的变体，该着色器变体不会被包含在编译中。详细信息可以查看 internal shader variants 文档。除了内置着色器以外，标准着色器也是这样的。<br /></li>
<li>着色器变体用来处理雾并且光照贴图模式没有被任何场景使用时，着色器变体也不会被包含在游戏数据中。如果你想覆盖这种行为，你可以查看 Graphics Settings 文档。<br /></li>
</ul>

<p>
组合上面的基本上可以降低着色器数据的大小。例如，一个完全编译的标准着色器将会占用几百兆字节，但是一个特定的项目中最终只会占用两兆字节（并且在应用程序打包处理时会进一步压缩）。<br />
</p>
</div>
</div>
<div id="outline-container-org02868d5" class="outline-4">
<h4 id="org02868d5">Default Unity shader loading behavior</h4>
<div class="outline-text-4" id="text-org02868d5">
<p>
在所有默认设置情况下，Unity 加载 shaderlab 着色器对象到内存中，但并不会创建内置的着色器变体，直到他们被需要的时候。<br />
这就意味着被包含在游戏编译中的着色器变体还是有可能被使用，但是并不会有内存占用也没有加载时间消耗，直到他们被需要的时候。例如，着色器总是包含一个变体来处理带有阴影的点光照，但是，如果你最终没有在游戏中使用带有阴影的点光源，就不会加载这个特定的变体。<br />
然而，默认行为的一个缺点是，当第一次需要某个特定的着色器变体时，可能会造成卡顿，因为一个新的 GPU 程序被加载到图形驱动中。在游戏过程中，这通常是不希望看到这种情况的，所以 Unity 有 ShaderVariantCollection 资源来帮助解决这个问题。<br />
</p>
</div>
</div>

<div id="outline-container-org0abaab7" class="outline-4">
<h4 id="org0abaab7">Shader Variant Collections</h4>
<div class="outline-text-4" id="text-org0abaab7">
<p>
ShaderVariantCollection 是一个基于着色器列表的资源，对于列表中的每个元素，有一个 Pass 类型列表和 shader 关键字组合被加载。<br />
为了基于实际使用的着色器和他们的变体来创建这些资源，编辑器可以追踪哪些着色器以及他们的变体在实际中被使用。在 Graphics Settings 中，有一个按钮可以依据当前追踪的着色器来创建一个新的 ShaderVariantCollection，或者是清除当前追踪的着色器列表。<br />
一旦你有了 ShaderVariantCollection 资源，你可以设置着色器变体在游戏加载时自动加载(在 Graphics Settings 下的 Preloaded Shaders 列表中设置)，或者你可以预加载独立的着色器变体集合。详细信息可以查看 ShaderVariantCollection 脚本类。<br />
</p>
</div>
</div>
</div>
<div id="outline-container-org8dcbb40" class="outline-3">
<h3 id="org8dcbb40">Animation Optimize</h3>
<div class="outline-text-3" id="text-org8dcbb40">
</div>
<div id="outline-container-orgb75f881" class="outline-4">
<h4 id="orgb75f881">MecanimPeformanceandOptimization</h4>
<div class="outline-text-4" id="text-orgb75f881">
<p>
<a href="https://docs.unity3d.com/Manual/MecanimPeformanceandOptimization.html">https://docs.unity3d.com/Manual/MecanimPeformanceandOptimization.html</a><br />
</p>
</div>
</div>
<div id="outline-container-org92f2dd0" class="outline-4">
<h4 id="org92f2dd0">参考文档</h4>
<div class="outline-text-4" id="text-org92f2dd0">
<p>
<a href="https://gameinstitute.qq.com/community/detail/113452">https://gameinstitute.qq.com/community/detail/113452</a><br />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org59adb94" class="outline-2">
<h2 id="org59adb94">Android Platform</h2>
<div class="outline-text-2" id="text-org59adb94">
</div>
<div id="outline-container-orgbb8e336" class="outline-3">
<h3 id="orgbb8e336">开发环境</h3>
<div class="outline-text-3" id="text-orgbb8e336">
<ol class="org-ol">
<li>下载 Android Studio 安装 Android SDK<br /></li>
<li>安装 JDK<br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orgc5caf2a" class="outline-2">
<h2 id="orgc5caf2a">Q&amp;A</h2>
<div class="outline-text-2" id="text-orgc5caf2a">
</div>
<div id="outline-container-org35220de" class="outline-3">
<h3 id="org35220de">激活 GameObject 和激活 Component 分别使用什么方法？</h3>
<div class="outline-text-3" id="text-org35220de">
<p>
gameObject.SetActive(true)<br />
comp.enabled = true<br />
大部分组件是包含 enabled 属性的，但是该属性并不是 Component 类的成员，例如：Transform 属性是没有 enabled 属性的。<br />
</p>
</div>
</div>
<div id="outline-container-org30f3131" class="outline-3">
<h3 id="org30f3131">删除 GameObject 和删除 Component 分别使用什么方法？</h3>
<div class="outline-text-3" id="text-org30f3131">
<p>
GameObject.Destroy(gameObject);<br />
GameObject.Destroy(com);<br />
</p>
</div>
</div>
<div id="outline-container-org34df9fd" class="outline-3">
<h3 id="org34df9fd">Unity 中插件下载目录在哪儿？</h3>
<div class="outline-text-3" id="text-org34df9fd">
<pre class="example">
- Win7/win8 
	C:\Users\accountName\AppData\Roaming\Unity\Asset Store
- mac 下
	~/Library/Unity/Asset Store
</pre>
</div>
</div>
</div>
</div>
</body>
</html>
